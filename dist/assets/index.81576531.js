var bO=Object.defineProperty;var wO=(re,oe,jt)=>oe in re?bO(re,oe,{enumerable:!0,configurable:!0,writable:!0,value:jt}):re[oe]=jt;var kr=(re,oe,jt)=>(wO(re,typeof oe!="symbol"?oe+"":oe,jt),jt);(async()=>{var pd;(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))e(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&e(s)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerpolicy&&(i.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?i.credentials="include":r.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function e(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}})();const re=Symbol.for("_am_meta"),oe=Symbol.for("_am_trace"),jt=Symbol.for("_am_objectId"),Zo=Symbol.for("_am_isProxy"),Km=Symbol.for("_am_uint"),Hm=Symbol.for("_am_int"),Gm=Symbol.for("_am_f64"),Yl=Symbol.for("_am_counter"),Zm=Symbol.for("_am_text");class En{constructor(t){if(typeof t=="string")this.elems=[...t];else if(Array.isArray(t))this.elems=t;else if(t===void 0)this.elems=[];else throw new TypeError(`Unsupported initial value for Text: ${t}`);Reflect.defineProperty(this,Zm,{value:!0})}get length(){return this.elems.length}get(t){return this.elems[t]}[Symbol.iterator](){const t=this.elems;let e=-1;return{next(){return e+=1,e<t.length?{done:!1,value:t[e]}:{done:!0}}}}toString(){if(!this.str){this.str="";for(const t of this.elems)typeof t=="string"?this.str+=t:this.str+="\uFFFC"}return this.str}toSpans(){if(!this.spans){this.spans=[];let t="";for(const e of this.elems)typeof e=="string"?t+=e:(t.length>0&&(this.spans.push(t),t=""),this.spans.push(e));t.length>0&&this.spans.push(t)}return this.spans}toJSON(){return this.toString()}set(t,e){if(this[re])throw new RangeError("object cannot be modified outside of a change block");this.elems[t]=e}insertAt(t,...e){if(this[re])throw new RangeError("object cannot be modified outside of a change block");this.elems.splice(t,0,...e)}deleteAt(t,e=1){if(this[re])throw new RangeError("object cannot be modified outside of a change block");this.elems.splice(t,e)}map(t){this.elems.map(t)}lastIndexOf(t,e){this.elems.lastIndexOf(t,e)}concat(t){return new En(this.elems.concat(t.elems))}every(t){return this.elems.every(t)}filter(t){return new En(this.elems.filter(t))}find(t){return this.elems.find(t)}findIndex(t){return this.elems.findIndex(t)}forEach(t){this.elems.forEach(t)}includes(t){return this.elems.includes(t)}indexOf(t){return this.elems.indexOf(t)}join(t){return this.elems.join(t)}reduce(t){this.elems.reduce(t)}reduceRight(t){this.elems.reduceRight(t)}slice(t,e){new En(this.elems.slice(t,e))}some(t){return this.elems.some(t)}toLocaleString(){this.toString()}}class Os{constructor(t){this.value=t||0,Reflect.defineProperty(this,Yl,{value:!0})}valueOf(){return this.value}toString(){return this.valueOf().toString()}toJSON(){return this.value}}class Ym extends Os{constructor(t,e,r,i,s){super(t),this.context=e,this.path=r,this.objectId=i,this.key=s}increment(t){return t=typeof t=="number"?t:1,this.context.increment(this.objectId,this.key,t),this.value+=t,this.value}decrement(t){return this.increment(typeof t=="number"?-t:-1)}}function Xm(n,t,e,r,i){return new Ym(n,t,e,r,i)}class Xl{constructor(t){this.val=t}}function We(n){if(typeof n=="string"&&/^[0-9]+$/.test(n)&&(n=parseInt(n,10)),typeof n!="number")return n;if(n<0||isNaN(n)||n===1/0||n===-1/0)throw new RangeError("A list index must be positive, but you passed "+n);return n}function me(n,t){const{context:e,objectId:r,path:i,readonly:s,heads:l,textV2:c}=n,h=e.getWithType(r,t,l);if(h===null)return;const d=h[0],m=h[1];switch(d){case void 0:return;case"map":return ro(e,m,c,[...i,t],s,l);case"list":return Xo(e,m,c,[...i,t],s,l);case"text":return c?e.text(m,l):oo(e,m,[...i,t],s,l);case"str":return m;case"uint":return m;case"int":return m;case"f64":return m;case"boolean":return m;case"null":return null;case"bytes":return m;case"timestamp":return m;case"counter":return s?new Os(m):Xm(m,e,i,r,t);default:throw RangeError(`datatype ${d} unimplemented`)}}function Yo(n,t){switch(typeof n){case"object":if(n==null)return[null,"null"];if(n[Km])return[n.value,"uint"];if(n[Hm])return[n.value,"int"];if(n[Gm])return[n.value,"f64"];if(n[Yl])return[n.value,"counter"];if(n instanceof Date)return[n.getTime(),"timestamp"];if(n instanceof Xl)return[n.val,"str"];if(n instanceof En)return[n,"text"];if(n instanceof Uint8Array)return[n,"bytes"];if(n instanceof Array)return[n,"list"];if(Object.getPrototypeOf(n)===Object.getPrototypeOf({}))return[n,"map"];throw n[jt]?new RangeError("Cannot create a reference to an existing document object"):new RangeError(`Cannot assign unknown object: ${n}`);case"boolean":return[n,"boolean"];case"number":return Number.isInteger(n)?[n,"int"]:[n,"f64"];case"string":return t?[n,"text"]:[n,"str"];default:throw new RangeError(`Unsupported type of value: ${typeof n}`)}}const Qm={get(n,t){const{context:e,objectId:r,cache:i}=n;return t===Symbol.toStringTag?n[Symbol.toStringTag]:t===jt?r:t===Zo?!0:t===oe?n.trace:t===re?{handle:e}:(i[t]||(i[t]=me(n,t)),i[t])},set(n,t,e){const{context:r,objectId:i,path:s,readonly:l,frozen:c,textV2:h}=n;if(n.cache={},e&&e[jt])throw new RangeError("Cannot create a reference to an existing document object");if(t===oe)return n.trace=e,!0;const[d,m]=Yo(e,h);if(c)throw new RangeError("Attempting to use an outdated Automerge document");if(l)throw new RangeError(`Object property "${t}" cannot be modified`);switch(m){case"list":{const y=r.putObject(i,t,[]),v=Xo(r,y,h,[...s,t],l);for(let b=0;b<d.length;b++)v[b]=d[b];break}case"text":{if(h)Qo(d),r.putObject(i,t,d);else{Ms(d);const y=r.putObject(i,t,""),v=oo(r,y,[...s,t],l);for(let b=0;b<d.length;b++)v[b]=d.get(b)}break}case"map":{const y=r.putObject(i,t,{}),v=ro(r,y,h,[...s,t],l);for(const b in d)v[b]=d[b];break}default:r.put(i,t,d,m)}return!0},deleteProperty(n,t){const{context:e,objectId:r,readonly:i}=n;if(n.cache={},i)throw new RangeError(`Object property "${t}" cannot be modified`);return e.delete(r,t),!0},has(n,t){return this.get(n,t)!==void 0},getOwnPropertyDescriptor(n,t){const e=this.get(n,t);if(typeof e<"u")return{configurable:!0,enumerable:!0,value:e}},ownKeys(n){const{context:t,objectId:e,heads:r}=n,i=t.keys(e,r);return[...new Set(i)]}},Ql={get(n,t){const{context:e,objectId:r,heads:i}=n;return t=We(t),t===Symbol.hasInstance?s=>Array.isArray(s):t===Symbol.toStringTag?n[Symbol.toStringTag]:t===jt?r:t===Zo?!0:t===oe?n.trace:t===re?{handle:e}:t==="length"?e.length(r,i):typeof t=="number"?me(n,t):tc(n)[t]},set(n,t,e){const{context:r,objectId:i,path:s,readonly:l,frozen:c,textV2:h}=n;if(t=We(t),e&&e[jt])throw new RangeError("Cannot create a reference to an existing document object");if(t===oe)return n.trace=e,!0;if(typeof t=="string")throw new RangeError("list index must be a number");const[d,m]=Yo(e,h);if(c)throw new RangeError("Attempting to use an outdated Automerge document");if(l)throw new RangeError(`Object property "${t}" cannot be modified`);switch(m){case"list":{let y;t>=r.length(i)?y=r.insertObject(i,t,[]):y=r.putObject(i,t,[]),Xo(r,y,h,[...s,t],l).splice(0,0,...d);break}case"text":{if(h)Qo(d),t>=r.length(i)?r.insertObject(i,t,d):r.putObject(i,t,d);else{let y;Ms(d),t>=r.length(i)?y=r.insertObject(i,t,""):y=r.putObject(i,t,""),oo(r,y,[...s,t],l).splice(0,0,...d)}break}case"map":{let y;t>=r.length(i)?y=r.insertObject(i,t,{}):y=r.putObject(i,t,{});const v=ro(r,y,h,[...s,t],l);for(const b in d)v[b]=d[b];break}default:t>=r.length(i)?r.insert(i,t,d,m):r.put(i,t,d,m)}return!0},deleteProperty(n,t){const{context:e,objectId:r}=n;t=We(t);const i=e.get(r,t);if(i!=null&&i[0]=="counter")throw new TypeError("Unsupported operation: deleting a counter from a list");return e.delete(r,t),!0},has(n,t){const{context:e,objectId:r,heads:i}=n;return t=We(t),typeof t=="number"?t<e.length(r,i):t==="length"},getOwnPropertyDescriptor(n,t){const{context:e,objectId:r,heads:i}=n;return t==="length"?{writable:!0,value:e.length(r,i)}:t===jt?{configurable:!1,enumerable:!1,value:r}:(t=We(t),{configurable:!0,enumerable:!0,value:me(n,t)})},getPrototypeOf(n){return Object.getPrototypeOf(n)},ownKeys(){const n=[];return n.push("length"),n}},tg=Object.assign({},Ql,{get(n,t){const{context:e,objectId:r,heads:i}=n;return t=We(t),t===Symbol.hasInstance?s=>Array.isArray(s):t===Symbol.toStringTag?n[Symbol.toStringTag]:t===jt?r:t===Zo?!0:t===oe?n.trace:t===re?{handle:e}:t==="length"?e.length(r,i):typeof t=="number"?me(n,t):ng(n)[t]||tc(n)[t]},getPrototypeOf(){return Object.getPrototypeOf(new En)}});function ro(n,t,e,r,i,s){const l={context:n,objectId:t,path:r||[],readonly:!!i,frozen:!1,heads:s,cache:{},textV2:e},c={};return Object.assign(c,l),new Proxy(c,Qm)}function Xo(n,t,e,r,i,s){const l={context:n,objectId:t,path:r||[],readonly:!!i,frozen:!1,heads:s,cache:{},textV2:e},c=[];return Object.assign(c,l),new Proxy(c,Ql)}function oo(n,t,e,r,i){const s={context:n,objectId:t,path:e||[],readonly:!!r,frozen:!1,heads:i,cache:{},textV2:!1},l={};return Object.assign(l,s),new Proxy(l,tg)}function eg(n,t,e){return ro(n,"_root",t,[],!!e)}function tc(n){const{context:t,objectId:e,path:r,readonly:i,frozen:s,heads:l,textV2:c}=n;return{deleteAt(h,d){return typeof d=="number"?t.splice(e,h,d):t.delete(e,h),this},fill(h,d,m){const[y,v]=Yo(h,c),b=t.length(e);d=We(d||0),m=We(m||b);for(let C=d;C<Math.min(m,b);C++)if(v==="list"||v==="map")t.putObject(e,C,y);else if(v==="text")if(c)Qo(y),t.putObject(e,C,y);else{Ms(y);const T=t.putObject(e,C,""),P=oo(t,T,[...r,C],i);for(let J=0;J<y.length;J++)P[J]=y.get(J)}else t.put(e,C,y,v);return this},indexOf(h,d=0){const m=t.length(e);for(let y=d;y<m;y++){const v=t.getWithType(e,y,l);if(v&&(v[1]===h[jt]||v[1]===h))return y}return-1},insertAt(h,...d){return this.splice(h,0,...d),this},pop(){const h=t.length(e);if(h==0)return;const d=me(n,h-1);return t.delete(e,h-1),d},push(...h){const d=t.length(e);return this.splice(d,0,...h),t.length(e)},shift(){if(t.length(e)==0)return;const h=me(n,0);return t.delete(e,0),h},splice(h,d,...m){h=We(h),d=We(d);for(const b of m)if(b&&b[jt])throw new RangeError("Cannot create a reference to an existing document object");if(s)throw new RangeError("Attempting to use an outdated Automerge document");if(i)throw new RangeError("Sequence object cannot be modified outside of a change block");const y=[];for(let b=0;b<d;b++){const C=me(n,h);C!==void 0&&y.push(C),t.delete(e,h)}const v=m.map(b=>Yo(b,c));for(const[b,C]of v){switch(C){case"list":{const T=t.insertObject(e,h,[]);Xo(t,T,c,[...r,h],i).splice(0,0,...b);break}case"text":{if(c)Qo(b),t.insertObject(e,h,b);else{const T=t.insertObject(e,h,"");oo(t,T,[...r,h],i).splice(0,0,...b)}break}case"map":{const T=t.insertObject(e,h,{}),P=ro(t,T,c,[...r,h],i);for(const J in b)P[J]=b[J];break}default:t.insert(e,h,b,C)}h+=1}return y},unshift(...h){return this.splice(0,0,...h),t.length(e)},entries(){return{next:()=>{const h=me(n,0);return h===void 0?{value:void 0,done:!0}:{value:[0,h],done:!1}}}},keys(){let h=0;const d=t.length(e,l);return{next:()=>{let m;return h<d&&(m=h,h++),{value:m,done:!0}}}},values(){return{next:()=>{const h=me(n,0);return h===void 0?{value:void 0,done:!0}:{value:h,done:!1}}}},toArray(){const h=[];let d;do d=me(n,h.length),d!==void 0&&h.push(d);while(d!==void 0);return h},map(h){return this.toArray().map(h)},toString(){return this.toArray().toString()},toLocaleString(){return this.toArray().toLocaleString()},forEach(h){return this.toArray().forEach(h)},concat(h){return this.toArray().concat(h)},every(h){return this.toArray().every(h)},filter(h){return this.toArray().filter(h)},find(h){let d=0;for(const m of this){if(h(m,d))return m;d+=1}},findIndex(h){let d=0;for(const m of this){if(h(m,d))return d;d+=1}return-1},includes(h){return this.find(d=>d===h)!==void 0},join(h){return this.toArray().join(h)},reduce(h,d){return this.toArray().reduce(h,d)},reduceRight(h,d){return this.toArray().reduceRight(h,d)},lastIndexOf(h,d=1/0){return this.toArray().lastIndexOf(h,d)},slice(h,d){return this.toArray().slice(h,d)},some(h){let d=0;for(const m of this){if(h(m,d))return!0;d+=1}return!1},[Symbol.iterator]:function*(){let h=0,d=me(n,h);for(;d!==void 0;)yield d,h+=1,d=me(n,h)}}}function ng(n){const{context:t,objectId:e,heads:r}=n;return{set(i,s){return this[i]=s},get(i){return this[i]},toString(){return t.text(e,r).replace(/￼/g,"")},toSpans(){const i=[];let s="";const l=t.length(e);for(let c=0;c<l;c++){const h=this[c];typeof h=="string"?s+=h:(s.length>0&&(i.push(s),s=""),i.push(h))}return s.length>0&&i.push(s),i},toJSON(){return this.toString()},indexOf(i,s=0){return t.text(e).indexOf(i,s)}}}function Ms(n){if(!(n instanceof En))throw new Error("value was not a Text instance")}function Qo(n){if(typeof n!="string")throw new Error("value was not a string")}function rg(n){for(const t in n)ec[t]=n[t]}const ec={create(n,t){throw new RangeError("Automerge.use() not called")},load(n,t,e){throw new RangeError("Automerge.use() not called (load)")},encodeChange(n){throw new RangeError("Automerge.use() not called (encodeChange)")},decodeChange(n){throw new RangeError("Automerge.use() not called (decodeChange)")},initSyncState(){throw new RangeError("Automerge.use() not called (initSyncState)")},encodeSyncMessage(n){throw new RangeError("Automerge.use() not called (encodeSyncMessage)")},decodeSyncMessage(n){throw new RangeError("Automerge.use() not called (decodeSyncMessage)")},encodeSyncState(n){throw new RangeError("Automerge.use() not called (encodeSyncState)")},decodeSyncState(n){throw new RangeError("Automerge.use() not called (decodeSyncState)")},exportSyncState(n){throw new RangeError("Automerge.use() not called (exportSyncState)")},importSyncState(n){throw new RangeError("Automerge.use() not called (importSyncState)")}};function qe(n,t=!0){if(typeof n!="object")throw new RangeError("must be the document root");const e=Reflect.get(n,re);if(e===void 0||e==null||t&&io(n)!=="_root")throw new RangeError("must be the document root");return e}function io(n){return typeof n!="object"||n===null?null:Reflect.get(n,jt)}function so(n){return!!Reflect.get(n,Zo)}const og=""+new URL("automerge_wasm_bg.89f17edf.wasm",import.meta.url).href,ig=async(n={},t)=>{let e;if(t.startsWith("data:")){const r=t.replace(/^data:.*?base64,/,"");let i;if(typeof Buffer=="function"&&typeof Buffer.from=="function")i=Buffer.from(r,"base64");else if(typeof atob=="function"){const s=atob(r);i=new Uint8Array(s.length);for(let l=0;l<s.length;l++)i[l]=s.charCodeAt(l)}else throw new Error("Cannot decode base64-encoded data URL");e=await WebAssembly.instantiate(i,n)}else{const r=await fetch(t),i=r.headers.get("Content-Type")||"";if("instantiateStreaming"in WebAssembly&&i.startsWith("application/wasm"))e=await WebAssembly.instantiateStreaming(r,n);else{const s=await r.arrayBuffer();e=await WebAssembly.instantiate(s,n)}}return e.instance.exports};let x;function nc(n){x=n}const fn=new Array(128).fill(void 0);fn.push(void 0,null,!0,!1);function z(n){return fn[n]}let Gt=0,ti=null;function ao(){return(ti===null||ti.byteLength===0)&&(ti=new Uint8Array(x.memory.buffer)),ti}const sg=typeof TextEncoder>"u"?(0,module.require)("util").TextEncoder:TextEncoder;let ei=new sg("utf-8");const ag=typeof ei.encodeInto=="function"?function(n,t){return ei.encodeInto(n,t)}:function(n,t){const e=ei.encode(n);return t.set(e),{read:n.length,written:e.length}};function ge(n,t,e){if(e===void 0){const c=ei.encode(n),h=t(c.length);return ao().subarray(h,h+c.length).set(c),Gt=c.length,h}let r=n.length,i=t(r);const s=ao();let l=0;for(;l<r;l++){const c=n.charCodeAt(l);if(c>127)break;s[i+l]=c}if(l!==r){l!==0&&(n=n.slice(l)),i=e(i,r,r=l+n.length*3);const c=ao().subarray(i+l,i+r),h=ag(n,c);l+=h.written}return Gt=l,i}let ni=null;function A(){return(ni===null||ni.byteLength===0)&&(ni=new Int32Array(x.memory.buffer)),ni}function vt(n){return n==null}let ri=null;function As(){return(ri===null||ri.byteLength===0)&&(ri=new Float64Array(x.memory.buffer)),ri}let lo=fn.length;function E(n){lo===fn.length&&fn.push(fn.length+1);const t=lo;return lo=fn[t],fn[t]=n,t}const lg=typeof TextDecoder>"u"?(0,module.require)("util").TextDecoder:TextDecoder;let rc=new lg("utf-8",{ignoreBOM:!0,fatal:!0});rc.decode();function Ae(n,t){return rc.decode(ao().subarray(n,n+t))}function cg(n){n<132||(fn[n]=lo,lo=n)}function j(n){const t=z(n);return cg(n),t}function Es(n){const t=typeof n;if(t=="number"||t=="boolean"||n==null)return`${n}`;if(t=="string")return`"${n}"`;if(t=="symbol"){const i=n.description;return i==null?"Symbol":`Symbol(${i})`}if(t=="function"){const i=n.name;return typeof i=="string"&&i.length>0?`Function(${i})`:"Function"}if(Array.isArray(n)){const i=n.length;let s="[";i>0&&(s+=Es(n[0]));for(let l=1;l<i;l++)s+=", "+Es(n[l]);return s+="]",s}const e=/\[object ([^\]]+)\]/.exec(toString.call(n));let r;if(e.length>1)r=e[1];else return toString.call(n);if(r=="Object")try{return"Object("+JSON.stringify(n)+")"}catch{return"Object"}return n instanceof Error?`${n.name}: ${n.message}
${n.stack}`:r}function xr(n,t){if(!(n instanceof t))throw new Error(`expected instance of ${t.name}`);return n.ptr}function ug(n,t){try{const c=x.__wbindgen_add_to_stack_pointer(-16);var e=vt(t)?0:ge(t,x.__wbindgen_malloc,x.__wbindgen_realloc),r=Gt;x.create(c,n,e,r);var i=A()[c/4+0],s=A()[c/4+1],l=A()[c/4+2];if(l)throw j(s);return Je.__wrap(i)}finally{x.__wbindgen_add_to_stack_pointer(16)}}function hg(n,t,e){try{const h=x.__wbindgen_add_to_stack_pointer(-16);var r=vt(e)?0:ge(e,x.__wbindgen_malloc,x.__wbindgen_realloc),i=Gt;x.load(h,E(n),t,r,i);var s=A()[h/4+0],l=A()[h/4+1],c=A()[h/4+2];if(c)throw j(l);return Je.__wrap(s)}finally{x.__wbindgen_add_to_stack_pointer(16)}}function fg(n){try{const i=x.__wbindgen_add_to_stack_pointer(-16);x.encodeChange(i,E(n));var t=A()[i/4+0],e=A()[i/4+1],r=A()[i/4+2];if(r)throw j(e);return j(t)}finally{x.__wbindgen_add_to_stack_pointer(16)}}function dg(n){try{const i=x.__wbindgen_add_to_stack_pointer(-16);x.decodeChange(i,E(n));var t=A()[i/4+0],e=A()[i/4+1],r=A()[i/4+2];if(r)throw j(e);return j(t)}finally{x.__wbindgen_add_to_stack_pointer(16)}}function pg(){const n=x.initSyncState();return Ee.__wrap(n)}function mg(n){try{const i=x.__wbindgen_add_to_stack_pointer(-16);x.importSyncState(i,E(n));var t=A()[i/4+0],e=A()[i/4+1],r=A()[i/4+2];if(r)throw j(e);return Ee.__wrap(t)}finally{x.__wbindgen_add_to_stack_pointer(16)}}function gg(n){xr(n,Ee);const t=x.exportSyncState(n.ptr);return j(t)}function _g(n){try{const i=x.__wbindgen_add_to_stack_pointer(-16);x.encodeSyncMessage(i,E(n));var t=A()[i/4+0],e=A()[i/4+1],r=A()[i/4+2];if(r)throw j(e);return j(t)}finally{x.__wbindgen_add_to_stack_pointer(16)}}function yg(n){try{const i=x.__wbindgen_add_to_stack_pointer(-16);x.decodeSyncMessage(i,E(n));var t=A()[i/4+0],e=A()[i/4+1],r=A()[i/4+2];if(r)throw j(e);return j(t)}finally{x.__wbindgen_add_to_stack_pointer(16)}}function bg(n){xr(n,Ee);const t=x.encodeSyncState(n.ptr);return j(t)}function wg(n){try{const i=x.__wbindgen_add_to_stack_pointer(-16);x.decodeSyncState(i,E(n));var t=A()[i/4+0],e=A()[i/4+1],r=A()[i/4+2];if(r)throw j(e);return Ee.__wrap(t)}finally{x.__wbindgen_add_to_stack_pointer(16)}}function Pt(n,t){try{return n.apply(this,t)}catch(e){x.__wbindgen_exn_store(E(e))}}function vg(n,t){return ao().subarray(n/1,n/1+t)}const kg=Object.freeze({Array:0,0:"Array",String:1,1:"String"}),oc=new FinalizationRegistry(n=>x.__wbg_automerge_free(n));class Je{static __wrap(t){const e=Object.create(Je.prototype);return e.ptr=t,oc.register(e,e.ptr,e),e}__destroy_into_raw(){const t=this.ptr;return this.ptr=0,oc.unregister(this),t}free(){const t=this.__destroy_into_raw();x.__wbg_automerge_free(t)}static new(t,e){try{const h=x.__wbindgen_add_to_stack_pointer(-16);var r=vt(t)?0:ge(t,x.__wbindgen_malloc,x.__wbindgen_realloc),i=Gt;x.automerge_new(h,r,i,e);var s=A()[h/4+0],l=A()[h/4+1],c=A()[h/4+2];if(c)throw j(l);return Je.__wrap(s)}finally{x.__wbindgen_add_to_stack_pointer(16)}}clone(t){try{const c=x.__wbindgen_add_to_stack_pointer(-16);var e=vt(t)?0:ge(t,x.__wbindgen_malloc,x.__wbindgen_realloc),r=Gt;x.automerge_clone(c,this.ptr,e,r);var i=A()[c/4+0],s=A()[c/4+1],l=A()[c/4+2];if(l)throw j(s);return Je.__wrap(i)}finally{x.__wbindgen_add_to_stack_pointer(16)}}fork(t,e){try{const h=x.__wbindgen_add_to_stack_pointer(-16);var r=vt(t)?0:ge(t,x.__wbindgen_malloc,x.__wbindgen_realloc),i=Gt;x.automerge_fork(h,this.ptr,r,i,E(e));var s=A()[h/4+0],l=A()[h/4+1],c=A()[h/4+2];if(c)throw j(l);return Je.__wrap(s)}finally{x.__wbindgen_add_to_stack_pointer(16)}}pendingOps(){const t=x.automerge_pendingOps(this.ptr);return j(t)}commit(t,e){var r=vt(t)?0:ge(t,x.__wbindgen_malloc,x.__wbindgen_realloc),i=Gt;const s=x.automerge_commit(this.ptr,r,i,!vt(e),vt(e)?0:e);return j(s)}merge(t){try{const s=x.__wbindgen_add_to_stack_pointer(-16);xr(t,Je),x.automerge_merge(s,this.ptr,t.ptr);var e=A()[s/4+0],r=A()[s/4+1],i=A()[s/4+2];if(i)throw j(r);return j(e)}finally{x.__wbindgen_add_to_stack_pointer(16)}}rollback(){return x.automerge_rollback(this.ptr)}keys(t,e){try{const l=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_keys(l,this.ptr,E(t),vt(e)?0:E(e));var r=A()[l/4+0],i=A()[l/4+1],s=A()[l/4+2];if(s)throw j(i);return j(r)}finally{x.__wbindgen_add_to_stack_pointer(16)}}text(t,e){try{const d=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_text(d,this.ptr,E(t),vt(e)?0:E(e));var r=A()[d/4+0],i=A()[d/4+1],s=A()[d/4+2],l=A()[d/4+3],c=r,h=i;if(l)throw c=0,h=0,j(s);return Ae(c,h)}finally{x.__wbindgen_add_to_stack_pointer(16),x.__wbindgen_free(c,h)}}splice(t,e,r,i){try{const c=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_splice(c,this.ptr,E(t),e,r,E(i));var s=A()[c/4+0],l=A()[c/4+1];if(l)throw j(s)}finally{x.__wbindgen_add_to_stack_pointer(16)}}push(t,e,r){try{const l=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_push(l,this.ptr,E(t),E(e),E(r));var i=A()[l/4+0],s=A()[l/4+1];if(s)throw j(i)}finally{x.__wbindgen_add_to_stack_pointer(16)}}pushObject(t,e){try{const c=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_pushObject(c,this.ptr,E(t),E(e));var r=A()[c/4+0],i=A()[c/4+1],s=A()[c/4+2],l=A()[c/4+3];if(l)throw j(s);let h;return r!==0&&(h=Ae(r,i).slice(),x.__wbindgen_free(r,i*1)),h}finally{x.__wbindgen_add_to_stack_pointer(16)}}insert(t,e,r,i){try{const c=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_insert(c,this.ptr,E(t),e,E(r),E(i));var s=A()[c/4+0],l=A()[c/4+1];if(l)throw j(s)}finally{x.__wbindgen_add_to_stack_pointer(16)}}insertObject(t,e,r){try{const h=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_insertObject(h,this.ptr,E(t),e,E(r));var i=A()[h/4+0],s=A()[h/4+1],l=A()[h/4+2],c=A()[h/4+3];if(c)throw j(l);let d;return i!==0&&(d=Ae(i,s).slice(),x.__wbindgen_free(i,s*1)),d}finally{x.__wbindgen_add_to_stack_pointer(16)}}put(t,e,r,i){try{const c=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_put(c,this.ptr,E(t),E(e),E(r),E(i));var s=A()[c/4+0],l=A()[c/4+1];if(l)throw j(s)}finally{x.__wbindgen_add_to_stack_pointer(16)}}putObject(t,e,r){try{const c=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_putObject(c,this.ptr,E(t),E(e),E(r));var i=A()[c/4+0],s=A()[c/4+1],l=A()[c/4+2];if(l)throw j(s);return j(i)}finally{x.__wbindgen_add_to_stack_pointer(16)}}increment(t,e,r){try{const l=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_increment(l,this.ptr,E(t),E(e),E(r));var i=A()[l/4+0],s=A()[l/4+1];if(s)throw j(i)}finally{x.__wbindgen_add_to_stack_pointer(16)}}get(t,e,r){try{const c=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_get(c,this.ptr,E(t),E(e),vt(r)?0:E(r));var i=A()[c/4+0],s=A()[c/4+1],l=A()[c/4+2];if(l)throw j(s);return j(i)}finally{x.__wbindgen_add_to_stack_pointer(16)}}getWithType(t,e,r){try{const c=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_getWithType(c,this.ptr,E(t),E(e),vt(r)?0:E(r));var i=A()[c/4+0],s=A()[c/4+1],l=A()[c/4+2];if(l)throw j(s);return j(i)}finally{x.__wbindgen_add_to_stack_pointer(16)}}getAll(t,e,r){try{const c=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_getAll(c,this.ptr,E(t),E(e),vt(r)?0:E(r));var i=A()[c/4+0],s=A()[c/4+1],l=A()[c/4+2];if(l)throw j(s);return j(i)}finally{x.__wbindgen_add_to_stack_pointer(16)}}enableFreeze(t){try{const s=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_enableFreeze(s,this.ptr,E(t));var e=A()[s/4+0],r=A()[s/4+1],i=A()[s/4+2];if(i)throw j(r);return j(e)}finally{x.__wbindgen_add_to_stack_pointer(16)}}enablePatches(t){try{const s=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_enablePatches(s,this.ptr,E(t));var e=A()[s/4+0],r=A()[s/4+1],i=A()[s/4+2];if(i)throw j(r);return j(e)}finally{x.__wbindgen_add_to_stack_pointer(16)}}registerDatatype(t,e){try{const s=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_registerDatatype(s,this.ptr,E(t),E(e));var r=A()[s/4+0],i=A()[s/4+1];if(i)throw j(r)}finally{x.__wbindgen_add_to_stack_pointer(16)}}applyPatches(t,e,r){try{const c=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_applyPatches(c,this.ptr,E(t),E(e),E(r));var i=A()[c/4+0],s=A()[c/4+1],l=A()[c/4+2];if(l)throw j(s);return j(i)}finally{x.__wbindgen_add_to_stack_pointer(16)}}popPatches(){try{const i=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_popPatches(i,this.ptr);var t=A()[i/4+0],e=A()[i/4+1],r=A()[i/4+2];if(r)throw j(e);return j(t)}finally{x.__wbindgen_add_to_stack_pointer(16)}}length(t,e){try{const l=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_length(l,this.ptr,E(t),vt(e)?0:E(e));var r=As()[l/8+0],i=A()[l/4+2],s=A()[l/4+3];if(s)throw j(i);return r}finally{x.__wbindgen_add_to_stack_pointer(16)}}delete(t,e){try{const s=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_delete(s,this.ptr,E(t),E(e));var r=A()[s/4+0],i=A()[s/4+1];if(i)throw j(r)}finally{x.__wbindgen_add_to_stack_pointer(16)}}save(){const t=x.automerge_save(this.ptr);return j(t)}saveIncremental(){const t=x.automerge_saveIncremental(this.ptr);return j(t)}loadIncremental(t){try{const s=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_loadIncremental(s,this.ptr,E(t));var e=As()[s/8+0],r=A()[s/4+2],i=A()[s/4+3];if(i)throw j(r);return e}finally{x.__wbindgen_add_to_stack_pointer(16)}}applyChanges(t){try{const i=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_applyChanges(i,this.ptr,E(t));var e=A()[i/4+0],r=A()[i/4+1];if(r)throw j(e)}finally{x.__wbindgen_add_to_stack_pointer(16)}}getChanges(t){try{const s=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_getChanges(s,this.ptr,E(t));var e=A()[s/4+0],r=A()[s/4+1],i=A()[s/4+2];if(i)throw j(r);return j(e)}finally{x.__wbindgen_add_to_stack_pointer(16)}}getChangeByHash(t){try{const s=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_getChangeByHash(s,this.ptr,E(t));var e=A()[s/4+0],r=A()[s/4+1],i=A()[s/4+2];if(i)throw j(r);return j(e)}finally{x.__wbindgen_add_to_stack_pointer(16)}}getChangesAdded(t){xr(t,Je);const e=x.automerge_getChangesAdded(this.ptr,t.ptr);return j(e)}getHeads(){const t=x.automerge_getHeads(this.ptr);return j(t)}getActorId(){try{const r=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_getActorId(r,this.ptr);var t=A()[r/4+0],e=A()[r/4+1];return Ae(t,e)}finally{x.__wbindgen_add_to_stack_pointer(16),x.__wbindgen_free(t,e)}}getLastLocalChange(){const t=x.automerge_getLastLocalChange(this.ptr);return j(t)}dump(){x.automerge_dump(this.ptr)}getMissingDeps(t){try{const s=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_getMissingDeps(s,this.ptr,vt(t)?0:E(t));var e=A()[s/4+0],r=A()[s/4+1],i=A()[s/4+2];if(i)throw j(r);return j(e)}finally{x.__wbindgen_add_to_stack_pointer(16)}}receiveSyncMessage(t,e){try{const s=x.__wbindgen_add_to_stack_pointer(-16);xr(t,Ee),x.automerge_receiveSyncMessage(s,this.ptr,t.ptr,E(e));var r=A()[s/4+0],i=A()[s/4+1];if(i)throw j(r)}finally{x.__wbindgen_add_to_stack_pointer(16)}}generateSyncMessage(t){xr(t,Ee);const e=x.automerge_generateSyncMessage(this.ptr,t.ptr);return j(e)}toJS(t){try{const s=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_toJS(s,this.ptr,E(t));var e=A()[s/4+0],r=A()[s/4+1],i=A()[s/4+2];if(i)throw j(r);return j(e)}finally{x.__wbindgen_add_to_stack_pointer(16)}}materialize(t,e,r){try{const c=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_materialize(c,this.ptr,E(t),vt(e)?0:E(e),E(r));var i=A()[c/4+0],s=A()[c/4+1],l=A()[c/4+2];if(l)throw j(s);return j(i)}finally{x.__wbindgen_add_to_stack_pointer(16)}}emptyChange(t,e){var r=vt(t)?0:ge(t,x.__wbindgen_malloc,x.__wbindgen_realloc),i=Gt;const s=x.automerge_emptyChange(this.ptr,r,i,!vt(e),vt(e)?0:e);return j(s)}mark(t,e,r,i,s){try{const h=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_mark(h,this.ptr,E(t),E(e),E(r),E(i),E(s));var l=A()[h/4+0],c=A()[h/4+1];if(c)throw j(l)}finally{x.__wbindgen_add_to_stack_pointer(16)}}unmark(t,e,r,i){try{const c=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_unmark(c,this.ptr,E(t),E(e),r,i);var s=A()[c/4+0],l=A()[c/4+1];if(l)throw j(s)}finally{x.__wbindgen_add_to_stack_pointer(16)}}marks(t,e){try{const l=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_marks(l,this.ptr,E(t),vt(e)?0:E(e));var r=A()[l/4+0],i=A()[l/4+1],s=A()[l/4+2];if(s)throw j(i);return j(r)}finally{x.__wbindgen_add_to_stack_pointer(16)}}}const ic=new FinalizationRegistry(n=>x.__wbg_syncstate_free(n));class Ee{static __wrap(t){const e=Object.create(Ee.prototype);return e.ptr=t,ic.register(e,e.ptr,e),e}__destroy_into_raw(){const t=this.ptr;return this.ptr=0,ic.unregister(this),t}free(){const t=this.__destroy_into_raw();x.__wbg_syncstate_free(t)}get sharedHeads(){const t=x.syncstate_sharedHeads(this.ptr);return j(t)}get lastSentHeads(){const t=x.syncstate_lastSentHeads(this.ptr);return j(t)}set lastSentHeads(t){try{const i=x.__wbindgen_add_to_stack_pointer(-16);x.syncstate_set_lastSentHeads(i,this.ptr,E(t));var e=A()[i/4+0],r=A()[i/4+1];if(r)throw j(e)}finally{x.__wbindgen_add_to_stack_pointer(16)}}set sentHashes(t){try{const i=x.__wbindgen_add_to_stack_pointer(-16);x.syncstate_set_sentHashes(i,this.ptr,E(t));var e=A()[i/4+0],r=A()[i/4+1];if(r)throw j(e)}finally{x.__wbindgen_add_to_stack_pointer(16)}}clone(){const t=x.syncstate_clone(this.ptr);return Ee.__wrap(t)}}function sc(n,t){const e=z(t),r=JSON.stringify(e===void 0?null:e),i=ge(r,x.__wbindgen_malloc,x.__wbindgen_realloc),s=Gt;A()[n/4+1]=s,A()[n/4+0]=i}function ac(n){return z(n)===void 0}function lc(n,t){const e=z(t),r=typeof e=="number"?e:void 0;As()[n/8+1]=vt(r)?0:r,A()[n/4+0]=!vt(r)}function cc(n){const t=z(n);return typeof t=="boolean"?t?1:0:2}function uc(n){return z(n)===null}function hc(n){return E(n)}function fc(n,t){const e=Ae(n,t);return E(e)}function dc(n,t){const e=z(t),r=typeof e=="string"?e:void 0;var i=vt(r)?0:ge(r,x.__wbindgen_malloc,x.__wbindgen_realloc),s=Gt;A()[n/4+1]=s,A()[n/4+0]=i}function pc(n){return typeof z(n)=="string"}function mc(n){const t=z(n);return E(t)}function gc(n,t){try{console.error(Ae(n,t))}finally{x.__wbindgen_free(n,t)}}function _c(){const n=new Error;return E(n)}function yc(n,t){const e=z(t).stack,r=ge(e,x.__wbindgen_malloc,x.__wbindgen_realloc),i=Gt;A()[n/4+1]=i,A()[n/4+0]=r}function bc(n){j(n)}function wc(n,t){const e=new Error(Ae(n,t));return E(e)}function vc(n,t){return z(n)==z(t)}function kc(n){const t=z(n);return typeof t=="object"&&t!==null}function xc(n){return E(n)}function Sc(n){const t=BigInt.asUintN(64,n);return E(t)}function Cc(n,t,e){z(n)[j(t)]=j(e)}function Oc(n,t){const e=String(z(t)),r=ge(e,x.__wbindgen_malloc,x.__wbindgen_realloc),i=Gt;A()[n/4+1]=i,A()[n/4+0]=r}function Mc(n){const t=z(n).crypto;return E(t)}function Ac(n){const t=z(n).msCrypto;return E(t)}function Ec(){return Pt(function(n,t){z(n).getRandomValues(z(t))},arguments)}function Tc(){return Pt(function(n,t,e){z(n).randomFillSync(vg(t,e))},arguments)}function Nc(){return Pt(function(){const n=module.require;return E(n)},arguments)}function Dc(n){const t=z(n).process;return E(t)}function Rc(n){const t=z(n).versions;return E(t)}function Ic(n){const t=z(n).node;return E(t)}function zc(n){console.log(z(n))}function jc(n,t){console.log(z(n),z(t))}function Pc(){const n=new Array;return E(n)}function Bc(n,t){const e=z(n)[t>>>0];return E(e)}function $c(n,t,e){z(n)[t>>>0]=j(e)}function Fc(n){const t=Array.from(z(n));return E(t)}function Vc(n){return Array.isArray(z(n))}function Lc(n){return z(n).length}function Wc(n,t){return z(n).push(z(t))}function qc(n,t){return z(n).unshift(z(t))}function Jc(n){let t;try{t=z(n)instanceof ArrayBuffer}catch{t=!1}return t}function Uc(n,t){const e=new Error(Ae(n,t));return E(e)}function Kc(n,t){const e=new Function(Ae(n,t));return E(e)}function Hc(){return Pt(function(n,t){const e=z(n).call(z(t));return E(e)},arguments)}function Gc(){return Pt(function(n,t,e){const r=z(n).call(z(t),z(e));return E(r)},arguments)}function Zc(){return Pt(function(n,t,e,r){const i=z(n).call(z(t),z(e),z(r));return E(i)},arguments)}function Yc(){return Pt(function(n){const t=z(n).next();return E(t)},arguments)}function Xc(n){const t=z(n).next;return E(t)}function Qc(n){return z(n).done}function tu(n){const t=z(n).value;return E(t)}function eu(n){let t;try{t=z(n)instanceof Date}catch{t=!1}return t}function nu(n){return z(n).getTime()}function ru(n){const t=new Date(z(n));return E(t)}function ou(n){let t;try{t=z(n)instanceof Object}catch{t=!1}return t}function iu(n,t){const e=Object.assign(z(n),z(t));return E(e)}function su(n,t,e){const r=Object.defineProperty(z(n),z(t),z(e));return E(r)}function au(n){const t=Object.entries(z(n));return E(t)}function lu(n){const t=Object.freeze(z(n));return E(t)}function cu(n){const t=Object.keys(z(n));return E(t)}function uu(){const n=new Object;return E(n)}function hu(n){const t=Object.values(z(n));return E(t)}function fu(n){return z(n).length}function du(n,t){const e=z(n).concat(z(t));return E(e)}function pu(n,t,e){const r=z(n).slice(t>>>0,e>>>0);return E(r)}function mu(){return E(Symbol.iterator)}function gu(n,t){const e=Symbol.for(Ae(n,t));return E(e)}function _u(n){const t=z(n).toString();return E(t)}function yu(){return Pt(function(){const n=globalThis.globalThis;return E(n)},arguments)}function bu(){return Pt(function(){const n=self.self;return E(n)},arguments)}function wu(){return Pt(function(){const n=window.window;return E(n)},arguments)}function vu(){return Pt(function(){const n=global.global;return E(n)},arguments)}function ku(n){let t;try{t=z(n)instanceof Uint8Array}catch{t=!1}return t}function xu(n){const t=new Uint8Array(z(n));return E(t)}function Su(n){const t=new Uint8Array(n>>>0);return E(t)}function Cu(n,t,e){const r=new Uint8Array(z(n),t>>>0,e>>>0);return E(r)}function Ou(n,t,e){const r=z(n).subarray(t>>>0,e>>>0);return E(r)}function Mu(n){return z(n).length}function Au(n,t,e){z(n).set(z(t),e>>>0)}function Eu(){return Pt(function(n,t,e){const r=Reflect.apply(z(n),z(t),z(e));return E(r)},arguments)}function Tu(){return Pt(function(n,t){return Reflect.deleteProperty(z(n),z(t))},arguments)}function Nu(){return Pt(function(n,t){const e=Reflect.get(z(n),z(t));return E(e)},arguments)}function Du(){return Pt(function(n){const t=Reflect.ownKeys(z(n));return E(t)},arguments)}function Ru(){return Pt(function(n,t,e){return Reflect.set(z(n),z(t),z(e))},arguments)}function Iu(n){return typeof z(n)=="function"}function zu(n){const t=z(n).buffer;return E(t)}function ju(n,t){const e=Es(z(t)),r=ge(e,x.__wbindgen_malloc,x.__wbindgen_realloc),i=Gt;A()[n/4+1]=i,A()[n/4+0]=r}function Pu(n,t){throw new Error(Ae(n,t))}function Bu(){const n=x.memory;return E(n)}URL=globalThis.URL;const F=await ig({"./automerge_wasm_bg.js":{__wbindgen_json_serialize:sc,__wbindgen_is_undefined:ac,__wbindgen_number_get:lc,__wbindgen_boolean_get:cc,__wbindgen_is_null:uc,__wbindgen_number_new:hc,__wbindgen_string_new:fc,__wbindgen_string_get:dc,__wbindgen_is_string:pc,__wbindgen_object_clone_ref:mc,__wbg_error_f851667af71bcfc6:gc,__wbg_new_abda76e883ba8a5f:_c,__wbg_stack_658279fe44541cf6:yc,__wbindgen_object_drop_ref:bc,__wbindgen_error_new:wc,__wbindgen_jsval_loose_eq:vc,__wbindgen_is_object:kc,__wbindgen_bigint_from_i64:xc,__wbindgen_bigint_from_u64:Sc,__wbg_set_20cbc34131e76824:Cc,__wbg_String_91fba7ded13ba54c:Oc,__wbg_crypto_e1d53a1d73fb10b8:Mc,__wbg_msCrypto_6e7d3e1f92610cbb:Ac,__wbg_getRandomValues_805f1c3d65988a5a:Ec,__wbg_randomFillSync_6894564c2c334c42:Tc,__wbg_require_78a3dcfbdba9cbce:Nc,__wbg_process_038c26bf42b093f8:Dc,__wbg_versions_ab37218d2f0b24a8:Rc,__wbg_node_080f4b19d15bc1fe:Ic,__wbg_log_7bb108d119bafbc1:zc,__wbg_log_d047cf0648d2678e:jc,__wbg_new_b525de17f44a8943:Pc,__wbg_get_27fe3dac1c4d0224:Bc,__wbg_set_17224bc548dd1d7b:$c,__wbg_from_67ca20fa722467e6:Fc,__wbg_isArray_39d28997bf6b96b4:Vc,__wbg_length_e498fbc24f9c1d4f:Lc,__wbg_push_49c286f04dd3bf59:Wc,__wbg_unshift_06a94bcbcb492eb3:qc,__wbg_instanceof_ArrayBuffer_a69f02ee4c4f5065:Jc,__wbg_new_15d3966e9981a196:Uc,__wbg_newnoargs_2b8b6bd7753c76ba:Kc,__wbg_call_95d1ea488d03e4e8:Hc,__wbg_call_9495de66fdbe016b:Gc,__wbg_call_96878afb7a8201ca:Zc,__wbg_next_88560ec06a094dea:Yc,__wbg_next_b7d530c04fd8b217:Xc,__wbg_done_1ebec03bbd919843:Qc,__wbg_value_6ac8da5cc5b3efda:tu,__wbg_instanceof_Date_e353425d719aa266:eu,__wbg_getTime_7c59072d1651a3cf:nu,__wbg_new_f127e324c1313064:ru,__wbg_instanceof_Object_f5a826c4da0d4a94:ou,__wbg_assign_b0b6530984f36574:iu,__wbg_defineProperty_4926f24c724d5310:su,__wbg_entries_4e1315b774245952:au,__wbg_freeze_4dcdbf0b5d9b50f4:lu,__wbg_keys_60443f4f867207f9:cu,__wbg_new_f9876326328f45ed:uu,__wbg_values_7444c4c2ccefdc9b:hu,__wbg_length_ea0846e494e3b16e:fu,__wbg_concat_040af6c9ba38dd98:du,__wbg_slice_47202b1d012cdc55:pu,__wbg_iterator_55f114446221aa5a:mu,__wbg_for_9a885d0d6d415e40:gu,__wbg_toString_7a3e0cd68ea2a337:_u,__wbg_globalThis_87cbb8506fecf3a9:yu,__wbg_self_e7c1f827057f6584:bu,__wbg_window_a09ec664e14b1b81:wu,__wbg_global_c85a9259e621f3db:vu,__wbg_instanceof_Uint8Array_01cebe79ca606cca:ku,__wbg_new_537b7341ce90bb31:xu,__wbg_newwithlength_b56c882b57805732:Su,__wbg_newwithbyteoffsetandlength_9fb2f11355ecadf5:Cu,__wbg_subarray_7526649b91a252a6:Ou,__wbg_length_27a2afe8ab42b09f:Mu,__wbg_set_17499e8aa4003ebd:Au,__wbg_apply_5435e78b95a524a6:Eu,__wbg_deleteProperty_31090878b92a7c0e:Tu,__wbg_get_baf4855f9a986186:Nu,__wbg_ownKeys_9efe69be404540aa:Du,__wbg_set_6aa458a4ebdb65cb:Ru,__wbindgen_is_function:Iu,__wbg_buffer_cf65c07de34b9a08:zu,__wbindgen_debug_string:ju,__wbindgen_throw:Pu,__wbindgen_memory:Bu}},og),xg=F.memory,Sg=F.__wbg_syncstate_free,Cg=F.syncstate_sharedHeads,Og=F.syncstate_lastSentHeads,Mg=F.syncstate_set_lastSentHeads,Ag=F.syncstate_set_sentHashes,Eg=F.syncstate_clone,Tg=F.__wbg_automerge_free,Ng=F.automerge_new,Dg=F.automerge_clone,Rg=F.automerge_fork,Ig=F.automerge_pendingOps,zg=F.automerge_commit,jg=F.automerge_merge,Pg=F.automerge_rollback,Bg=F.automerge_keys,$g=F.automerge_text,Fg=F.automerge_splice,Vg=F.automerge_push,Lg=F.automerge_pushObject,Wg=F.automerge_insert,qg=F.automerge_insertObject,Jg=F.automerge_put,Ug=F.automerge_putObject,Kg=F.automerge_increment,Hg=F.automerge_get,Gg=F.automerge_getWithType,Zg=F.automerge_getAll,Yg=F.automerge_enableFreeze,Xg=F.automerge_enablePatches,Qg=F.automerge_registerDatatype,t0=F.automerge_applyPatches,e0=F.automerge_popPatches,n0=F.automerge_length,r0=F.automerge_delete,o0=F.automerge_save,i0=F.automerge_saveIncremental,s0=F.automerge_loadIncremental,a0=F.automerge_applyChanges,l0=F.automerge_getChanges,c0=F.automerge_getChangeByHash,u0=F.automerge_getChangesAdded,h0=F.automerge_getHeads,f0=F.automerge_getActorId,d0=F.automerge_getLastLocalChange,p0=F.automerge_dump,m0=F.automerge_getMissingDeps,g0=F.automerge_receiveSyncMessage,_0=F.automerge_generateSyncMessage,y0=F.automerge_toJS,b0=F.automerge_materialize,w0=F.automerge_emptyChange,v0=F.automerge_mark,k0=F.automerge_unmark,x0=F.automerge_marks,S0=F.create,C0=F.load,O0=F.encodeChange,M0=F.decodeChange,A0=F.initSyncState,E0=F.importSyncState,T0=F.exportSyncState,N0=F.encodeSyncMessage,D0=F.decodeSyncMessage,R0=F.encodeSyncState,I0=F.decodeSyncState,z0=F.__wbindgen_malloc,j0=F.__wbindgen_realloc,P0=F.__wbindgen_add_to_stack_pointer,B0=F.__wbindgen_free,$0=F.__wbindgen_exn_store,F0=Object.freeze(Object.defineProperty({__proto__:null,memory:xg,__wbg_syncstate_free:Sg,syncstate_sharedHeads:Cg,syncstate_lastSentHeads:Og,syncstate_set_lastSentHeads:Mg,syncstate_set_sentHashes:Ag,syncstate_clone:Eg,__wbg_automerge_free:Tg,automerge_new:Ng,automerge_clone:Dg,automerge_fork:Rg,automerge_pendingOps:Ig,automerge_commit:zg,automerge_merge:jg,automerge_rollback:Pg,automerge_keys:Bg,automerge_text:$g,automerge_splice:Fg,automerge_push:Vg,automerge_pushObject:Lg,automerge_insert:Wg,automerge_insertObject:qg,automerge_put:Jg,automerge_putObject:Ug,automerge_increment:Kg,automerge_get:Hg,automerge_getWithType:Gg,automerge_getAll:Zg,automerge_enableFreeze:Yg,automerge_enablePatches:Xg,automerge_registerDatatype:Qg,automerge_applyPatches:t0,automerge_popPatches:e0,automerge_length:n0,automerge_delete:r0,automerge_save:o0,automerge_saveIncremental:i0,automerge_loadIncremental:s0,automerge_applyChanges:a0,automerge_getChanges:l0,automerge_getChangeByHash:c0,automerge_getChangesAdded:u0,automerge_getHeads:h0,automerge_getActorId:f0,automerge_getLastLocalChange:d0,automerge_dump:p0,automerge_getMissingDeps:m0,automerge_receiveSyncMessage:g0,automerge_generateSyncMessage:_0,automerge_toJS:y0,automerge_materialize:b0,automerge_emptyChange:w0,automerge_mark:v0,automerge_unmark:k0,automerge_marks:x0,create:S0,load:C0,encodeChange:O0,decodeChange:M0,initSyncState:A0,importSyncState:E0,exportSyncState:T0,encodeSyncMessage:N0,decodeSyncMessage:D0,encodeSyncState:R0,decodeSyncState:I0,__wbindgen_malloc:z0,__wbindgen_realloc:j0,__wbindgen_add_to_stack_pointer:P0,__wbindgen_free:B0,__wbindgen_exn_store:$0},Symbol.toStringTag,{value:"Module"}));nc(F0);const V0=Object.freeze(Object.defineProperty({__proto__:null,__wbg_set_wasm:nc,create:ug,load:hg,encodeChange:fg,decodeChange:dg,initSyncState:pg,importSyncState:mg,exportSyncState:gg,encodeSyncMessage:_g,decodeSyncMessage:yg,encodeSyncState:bg,decodeSyncState:wg,TextRepresentation:kg,Automerge:Je,SyncState:Ee,__wbindgen_json_serialize:sc,__wbindgen_is_undefined:ac,__wbindgen_number_get:lc,__wbindgen_boolean_get:cc,__wbindgen_is_null:uc,__wbindgen_number_new:hc,__wbindgen_string_new:fc,__wbindgen_string_get:dc,__wbindgen_is_string:pc,__wbindgen_object_clone_ref:mc,__wbg_error_f851667af71bcfc6:gc,__wbg_new_abda76e883ba8a5f:_c,__wbg_stack_658279fe44541cf6:yc,__wbindgen_object_drop_ref:bc,__wbindgen_error_new:wc,__wbindgen_jsval_loose_eq:vc,__wbindgen_is_object:kc,__wbindgen_bigint_from_i64:xc,__wbindgen_bigint_from_u64:Sc,__wbg_set_20cbc34131e76824:Cc,__wbg_String_91fba7ded13ba54c:Oc,__wbg_crypto_e1d53a1d73fb10b8:Mc,__wbg_msCrypto_6e7d3e1f92610cbb:Ac,__wbg_getRandomValues_805f1c3d65988a5a:Ec,__wbg_randomFillSync_6894564c2c334c42:Tc,__wbg_require_78a3dcfbdba9cbce:Nc,__wbg_process_038c26bf42b093f8:Dc,__wbg_versions_ab37218d2f0b24a8:Rc,__wbg_node_080f4b19d15bc1fe:Ic,__wbg_log_7bb108d119bafbc1:zc,__wbg_log_d047cf0648d2678e:jc,__wbg_new_b525de17f44a8943:Pc,__wbg_get_27fe3dac1c4d0224:Bc,__wbg_set_17224bc548dd1d7b:$c,__wbg_from_67ca20fa722467e6:Fc,__wbg_isArray_39d28997bf6b96b4:Vc,__wbg_length_e498fbc24f9c1d4f:Lc,__wbg_push_49c286f04dd3bf59:Wc,__wbg_unshift_06a94bcbcb492eb3:qc,__wbg_instanceof_ArrayBuffer_a69f02ee4c4f5065:Jc,__wbg_new_15d3966e9981a196:Uc,__wbg_newnoargs_2b8b6bd7753c76ba:Kc,__wbg_call_95d1ea488d03e4e8:Hc,__wbg_call_9495de66fdbe016b:Gc,__wbg_call_96878afb7a8201ca:Zc,__wbg_next_88560ec06a094dea:Yc,__wbg_next_b7d530c04fd8b217:Xc,__wbg_done_1ebec03bbd919843:Qc,__wbg_value_6ac8da5cc5b3efda:tu,__wbg_instanceof_Date_e353425d719aa266:eu,__wbg_getTime_7c59072d1651a3cf:nu,__wbg_new_f127e324c1313064:ru,__wbg_instanceof_Object_f5a826c4da0d4a94:ou,__wbg_assign_b0b6530984f36574:iu,__wbg_defineProperty_4926f24c724d5310:su,__wbg_entries_4e1315b774245952:au,__wbg_freeze_4dcdbf0b5d9b50f4:lu,__wbg_keys_60443f4f867207f9:cu,__wbg_new_f9876326328f45ed:uu,__wbg_values_7444c4c2ccefdc9b:hu,__wbg_length_ea0846e494e3b16e:fu,__wbg_concat_040af6c9ba38dd98:du,__wbg_slice_47202b1d012cdc55:pu,__wbg_iterator_55f114446221aa5a:mu,__wbg_for_9a885d0d6d415e40:gu,__wbg_toString_7a3e0cd68ea2a337:_u,__wbg_globalThis_87cbb8506fecf3a9:yu,__wbg_self_e7c1f827057f6584:bu,__wbg_window_a09ec664e14b1b81:wu,__wbg_global_c85a9259e621f3db:vu,__wbg_instanceof_Uint8Array_01cebe79ca606cca:ku,__wbg_new_537b7341ce90bb31:xu,__wbg_newwithlength_b56c882b57805732:Su,__wbg_newwithbyteoffsetandlength_9fb2f11355ecadf5:Cu,__wbg_subarray_7526649b91a252a6:Ou,__wbg_length_27a2afe8ab42b09f:Mu,__wbg_set_17499e8aa4003ebd:Au,__wbg_apply_5435e78b95a524a6:Eu,__wbg_deleteProperty_31090878b92a7c0e:Tu,__wbg_get_baf4855f9a986186:Nu,__wbg_ownKeys_9efe69be404540aa:Du,__wbg_set_6aa458a4ebdb65cb:Ru,__wbindgen_is_function:Iu,__wbg_buffer_cf65c07de34b9a08:zu,__wbindgen_debug_string:ju,__wbindgen_throw:Pu,__wbindgen_memory:Bu},Symbol.toStringTag,{value:"Module"}));var L0=globalThis&&globalThis.__rest||function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]]);return e};function W0(n){rg(n)}W0(V0);function $u(n){return typeof n=="object"?n:{actor:n}}function q0(n){const t=$u(n),e=!!t.freeze,r=t.patchCallback,i=ec.create(t.enableTextV2||!1,t.actor);i.enablePatches(!0),i.enableFreeze(!!t.freeze),i.registerDatatype("counter",l=>new Os(l));const s=t.enableTextV2||!1;return s?i.registerDatatype("str",l=>new Xl(l)):i.registerDatatype("text",l=>new En(l)),i.materialize("/",void 0,{handle:i,heads:void 0,freeze:e,patchCallback:r,textV2:s})}function J0(n,t){const e=qe(n),r=e.heads,i=$u(t),s=e.handle.fork(i.actor,r),l=L0(e,["heads"]);return s.applyPatches(n,Object.assign(Object.assign({},l),{handle:s}))}function U0(n,t){return oi(q0(t),e=>Object.assign(e,n))}function oi(n,t,e){if(typeof t=="function")return Vu(n,{},t);if(typeof e=="function")return typeof t=="string"&&(t={message:t}),Vu(n,t,e);throw RangeError("Invalid args for change")}function Fu(n,t,e){if(t==null)return n;const r=qe(n),i=Object.assign(Object.assign({},r),{heads:void 0}),s=r.handle.applyPatches(n,i,e);return r.heads=t,s}function Vu(n,t,e){if(typeof e!="function")throw new RangeError("invalid change function");const r=qe(n);if(n===void 0||r===void 0)throw new RangeError("must be the document root");if(r.heads)throw new RangeError("Attempting to change an outdated document.  Use Automerge.clone() if you wish to make a writable copy.");if(so(n))throw new RangeError("Calls to Automerge.change cannot be nested");const i=r.handle.getHeads();try{r.heads=i;const s=eg(r.handle,r.textV2);return e(s),r.handle.pendingOps()===0?(r.heads=void 0,n):(r.handle.commit(t.message,t.time),Fu(n,i,t.patchCallback||r.patchCallback))}catch(s){throw r.heads=void 0,r.handle.rollback(),s}}function K0(n,t){return qe(t).handle.getChanges(G0(n))}function H0(n,t,e){const r=qe(n);if(e||(e={}),r.heads)throw new RangeError("Attempting to change an outdated document.  Use Automerge.clone() if you wish to make a writable copy.");if(so(n))throw new RangeError("Calls to Automerge.change cannot be nested");const i=r.handle.getHeads();return r.handle.applyChanges(t),r.heads=i,[Fu(n,i,e.patchCallback||r.patchCallback)]}function G0(n){const t=qe(n);return t.heads||t.handle.getHeads()}function Z0(n,t){const e=Lu(t);return e.enableTextV2=!0,J0(n,e)}function Y0(n,t){const e=Lu(t);return e.enableTextV2=!0,U0(n,e)}function Lu(n){return typeof n=="object"?n:{actor:n}}function Ts(n,t,e,r,i){if(!so(n))throw new RangeError("object cannot be modified outside of a change block");const s=qe(n,!1),l=io(n);if(!l)throw new RangeError("invalid object for splice");const c=`${l}/${t}`;try{return s.handle.splice(c,e,r,i)}catch(h){throw new RangeError(`Cannot splice: ${h}`)}}function Sr(n,t,e,r,i){if(!so(n))throw new RangeError("object cannot be modified outside of a change block");const s=qe(n,!1),l=io(n);if(!l)throw new RangeError("invalid object for mark");const c=`${l}/${t}`;try{return s.handle.mark(c,r,e,i)}catch(h){throw new RangeError(`Cannot mark: ${h}`)}}function Wu(n,t,e,r,i){if(!so(n))throw new RangeError("object cannot be modified outside of a change block");const s=qe(n,!1),l=io(n);if(!l)throw new RangeError("invalid object for unmark");const c=`${l}/${t}`;try{return s.handle.unmark(c,e,r,i)}catch(h){throw new RangeError(`Cannot unmark: ${h}`)}}function X0(n,t){const e=qe(n,!1),r=io(n);if(!r)throw new RangeError("invalid object for unmark");const i=`${r}/${t}`;try{return e.handle.marks(i)}catch(s){throw new RangeError(`Cannot call marks(): ${s}`)}}function Dt(n){this.content=n}Dt.prototype={constructor:Dt,find:function(n){for(var t=0;t<this.content.length;t+=2)if(this.content[t]===n)return t;return-1},get:function(n){var t=this.find(n);return t==-1?void 0:this.content[t+1]},update:function(n,t,e){var r=e&&e!=n?this.remove(e):this,i=r.find(n),s=r.content.slice();return i==-1?s.push(e||n,t):(s[i+1]=t,e&&(s[i]=e)),new Dt(s)},remove:function(n){var t=this.find(n);if(t==-1)return this;var e=this.content.slice();return e.splice(t,2),new Dt(e)},addToStart:function(n,t){return new Dt([n,t].concat(this.remove(n).content))},addToEnd:function(n,t){var e=this.remove(n).content.slice();return e.push(n,t),new Dt(e)},addBefore:function(n,t,e){var r=this.remove(t),i=r.content.slice(),s=r.find(n);return i.splice(s==-1?i.length:s,0,t,e),new Dt(i)},forEach:function(n){for(var t=0;t<this.content.length;t+=2)n(this.content[t],this.content[t+1])},prepend:function(n){return n=Dt.from(n),n.size?new Dt(n.content.concat(this.subtract(n).content)):this},append:function(n){return n=Dt.from(n),n.size?new Dt(this.subtract(n).content.concat(n.content)):this},subtract:function(n){var t=this;n=Dt.from(n);for(var e=0;e<n.content.length;e+=2)t=t.remove(n.content[e]);return t},toObject:function(){var n={};return this.forEach(function(t,e){n[t]=e}),n},get size(){return this.content.length>>1}},Dt.from=function(n){if(n instanceof Dt)return n;var t=[];if(n)for(var e in n)t.push(e,n[e]);return new Dt(t)};function qu(n,t,e){for(let r=0;;r++){if(r==n.childCount||r==t.childCount)return n.childCount==t.childCount?null:e;let i=n.child(r),s=t.child(r);if(i==s){e+=i.nodeSize;continue}if(!i.sameMarkup(s))return e;if(i.isText&&i.text!=s.text){for(let l=0;i.text[l]==s.text[l];l++)e++;return e}if(i.content.size||s.content.size){let l=qu(i.content,s.content,e+1);if(l!=null)return l}e+=i.nodeSize}}function Ju(n,t,e,r){for(let i=n.childCount,s=t.childCount;;){if(i==0||s==0)return i==s?null:{a:e,b:r};let l=n.child(--i),c=t.child(--s),h=l.nodeSize;if(l==c){e-=h,r-=h;continue}if(!l.sameMarkup(c))return{a:e,b:r};if(l.isText&&l.text!=c.text){let d=0,m=Math.min(l.text.length,c.text.length);for(;d<m&&l.text[l.text.length-d-1]==c.text[c.text.length-d-1];)d++,e--,r--;return{a:e,b:r}}if(l.content.size||c.content.size){let d=Ju(l.content,c.content,e-1,r-1);if(d)return d}e-=h,r-=h}}class B{constructor(t,e){if(this.content=t,this.size=e||0,e==null)for(let r=0;r<t.length;r++)this.size+=t[r].nodeSize}nodesBetween(t,e,r,i=0,s){for(let l=0,c=0;c<e;l++){let h=this.content[l],d=c+h.nodeSize;if(d>t&&r(h,i+c,s||null,l)!==!1&&h.content.size){let m=c+1;h.nodesBetween(Math.max(0,t-m),Math.min(h.content.size,e-m),r,i+m)}c=d}}descendants(t){this.nodesBetween(0,this.size,t)}textBetween(t,e,r,i){let s="",l=!0;return this.nodesBetween(t,e,(c,h)=>{c.isText?(s+=c.text.slice(Math.max(t,h)-h,e-h),l=!r):c.isLeaf?(i?s+=typeof i=="function"?i(c):i:c.type.spec.leafText&&(s+=c.type.spec.leafText(c)),l=!r):!l&&c.isBlock&&(s+=r,l=!0)},0),s}append(t){if(!t.size)return this;if(!this.size)return t;let e=this.lastChild,r=t.firstChild,i=this.content.slice(),s=0;for(e.isText&&e.sameMarkup(r)&&(i[i.length-1]=e.withText(e.text+r.text),s=1);s<t.content.length;s++)i.push(t.content[s]);return new B(i,this.size+t.size)}cut(t,e=this.size){if(t==0&&e==this.size)return this;let r=[],i=0;if(e>t)for(let s=0,l=0;l<e;s++){let c=this.content[s],h=l+c.nodeSize;h>t&&((l<t||h>e)&&(c.isText?c=c.cut(Math.max(0,t-l),Math.min(c.text.length,e-l)):c=c.cut(Math.max(0,t-l-1),Math.min(c.content.size,e-l-1))),r.push(c),i+=c.nodeSize),l=h}return new B(r,i)}cutByIndex(t,e){return t==e?B.empty:t==0&&e==this.content.length?this:new B(this.content.slice(t,e))}replaceChild(t,e){let r=this.content[t];if(r==e)return this;let i=this.content.slice(),s=this.size+e.nodeSize-r.nodeSize;return i[t]=e,new B(i,s)}addToStart(t){return new B([t].concat(this.content),this.size+t.nodeSize)}addToEnd(t){return new B(this.content.concat(t),this.size+t.nodeSize)}eq(t){if(this.content.length!=t.content.length)return!1;for(let e=0;e<this.content.length;e++)if(!this.content[e].eq(t.content[e]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(t){let e=this.content[t];if(!e)throw new RangeError("Index "+t+" out of range for "+this);return e}maybeChild(t){return this.content[t]||null}forEach(t){for(let e=0,r=0;e<this.content.length;e++){let i=this.content[e];t(i,r,e),r+=i.nodeSize}}findDiffStart(t,e=0){return qu(this,t,e)}findDiffEnd(t,e=this.size,r=t.size){return Ju(this,t,e,r)}findIndex(t,e=-1){if(t==0)return ii(0,t);if(t==this.size)return ii(this.content.length,t);if(t>this.size||t<0)throw new RangeError(`Position ${t} outside of fragment (${this})`);for(let r=0,i=0;;r++){let s=this.child(r),l=i+s.nodeSize;if(l>=t)return l==t||e>0?ii(r+1,l):ii(r,i);i=l}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(t=>t.toJSON()):null}static fromJSON(t,e){if(!e)return B.empty;if(!Array.isArray(e))throw new RangeError("Invalid input for Fragment.fromJSON");return new B(e.map(t.nodeFromJSON))}static fromArray(t){if(!t.length)return B.empty;let e,r=0;for(let i=0;i<t.length;i++){let s=t[i];r+=s.nodeSize,i&&s.isText&&t[i-1].sameMarkup(s)?(e||(e=t.slice(0,i)),e[e.length-1]=s.withText(e[e.length-1].text+s.text)):e&&e.push(s)}return new B(e||t,r)}static from(t){if(!t)return B.empty;if(t instanceof B)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new B([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}B.empty=new B([],0);const Ns={index:0,offset:0};function ii(n,t){return Ns.index=n,Ns.offset=t,Ns}function si(n,t){if(n===t)return!0;if(!(n&&typeof n=="object")||!(t&&typeof t=="object"))return!1;let e=Array.isArray(n);if(Array.isArray(t)!=e)return!1;if(e){if(n.length!=t.length)return!1;for(let r=0;r<n.length;r++)if(!si(n[r],t[r]))return!1}else{for(let r in n)if(!(r in t)||!si(n[r],t[r]))return!1;for(let r in t)if(!(r in n))return!1}return!0}class ct{constructor(t,e){this.type=t,this.attrs=e}addToSet(t){let e,r=!1;for(let i=0;i<t.length;i++){let s=t[i];if(this.eq(s))return t;if(this.type.excludes(s.type))e||(e=t.slice(0,i));else{if(s.type.excludes(this.type))return t;!r&&s.type.rank>this.type.rank&&(e||(e=t.slice(0,i)),e.push(this),r=!0),e&&e.push(s)}}return e||(e=t.slice()),r||e.push(this),e}removeFromSet(t){for(let e=0;e<t.length;e++)if(this.eq(t[e]))return t.slice(0,e).concat(t.slice(e+1));return t}isInSet(t){for(let e=0;e<t.length;e++)if(this.eq(t[e]))return!0;return!1}eq(t){return this==t||this.type==t.type&&si(this.attrs,t.attrs)}toJSON(){let t={type:this.type.name};for(let e in this.attrs){t.attrs=this.attrs;break}return t}static fromJSON(t,e){if(!e)throw new RangeError("Invalid input for Mark.fromJSON");let r=t.marks[e.type];if(!r)throw new RangeError(`There is no mark type ${e.type} in this schema`);return r.create(e.attrs)}static sameSet(t,e){if(t==e)return!0;if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!t[r].eq(e[r]))return!1;return!0}static setFrom(t){if(!t||Array.isArray(t)&&t.length==0)return ct.none;if(t instanceof ct)return[t];let e=t.slice();return e.sort((r,i)=>r.type.rank-i.type.rank),e}}ct.none=[];class ai extends Error{}class W{constructor(t,e,r){this.content=t,this.openStart=e,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(t,e){let r=Ku(this.content,t+this.openStart,e);return r&&new W(r,this.openStart,this.openEnd)}removeBetween(t,e){return new W(Uu(this.content,t+this.openStart,e+this.openStart),this.openStart,this.openEnd)}eq(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t}static fromJSON(t,e){if(!e)return W.empty;let r=e.openStart||0,i=e.openEnd||0;if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new W(B.fromJSON(t,e.content),r,i)}static maxOpen(t,e=!0){let r=0,i=0;for(let s=t.firstChild;s&&!s.isLeaf&&(e||!s.type.spec.isolating);s=s.firstChild)r++;for(let s=t.lastChild;s&&!s.isLeaf&&(e||!s.type.spec.isolating);s=s.lastChild)i++;return new W(t,r,i)}}W.empty=new W(B.empty,0,0);function Uu(n,t,e){let{index:r,offset:i}=n.findIndex(t),s=n.maybeChild(r),{index:l,offset:c}=n.findIndex(e);if(i==t||s.isText){if(c!=e&&!n.child(l).isText)throw new RangeError("Removing non-flat range");return n.cut(0,t).append(n.cut(e))}if(r!=l)throw new RangeError("Removing non-flat range");return n.replaceChild(r,s.copy(Uu(s.content,t-i-1,e-i-1)))}function Ku(n,t,e,r){let{index:i,offset:s}=n.findIndex(t),l=n.maybeChild(i);if(s==t||l.isText)return r&&!r.canReplace(i,i,e)?null:n.cut(0,t).append(e).append(n.cut(t));let c=Ku(l.content,t-s-1,e);return c&&n.replaceChild(i,l.copy(c))}function Q0(n,t,e){if(e.openStart>n.depth)throw new ai("Inserted content deeper than insertion position");if(n.depth-e.openStart!=t.depth-e.openEnd)throw new ai("Inconsistent open depths");return Hu(n,t,e,0)}function Hu(n,t,e,r){let i=n.index(r),s=n.node(r);if(i==t.index(r)&&r<n.depth-e.openStart){let l=Hu(n,t,e,r+1);return s.copy(s.content.replaceChild(i,l))}else if(e.content.size)if(!e.openStart&&!e.openEnd&&n.depth==r&&t.depth==r){let l=n.parent,c=l.content;return tr(l,c.cut(0,n.parentOffset).append(e.content).append(c.cut(t.parentOffset)))}else{let{start:l,end:c}=t_(e,n);return tr(s,Zu(n,l,c,t,r))}else return tr(s,li(n,t,r))}function Gu(n,t){if(!t.type.compatibleContent(n.type))throw new ai("Cannot join "+t.type.name+" onto "+n.type.name)}function Ds(n,t,e){let r=n.node(e);return Gu(r,t.node(e)),r}function Qn(n,t){let e=t.length-1;e>=0&&n.isText&&n.sameMarkup(t[e])?t[e]=n.withText(t[e].text+n.text):t.push(n)}function co(n,t,e,r){let i=(t||n).node(e),s=0,l=t?t.index(e):i.childCount;n&&(s=n.index(e),n.depth>e?s++:n.textOffset&&(Qn(n.nodeAfter,r),s++));for(let c=s;c<l;c++)Qn(i.child(c),r);t&&t.depth==e&&t.textOffset&&Qn(t.nodeBefore,r)}function tr(n,t){return n.type.checkContent(t),n.copy(t)}function Zu(n,t,e,r,i){let s=n.depth>i&&Ds(n,t,i+1),l=r.depth>i&&Ds(e,r,i+1),c=[];return co(null,n,i,c),s&&l&&t.index(i)==e.index(i)?(Gu(s,l),Qn(tr(s,Zu(n,t,e,r,i+1)),c)):(s&&Qn(tr(s,li(n,t,i+1)),c),co(t,e,i,c),l&&Qn(tr(l,li(e,r,i+1)),c)),co(r,null,i,c),new B(c)}function li(n,t,e){let r=[];if(co(null,n,e,r),n.depth>e){let i=Ds(n,t,e+1);Qn(tr(i,li(n,t,e+1)),r)}return co(t,null,e,r),new B(r)}function t_(n,t){let e=t.depth-n.openStart,r=t.node(e).copy(n.content);for(let i=e-1;i>=0;i--)r=t.node(i).copy(B.from(r));return{start:r.resolveNoCache(n.openStart+e),end:r.resolveNoCache(r.content.size-n.openEnd-e)}}class uo{constructor(t,e,r){this.pos=t,this.path=e,this.parentOffset=r,this.depth=e.length/3-1}resolveDepth(t){return t==null?this.depth:t<0?this.depth+t:t}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(t){return this.path[this.resolveDepth(t)*3]}index(t){return this.path[this.resolveDepth(t)*3+1]}indexAfter(t){return t=this.resolveDepth(t),this.index(t)+(t==this.depth&&!this.textOffset?0:1)}start(t){return t=this.resolveDepth(t),t==0?0:this.path[t*3-1]+1}end(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size}before(t){if(t=this.resolveDepth(t),!t)throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[t*3-1]}after(t){if(t=this.resolveDepth(t),!t)throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[t*3-1]+this.path[t*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let t=this.parent,e=this.index(this.depth);if(e==t.childCount)return null;let r=this.pos-this.path[this.path.length-1],i=t.child(e);return r?t.child(e).cut(r):i}get nodeBefore(){let t=this.index(this.depth),e=this.pos-this.path[this.path.length-1];return e?this.parent.child(t).cut(0,e):t==0?null:this.parent.child(t-1)}posAtIndex(t,e){e=this.resolveDepth(e);let r=this.path[e*3],i=e==0?0:this.path[e*3-1]+1;for(let s=0;s<t;s++)i+=r.child(s).nodeSize;return i}marks(){let t=this.parent,e=this.index();if(t.content.size==0)return ct.none;if(this.textOffset)return t.child(e).marks;let r=t.maybeChild(e-1),i=t.maybeChild(e);if(!r){let c=r;r=i,i=c}let s=r.marks;for(var l=0;l<s.length;l++)s[l].type.spec.inclusive===!1&&(!i||!s[l].isInSet(i.marks))&&(s=s[l--].removeFromSet(s));return s}marksAcross(t){let e=this.parent.maybeChild(this.index());if(!e||!e.isInline)return null;let r=e.marks,i=t.parent.maybeChild(t.index());for(var s=0;s<r.length;s++)r[s].type.spec.inclusive===!1&&(!i||!r[s].isInSet(i.marks))&&(r=r[s--].removeFromSet(r));return r}sharedDepth(t){for(let e=this.depth;e>0;e--)if(this.start(e)<=t&&this.end(e)>=t)return e;return 0}blockRange(t=this,e){if(t.pos<this.pos)return t.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);r>=0;r--)if(t.pos<=this.end(r)&&(!e||e(this.node(r))))return new n_(this,t,r);return null}sameParent(t){return this.pos-this.parentOffset==t.pos-t.parentOffset}max(t){return t.pos>this.pos?t:this}min(t){return t.pos<this.pos?t:this}toString(){let t="";for(let e=1;e<=this.depth;e++)t+=(t?"/":"")+this.node(e).type.name+"_"+this.index(e-1);return t+":"+this.parentOffset}static resolve(t,e){if(!(e>=0&&e<=t.content.size))throw new RangeError("Position "+e+" out of range");let r=[],i=0,s=e;for(let l=t;;){let{index:c,offset:h}=l.content.findIndex(s),d=s-h;if(r.push(l,c,i+h),!d||(l=l.child(c),l.isText))break;s=d-1,i+=h+1}return new uo(e,r,s)}static resolveCached(t,e){for(let i=0;i<Rs.length;i++){let s=Rs[i];if(s.pos==e&&s.doc==t)return s}let r=Rs[Is]=uo.resolve(t,e);return Is=(Is+1)%e_,r}}let Rs=[],Is=0,e_=12;class n_{constructor(t,e,r){this.$from=t,this.$to=e,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const r_=Object.create(null);class Ue{constructor(t,e,r,i=ct.none){this.type=t,this.attrs=e,this.marks=i,this.content=r||B.empty}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(t){return this.content.child(t)}maybeChild(t){return this.content.maybeChild(t)}forEach(t){this.content.forEach(t)}nodesBetween(t,e,r,i=0){this.content.nodesBetween(t,e,r,i,this)}descendants(t){this.nodesBetween(0,this.content.size,t)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(t,e,r,i){return this.content.textBetween(t,e,r,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)}sameMarkup(t){return this.hasMarkup(t.type,t.attrs,t.marks)}hasMarkup(t,e,r){return this.type==t&&si(this.attrs,e||t.defaultAttrs||r_)&&ct.sameSet(this.marks,r||ct.none)}copy(t=null){return t==this.content?this:new Ue(this.type,this.attrs,t,this.marks)}mark(t){return t==this.marks?this:new Ue(this.type,this.attrs,this.content,t)}cut(t,e=this.content.size){return t==0&&e==this.content.size?this:this.copy(this.content.cut(t,e))}slice(t,e=this.content.size,r=!1){if(t==e)return W.empty;let i=this.resolve(t),s=this.resolve(e),l=r?0:i.sharedDepth(e),c=i.start(l),h=i.node(l).content.cut(i.pos-c,s.pos-c);return new W(h,i.depth-l,s.depth-l)}replace(t,e,r){return Q0(this.resolve(t),this.resolve(e),r)}nodeAt(t){for(let e=this;;){let{index:r,offset:i}=e.content.findIndex(t);if(e=e.maybeChild(r),!e)return null;if(i==t||e.isText)return e;t-=i+1}}childAfter(t){let{index:e,offset:r}=this.content.findIndex(t);return{node:this.content.maybeChild(e),index:e,offset:r}}childBefore(t){if(t==0)return{node:null,index:0,offset:0};let{index:e,offset:r}=this.content.findIndex(t);if(r<t)return{node:this.content.child(e),index:e,offset:r};let i=this.content.child(e-1);return{node:i,index:e-1,offset:r-i.nodeSize}}resolve(t){return uo.resolveCached(this,t)}resolveNoCache(t){return uo.resolve(this,t)}rangeHasMark(t,e,r){let i=!1;return e>t&&this.nodesBetween(t,e,s=>(r.isInSet(s.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),Yu(this.marks,t)}contentMatchAt(t){let e=this.type.contentMatch.matchFragment(this.content,0,t);if(!e)throw new Error("Called contentMatchAt on a node with invalid content");return e}canReplace(t,e,r=B.empty,i=0,s=r.childCount){let l=this.contentMatchAt(t).matchFragment(r,i,s),c=l&&l.matchFragment(this.content,e);if(!c||!c.validEnd)return!1;for(let h=i;h<s;h++)if(!this.type.allowsMarks(r.child(h).marks))return!1;return!0}canReplaceWith(t,e,r,i){if(i&&!this.type.allowsMarks(i))return!1;let s=this.contentMatchAt(t).matchType(r),l=s&&s.matchFragment(this.content,e);return l?l.validEnd:!1}canAppend(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)}check(){this.type.checkContent(this.content);let t=ct.none;for(let e=0;e<this.marks.length;e++)t=this.marks[e].addToSet(t);if(!ct.sameSet(t,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(e=>e.type.name)}`);this.content.forEach(e=>e.check())}toJSON(){let t={type:this.type.name};for(let e in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map(e=>e.toJSON())),t}static fromJSON(t,e){if(!e)throw new RangeError("Invalid input for Node.fromJSON");let r=null;if(e.marks){if(!Array.isArray(e.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=e.marks.map(t.markFromJSON)}if(e.type=="text"){if(typeof e.text!="string")throw new RangeError("Invalid text node in JSON");return t.text(e.text,r)}let i=B.fromJSON(t,e.content);return t.nodeType(e.type).create(e.attrs,i,r)}}Ue.prototype.text=void 0;class ci extends Ue{constructor(t,e,r,i){if(super(t,e,null,i),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):Yu(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(t,e){return this.text.slice(t,e)}get nodeSize(){return this.text.length}mark(t){return t==this.marks?this:new ci(this.type,this.attrs,this.text,t)}withText(t){return t==this.text?this:new ci(this.type,this.attrs,t,this.marks)}cut(t=0,e=this.text.length){return t==0&&e==this.text.length?this:this.withText(this.text.slice(t,e))}eq(t){return this.sameMarkup(t)&&this.text==t.text}toJSON(){let t=super.toJSON();return t.text=this.text,t}}function Yu(n,t){for(let e=n.length-1;e>=0;e--)t=n[e].type.name+"("+t+")";return t}class er{constructor(t){this.validEnd=t,this.next=[],this.wrapCache=[]}static parse(t,e){let r=new o_(t,e);if(r.next==null)return er.empty;let i=Xu(r);r.next&&r.err("Unexpected trailing text");let s=h_(u_(i));return f_(s,r),s}matchType(t){for(let e=0;e<this.next.length;e++)if(this.next[e].type==t)return this.next[e].next;return null}matchFragment(t,e=0,r=t.childCount){let i=this;for(let s=e;i&&s<r;s++)i=i.matchType(t.child(s).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let t=0;t<this.next.length;t++){let{type:e}=this.next[t];if(!(e.isText||e.hasRequiredAttrs()))return e}return null}compatible(t){for(let e=0;e<this.next.length;e++)for(let r=0;r<t.next.length;r++)if(this.next[e].type==t.next[r].type)return!0;return!1}fillBefore(t,e=!1,r=0){let i=[this];function s(l,c){let h=l.matchFragment(t,r);if(h&&(!e||h.validEnd))return B.from(c.map(d=>d.createAndFill()));for(let d=0;d<l.next.length;d++){let{type:m,next:y}=l.next[d];if(!(m.isText||m.hasRequiredAttrs())&&i.indexOf(y)==-1){i.push(y);let v=s(y,c.concat(m));if(v)return v}}return null}return s(this,[])}findWrapping(t){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==t)return this.wrapCache[r+1];let e=this.computeWrapping(t);return this.wrapCache.push(t,e),e}computeWrapping(t){let e=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let i=r.shift(),s=i.match;if(s.matchType(t)){let l=[];for(let c=i;c.type;c=c.via)l.push(c.type);return l.reverse()}for(let l=0;l<s.next.length;l++){let{type:c,next:h}=s.next[l];!c.isLeaf&&!c.hasRequiredAttrs()&&!(c.name in e)&&(!i.type||h.validEnd)&&(r.push({match:c.contentMatch,type:c,via:i}),e[c.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(t){if(t>=this.next.length)throw new RangeError(`There's no ${t}th edge in this content match`);return this.next[t]}toString(){let t=[];function e(r){t.push(r);for(let i=0;i<r.next.length;i++)t.indexOf(r.next[i].next)==-1&&e(r.next[i].next)}return e(this),t.map((r,i)=>{let s=i+(r.validEnd?"*":" ")+" ";for(let l=0;l<r.next.length;l++)s+=(l?", ":"")+r.next[l].type.name+"->"+t.indexOf(r.next[l].next);return s}).join(`
`)}}er.empty=new er(!0);class o_{constructor(t,e){this.string=t,this.nodeTypes=e,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(t){return this.next==t&&(this.pos++||!0)}err(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")}}function Xu(n){let t=[];do t.push(i_(n));while(n.eat("|"));return t.length==1?t[0]:{type:"choice",exprs:t}}function i_(n){let t=[];do t.push(s_(n));while(n.next&&n.next!=")"&&n.next!="|");return t.length==1?t[0]:{type:"seq",exprs:t}}function s_(n){let t=c_(n);for(;;)if(n.eat("+"))t={type:"plus",expr:t};else if(n.eat("*"))t={type:"star",expr:t};else if(n.eat("?"))t={type:"opt",expr:t};else if(n.eat("{"))t=a_(n,t);else break;return t}function Qu(n){/\D/.test(n.next)&&n.err("Expected number, got '"+n.next+"'");let t=Number(n.next);return n.pos++,t}function a_(n,t){let e=Qu(n),r=e;return n.eat(",")&&(n.next!="}"?r=Qu(n):r=-1),n.eat("}")||n.err("Unclosed braced range"),{type:"range",min:e,max:r,expr:t}}function l_(n,t){let e=n.nodeTypes,r=e[t];if(r)return[r];let i=[];for(let s in e){let l=e[s];l.groups.indexOf(t)>-1&&i.push(l)}return i.length==0&&n.err("No node type or group '"+t+"' found"),i}function c_(n){if(n.eat("(")){let t=Xu(n);return n.eat(")")||n.err("Missing closing paren"),t}else if(/\W/.test(n.next))n.err("Unexpected token '"+n.next+"'");else{let t=l_(n,n.next).map(e=>(n.inline==null?n.inline=e.isInline:n.inline!=e.isInline&&n.err("Mixing inline and block content"),{type:"name",value:e}));return n.pos++,t.length==1?t[0]:{type:"choice",exprs:t}}}function u_(n){let t=[[]];return i(s(n,0),e()),t;function e(){return t.push([])-1}function r(l,c,h){let d={term:h,to:c};return t[l].push(d),d}function i(l,c){l.forEach(h=>h.to=c)}function s(l,c){if(l.type=="choice")return l.exprs.reduce((h,d)=>h.concat(s(d,c)),[]);if(l.type=="seq")for(let h=0;;h++){let d=s(l.exprs[h],c);if(h==l.exprs.length-1)return d;i(d,c=e())}else if(l.type=="star"){let h=e();return r(c,h),i(s(l.expr,h),h),[r(h)]}else if(l.type=="plus"){let h=e();return i(s(l.expr,c),h),i(s(l.expr,h),h),[r(h)]}else{if(l.type=="opt")return[r(c)].concat(s(l.expr,c));if(l.type=="range"){let h=c;for(let d=0;d<l.min;d++){let m=e();i(s(l.expr,h),m),h=m}if(l.max==-1)i(s(l.expr,h),h);else for(let d=l.min;d<l.max;d++){let m=e();r(h,m),i(s(l.expr,h),m),h=m}return[r(h)]}else{if(l.type=="name")return[r(c,void 0,l.value)];throw new Error("Unknown expr type")}}}}function th(n,t){return t-n}function eh(n,t){let e=[];return r(t),e.sort(th);function r(i){let s=n[i];if(s.length==1&&!s[0].term)return r(s[0].to);e.push(i);for(let l=0;l<s.length;l++){let{term:c,to:h}=s[l];!c&&e.indexOf(h)==-1&&r(h)}}}function h_(n){let t=Object.create(null);return e(eh(n,0));function e(r){let i=[];r.forEach(l=>{n[l].forEach(({term:c,to:h})=>{if(!c)return;let d;for(let m=0;m<i.length;m++)i[m][0]==c&&(d=i[m][1]);eh(n,h).forEach(m=>{d||i.push([c,d=[]]),d.indexOf(m)==-1&&d.push(m)})})});let s=t[r.join(",")]=new er(r.indexOf(n.length-1)>-1);for(let l=0;l<i.length;l++){let c=i[l][1].sort(th);s.next.push({type:i[l][0],next:t[c.join(",")]||e(c)})}return s}}function f_(n,t){for(let e=0,r=[n];e<r.length;e++){let i=r[e],s=!i.validEnd,l=[];for(let c=0;c<i.next.length;c++){let{type:h,next:d}=i.next[c];l.push(h.name),s&&!(h.isText||h.hasRequiredAttrs())&&(s=!1),r.indexOf(d)==-1&&r.push(d)}s&&t.err("Only non-generatable nodes ("+l.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function nh(n){let t=Object.create(null);for(let e in n){let r=n[e];if(!r.hasDefault)return null;t[e]=r.default}return t}function rh(n,t){let e=Object.create(null);for(let r in n){let i=t&&t[r];if(i===void 0){let s=n[r];if(s.hasDefault)i=s.default;else throw new RangeError("No value supplied for attribute "+r)}e[r]=i}return e}function oh(n){let t=Object.create(null);if(n)for(let e in n)t[e]=new d_(n[e]);return t}class ui{constructor(t,e,r){this.name=t,this.schema=e,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=oh(r.attrs),this.defaultAttrs=nh(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||t=="text"),this.isText=t=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==er.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1}compatibleContent(t){return this==t||this.contentMatch.compatible(t.contentMatch)}computeAttrs(t){return!t&&this.defaultAttrs?this.defaultAttrs:rh(this.attrs,t)}create(t=null,e,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Ue(this,this.computeAttrs(t),B.from(e),ct.setFrom(r))}createChecked(t=null,e,r){return e=B.from(e),this.checkContent(e),new Ue(this,this.computeAttrs(t),e,ct.setFrom(r))}createAndFill(t=null,e,r){if(t=this.computeAttrs(t),e=B.from(e),e.size){let l=this.contentMatch.fillBefore(e);if(!l)return null;e=l.append(e)}let i=this.contentMatch.matchFragment(e),s=i&&i.fillBefore(B.empty,!0);return s?new Ue(this,t,e.append(s),ct.setFrom(r)):null}validContent(t){let e=this.contentMatch.matchFragment(t);if(!e||!e.validEnd)return!1;for(let r=0;r<t.childCount;r++)if(!this.allowsMarks(t.child(r).marks))return!1;return!0}checkContent(t){if(!this.validContent(t))throw new RangeError(`Invalid content for node ${this.name}: ${t.toString().slice(0,50)}`)}allowsMarkType(t){return this.markSet==null||this.markSet.indexOf(t)>-1}allowsMarks(t){if(this.markSet==null)return!0;for(let e=0;e<t.length;e++)if(!this.allowsMarkType(t[e].type))return!1;return!0}allowedMarks(t){if(this.markSet==null)return t;let e;for(let r=0;r<t.length;r++)this.allowsMarkType(t[r].type)?e&&e.push(t[r]):e||(e=t.slice(0,r));return e?e.length?e:ct.none:t}static compile(t,e){let r=Object.create(null);t.forEach((s,l)=>r[s]=new ui(s,e,l));let i=e.spec.topNode||"doc";if(!r[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let s in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}}class d_{constructor(t){this.hasDefault=Object.prototype.hasOwnProperty.call(t,"default"),this.default=t.default}get isRequired(){return!this.hasDefault}}class hi{constructor(t,e,r,i){this.name=t,this.rank=e,this.schema=r,this.spec=i,this.attrs=oh(i.attrs),this.excluded=null;let s=nh(this.attrs);this.instance=s?new ct(this,s):null}create(t=null){return!t&&this.instance?this.instance:new ct(this,rh(this.attrs,t))}static compile(t,e){let r=Object.create(null),i=0;return t.forEach((s,l)=>r[s]=new hi(s,i++,e,l)),r}removeFromSet(t){for(var e=0;e<t.length;e++)t[e].type==this&&(t=t.slice(0,e).concat(t.slice(e+1)),e--);return t}isInSet(t){for(let e=0;e<t.length;e++)if(t[e].type==this)return t[e]}excludes(t){return this.excluded.indexOf(t)>-1}}class p_{constructor(t){this.cached=Object.create(null);let e=this.spec={};for(let i in t)e[i]=t[i];e.nodes=Dt.from(t.nodes),e.marks=Dt.from(t.marks||{}),this.nodes=ui.compile(this.spec.nodes,this),this.marks=hi.compile(this.spec.marks,this);let r=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let s=this.nodes[i],l=s.spec.content||"",c=s.spec.marks;s.contentMatch=r[l]||(r[l]=er.parse(l,this.nodes)),s.inlineContent=s.contentMatch.inlineContent,s.markSet=c=="_"?null:c?ih(this,c.split(" ")):c==""||!s.inlineContent?[]:null}for(let i in this.marks){let s=this.marks[i],l=s.spec.excludes;s.excluded=l==null?[s]:l==""?[]:ih(this,l.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(t,e=null,r,i){if(typeof t=="string")t=this.nodeType(t);else if(t instanceof ui){if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}else throw new RangeError("Invalid node type: "+t);return t.createChecked(e,r,i)}text(t,e){let r=this.nodes.text;return new ci(r,r.defaultAttrs,t,ct.setFrom(e))}mark(t,e){return typeof t=="string"&&(t=this.marks[t]),t.create(e)}nodeFromJSON(t){return Ue.fromJSON(this,t)}markFromJSON(t){return ct.fromJSON(this,t)}nodeType(t){let e=this.nodes[t];if(!e)throw new RangeError("Unknown node type: "+t);return e}}function ih(n,t){let e=[];for(let r=0;r<t.length;r++){let i=t[r],s=n.marks[i],l=s;if(s)e.push(s);else for(let c in n.marks){let h=n.marks[c];(i=="_"||h.spec.group&&h.spec.group.split(" ").indexOf(i)>-1)&&e.push(l=h)}if(!l)throw new SyntaxError("Unknown mark type: '"+t[r]+"'")}return e}class ho{constructor(t,e){this.schema=t,this.rules=e,this.tags=[],this.styles=[],e.forEach(r=>{r.tag?this.tags.push(r):r.style&&this.styles.push(r)}),this.normalizeLists=!this.tags.some(r=>{if(!/^(ul|ol)\b/.test(r.tag)||!r.node)return!1;let i=t.nodes[r.node];return i.contentMatch.matchType(i)})}parse(t,e={}){let r=new ch(this,e,!1);return r.addAll(t,e.from,e.to),r.finish()}parseSlice(t,e={}){let r=new ch(this,e,!0);return r.addAll(t,e.from,e.to),W.maxOpen(r.finish())}matchTag(t,e,r){for(let i=r?this.tags.indexOf(r)+1:0;i<this.tags.length;i++){let s=this.tags[i];if(__(t,s.tag)&&(s.namespace===void 0||t.namespaceURI==s.namespace)&&(!s.context||e.matchesContext(s.context))){if(s.getAttrs){let l=s.getAttrs(t);if(l===!1)continue;s.attrs=l||void 0}return s}}}matchStyle(t,e,r,i){for(let s=i?this.styles.indexOf(i)+1:0;s<this.styles.length;s++){let l=this.styles[s],c=l.style;if(!(c.indexOf(t)!=0||l.context&&!r.matchesContext(l.context)||c.length>t.length&&(c.charCodeAt(t.length)!=61||c.slice(t.length+1)!=e))){if(l.getAttrs){let h=l.getAttrs(e);if(h===!1)continue;l.attrs=h||void 0}return l}}}static schemaRules(t){let e=[];function r(i){let s=i.priority==null?50:i.priority,l=0;for(;l<e.length;l++){let c=e[l];if((c.priority==null?50:c.priority)<s)break}e.splice(l,0,i)}for(let i in t.marks){let s=t.marks[i].spec.parseDOM;s&&s.forEach(l=>{r(l=uh(l)),l.mark||l.ignore||l.clearMark||(l.mark=i)})}for(let i in t.nodes){let s=t.nodes[i].spec.parseDOM;s&&s.forEach(l=>{r(l=uh(l)),l.node||l.ignore||l.mark||(l.node=i)})}return e}static fromSchema(t){return t.cached.domParser||(t.cached.domParser=new ho(t,ho.schemaRules(t)))}}const sh={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},m_={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},ah={ol:!0,ul:!0},fi=1,di=2,fo=4;function lh(n,t,e){return t!=null?(t?fi:0)|(t==="full"?di:0):n&&n.whitespace=="pre"?fi|di:e&~fo}class pi{constructor(t,e,r,i,s,l,c){this.type=t,this.attrs=e,this.marks=r,this.pendingMarks=i,this.solid=s,this.options=c,this.content=[],this.activeMarks=ct.none,this.stashMarks=[],this.match=l||(c&fo?null:t.contentMatch)}findWrapping(t){if(!this.match){if(!this.type)return[];let e=this.type.contentMatch.fillBefore(B.from(t));if(e)this.match=this.type.contentMatch.matchFragment(e);else{let r=this.type.contentMatch,i;return(i=r.findWrapping(t.type))?(this.match=r,i):null}}return this.match.findWrapping(t.type)}finish(t){if(!(this.options&fi)){let r=this.content[this.content.length-1],i;if(r&&r.isText&&(i=/[ \t\r\n\u000c]+$/.exec(r.text))){let s=r;r.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=s.withText(s.text.slice(0,s.text.length-i[0].length))}}let e=B.from(this.content);return!t&&this.match&&(e=e.append(this.match.fillBefore(B.empty,!0))),this.type?this.type.create(this.attrs,e,this.marks):e}popFromStashMark(t){for(let e=this.stashMarks.length-1;e>=0;e--)if(t.eq(this.stashMarks[e]))return this.stashMarks.splice(e,1)[0]}applyPending(t){for(let e=0,r=this.pendingMarks;e<r.length;e++){let i=r[e];(this.type?this.type.allowsMarkType(i.type):b_(i.type,t))&&!i.isInSet(this.activeMarks)&&(this.activeMarks=i.addToSet(this.activeMarks),this.pendingMarks=i.removeFromSet(this.pendingMarks))}}inlineContext(t){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:t.parentNode&&!sh.hasOwnProperty(t.parentNode.nodeName.toLowerCase())}}class ch{constructor(t,e,r){this.parser=t,this.options=e,this.isOpen=r,this.open=0;let i=e.topNode,s,l=lh(null,e.preserveWhitespace,0)|(r?fo:0);i?s=new pi(i.type,i.attrs,ct.none,ct.none,!0,e.topMatch||i.type.contentMatch,l):r?s=new pi(null,null,ct.none,ct.none,!0,null,l):s=new pi(t.schema.topNodeType,null,ct.none,ct.none,!0,null,l),this.nodes=[s],this.find=e.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(t){if(t.nodeType==3)this.addTextNode(t);else if(t.nodeType==1){let e=t.getAttribute("style");if(!e)this.addElement(t);else{let r=this.readStyles(y_(e));if(!r)return;let[i,s]=r,l=this.top;for(let c=0;c<s.length;c++)this.removePendingMark(s[c],l);for(let c=0;c<i.length;c++)this.addPendingMark(i[c]);this.addElement(t);for(let c=0;c<i.length;c++)this.removePendingMark(i[c],l);for(let c=0;c<s.length;c++)this.addPendingMark(s[c])}}}addTextNode(t){let e=t.nodeValue,r=this.top;if(r.options&di||r.inlineContext(t)||/[^ \t\r\n\u000c]/.test(e)){if(r.options&fi)r.options&di?e=e.replace(/\r\n?/g,`
`):e=e.replace(/\r?\n|\r/g," ");else if(e=e.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(e)&&this.open==this.nodes.length-1){let i=r.content[r.content.length-1],s=t.previousSibling;(!i||s&&s.nodeName=="BR"||i.isText&&/[ \t\r\n\u000c]$/.test(i.text))&&(e=e.slice(1))}e&&this.insertNode(this.parser.schema.text(e)),this.findInText(t)}else this.findInside(t)}addElement(t,e){let r=t.nodeName.toLowerCase(),i;ah.hasOwnProperty(r)&&this.parser.normalizeLists&&g_(t);let s=this.options.ruleFromNode&&this.options.ruleFromNode(t)||(i=this.parser.matchTag(t,this,e));if(s?s.ignore:m_.hasOwnProperty(r))this.findInside(t),this.ignoreFallback(t);else if(!s||s.skip||s.closeParent){s&&s.closeParent?this.open=Math.max(0,this.open-1):s&&s.skip.nodeType&&(t=s.skip);let l,c=this.top,h=this.needsBlock;if(sh.hasOwnProperty(r))c.content.length&&c.content[0].isInline&&this.open&&(this.open--,c=this.top),l=!0,c.type||(this.needsBlock=!0);else if(!t.firstChild){this.leafFallback(t);return}this.addAll(t),l&&this.sync(c),this.needsBlock=h}else this.addElementByRule(t,s,s.consuming===!1?i:void 0)}leafFallback(t){t.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode(`
`))}ignoreFallback(t){t.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"))}readStyles(t){let e=ct.none,r=ct.none;t:for(let i=0;i<t.length;i+=2)for(let s=void 0;;){let l=this.parser.matchStyle(t[i],t[i+1],this,s);if(!l)continue t;if(l.ignore)return null;if(l.clearMark?this.top.pendingMarks.forEach(c=>{l.clearMark(c)&&(r=c.addToSet(r))}):e=this.parser.schema.marks[l.mark].create(l.attrs).addToSet(e),l.consuming===!1)s=l;else break}return[e,r]}addElementByRule(t,e,r){let i,s,l;e.node?(s=this.parser.schema.nodes[e.node],s.isLeaf?this.insertNode(s.create(e.attrs))||this.leafFallback(t):i=this.enter(s,e.attrs||null,e.preserveWhitespace)):(l=this.parser.schema.marks[e.mark].create(e.attrs),this.addPendingMark(l));let c=this.top;if(s&&s.isLeaf)this.findInside(t);else if(r)this.addElement(t,r);else if(e.getContent)this.findInside(t),e.getContent(t,this.parser.schema).forEach(h=>this.insertNode(h));else{let h=t;typeof e.contentElement=="string"?h=t.querySelector(e.contentElement):typeof e.contentElement=="function"?h=e.contentElement(t):e.contentElement&&(h=e.contentElement),this.findAround(t,h,!0),this.addAll(h)}i&&this.sync(c)&&this.open--,l&&this.removePendingMark(l,c)}addAll(t,e,r){let i=e||0;for(let s=e?t.childNodes[e]:t.firstChild,l=r==null?null:t.childNodes[r];s!=l;s=s.nextSibling,++i)this.findAtPoint(t,i),this.addDOM(s);this.findAtPoint(t,i)}findPlace(t){let e,r;for(let i=this.open;i>=0;i--){let s=this.nodes[i],l=s.findWrapping(t);if(l&&(!e||e.length>l.length)&&(e=l,r=s,!l.length)||s.solid)break}if(!e)return!1;this.sync(r);for(let i=0;i<e.length;i++)this.enterInner(e[i],null,!1);return!0}insertNode(t){if(t.isInline&&this.needsBlock&&!this.top.type){let e=this.textblockFromContext();e&&this.enterInner(e)}if(this.findPlace(t)){this.closeExtra();let e=this.top;e.applyPending(t.type),e.match&&(e.match=e.match.matchType(t.type));let r=e.activeMarks;for(let i=0;i<t.marks.length;i++)(!e.type||e.type.allowsMarkType(t.marks[i].type))&&(r=t.marks[i].addToSet(r));return e.content.push(t.mark(r)),!0}return!1}enter(t,e,r){let i=this.findPlace(t.create(e));return i&&this.enterInner(t,e,!0,r),i}enterInner(t,e=null,r=!1,i){this.closeExtra();let s=this.top;s.applyPending(t),s.match=s.match&&s.match.matchType(t);let l=lh(t,i,s.options);s.options&fo&&s.content.length==0&&(l|=fo),this.nodes.push(new pi(t,e,s.activeMarks,s.pendingMarks,r,null,l)),this.open++}closeExtra(t=!1){let e=this.nodes.length-1;if(e>this.open){for(;e>this.open;e--)this.nodes[e-1].content.push(this.nodes[e].finish(t));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)}sync(t){for(let e=this.open;e>=0;e--)if(this.nodes[e]==t)return this.open=e,!0;return!1}get currentPos(){this.closeExtra();let t=0;for(let e=this.open;e>=0;e--){let r=this.nodes[e].content;for(let i=r.length-1;i>=0;i--)t+=r[i].nodeSize;e&&t++}return t}findAtPoint(t,e){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==t&&this.find[r].offset==e&&(this.find[r].pos=this.currentPos)}findInside(t){if(this.find)for(let e=0;e<this.find.length;e++)this.find[e].pos==null&&t.nodeType==1&&t.contains(this.find[e].node)&&(this.find[e].pos=this.currentPos)}findAround(t,e,r){if(t!=e&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&t.nodeType==1&&t.contains(this.find[i].node)&&e.compareDocumentPosition(this.find[i].node)&(r?2:4)&&(this.find[i].pos=this.currentPos)}findInText(t){if(this.find)for(let e=0;e<this.find.length;e++)this.find[e].node==t&&(this.find[e].pos=this.currentPos-(t.nodeValue.length-this.find[e].offset))}matchesContext(t){if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);let e=t.split("/"),r=this.options.context,i=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),s=-(r?r.depth+1:0)+(i?0:1),l=(c,h)=>{for(;c>=0;c--){let d=e[c];if(d==""){if(c==e.length-1||c==0)continue;for(;h>=s;h--)if(l(c-1,h))return!0;return!1}else{let m=h>0||h==0&&i?this.nodes[h].type:r&&h>=s?r.node(h-s).type:null;if(!m||m.name!=d&&m.groups.indexOf(d)==-1)return!1;h--}}return!0};return l(e.length-1,this.open)}textblockFromContext(){let t=this.options.context;if(t)for(let e=t.depth;e>=0;e--){let r=t.node(e).contentMatchAt(t.indexAfter(e)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let e in this.parser.schema.nodes){let r=this.parser.schema.nodes[e];if(r.isTextblock&&r.defaultAttrs)return r}}addPendingMark(t){let e=w_(t,this.top.pendingMarks);e&&this.top.stashMarks.push(e),this.top.pendingMarks=t.addToSet(this.top.pendingMarks)}removePendingMark(t,e){for(let r=this.open;r>=0;r--){let i=this.nodes[r];if(i.pendingMarks.lastIndexOf(t)>-1)i.pendingMarks=t.removeFromSet(i.pendingMarks);else{i.activeMarks=t.removeFromSet(i.activeMarks);let s=i.popFromStashMark(t);s&&i.type&&i.type.allowsMarkType(s.type)&&(i.activeMarks=s.addToSet(i.activeMarks))}if(i==e)break}}}function g_(n){for(let t=n.firstChild,e=null;t;t=t.nextSibling){let r=t.nodeType==1?t.nodeName.toLowerCase():null;r&&ah.hasOwnProperty(r)&&e?(e.appendChild(t),t=e):r=="li"?e=t:r&&(e=null)}}function __(n,t){return(n.matches||n.msMatchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector).call(n,t)}function y_(n){let t=/\s*([\w-]+)\s*:\s*([^;]+)/g,e,r=[];for(;e=t.exec(n);)r.push(e[1],e[2].trim());return r}function uh(n){let t={};for(let e in n)t[e]=n[e];return t}function b_(n,t){let e=t.schema.nodes;for(let r in e){let i=e[r];if(!i.allowsMarkType(n))continue;let s=[],l=c=>{s.push(c);for(let h=0;h<c.edgeCount;h++){let{type:d,next:m}=c.edge(h);if(d==t||s.indexOf(m)<0&&l(m))return!0}};if(l(i.contentMatch))return!0}}function w_(n,t){for(let e=0;e<t.length;e++)if(n.eq(t[e]))return t[e]}class dn{constructor(t,e){this.nodes=t,this.marks=e}serializeFragment(t,e={},r){r||(r=zs(e).createDocumentFragment());let i=r,s=[];return t.forEach(l=>{if(s.length||l.marks.length){let c=0,h=0;for(;c<s.length&&h<l.marks.length;){let d=l.marks[h];if(!this.marks[d.type.name]){h++;continue}if(!d.eq(s[c][0])||d.type.spec.spanning===!1)break;c++,h++}for(;c<s.length;)i=s.pop()[1];for(;h<l.marks.length;){let d=l.marks[h++],m=this.serializeMark(d,l.isInline,e);m&&(s.push([d,i]),i.appendChild(m.dom),i=m.contentDOM||m.dom)}}i.appendChild(this.serializeNodeInner(l,e))}),r}serializeNodeInner(t,e){let{dom:r,contentDOM:i}=dn.renderSpec(zs(e),this.nodes[t.type.name](t));if(i){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(t.content,e,i)}return r}serializeNode(t,e={}){let r=this.serializeNodeInner(t,e);for(let i=t.marks.length-1;i>=0;i--){let s=this.serializeMark(t.marks[i],t.isInline,e);s&&((s.contentDOM||s.dom).appendChild(r),r=s.dom)}return r}serializeMark(t,e,r={}){let i=this.marks[t.type.name];return i&&dn.renderSpec(zs(r),i(t,e))}static renderSpec(t,e,r=null){if(typeof e=="string")return{dom:t.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let i=e[0],s=i.indexOf(" ");s>0&&(r=i.slice(0,s),i=i.slice(s+1));let l,c=r?t.createElementNS(r,i):t.createElement(i),h=e[1],d=1;if(h&&typeof h=="object"&&h.nodeType==null&&!Array.isArray(h)){d=2;for(let m in h)if(h[m]!=null){let y=m.indexOf(" ");y>0?c.setAttributeNS(m.slice(0,y),m.slice(y+1),h[m]):c.setAttribute(m,h[m])}}for(let m=d;m<e.length;m++){let y=e[m];if(y===0){if(m<e.length-1||m>d)throw new RangeError("Content hole must be the only child of its parent node");return{dom:c,contentDOM:c}}else{let{dom:v,contentDOM:b}=dn.renderSpec(t,y,r);if(c.appendChild(v),b){if(l)throw new RangeError("Multiple content holes");l=b}}}return{dom:c,contentDOM:l}}static fromSchema(t){return t.cached.domSerializer||(t.cached.domSerializer=new dn(this.nodesFromSchema(t),this.marksFromSchema(t)))}static nodesFromSchema(t){let e=hh(t.nodes);return e.text||(e.text=r=>r.text),e}static marksFromSchema(t){return hh(t.marks)}}function hh(n){let t={};for(let e in n){let r=n[e].spec.toDOM;r&&(t[e]=r)}return t}function zs(n){return n.document||window.document}const fh=65535,dh=Math.pow(2,16);function v_(n,t){return n+t*dh}function ph(n){return n&fh}function k_(n){return(n-(n&fh))/dh}const mh=1,gh=2,mi=4,_h=8;class js{constructor(t,e,r){this.pos=t,this.delInfo=e,this.recover=r}get deleted(){return(this.delInfo&_h)>0}get deletedBefore(){return(this.delInfo&(mh|mi))>0}get deletedAfter(){return(this.delInfo&(gh|mi))>0}get deletedAcross(){return(this.delInfo&mi)>0}}class _e{constructor(t,e=!1){if(this.ranges=t,this.inverted=e,!t.length&&_e.empty)return _e.empty}recover(t){let e=0,r=ph(t);if(!this.inverted)for(let i=0;i<r;i++)e+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+e+k_(t)}mapResult(t,e=1){return this._map(t,e,!1)}map(t,e=1){return this._map(t,e,!0)}_map(t,e,r){let i=0,s=this.inverted?2:1,l=this.inverted?1:2;for(let c=0;c<this.ranges.length;c+=3){let h=this.ranges[c]-(this.inverted?i:0);if(h>t)break;let d=this.ranges[c+s],m=this.ranges[c+l],y=h+d;if(t<=y){let v=d?t==h?-1:t==y?1:e:e,b=h+i+(v<0?0:m);if(r)return b;let C=t==(e<0?h:y)?null:v_(c/3,t-h),T=t==h?gh:t==y?mh:mi;return(e<0?t!=h:t!=y)&&(T|=_h),new js(b,T,C)}i+=m-d}return r?t+i:new js(t+i,0,null)}touches(t,e){let r=0,i=ph(e),s=this.inverted?2:1,l=this.inverted?1:2;for(let c=0;c<this.ranges.length;c+=3){let h=this.ranges[c]-(this.inverted?r:0);if(h>t)break;let d=this.ranges[c+s],m=h+d;if(t<=m&&c==i*3)return!0;r+=this.ranges[c+l]-d}return!1}forEach(t){let e=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,s=0;i<this.ranges.length;i+=3){let l=this.ranges[i],c=l-(this.inverted?s:0),h=l+(this.inverted?0:s),d=this.ranges[i+e],m=this.ranges[i+r];t(c,c+d,h,h+m),s+=m-d}}invert(){return new _e(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(t){return t==0?_e.empty:new _e(t<0?[0,-t,0]:[0,0,t])}}_e.empty=new _e([]);class po{constructor(t=[],e,r=0,i=t.length){this.maps=t,this.mirror=e,this.from=r,this.to=i}slice(t=0,e=this.maps.length){return new po(this.maps,this.mirror,t,e)}copy(){return new po(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(t,e){this.to=this.maps.push(t),e!=null&&this.setMirror(this.maps.length-1,e)}appendMapping(t){for(let e=0,r=this.maps.length;e<t.maps.length;e++){let i=t.getMirror(e);this.appendMap(t.maps[e],i!=null&&i<e?r+i:void 0)}}getMirror(t){if(this.mirror){for(let e=0;e<this.mirror.length;e++)if(this.mirror[e]==t)return this.mirror[e+(e%2?-1:1)]}}setMirror(t,e){this.mirror||(this.mirror=[]),this.mirror.push(t,e)}appendMappingInverted(t){for(let e=t.maps.length-1,r=this.maps.length+t.maps.length;e>=0;e--){let i=t.getMirror(e);this.appendMap(t.maps[e].invert(),i!=null&&i>e?r-i-1:void 0)}}invert(){let t=new po;return t.appendMappingInverted(this),t}map(t,e=1){if(this.mirror)return this._map(t,e,!0);for(let r=this.from;r<this.to;r++)t=this.maps[r].map(t,e);return t}mapResult(t,e=1){return this._map(t,e,!1)}_map(t,e,r){let i=0;for(let s=this.from;s<this.to;s++){let l=this.maps[s],c=l.mapResult(t,e);if(c.recover!=null){let h=this.getMirror(s);if(h!=null&&h>s&&h<this.to){s=h,t=this.maps[h].recover(c.recover);continue}}i|=c.delInfo,t=c.pos}return r?t:new js(t,i,null)}}const Ps=Object.create(null);class Zt{getMap(){return _e.empty}merge(t){return null}static fromJSON(t,e){if(!e||!e.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=Ps[e.stepType];if(!r)throw new RangeError(`No step type ${e.stepType} defined`);return r.fromJSON(t,e)}static jsonID(t,e){if(t in Ps)throw new RangeError("Duplicate use of step JSON ID "+t);return Ps[t]=e,e.prototype.jsonID=t,e}}class Ot{constructor(t,e){this.doc=t,this.failed=e}static ok(t){return new Ot(t,null)}static fail(t){return new Ot(null,t)}static fromReplace(t,e,r,i){try{return Ot.ok(t.replace(e,r,i))}catch(s){if(s instanceof ai)return Ot.fail(s.message);throw s}}}function Bs(n,t,e){let r=[];for(let i=0;i<n.childCount;i++){let s=n.child(i);s.content.size&&(s=s.copy(Bs(s.content,t,s))),s.isInline&&(s=t(s,e,i)),r.push(s)}return B.fromArray(r)}class pn extends Zt{constructor(t,e,r){super(),this.from=t,this.to=e,this.mark=r}apply(t){let e=t.slice(this.from,this.to),r=t.resolve(this.from),i=r.node(r.sharedDepth(this.to)),s=new W(Bs(e.content,(l,c)=>!l.isAtom||!c.type.allowsMarkType(this.mark.type)?l:l.mark(this.mark.addToSet(l.marks)),i),e.openStart,e.openEnd);return Ot.fromReplace(t,this.from,this.to,s)}invert(){return new Te(this.from,this.to,this.mark)}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return e.deleted&&r.deleted||e.pos>=r.pos?null:new pn(e.pos,r.pos,this.mark)}merge(t){return t instanceof pn&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new pn(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,e){if(typeof e.from!="number"||typeof e.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new pn(e.from,e.to,t.markFromJSON(e.mark))}}Zt.jsonID("addMark",pn);class Te extends Zt{constructor(t,e,r){super(),this.from=t,this.to=e,this.mark=r}apply(t){let e=t.slice(this.from,this.to),r=new W(Bs(e.content,i=>i.mark(this.mark.removeFromSet(i.marks)),t),e.openStart,e.openEnd);return Ot.fromReplace(t,this.from,this.to,r)}invert(){return new pn(this.from,this.to,this.mark)}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return e.deleted&&r.deleted||e.pos>=r.pos?null:new Te(e.pos,r.pos,this.mark)}merge(t){return t instanceof Te&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new Te(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,e){if(typeof e.from!="number"||typeof e.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Te(e.from,e.to,t.markFromJSON(e.mark))}}Zt.jsonID("removeMark",Te);class Tn extends Zt{constructor(t,e){super(),this.pos=t,this.mark=e}apply(t){let e=t.nodeAt(this.pos);if(!e)return Ot.fail("No node at mark step's position");let r=e.type.create(e.attrs,null,this.mark.addToSet(e.marks));return Ot.fromReplace(t,this.pos,this.pos+1,new W(B.from(r),0,e.isLeaf?0:1))}invert(t){let e=t.nodeAt(this.pos);if(e){let r=this.mark.addToSet(e.marks);if(r.length==e.marks.length){for(let i=0;i<e.marks.length;i++)if(!e.marks[i].isInSet(r))return new Tn(this.pos,e.marks[i]);return new Tn(this.pos,this.mark)}}return new Cr(this.pos,this.mark)}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new Tn(e.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,e){if(typeof e.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Tn(e.pos,t.markFromJSON(e.mark))}}Zt.jsonID("addNodeMark",Tn);class Cr extends Zt{constructor(t,e){super(),this.pos=t,this.mark=e}apply(t){let e=t.nodeAt(this.pos);if(!e)return Ot.fail("No node at mark step's position");let r=e.type.create(e.attrs,null,this.mark.removeFromSet(e.marks));return Ot.fromReplace(t,this.pos,this.pos+1,new W(B.from(r),0,e.isLeaf?0:1))}invert(t){let e=t.nodeAt(this.pos);return!e||!this.mark.isInSet(e.marks)?this:new Tn(this.pos,this.mark)}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new Cr(e.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,e){if(typeof e.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Cr(e.pos,t.markFromJSON(e.mark))}}Zt.jsonID("removeNodeMark",Cr);class Bt extends Zt{constructor(t,e,r,i=!1){super(),this.from=t,this.to=e,this.slice=r,this.structure=i}apply(t){return this.structure&&$s(t,this.from,this.to)?Ot.fail("Structure replace would overwrite content"):Ot.fromReplace(t,this.from,this.to,this.slice)}getMap(){return new _e([this.from,this.to-this.from,this.slice.size])}invert(t){return new Bt(this.from,this.from+this.slice.size,t.slice(this.from,this.to))}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return e.deletedAcross&&r.deletedAcross?null:new Bt(e.pos,Math.max(e.pos,r.pos),this.slice)}merge(t){if(!(t instanceof Bt)||t.structure||this.structure)return null;if(this.from+this.slice.size==t.from&&!this.slice.openEnd&&!t.slice.openStart){let e=this.slice.size+t.slice.size==0?W.empty:new W(this.slice.content.append(t.slice.content),this.slice.openStart,t.slice.openEnd);return new Bt(this.from,this.to+(t.to-t.from),e,this.structure)}else if(t.to==this.from&&!this.slice.openStart&&!t.slice.openEnd){let e=this.slice.size+t.slice.size==0?W.empty:new W(t.slice.content.append(this.slice.content),t.slice.openStart,this.slice.openEnd);return new Bt(t.from,this.to,e,this.structure)}else return null}toJSON(){let t={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,e){if(typeof e.from!="number"||typeof e.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Bt(e.from,e.to,W.fromJSON(t,e.slice),!!e.structure)}}Zt.jsonID("replace",Bt);class ie extends Zt{constructor(t,e,r,i,s,l,c=!1){super(),this.from=t,this.to=e,this.gapFrom=r,this.gapTo=i,this.slice=s,this.insert=l,this.structure=c}apply(t){if(this.structure&&($s(t,this.from,this.gapFrom)||$s(t,this.gapTo,this.to)))return Ot.fail("Structure gap-replace would overwrite content");let e=t.slice(this.gapFrom,this.gapTo);if(e.openStart||e.openEnd)return Ot.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,e.content);return r?Ot.fromReplace(t,this.from,this.to,r):Ot.fail("Content does not fit in gap")}getMap(){return new _e([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(t){let e=this.gapTo-this.gapFrom;return new ie(this.from,this.from+this.slice.size+e,this.from+this.insert,this.from+this.insert+e,t.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1),i=t.map(this.gapFrom,-1),s=t.map(this.gapTo,1);return e.deletedAcross&&r.deletedAcross||i<e.pos||s>r.pos?null:new ie(e.pos,r.pos,i,s,this.slice,this.insert,this.structure)}toJSON(){let t={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,e){if(typeof e.from!="number"||typeof e.to!="number"||typeof e.gapFrom!="number"||typeof e.gapTo!="number"||typeof e.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new ie(e.from,e.to,e.gapFrom,e.gapTo,W.fromJSON(t,e.slice),e.insert,!!e.structure)}}Zt.jsonID("replaceAround",ie);function $s(n,t,e){let r=n.resolve(t),i=e-t,s=r.depth;for(;i>0&&s>0&&r.indexAfter(s)==r.node(s).childCount;)s--,i--;if(i>0){let l=r.node(s).maybeChild(r.indexAfter(s));for(;i>0;){if(!l||l.isLeaf)return!0;l=l.firstChild,i--}}return!1}function x_(n,t,e,r){let i=[],s=[],l,c;n.doc.nodesBetween(t,e,(h,d,m)=>{if(!h.isInline)return;let y=h.marks;if(!r.isInSet(y)&&m.type.allowsMarkType(r.type)){let v=Math.max(d,t),b=Math.min(d+h.nodeSize,e),C=r.addToSet(y);for(let T=0;T<y.length;T++)y[T].isInSet(C)||(l&&l.to==v&&l.mark.eq(y[T])?l.to=b:i.push(l=new Te(v,b,y[T])));c&&c.to==v?c.to=b:s.push(c=new pn(v,b,r))}}),i.forEach(h=>n.step(h)),s.forEach(h=>n.step(h))}function S_(n,t,e,r){let i=[],s=0;n.doc.nodesBetween(t,e,(l,c)=>{if(!l.isInline)return;s++;let h=null;if(r instanceof hi){let d=l.marks,m;for(;m=r.isInSet(d);)(h||(h=[])).push(m),d=m.removeFromSet(d)}else r?r.isInSet(l.marks)&&(h=[r]):h=l.marks;if(h&&h.length){let d=Math.min(c+l.nodeSize,e);for(let m=0;m<h.length;m++){let y=h[m],v;for(let b=0;b<i.length;b++){let C=i[b];C.step==s-1&&y.eq(i[b].style)&&(v=C)}v?(v.to=d,v.step=s):i.push({style:y,from:Math.max(c,t),to:d,step:s})}}}),i.forEach(l=>n.step(new Te(l.from,l.to,l.style)))}function C_(n,t,e,r=e.contentMatch){let i=n.doc.nodeAt(t),s=[],l=t+1;for(let c=0;c<i.childCount;c++){let h=i.child(c),d=l+h.nodeSize,m=r.matchType(h.type);if(!m)s.push(new Bt(l,d,W.empty));else{r=m;for(let y=0;y<h.marks.length;y++)e.allowsMarkType(h.marks[y].type)||n.step(new Te(l,d,h.marks[y]))}l=d}if(!r.validEnd){let c=r.fillBefore(B.empty,!0);n.replace(l,l,new W(c,0,0))}for(let c=s.length-1;c>=0;c--)n.step(s[c])}function O_(n,t,e){return(t==0||n.canReplace(t,n.childCount))&&(e==n.childCount||n.canReplace(0,e))}function Fs(n){let t=n.parent.content.cutByIndex(n.startIndex,n.endIndex);for(let e=n.depth;;--e){let r=n.$from.node(e),i=n.$from.index(e),s=n.$to.indexAfter(e);if(e<n.depth&&r.canReplace(i,s,t))return e;if(e==0||r.type.spec.isolating||!O_(r,i,s))break}return null}function M_(n,t,e){let{$from:r,$to:i,depth:s}=t,l=r.before(s+1),c=i.after(s+1),h=l,d=c,m=B.empty,y=0;for(let C=s,T=!1;C>e;C--)T||r.index(C)>0?(T=!0,m=B.from(r.node(C).copy(m)),y++):h--;let v=B.empty,b=0;for(let C=s,T=!1;C>e;C--)T||i.after(C+1)<i.end(C)?(T=!0,v=B.from(i.node(C).copy(v)),b++):d++;n.step(new ie(h,d,l,c,new W(m.append(v),y,b),m.size-y,!0))}function A_(n,t,e){let r=B.empty;for(let l=e.length-1;l>=0;l--){if(r.size){let c=e[l].type.contentMatch.matchFragment(r);if(!c||!c.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=B.from(e[l].type.create(e[l].attrs,r))}let i=t.start,s=t.end;n.step(new ie(i,s,i,s,new W(r,0,0),e.length,!0))}function E_(n,t,e,r,i){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let s=n.steps.length;n.doc.nodesBetween(t,e,(l,c)=>{if(l.isTextblock&&!l.hasMarkup(r,i)&&T_(n.doc,n.mapping.slice(s).map(c),r)){n.clearIncompatible(n.mapping.slice(s).map(c,1),r);let h=n.mapping.slice(s),d=h.map(c,1),m=h.map(c+l.nodeSize,1);return n.step(new ie(d,m,d+1,m-1,new W(B.from(r.create(i,null,l.marks)),0,0),1,!0)),!1}})}function T_(n,t,e){let r=n.resolve(t),i=r.index();return r.parent.canReplaceWith(i,i+1,e)}function N_(n,t,e,r,i){let s=n.doc.nodeAt(t);if(!s)throw new RangeError("No node at given position");e||(e=s.type);let l=e.create(r,null,i||s.marks);if(s.isLeaf)return n.replaceWith(t,t+s.nodeSize,l);if(!e.validContent(s.content))throw new RangeError("Invalid content for node type "+e.name);n.step(new ie(t,t+s.nodeSize,t+1,t+s.nodeSize-1,new W(B.from(l),0,0),1,!0))}function gi(n,t,e=1,r){let i=n.resolve(t),s=i.depth-e,l=r&&r[r.length-1]||i.parent;if(s<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!l.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let d=i.depth-1,m=e-2;d>s;d--,m--){let y=i.node(d),v=i.index(d);if(y.type.spec.isolating)return!1;let b=y.content.cutByIndex(v,y.childCount),C=r&&r[m]||y;if(C!=y&&(b=b.replaceChild(0,C.type.create(C.attrs))),!y.canReplace(v+1,y.childCount)||!C.type.validContent(b))return!1}let c=i.indexAfter(s),h=r&&r[0];return i.node(s).canReplaceWith(c,c,h?h.type:i.node(s+1).type)}function D_(n,t,e=1,r){let i=n.doc.resolve(t),s=B.empty,l=B.empty;for(let c=i.depth,h=i.depth-e,d=e-1;c>h;c--,d--){s=B.from(i.node(c).copy(s));let m=r&&r[d];l=B.from(m?m.type.create(m.attrs,l):i.node(c).copy(l))}n.step(new Bt(t,t,new W(s.append(l),e,e),!0))}function yh(n,t){let e=n.resolve(t),r=e.index();return R_(e.nodeBefore,e.nodeAfter)&&e.parent.canReplace(r,r+1)}function R_(n,t){return!!(n&&t&&!n.isLeaf&&n.canAppend(t))}function I_(n,t,e){let r=new Bt(t-e,t+e,W.empty,!0);n.step(r)}function z_(n,t,e){let r=n.resolve(t);if(r.parent.canReplaceWith(r.index(),r.index(),e))return t;if(r.parentOffset==0)for(let i=r.depth-1;i>=0;i--){let s=r.index(i);if(r.node(i).canReplaceWith(s,s,e))return r.before(i+1);if(s>0)return null}if(r.parentOffset==r.parent.content.size)for(let i=r.depth-1;i>=0;i--){let s=r.indexAfter(i);if(r.node(i).canReplaceWith(s,s,e))return r.after(i+1);if(s<r.node(i).childCount)return null}return null}function j_(n,t,e){let r=n.resolve(t);if(!e.content.size)return t;let i=e.content;for(let s=0;s<e.openStart;s++)i=i.firstChild.content;for(let s=1;s<=(e.openStart==0&&e.size?2:1);s++)for(let l=r.depth;l>=0;l--){let c=l==r.depth?0:r.pos<=(r.start(l+1)+r.end(l+1))/2?-1:1,h=r.index(l)+(c>0?1:0),d=r.node(l),m=!1;if(s==1)m=d.canReplace(h,h,i);else{let y=d.contentMatchAt(h).findWrapping(i.firstChild.type);m=y&&d.canReplaceWith(h,h,y[0])}if(m)return c==0?r.pos:c<0?r.before(l+1):r.after(l+1)}return null}function Vs(n,t,e=t,r=W.empty){if(t==e&&!r.size)return null;let i=n.resolve(t),s=n.resolve(e);return bh(i,s,r)?new Bt(t,e,r):new P_(i,s,r).fit()}function bh(n,t,e){return!e.openStart&&!e.openEnd&&n.start()==t.start()&&n.parent.canReplace(n.index(),t.index(),e.content)}class P_{constructor(t,e,r){this.$from=t,this.$to=e,this.unplaced=r,this.frontier=[],this.placed=B.empty;for(let i=0;i<=t.depth;i++){let s=t.node(i);this.frontier.push({type:s.type,match:s.contentMatchAt(t.indexAfter(i))})}for(let i=t.depth;i>0;i--)this.placed=B.from(t.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let d=this.findFittable();d?this.placeNodes(d):this.openMore()||this.dropNode()}let t=this.mustMoveInline(),e=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(t<0?this.$to:r.doc.resolve(t));if(!i)return null;let s=this.placed,l=r.depth,c=i.depth;for(;l&&c&&s.childCount==1;)s=s.firstChild.content,l--,c--;let h=new W(s,l,c);return t>-1?new ie(r.pos,t,this.$to.pos,this.$to.end(),h,e):h.size||r.pos!=this.$to.pos?new Bt(r.pos,i.pos,h):null}findFittable(){let t=this.unplaced.openStart;for(let e=this.unplaced.content,r=0,i=this.unplaced.openEnd;r<t;r++){let s=e.firstChild;if(e.childCount>1&&(i=0),s.type.spec.isolating&&i<=r){t=r;break}e=s.content}for(let e=1;e<=2;e++)for(let r=e==1?t:this.unplaced.openStart;r>=0;r--){let i,s=null;r?(s=Ls(this.unplaced.content,r-1).firstChild,i=s.content):i=this.unplaced.content;let l=i.firstChild;for(let c=this.depth;c>=0;c--){let{type:h,match:d}=this.frontier[c],m,y=null;if(e==1&&(l?d.matchType(l.type)||(y=d.fillBefore(B.from(l),!1)):s&&h.compatibleContent(s.type)))return{sliceDepth:r,frontierDepth:c,parent:s,inject:y};if(e==2&&l&&(m=d.findWrapping(l.type)))return{sliceDepth:r,frontierDepth:c,parent:s,wrap:m};if(s&&d.matchType(s.type))break}}}openMore(){let{content:t,openStart:e,openEnd:r}=this.unplaced,i=Ls(t,e);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new W(t,e+1,Math.max(r,i.size+e>=t.size-r?e+1:0)),!0)}dropNode(){let{content:t,openStart:e,openEnd:r}=this.unplaced,i=Ls(t,e);if(i.childCount<=1&&e>0){let s=t.size-e<=e+i.size;this.unplaced=new W(mo(t,e-1,1),e-1,s?e-1:r)}else this.unplaced=new W(mo(t,e,1),e,r)}placeNodes({sliceDepth:t,frontierDepth:e,parent:r,inject:i,wrap:s}){for(;this.depth>e;)this.closeFrontierNode();if(s)for(let T=0;T<s.length;T++)this.openFrontierNode(s[T]);let l=this.unplaced,c=r?r.content:l.content,h=l.openStart-t,d=0,m=[],{match:y,type:v}=this.frontier[e];if(i){for(let T=0;T<i.childCount;T++)m.push(i.child(T));y=y.matchFragment(i)}let b=c.size+t-(l.content.size-l.openEnd);for(;d<c.childCount;){let T=c.child(d),P=y.matchType(T.type);if(!P)break;d++,(d>1||h==0||T.content.size)&&(y=P,m.push(wh(T.mark(v.allowedMarks(T.marks)),d==1?h:0,d==c.childCount?b:-1)))}let C=d==c.childCount;C||(b=-1),this.placed=go(this.placed,e,B.from(m)),this.frontier[e].match=y,C&&b<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let T=0,P=c;T<b;T++){let J=P.lastChild;this.frontier.push({type:J.type,match:J.contentMatchAt(J.childCount)}),P=J.content}this.unplaced=C?t==0?W.empty:new W(mo(l.content,t-1,1),t-1,b<0?l.openEnd:t-1):new W(mo(l.content,t,d),l.openStart,l.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let t=this.frontier[this.depth],e;if(!t.type.isTextblock||!Ws(this.$to,this.$to.depth,t.type,t.match,!1)||this.$to.depth==this.depth&&(e=this.findCloseLevel(this.$to))&&e.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(t){t:for(let e=Math.min(this.depth,t.depth);e>=0;e--){let{match:r,type:i}=this.frontier[e],s=e<t.depth&&t.end(e+1)==t.pos+(t.depth-(e+1)),l=Ws(t,e,i,r,s);if(l){for(let c=e-1;c>=0;c--){let{match:h,type:d}=this.frontier[c],m=Ws(t,c,d,h,!0);if(!m||m.childCount)continue t}return{depth:e,fit:l,move:s?t.doc.resolve(t.after(e+1)):t}}}}close(t){let e=this.findCloseLevel(t);if(!e)return null;for(;this.depth>e.depth;)this.closeFrontierNode();e.fit.childCount&&(this.placed=go(this.placed,e.depth,e.fit)),t=e.move;for(let r=e.depth+1;r<=t.depth;r++){let i=t.node(r),s=i.type.contentMatch.fillBefore(i.content,!0,t.index(r));this.openFrontierNode(i.type,i.attrs,s)}return t}openFrontierNode(t,e=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(t),this.placed=go(this.placed,this.depth,B.from(t.create(e,r))),this.frontier.push({type:t,match:t.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(B.empty,!0);t.childCount&&(this.placed=go(this.placed,this.frontier.length,t))}}function mo(n,t,e){return t==0?n.cutByIndex(e,n.childCount):n.replaceChild(0,n.firstChild.copy(mo(n.firstChild.content,t-1,e)))}function go(n,t,e){return t==0?n.append(e):n.replaceChild(n.childCount-1,n.lastChild.copy(go(n.lastChild.content,t-1,e)))}function Ls(n,t){for(let e=0;e<t;e++)n=n.firstChild.content;return n}function wh(n,t,e){if(t<=0)return n;let r=n.content;return t>1&&(r=r.replaceChild(0,wh(r.firstChild,t-1,r.childCount==1?e-1:0))),t>0&&(r=n.type.contentMatch.fillBefore(r).append(r),e<=0&&(r=r.append(n.type.contentMatch.matchFragment(r).fillBefore(B.empty,!0)))),n.copy(r)}function Ws(n,t,e,r,i){let s=n.node(t),l=i?n.indexAfter(t):n.index(t);if(l==s.childCount&&!e.compatibleContent(s.type))return null;let c=r.fillBefore(s.content,!0,l);return c&&!B_(e,s.content,l)?c:null}function B_(n,t,e){for(let r=e;r<t.childCount;r++)if(!n.allowsMarks(t.child(r).marks))return!0;return!1}function $_(n){return n.spec.defining||n.spec.definingForContent}function F_(n,t,e,r){if(!r.size)return n.deleteRange(t,e);let i=n.doc.resolve(t),s=n.doc.resolve(e);if(bh(i,s,r))return n.step(new Bt(t,e,r));let l=kh(i,n.doc.resolve(e));l[l.length-1]==0&&l.pop();let c=-(i.depth+1);l.unshift(c);for(let v=i.depth,b=i.pos-1;v>0;v--,b--){let C=i.node(v).type.spec;if(C.defining||C.definingAsContext||C.isolating)break;l.indexOf(v)>-1?c=v:i.before(v)==b&&l.splice(1,0,-v)}let h=l.indexOf(c),d=[],m=r.openStart;for(let v=r.content,b=0;;b++){let C=v.firstChild;if(d.push(C),b==r.openStart)break;v=C.content}for(let v=m-1;v>=0;v--){let b=d[v].type,C=$_(b);if(C&&i.node(h).type!=b)m=v;else if(C||!b.isTextblock)break}for(let v=r.openStart;v>=0;v--){let b=(v+m+1)%(r.openStart+1),C=d[b];if(C)for(let T=0;T<l.length;T++){let P=l[(T+h)%l.length],J=!0;P<0&&(J=!1,P=-P);let mt=i.node(P-1),st=i.index(P-1);if(mt.canReplaceWith(st,st,C.type,C.marks))return n.replace(i.before(P),J?s.after(P):e,new W(vh(r.content,0,r.openStart,b),b,r.openEnd))}}let y=n.steps.length;for(let v=l.length-1;v>=0&&(n.replace(t,e,r),!(n.steps.length>y));v--){let b=l[v];b<0||(t=i.before(b),e=s.after(b))}}function vh(n,t,e,r,i){if(t<e){let s=n.firstChild;n=n.replaceChild(0,s.copy(vh(s.content,t+1,e,r,s)))}if(t>r){let s=i.contentMatchAt(0),l=s.fillBefore(n).append(n);n=l.append(s.matchFragment(l).fillBefore(B.empty,!0))}return n}function V_(n,t,e,r){if(!r.isInline&&t==e&&n.doc.resolve(t).parent.content.size){let i=z_(n.doc,t,r.type);i!=null&&(t=e=i)}n.replaceRange(t,e,new W(B.from(r),0,0))}function L_(n,t,e){let r=n.doc.resolve(t),i=n.doc.resolve(e),s=kh(r,i);for(let l=0;l<s.length;l++){let c=s[l],h=l==s.length-1;if(h&&c==0||r.node(c).type.contentMatch.validEnd)return n.delete(r.start(c),i.end(c));if(c>0&&(h||r.node(c-1).canReplace(r.index(c-1),i.indexAfter(c-1))))return n.delete(r.before(c),i.after(c))}for(let l=1;l<=r.depth&&l<=i.depth;l++)if(t-r.start(l)==r.depth-l&&e>r.end(l)&&i.end(l)-e!=i.depth-l)return n.delete(r.before(l),e);n.delete(t,e)}function kh(n,t){let e=[],r=Math.min(n.depth,t.depth);for(let i=r;i>=0;i--){let s=n.start(i);if(s<n.pos-(n.depth-i)||t.end(i)>t.pos+(t.depth-i)||n.node(i).type.spec.isolating||t.node(i).type.spec.isolating)break;(s==t.start(i)||i==n.depth&&i==t.depth&&n.parent.inlineContent&&t.parent.inlineContent&&i&&t.start(i-1)==s-1)&&e.push(i)}return e}class Or extends Zt{constructor(t,e,r){super(),this.pos=t,this.attr=e,this.value=r}apply(t){let e=t.nodeAt(this.pos);if(!e)return Ot.fail("No node at attribute step's position");let r=Object.create(null);for(let s in e.attrs)r[s]=e.attrs[s];r[this.attr]=this.value;let i=e.type.create(r,null,e.marks);return Ot.fromReplace(t,this.pos,this.pos+1,new W(B.from(i),0,e.isLeaf?0:1))}getMap(){return _e.empty}invert(t){return new Or(this.pos,this.attr,t.nodeAt(this.pos).attrs[this.attr])}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new Or(e.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(t,e){if(typeof e.pos!="number"||typeof e.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Or(e.pos,e.attr,e.value)}}Zt.jsonID("attr",Or);let Mr=class extends Error{};Mr=function n(t){let e=Error.call(this,t);return e.__proto__=n.prototype,e},Mr.prototype=Object.create(Error.prototype),Mr.prototype.constructor=Mr,Mr.prototype.name="TransformError";class W_{constructor(t){this.doc=t,this.steps=[],this.docs=[],this.mapping=new po}get before(){return this.docs.length?this.docs[0]:this.doc}step(t){let e=this.maybeStep(t);if(e.failed)throw new Mr(e.failed);return this}maybeStep(t){let e=t.apply(this.doc);return e.failed||this.addStep(t,e.doc),e}get docChanged(){return this.steps.length>0}addStep(t,e){this.docs.push(this.doc),this.steps.push(t),this.mapping.appendMap(t.getMap()),this.doc=e}replace(t,e=t,r=W.empty){let i=Vs(this.doc,t,e,r);return i&&this.step(i),this}replaceWith(t,e,r){return this.replace(t,e,new W(B.from(r),0,0))}delete(t,e){return this.replace(t,e,W.empty)}insert(t,e){return this.replaceWith(t,t,e)}replaceRange(t,e,r){return F_(this,t,e,r),this}replaceRangeWith(t,e,r){return V_(this,t,e,r),this}deleteRange(t,e){return L_(this,t,e),this}lift(t,e){return M_(this,t,e),this}join(t,e=1){return I_(this,t,e),this}wrap(t,e){return A_(this,t,e),this}setBlockType(t,e=t,r,i=null){return E_(this,t,e,r,i),this}setNodeMarkup(t,e,r=null,i){return N_(this,t,e,r,i),this}setNodeAttribute(t,e,r){return this.step(new Or(t,e,r)),this}addNodeMark(t,e){return this.step(new Tn(t,e)),this}removeNodeMark(t,e){if(!(e instanceof ct)){let r=this.doc.nodeAt(t);if(!r)throw new RangeError("No node at position "+t);if(e=e.isInSet(r.marks),!e)return this}return this.step(new Cr(t,e)),this}split(t,e=1,r){return D_(this,t,e,r),this}addMark(t,e,r){return x_(this,t,e,r),this}removeMark(t,e,r){return S_(this,t,e,r),this}clearIncompatible(t,e,r){return C_(this,t,e,r),this}}const qs=Object.create(null);class ht{constructor(t,e,r){this.$anchor=t,this.$head=e,this.ranges=r||[new q_(t.min(e),t.max(e))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let t=this.ranges;for(let e=0;e<t.length;e++)if(t[e].$from.pos!=t[e].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(t,e=W.empty){let r=e.content.lastChild,i=null;for(let c=0;c<e.openEnd;c++)i=r,r=r.lastChild;let s=t.steps.length,l=this.ranges;for(let c=0;c<l.length;c++){let{$from:h,$to:d}=l[c],m=t.mapping.slice(s);t.replaceRange(m.map(h.pos),m.map(d.pos),c?W.empty:e),c==0&&Ch(t,s,(r?r.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(t,e){let r=t.steps.length,i=this.ranges;for(let s=0;s<i.length;s++){let{$from:l,$to:c}=i[s],h=t.mapping.slice(r),d=h.map(l.pos),m=h.map(c.pos);s?t.deleteRange(d,m):(t.replaceRangeWith(d,m,e),Ch(t,r,e.isInline?-1:1))}}static findFrom(t,e,r=!1){let i=t.parent.inlineContent?new pt(t):Ar(t.node(0),t.parent,t.pos,t.index(),e,r);if(i)return i;for(let s=t.depth-1;s>=0;s--){let l=e<0?Ar(t.node(0),t.node(s),t.before(s+1),t.index(s),e,r):Ar(t.node(0),t.node(s),t.after(s+1),t.index(s)+1,e,r);if(l)return l}return null}static near(t,e=1){return this.findFrom(t,e)||this.findFrom(t,-e)||new se(t.node(0))}static atStart(t){return Ar(t,t,0,0,1)||new se(t)}static atEnd(t){return Ar(t,t,t.content.size,t.childCount,-1)||new se(t)}static fromJSON(t,e){if(!e||!e.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=qs[e.type];if(!r)throw new RangeError(`No selection type ${e.type} defined`);return r.fromJSON(t,e)}static jsonID(t,e){if(t in qs)throw new RangeError("Duplicate use of selection JSON ID "+t);return qs[t]=e,e.prototype.jsonID=t,e}getBookmark(){return pt.between(this.$anchor,this.$head).getBookmark()}}ht.prototype.visible=!0;class q_{constructor(t,e){this.$from=t,this.$to=e}}let xh=!1;function Sh(n){!xh&&!n.parent.inlineContent&&(xh=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+n.parent.type.name+")"))}class pt extends ht{constructor(t,e=t){Sh(t),Sh(e),super(t,e)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(t,e){let r=t.resolve(e.map(this.head));if(!r.parent.inlineContent)return ht.near(r);let i=t.resolve(e.map(this.anchor));return new pt(i.parent.inlineContent?i:r,r)}replace(t,e=W.empty){if(super.replace(t,e),e==W.empty){let r=this.$from.marksAcross(this.$to);r&&t.ensureMarks(r)}}eq(t){return t instanceof pt&&t.anchor==this.anchor&&t.head==this.head}getBookmark(){return new _i(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(t,e){if(typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new pt(t.resolve(e.anchor),t.resolve(e.head))}static create(t,e,r=e){let i=t.resolve(e);return new this(i,r==e?i:t.resolve(r))}static between(t,e,r){let i=t.pos-e.pos;if((!r||i)&&(r=i>=0?1:-1),!e.parent.inlineContent){let s=ht.findFrom(e,r,!0)||ht.findFrom(e,-r,!0);if(s)e=s.$head;else return ht.near(e,r)}return t.parent.inlineContent||(i==0?t=e:(t=(ht.findFrom(t,-r,!0)||ht.findFrom(t,r,!0)).$anchor,t.pos<e.pos!=i<0&&(t=e))),new pt(t,e)}}ht.jsonID("text",pt);class _i{constructor(t,e){this.anchor=t,this.head=e}map(t){return new _i(t.map(this.anchor),t.map(this.head))}resolve(t){return pt.between(t.resolve(this.anchor),t.resolve(this.head))}}class Q extends ht{constructor(t){let e=t.nodeAfter,r=t.node(0).resolve(t.pos+e.nodeSize);super(t,r),this.node=e}map(t,e){let{deleted:r,pos:i}=e.mapResult(this.anchor),s=t.resolve(i);return r?ht.near(s):new Q(s)}content(){return new W(B.from(this.node),0,0)}eq(t){return t instanceof Q&&t.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new Js(this.anchor)}static fromJSON(t,e){if(typeof e.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new Q(t.resolve(e.anchor))}static create(t,e){return new Q(t.resolve(e))}static isSelectable(t){return!t.isText&&t.type.spec.selectable!==!1}}Q.prototype.visible=!1,ht.jsonID("node",Q);class Js{constructor(t){this.anchor=t}map(t){let{deleted:e,pos:r}=t.mapResult(this.anchor);return e?new _i(r,r):new Js(r)}resolve(t){let e=t.resolve(this.anchor),r=e.nodeAfter;return r&&Q.isSelectable(r)?new Q(e):ht.near(e)}}class se extends ht{constructor(t){super(t.resolve(0),t.resolve(t.content.size))}replace(t,e=W.empty){if(e==W.empty){t.delete(0,t.doc.content.size);let r=ht.atStart(t.doc);r.eq(t.selection)||t.setSelection(r)}else super.replace(t,e)}toJSON(){return{type:"all"}}static fromJSON(t){return new se(t)}map(t){return new se(t)}eq(t){return t instanceof se}getBookmark(){return J_}}ht.jsonID("all",se);const J_={map(){return this},resolve(n){return new se(n)}};function Ar(n,t,e,r,i,s=!1){if(t.inlineContent)return pt.create(n,e);for(let l=r-(i>0?0:1);i>0?l<t.childCount:l>=0;l+=i){let c=t.child(l);if(c.isAtom){if(!s&&Q.isSelectable(c))return Q.create(n,e-(i<0?c.nodeSize:0))}else{let h=Ar(n,c,e+i,i<0?c.childCount:0,i,s);if(h)return h}e+=c.nodeSize*i}return null}function Ch(n,t,e){let r=n.steps.length-1;if(r<t)return;let i=n.steps[r];if(!(i instanceof Bt||i instanceof ie))return;let s=n.mapping.maps[r],l;s.forEach((c,h,d,m)=>{l==null&&(l=m)}),n.setSelection(ht.near(n.doc.resolve(l),e))}const Oh=1,yi=2,Mh=4;class U_ extends W_{constructor(t){super(t.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=t.selection,this.storedMarks=t.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(t){if(t.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=t,this.curSelectionFor=this.steps.length,this.updated=(this.updated|Oh)&~yi,this.storedMarks=null,this}get selectionSet(){return(this.updated&Oh)>0}setStoredMarks(t){return this.storedMarks=t,this.updated|=yi,this}ensureMarks(t){return ct.sameSet(this.storedMarks||this.selection.$from.marks(),t)||this.setStoredMarks(t),this}addStoredMark(t){return this.ensureMarks(t.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(t){return this.ensureMarks(t.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&yi)>0}addStep(t,e){super.addStep(t,e),this.updated=this.updated&~yi,this.storedMarks=null}setTime(t){return this.time=t,this}replaceSelection(t){return this.selection.replace(this,t),this}replaceSelectionWith(t,e=!0){let r=this.selection;return e&&(t=t.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||ct.none))),r.replaceWith(this,t),this}deleteSelection(){return this.selection.replace(this),this}insertText(t,e,r){let i=this.doc.type.schema;if(e==null)return t?this.replaceSelectionWith(i.text(t),!0):this.deleteSelection();{if(r==null&&(r=e),r=r!=null?r:e,!t)return this.deleteRange(e,r);let s=this.storedMarks;if(!s){let l=this.doc.resolve(e);s=r==e?l.marks():l.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(e,r,i.text(t,s)),this.selection.empty||this.setSelection(ht.near(this.selection.$to)),this}}setMeta(t,e){return this.meta[typeof t=="string"?t:t.key]=e,this}getMeta(t){return this.meta[typeof t=="string"?t:t.key]}get isGeneric(){for(let t in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=Mh,this}get scrolledIntoView(){return(this.updated&Mh)>0}}function Ah(n,t){return!t||!n?n:n.bind(t)}class _o{constructor(t,e,r){this.name=t,this.init=Ah(e.init,r),this.apply=Ah(e.apply,r)}}const K_=[new _o("doc",{init(n){return n.doc||n.schema.topNodeType.createAndFill()},apply(n){return n.doc}}),new _o("selection",{init(n,t){return n.selection||ht.atStart(t.doc)},apply(n){return n.selection}}),new _o("storedMarks",{init(n){return n.storedMarks||null},apply(n,t,e,r){return r.selection.$cursor?n.storedMarks:null}}),new _o("scrollToSelection",{init(){return 0},apply(n,t){return n.scrolledIntoView?t+1:t}})];class Us{constructor(t,e){this.schema=t,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=K_.slice(),e&&e.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new _o(r.key,r.spec.state,r))})}}class Er{constructor(t){this.config=t}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(t){return this.applyTransaction(t).state}filterTransaction(t,e=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=e){let i=this.config.plugins[r];if(i.spec.filterTransaction&&!i.spec.filterTransaction.call(i,t,this))return!1}return!0}applyTransaction(t){if(!this.filterTransaction(t))return{state:this,transactions:[]};let e=[t],r=this.applyInner(t),i=null;for(;;){let s=!1;for(let l=0;l<this.config.plugins.length;l++){let c=this.config.plugins[l];if(c.spec.appendTransaction){let h=i?i[l].n:0,d=i?i[l].state:this,m=h<e.length&&c.spec.appendTransaction.call(c,h?e.slice(h):e,d,r);if(m&&r.filterTransaction(m,l)){if(m.setMeta("appendedTransaction",t),!i){i=[];for(let y=0;y<this.config.plugins.length;y++)i.push(y<l?{state:r,n:e.length}:{state:this,n:0})}e.push(m),r=r.applyInner(m),s=!0}i&&(i[l]={state:r,n:e.length})}}if(!s)return{state:r,transactions:e}}}applyInner(t){if(!t.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let e=new Er(this.config),r=this.config.fields;for(let i=0;i<r.length;i++){let s=r[i];e[s.name]=s.apply(t,this[s.name],this,e)}return e}get tr(){return new U_(this)}static create(t){let e=new Us(t.doc?t.doc.type.schema:t.schema,t.plugins),r=new Er(e);for(let i=0;i<e.fields.length;i++)r[e.fields[i].name]=e.fields[i].init(t,r);return r}reconfigure(t){let e=new Us(this.schema,t.plugins),r=e.fields,i=new Er(e);for(let s=0;s<r.length;s++){let l=r[s].name;i[l]=this.hasOwnProperty(l)?this[l]:r[s].init(t,i)}return i}toJSON(t){let e={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(e.storedMarks=this.storedMarks.map(r=>r.toJSON())),t&&typeof t=="object")for(let r in t){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=t[r],s=i.spec.state;s&&s.toJSON&&(e[r]=s.toJSON.call(i,this[i.key]))}return e}static fromJSON(t,e,r){if(!e)throw new RangeError("Invalid input for EditorState.fromJSON");if(!t.schema)throw new RangeError("Required config field 'schema' missing");let i=new Us(t.schema,t.plugins),s=new Er(i);return i.fields.forEach(l=>{if(l.name=="doc")s.doc=Ue.fromJSON(t.schema,e.doc);else if(l.name=="selection")s.selection=ht.fromJSON(s.doc,e.selection);else if(l.name=="storedMarks")e.storedMarks&&(s.storedMarks=e.storedMarks.map(t.schema.markFromJSON));else{if(r)for(let c in r){let h=r[c],d=h.spec.state;if(h.key==l.name&&d&&d.fromJSON&&Object.prototype.hasOwnProperty.call(e,c)){s[l.name]=d.fromJSON.call(h,t,e[c],s);return}}s[l.name]=l.init(t,s)}}),s}}function Eh(n,t,e){for(let r in n){let i=n[r];i instanceof Function?i=i.bind(t):r=="handleDOMEvents"&&(i=Eh(i,t,{})),e[r]=i}return e}class H_{constructor(t){this.spec=t,this.props={},t.props&&Eh(t.props,this,this.props),this.key=t.key?t.key.key:G_("plugin")}getState(t){return t[this.key]}}const Ks=Object.create(null);function G_(n){return n in Ks?n+"$"+ ++Ks[n]:(Ks[n]=0,n+"$")}const ae=function(n){for(var t=0;;t++)if(n=n.previousSibling,!n)return t},yo=function(n){let t=n.assignedSlot||n.parentNode;return t&&t.nodeType==11?t.host:t};let Th=null;const mn=function(n,t,e){let r=Th||(Th=document.createRange());return r.setEnd(n,e!=null?e:n.nodeValue.length),r.setStart(n,t||0),r},nr=function(n,t,e,r){return e&&(Nh(n,t,e,r,-1)||Nh(n,t,e,r,1))},Z_=/^(img|br|input|textarea|hr)$/i;function Nh(n,t,e,r,i){for(;;){if(n==e&&t==r)return!0;if(t==(i<0?0:Ke(n))){let s=n.parentNode;if(!s||s.nodeType!=1||X_(n)||Z_.test(n.nodeName)||n.contentEditable=="false")return!1;t=ae(n)+(i<0?0:1),n=s}else if(n.nodeType==1){if(n=n.childNodes[t+(i<0?-1:0)],n.contentEditable=="false")return!1;t=i<0?Ke(n):0}else return!1}}function Ke(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function Y_(n,t,e){for(let r=t==0,i=t==Ke(n);r||i;){if(n==e)return!0;let s=ae(n);if(n=n.parentNode,!n)return!1;r=r&&s==0,i=i&&s==Ke(n)}}function X_(n){let t;for(let e=n;e&&!(t=e.pmViewDesc);e=e.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==n||t.contentDOM==n)}const bi=function(n){return n.focusNode&&nr(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)};function rr(n,t){let e=document.createEvent("Event");return e.initEvent("keydown",!0,!0),e.keyCode=n,e.key=e.code=t,e}function Q_(n){let t=n.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}const Nn=typeof navigator<"u"?navigator:null,Dh=typeof document<"u"?document:null,Dn=Nn&&Nn.userAgent||"",Hs=/Edge\/(\d+)/.exec(Dn),Rh=/MSIE \d/.exec(Dn),Gs=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Dn),Yt=!!(Rh||Gs||Hs),Rn=Rh?document.documentMode:Gs?+Gs[1]:Hs?+Hs[1]:0,Ne=!Yt&&/gecko\/(\d+)/i.test(Dn);Ne&&+(/Firefox\/(\d+)/.exec(Dn)||[0,0])[1];const Zs=!Yt&&/Chrome\/(\d+)/.exec(Dn),Lt=!!Zs,t1=Zs?+Zs[1]:0,Wt=!Yt&&!!Nn&&/Apple Computer/.test(Nn.vendor),Tr=Wt&&(/Mobile\/\w+/.test(Dn)||!!Nn&&Nn.maxTouchPoints>2),ye=Tr||(Nn?/Mac/.test(Nn.platform):!1),De=/Android \d/.test(Dn),wi=!!Dh&&"webkitFontSmoothing"in Dh.documentElement.style,e1=wi?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function n1(n){return{left:0,right:n.documentElement.clientWidth,top:0,bottom:n.documentElement.clientHeight}}function In(n,t){return typeof n=="number"?n:n[t]}function r1(n){let t=n.getBoundingClientRect(),e=t.width/n.offsetWidth||1,r=t.height/n.offsetHeight||1;return{left:t.left,right:t.left+n.clientWidth*e,top:t.top,bottom:t.top+n.clientHeight*r}}function Ih(n,t,e){let r=n.someProp("scrollThreshold")||0,i=n.someProp("scrollMargin")||5,s=n.dom.ownerDocument;for(let l=e||n.dom;l;l=yo(l)){if(l.nodeType!=1)continue;let c=l,h=c==s.body,d=h?n1(s):r1(c),m=0,y=0;if(t.top<d.top+In(r,"top")?y=-(d.top-t.top+In(i,"top")):t.bottom>d.bottom-In(r,"bottom")&&(y=t.bottom-d.bottom+In(i,"bottom")),t.left<d.left+In(r,"left")?m=-(d.left-t.left+In(i,"left")):t.right>d.right-In(r,"right")&&(m=t.right-d.right+In(i,"right")),m||y)if(h)s.defaultView.scrollBy(m,y);else{let v=c.scrollLeft,b=c.scrollTop;y&&(c.scrollTop+=y),m&&(c.scrollLeft+=m);let C=c.scrollLeft-v,T=c.scrollTop-b;t={left:t.left-C,top:t.top-T,right:t.right-C,bottom:t.bottom-T}}if(h)break}}function o1(n){let t=n.dom.getBoundingClientRect(),e=Math.max(0,t.top),r,i;for(let s=(t.left+t.right)/2,l=e+1;l<Math.min(innerHeight,t.bottom);l+=5){let c=n.root.elementFromPoint(s,l);if(!c||c==n.dom||!n.dom.contains(c))continue;let h=c.getBoundingClientRect();if(h.top>=e-20){r=c,i=h.top;break}}return{refDOM:r,refTop:i,stack:zh(n.dom)}}function zh(n){let t=[],e=n.ownerDocument;for(let r=n;r&&(t.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),n!=e);r=yo(r));return t}function i1({refDOM:n,refTop:t,stack:e}){let r=n?n.getBoundingClientRect().top:0;jh(e,r==0?0:r-t)}function jh(n,t){for(let e=0;e<n.length;e++){let{dom:r,top:i,left:s}=n[e];r.scrollTop!=i+t&&(r.scrollTop=i+t),r.scrollLeft!=s&&(r.scrollLeft=s)}}let Nr=null;function s1(n){if(n.setActive)return n.setActive();if(Nr)return n.focus(Nr);let t=zh(n);n.focus(Nr==null?{get preventScroll(){return Nr={preventScroll:!0},!0}}:void 0),Nr||(Nr=!1,jh(t,0))}function Ph(n,t){let e,r=2e8,i,s=0,l=t.top,c=t.top;for(let h=n.firstChild,d=0;h;h=h.nextSibling,d++){let m;if(h.nodeType==1)m=h.getClientRects();else if(h.nodeType==3)m=mn(h).getClientRects();else continue;for(let y=0;y<m.length;y++){let v=m[y];if(v.top<=l&&v.bottom>=c){l=Math.max(v.bottom,l),c=Math.min(v.top,c);let b=v.left>t.left?v.left-t.left:v.right<t.left?t.left-v.right:0;if(b<r){e=h,r=b,i=b&&e.nodeType==3?{left:v.right<t.left?v.right:v.left,top:t.top}:t,h.nodeType==1&&b&&(s=d+(t.left>=(v.left+v.right)/2?1:0));continue}}!e&&(t.left>=v.right&&t.top>=v.top||t.left>=v.left&&t.top>=v.bottom)&&(s=d+1)}}return e&&e.nodeType==3?a1(e,i):!e||r&&e.nodeType==1?{node:n,offset:s}:Ph(e,i)}function a1(n,t){let e=n.nodeValue.length,r=document.createRange();for(let i=0;i<e;i++){r.setEnd(n,i+1),r.setStart(n,i);let s=zn(r,1);if(s.top!=s.bottom&&Ys(t,s))return{node:n,offset:i+(t.left>=(s.left+s.right)/2?1:0)}}return{node:n,offset:0}}function Ys(n,t){return n.left>=t.left-1&&n.left<=t.right+1&&n.top>=t.top-1&&n.top<=t.bottom+1}function l1(n,t){let e=n.parentNode;return e&&/^li$/i.test(e.nodeName)&&t.left<n.getBoundingClientRect().left?e:n}function c1(n,t,e){let{node:r,offset:i}=Ph(t,e),s=-1;if(r.nodeType==1&&!r.firstChild){let l=r.getBoundingClientRect();s=l.left!=l.right&&e.left>(l.left+l.right)/2?1:-1}return n.docView.posFromDOM(r,i,s)}function u1(n,t,e,r){let i=-1;for(let s=t;s!=n.dom;){let l=n.docView.nearestDesc(s,!0);if(!l)return null;if(l.dom.nodeType==1&&(l.node.isBlock&&l.parent||!l.contentDOM)){let c=l.dom.getBoundingClientRect();if(l.node.isBlock&&l.parent&&(c.left>r.left||c.top>r.top?i=l.posBefore:(c.right<r.left||c.bottom<r.top)&&(i=l.posAfter)),!l.contentDOM&&i<0)return(l.node.isBlock?r.top<(c.top+c.bottom)/2:r.left<(c.left+c.right)/2)?l.posBefore:l.posAfter}s=l.dom.parentNode}return i>-1?i:n.docView.posFromDOM(t,e,-1)}function Bh(n,t,e){let r=n.childNodes.length;if(r&&e.top<e.bottom)for(let i=Math.max(0,Math.min(r-1,Math.floor(r*(t.top-e.top)/(e.bottom-e.top))-2)),s=i;;){let l=n.childNodes[s];if(l.nodeType==1){let c=l.getClientRects();for(let h=0;h<c.length;h++){let d=c[h];if(Ys(t,d))return Bh(l,t,d)}}if((s=(s+1)%r)==i)break}return n}function h1(n,t){let e=n.dom.ownerDocument,r,i=0;if(e.caretPositionFromPoint)try{let h=e.caretPositionFromPoint(t.left,t.top);h&&({offsetNode:r,offset:i}=h)}catch{}if(!r&&e.caretRangeFromPoint){let h=e.caretRangeFromPoint(t.left,t.top);h&&({startContainer:r,startOffset:i}=h)}let s=(n.root.elementFromPoint?n.root:e).elementFromPoint(t.left,t.top),l;if(!s||!n.dom.contains(s.nodeType!=1?s.parentNode:s)){let h=n.dom.getBoundingClientRect();if(!Ys(t,h)||(s=Bh(n.dom,t,h),!s))return null}if(Wt)for(let h=s;r&&h;h=yo(h))h.draggable&&(r=void 0);if(s=l1(s,t),r){if(Ne&&r.nodeType==1&&(i=Math.min(i,r.childNodes.length),i<r.childNodes.length)){let h=r.childNodes[i],d;h.nodeName=="IMG"&&(d=h.getBoundingClientRect()).right<=t.left&&d.bottom>t.top&&i++}r==n.dom&&i==r.childNodes.length-1&&r.lastChild.nodeType==1&&t.top>r.lastChild.getBoundingClientRect().bottom?l=n.state.doc.content.size:(i==0||r.nodeType!=1||r.childNodes[i-1].nodeName!="BR")&&(l=u1(n,r,i,t))}l==null&&(l=c1(n,s,t));let c=n.docView.nearestDesc(s,!0);return{pos:l,inside:c?c.posAtStart-c.border:-1}}function zn(n,t){let e=n.getClientRects();return e.length?e[t<0?0:e.length-1]:n.getBoundingClientRect()}const f1=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function $h(n,t,e){let{node:r,offset:i,atom:s}=n.docView.domFromPos(t,e<0?-1:1),l=wi||Ne;if(r.nodeType==3)if(l&&(f1.test(r.nodeValue)||(e<0?!i:i==r.nodeValue.length))){let c=zn(mn(r,i,i),e);if(Ne&&i&&/\s/.test(r.nodeValue[i-1])&&i<r.nodeValue.length){let h=zn(mn(r,i-1,i-1),-1);if(h.top==c.top){let d=zn(mn(r,i,i+1),-1);if(d.top!=c.top)return bo(d,d.left<h.left)}}return c}else{let c=i,h=i,d=e<0?1:-1;return e<0&&!i?(h++,d=-1):e>=0&&i==r.nodeValue.length?(c--,d=1):e<0?c--:h++,bo(zn(mn(r,c,h),1),d<0)}if(!n.state.doc.resolve(t-(s||0)).parent.inlineContent){if(s==null&&i&&(e<0||i==Ke(r))){let c=r.childNodes[i-1];if(c.nodeType==1)return Xs(c.getBoundingClientRect(),!1)}if(s==null&&i<Ke(r)){let c=r.childNodes[i];if(c.nodeType==1)return Xs(c.getBoundingClientRect(),!0)}return Xs(r.getBoundingClientRect(),e>=0)}if(s==null&&i&&(e<0||i==Ke(r))){let c=r.childNodes[i-1],h=c.nodeType==3?mn(c,Ke(c)-(l?0:1)):c.nodeType==1&&(c.nodeName!="BR"||!c.nextSibling)?c:null;if(h)return bo(zn(h,1),!1)}if(s==null&&i<Ke(r)){let c=r.childNodes[i];for(;c.pmViewDesc&&c.pmViewDesc.ignoreForCoords;)c=c.nextSibling;let h=c?c.nodeType==3?mn(c,0,l?0:1):c.nodeType==1?c:null:null;if(h)return bo(zn(h,-1),!0)}return bo(zn(r.nodeType==3?mn(r):r,-e),e>=0)}function bo(n,t){if(n.width==0)return n;let e=t?n.left:n.right;return{top:n.top,bottom:n.bottom,left:e,right:e}}function Xs(n,t){if(n.height==0)return n;let e=t?n.top:n.bottom;return{top:e,bottom:e,left:n.left,right:n.right}}function Fh(n,t,e){let r=n.state,i=n.root.activeElement;r!=t&&n.updateState(t),i!=n.dom&&n.focus();try{return e()}finally{r!=t&&n.updateState(r),i!=n.dom&&i&&i.focus()}}function d1(n,t,e){let r=t.selection,i=e=="up"?r.$from:r.$to;return Fh(n,t,()=>{let{node:s}=n.docView.domFromPos(i.pos,e=="up"?-1:1);for(;;){let c=n.docView.nearestDesc(s,!0);if(!c)break;if(c.node.isBlock){s=c.contentDOM||c.dom;break}s=c.dom.parentNode}let l=$h(n,i.pos,1);for(let c=s.firstChild;c;c=c.nextSibling){let h;if(c.nodeType==1)h=c.getClientRects();else if(c.nodeType==3)h=mn(c,0,c.nodeValue.length).getClientRects();else continue;for(let d=0;d<h.length;d++){let m=h[d];if(m.bottom>m.top+1&&(e=="up"?l.top-m.top>(m.bottom-l.top)*2:m.bottom-l.bottom>(l.bottom-m.top)*2))return!1}}return!0})}const p1=/[\u0590-\u08ac]/;function m1(n,t,e){let{$head:r}=t.selection;if(!r.parent.isTextblock)return!1;let i=r.parentOffset,s=!i,l=i==r.parent.content.size,c=n.domSelection();return!p1.test(r.parent.textContent)||!c.modify?e=="left"||e=="backward"?s:l:Fh(n,t,()=>{let{focusNode:h,focusOffset:d,anchorNode:m,anchorOffset:y}=n.domSelectionRange(),v=c.caretBidiLevel;c.modify("move",e,"character");let b=r.depth?n.docView.domAfterPos(r.before()):n.dom,{focusNode:C,focusOffset:T}=n.domSelectionRange(),P=C&&!b.contains(C.nodeType==1?C:C.parentNode)||h==C&&d==T;try{c.collapse(m,y),h&&(h!=m||d!=y)&&c.extend&&c.extend(h,d)}catch{}return v!=null&&(c.caretBidiLevel=v),P})}let Vh=null,Lh=null,Wh=!1;function g1(n,t,e){return Vh==t&&Lh==e?Wh:(Vh=t,Lh=e,Wh=e=="up"||e=="down"?d1(n,t,e):m1(n,t,e))}const Re=0,qh=1,Dr=2,He=3;class wo{constructor(t,e,r,i){this.parent=t,this.children=e,this.dom=r,this.contentDOM=i,this.dirty=Re,r.pmViewDesc=this}matchesWidget(t){return!1}matchesMark(t){return!1}matchesNode(t,e,r){return!1}matchesHack(t){return!1}parseRule(){return null}stopEvent(t){return!1}get size(){let t=0;for(let e=0;e<this.children.length;e++)t+=this.children[e].size;return t}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let t=0;t<this.children.length;t++)this.children[t].destroy()}posBeforeChild(t){for(let e=0,r=this.posAtStart;;e++){let i=this.children[e];if(i==t)return r;r+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(t,e,r){if(this.contentDOM&&this.contentDOM.contains(t.nodeType==1?t:t.parentNode))if(r<0){let s,l;if(t==this.contentDOM)s=t.childNodes[e-1];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;s=t.previousSibling}for(;s&&!((l=s.pmViewDesc)&&l.parent==this);)s=s.previousSibling;return s?this.posBeforeChild(l)+l.size:this.posAtStart}else{let s,l;if(t==this.contentDOM)s=t.childNodes[e];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;s=t.nextSibling}for(;s&&!((l=s.pmViewDesc)&&l.parent==this);)s=s.nextSibling;return s?this.posBeforeChild(l):this.posAtEnd}let i;if(t==this.dom&&this.contentDOM)i=e>ae(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=t.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(e==0)for(let s=t;;s=s.parentNode){if(s==this.dom){i=!1;break}if(s.previousSibling)break}if(i==null&&e==t.childNodes.length)for(let s=t;;s=s.parentNode){if(s==this.dom){i=!0;break}if(s.nextSibling)break}}return(i!=null?i:r>0)?this.posAtEnd:this.posAtStart}nearestDesc(t,e=!1){for(let r=!0,i=t;i;i=i.parentNode){let s=this.getDesc(i),l;if(s&&(!e||s.node))if(r&&(l=s.nodeDOM)&&!(l.nodeType==1?l.contains(t.nodeType==1?t:t.parentNode):l==t))r=!1;else return s}}getDesc(t){let e=t.pmViewDesc;for(let r=e;r;r=r.parent)if(r==this)return e}posFromDOM(t,e,r){for(let i=t;i;i=i.parentNode){let s=this.getDesc(i);if(s)return s.localPosFromDOM(t,e,r)}return-1}descAt(t){for(let e=0,r=0;e<this.children.length;e++){let i=this.children[e],s=r+i.size;if(r==t&&s!=r){for(;!i.border&&i.children.length;)i=i.children[0];return i}if(t<s)return i.descAt(t-r-i.border);r=s}}domFromPos(t,e){if(!this.contentDOM)return{node:this.dom,offset:0,atom:t+1};let r=0,i=0;for(let s=0;r<this.children.length;r++){let l=this.children[r],c=s+l.size;if(c>t||l instanceof Kh){i=t-s;break}s=c}if(i)return this.children[r].domFromPos(i-this.children[r].border,e);for(let s;r&&!(s=this.children[r-1]).size&&s instanceof Jh&&s.side>=0;r--);if(e<=0){let s,l=!0;for(;s=r?this.children[r-1]:null,!(!s||s.dom.parentNode==this.contentDOM);r--,l=!1);return s&&e&&l&&!s.border&&!s.domAtom?s.domFromPos(s.size,e):{node:this.contentDOM,offset:s?ae(s.dom)+1:0}}else{let s,l=!0;for(;s=r<this.children.length?this.children[r]:null,!(!s||s.dom.parentNode==this.contentDOM);r++,l=!1);return s&&l&&!s.border&&!s.domAtom?s.domFromPos(0,e):{node:this.contentDOM,offset:s?ae(s.dom):this.contentDOM.childNodes.length}}}parseRange(t,e,r=0){if(this.children.length==0)return{node:this.contentDOM,from:t,to:e,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,s=-1;for(let l=r,c=0;;c++){let h=this.children[c],d=l+h.size;if(i==-1&&t<=d){let m=l+h.border;if(t>=m&&e<=d-h.border&&h.node&&h.contentDOM&&this.contentDOM.contains(h.contentDOM))return h.parseRange(t,e,m);t=l;for(let y=c;y>0;y--){let v=this.children[y-1];if(v.size&&v.dom.parentNode==this.contentDOM&&!v.emptyChildAt(1)){i=ae(v.dom)+1;break}t-=v.size}i==-1&&(i=0)}if(i>-1&&(d>e||c==this.children.length-1)){e=d;for(let m=c+1;m<this.children.length;m++){let y=this.children[m];if(y.size&&y.dom.parentNode==this.contentDOM&&!y.emptyChildAt(-1)){s=ae(y.dom);break}e+=y.size}s==-1&&(s=this.contentDOM.childNodes.length);break}l=d}return{node:this.contentDOM,from:t,to:e,fromOffset:i,toOffset:s}}emptyChildAt(t){if(this.border||!this.contentDOM||!this.children.length)return!1;let e=this.children[t<0?0:this.children.length-1];return e.size==0||e.emptyChildAt(t)}domAfterPos(t){let{node:e,offset:r}=this.domFromPos(t,0);if(e.nodeType!=1||r==e.childNodes.length)throw new RangeError("No node after pos "+t);return e.childNodes[r]}setSelection(t,e,r,i=!1){let s=Math.min(t,e),l=Math.max(t,e);for(let v=0,b=0;v<this.children.length;v++){let C=this.children[v],T=b+C.size;if(s>b&&l<T)return C.setSelection(t-b-C.border,e-b-C.border,r,i);b=T}let c=this.domFromPos(t,t?-1:1),h=e==t?c:this.domFromPos(e,e?-1:1),d=r.getSelection(),m=!1;if((Ne||Wt)&&t==e){let{node:v,offset:b}=c;if(v.nodeType==3){if(m=!!(b&&v.nodeValue[b-1]==`
`),m&&b==v.nodeValue.length)for(let C=v,T;C;C=C.parentNode){if(T=C.nextSibling){T.nodeName=="BR"&&(c=h={node:T.parentNode,offset:ae(T)+1});break}let P=C.pmViewDesc;if(P&&P.node&&P.node.isBlock)break}}else{let C=v.childNodes[b-1];m=C&&(C.nodeName=="BR"||C.contentEditable=="false")}}if(Ne&&d.focusNode&&d.focusNode!=h.node&&d.focusNode.nodeType==1){let v=d.focusNode.childNodes[d.focusOffset];v&&v.contentEditable=="false"&&(i=!0)}if(!(i||m&&Wt)&&nr(c.node,c.offset,d.anchorNode,d.anchorOffset)&&nr(h.node,h.offset,d.focusNode,d.focusOffset))return;let y=!1;if((d.extend||t==e)&&!m){d.collapse(c.node,c.offset);try{t!=e&&d.extend(h.node,h.offset),y=!0}catch{}}if(!y){if(t>e){let b=c;c=h,h=b}let v=document.createRange();v.setEnd(h.node,h.offset),v.setStart(c.node,c.offset),d.removeAllRanges(),d.addRange(v)}}ignoreMutation(t){return!this.contentDOM&&t.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(t,e){for(let r=0,i=0;i<this.children.length;i++){let s=this.children[i],l=r+s.size;if(r==l?t<=l&&e>=r:t<l&&e>r){let c=r+s.border,h=l-s.border;if(t>=c&&e<=h){this.dirty=t==r||e==l?Dr:qh,t==c&&e==h&&(s.contentLost||s.dom.parentNode!=this.contentDOM)?s.dirty=He:s.markDirty(t-c,e-c);return}else s.dirty=s.dom==s.contentDOM&&s.dom.parentNode==this.contentDOM&&!s.children.length?Dr:He}r=l}this.dirty=Dr}markParentsDirty(){let t=1;for(let e=this.parent;e;e=e.parent,t++){let r=t==1?Dr:qh;e.dirty<r&&(e.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}}class Jh extends wo{constructor(t,e,r,i){let s,l=e.type.toDOM;if(typeof l=="function"&&(l=l(r,()=>{if(!s)return i;if(s.parent)return s.parent.posBeforeChild(s)})),!e.type.spec.raw){if(l.nodeType!=1){let c=document.createElement("span");c.appendChild(l),l=c}l.contentEditable="false",l.classList.add("ProseMirror-widget")}super(t,[],l,null),this.widget=e,this.widget=e,s=this}matchesWidget(t){return this.dirty==Re&&t.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(t){let e=this.widget.spec.stopEvent;return e?e(t):!1}ignoreMutation(t){return t.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class _1 extends wo{constructor(t,e,r,i){super(t,[],e,null),this.textDOM=r,this.text=i}get size(){return this.text.length}localPosFromDOM(t,e){return t!=this.textDOM?this.posAtStart+(e?this.size:0):this.posAtStart+e}domFromPos(t){return{node:this.textDOM,offset:t}}ignoreMutation(t){return t.type==="characterData"&&t.target.nodeValue==t.oldValue}}class or extends wo{constructor(t,e,r,i){super(t,[],r,i),this.mark=e}static create(t,e,r,i){let s=i.nodeViews[e.type.name],l=s&&s(e,i,r);return(!l||!l.dom)&&(l=dn.renderSpec(document,e.type.spec.toDOM(e,r))),new or(t,e,l.dom,l.contentDOM||l.dom)}parseRule(){return this.dirty&He||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM||void 0}}matchesMark(t){return this.dirty!=He&&this.mark.eq(t)}markDirty(t,e){if(super.markDirty(t,e),this.dirty!=Re){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=Re}}slice(t,e,r){let i=or.create(this.parent,this.mark,!0,r),s=this.children,l=this.size;e<l&&(s=ea(s,e,l,r)),t>0&&(s=ea(s,0,t,r));for(let c=0;c<s.length;c++)s[c].parent=i;return i.children=s,i}}class ir extends wo{constructor(t,e,r,i,s,l,c,h,d){super(t,[],s,l),this.node=e,this.outerDeco=r,this.innerDeco=i,this.nodeDOM=c,l&&this.updateChildren(h,d)}static create(t,e,r,i,s,l){let c=s.nodeViews[e.type.name],h,d=c&&c(e,s,()=>{if(!h)return l;if(h.parent)return h.parent.posBeforeChild(h)},r,i),m=d&&d.dom,y=d&&d.contentDOM;if(e.isText){if(!m)m=document.createTextNode(e.text);else if(m.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else m||({dom:m,contentDOM:y}=dn.renderSpec(document,e.type.spec.toDOM(e)));!y&&!e.isText&&m.nodeName!="BR"&&(m.hasAttribute("contenteditable")||(m.contentEditable="false"),e.type.spec.draggable&&(m.draggable=!0));let v=m;return m=Zh(m,r,e),d?h=new y1(t,e,r,i,m,y||null,v,d,s,l+1):e.isText?new vi(t,e,r,i,m,v,s):new ir(t,e,r,i,m,y||null,v,s,l+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let t={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(t.preserveWhitespace="full"),!this.contentDOM)t.getContent=()=>this.node.content;else if(!this.contentLost)t.contentElement=this.contentDOM;else{for(let e=this.children.length-1;e>=0;e--){let r=this.children[e];if(this.dom.contains(r.dom.parentNode)){t.contentElement=r.dom.parentNode;break}}t.contentElement||(t.getContent=()=>B.empty)}return t}matchesNode(t,e,r){return this.dirty==Re&&t.eq(this.node)&&ta(e,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(t,e){let r=this.node.inlineContent,i=e,s=t.composing?this.localCompositionInfo(t,e):null,l=s&&s.pos>-1?s:null,c=s&&s.pos<0,h=new w1(this,l&&l.node,t);x1(this.node,this.innerDeco,(d,m,y)=>{d.spec.marks?h.syncToMarks(d.spec.marks,r,t):d.type.side>=0&&!y&&h.syncToMarks(m==this.node.childCount?ct.none:this.node.child(m).marks,r,t),h.placeWidget(d,t,i)},(d,m,y,v)=>{h.syncToMarks(d.marks,r,t);let b;h.findNodeMatch(d,m,y,v)||c&&t.state.selection.from>i&&t.state.selection.to<i+d.nodeSize&&(b=h.findIndexWithChild(s.node))>-1&&h.updateNodeAt(d,m,y,b,t)||h.updateNextNode(d,m,y,t,v)||h.addNode(d,m,y,t,i),i+=d.nodeSize}),h.syncToMarks([],r,t),this.node.isTextblock&&h.addTextblockHacks(),h.destroyRest(),(h.changed||this.dirty==Dr)&&(l&&this.protectLocalComposition(t,l),Hh(this.contentDOM,this.children,t),Tr&&S1(this.dom))}localCompositionInfo(t,e){let{from:r,to:i}=t.state.selection;if(!(t.state.selection instanceof pt)||r<e||i>e+this.node.content.size)return null;let s=t.domSelectionRange(),l=C1(s.focusNode,s.focusOffset);if(!l||!this.dom.contains(l.parentNode))return null;if(this.node.inlineContent){let c=l.nodeValue,h=O1(this.node.content,c,r-e,i-e);return h<0?null:{node:l,pos:h,text:c}}else return{node:l,pos:-1,text:""}}protectLocalComposition(t,{node:e,pos:r,text:i}){if(this.getDesc(e))return;let s=e;for(;s.parentNode!=this.contentDOM;s=s.parentNode){for(;s.previousSibling;)s.parentNode.removeChild(s.previousSibling);for(;s.nextSibling;)s.parentNode.removeChild(s.nextSibling);s.pmViewDesc&&(s.pmViewDesc=void 0)}let l=new _1(this,s,e,i);t.input.compositionNodes.push(l),this.children=ea(this.children,r,r+i.length,t,l)}update(t,e,r,i){return this.dirty==He||!t.sameMarkup(this.node)?!1:(this.updateInner(t,e,r,i),!0)}updateInner(t,e,r,i){this.updateOuterDeco(e),this.node=t,this.innerDeco=r,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=Re}updateOuterDeco(t){if(ta(t,this.outerDeco))return;let e=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=Gh(this.dom,this.nodeDOM,Qs(this.outerDeco,this.node,e),Qs(t,this.node,e)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=t}selectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable")}get domAtom(){return this.node.isAtom}}function Uh(n,t,e,r,i){return Zh(r,t,n),new ir(void 0,n,t,e,r,r,r,i,0)}class vi extends ir{constructor(t,e,r,i,s,l,c){super(t,e,r,i,s,null,l,c,0)}parseRule(){let t=this.nodeDOM.parentNode;for(;t&&t!=this.dom&&!t.pmIsDeco;)t=t.parentNode;return{skip:t||!0}}update(t,e,r,i){return this.dirty==He||this.dirty!=Re&&!this.inParent()||!t.sameMarkup(this.node)?!1:(this.updateOuterDeco(e),(this.dirty!=Re||t.text!=this.node.text)&&t.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=t.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=t,this.dirty=Re,!0)}inParent(){let t=this.parent.contentDOM;for(let e=this.nodeDOM;e;e=e.parentNode)if(e==t)return!0;return!1}domFromPos(t){return{node:this.nodeDOM,offset:t}}localPosFromDOM(t,e,r){return t==this.nodeDOM?this.posAtStart+Math.min(e,this.node.text.length):super.localPosFromDOM(t,e,r)}ignoreMutation(t){return t.type!="characterData"&&t.type!="selection"}slice(t,e,r){let i=this.node.cut(t,e),s=document.createTextNode(i.text);return new vi(this.parent,i,this.outerDeco,this.innerDeco,s,s,r)}markDirty(t,e){super.markDirty(t,e),this.dom!=this.nodeDOM&&(t==0||e==this.nodeDOM.nodeValue.length)&&(this.dirty=He)}get domAtom(){return!1}}class Kh extends wo{parseRule(){return{ignore:!0}}matchesHack(t){return this.dirty==Re&&this.dom.nodeName==t}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class y1 extends ir{constructor(t,e,r,i,s,l,c,h,d,m){super(t,e,r,i,s,l,c,d,m),this.spec=h}update(t,e,r,i){if(this.dirty==He)return!1;if(this.spec.update){let s=this.spec.update(t,e,r);return s&&this.updateInner(t,e,r,i),s}else return!this.contentDOM&&!t.isLeaf?!1:super.update(t,e,r,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(t,e,r,i){this.spec.setSelection?this.spec.setSelection(t,e,r):super.setSelection(t,e,r,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(t){return this.spec.stopEvent?this.spec.stopEvent(t):!1}ignoreMutation(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):super.ignoreMutation(t)}}function Hh(n,t,e){let r=n.firstChild,i=!1;for(let s=0;s<t.length;s++){let l=t[s],c=l.dom;if(c.parentNode==n){for(;c!=r;)r=Yh(r),i=!0;r=r.nextSibling}else i=!0,n.insertBefore(c,r);if(l instanceof or){let h=r?r.previousSibling:n.lastChild;Hh(l.contentDOM,l.children,e),r=h?h.nextSibling:n.firstChild}}for(;r;)r=Yh(r),i=!0;i&&e.trackWrites==n&&(e.trackWrites=null)}const vo=function(n){n&&(this.nodeName=n)};vo.prototype=Object.create(null);const sr=[new vo];function Qs(n,t,e){if(n.length==0)return sr;let r=e?sr[0]:new vo,i=[r];for(let s=0;s<n.length;s++){let l=n[s].type.attrs;if(l){l.nodeName&&i.push(r=new vo(l.nodeName));for(let c in l){let h=l[c];h!=null&&(e&&i.length==1&&i.push(r=new vo(t.isInline?"span":"div")),c=="class"?r.class=(r.class?r.class+" ":"")+h:c=="style"?r.style=(r.style?r.style+";":"")+h:c!="nodeName"&&(r[c]=h))}}}return i}function Gh(n,t,e,r){if(e==sr&&r==sr)return t;let i=t;for(let s=0;s<r.length;s++){let l=r[s],c=e[s];if(s){let h;c&&c.nodeName==l.nodeName&&i!=n&&(h=i.parentNode)&&h.nodeName.toLowerCase()==l.nodeName||(h=document.createElement(l.nodeName),h.pmIsDeco=!0,h.appendChild(i),c=sr[0]),i=h}b1(i,c||sr[0],l)}return i}function b1(n,t,e){for(let r in t)r!="class"&&r!="style"&&r!="nodeName"&&!(r in e)&&n.removeAttribute(r);for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&e[r]!=t[r]&&n.setAttribute(r,e[r]);if(t.class!=e.class){let r=t.class?t.class.split(" ").filter(Boolean):[],i=e.class?e.class.split(" ").filter(Boolean):[];for(let s=0;s<r.length;s++)i.indexOf(r[s])==-1&&n.classList.remove(r[s]);for(let s=0;s<i.length;s++)r.indexOf(i[s])==-1&&n.classList.add(i[s]);n.classList.length==0&&n.removeAttribute("class")}if(t.style!=e.style){if(t.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,i;for(;i=r.exec(t.style);)n.style.removeProperty(i[1])}e.style&&(n.style.cssText+=e.style)}}function Zh(n,t,e){return Gh(n,n,sr,Qs(t,e,n.nodeType!=1))}function ta(n,t){if(n.length!=t.length)return!1;for(let e=0;e<n.length;e++)if(!n[e].type.eq(t[e].type))return!1;return!0}function Yh(n){let t=n.nextSibling;return n.parentNode.removeChild(n),t}class w1{constructor(t,e,r){this.lock=e,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=t,this.preMatch=v1(t.node.content,t)}destroyBetween(t,e){if(t!=e){for(let r=t;r<e;r++)this.top.children[r].destroy();this.top.children.splice(t,e-t),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(t,e,r){let i=0,s=this.stack.length>>1,l=Math.min(s,t.length);for(;i<l&&(i==s-1?this.top:this.stack[i+1<<1]).matchesMark(t[i])&&t[i].type.spec.spanning!==!1;)i++;for(;i<s;)this.destroyRest(),this.top.dirty=Re,this.index=this.stack.pop(),this.top=this.stack.pop(),s--;for(;s<t.length;){this.stack.push(this.top,this.index+1);let c=-1;for(let h=this.index;h<Math.min(this.index+3,this.top.children.length);h++){let d=this.top.children[h];if(d.matchesMark(t[s])&&!this.isLocked(d.dom)){c=h;break}}if(c>-1)c>this.index&&(this.changed=!0,this.destroyBetween(this.index,c)),this.top=this.top.children[this.index];else{let h=or.create(this.top,t[s],e,r);this.top.children.splice(this.index,0,h),this.top=h,this.changed=!0}this.index=0,s++}}findNodeMatch(t,e,r,i){let s=-1,l;if(i>=this.preMatch.index&&(l=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&l.matchesNode(t,e,r))s=this.top.children.indexOf(l,this.index);else for(let c=this.index,h=Math.min(this.top.children.length,c+5);c<h;c++){let d=this.top.children[c];if(d.matchesNode(t,e,r)&&!this.preMatch.matched.has(d)){s=c;break}}return s<0?!1:(this.destroyBetween(this.index,s),this.index++,!0)}updateNodeAt(t,e,r,i,s){let l=this.top.children[i];return l.dirty==He&&l.dom==l.contentDOM&&(l.dirty=Dr),l.update(t,e,r,s)?(this.destroyBetween(this.index,i),this.index++,!0):!1}findIndexWithChild(t){for(;;){let e=t.parentNode;if(!e)return-1;if(e==this.top.contentDOM){let r=t.pmViewDesc;if(r){for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==r)return i}return-1}t=e}}updateNextNode(t,e,r,i,s){for(let l=this.index;l<this.top.children.length;l++){let c=this.top.children[l];if(c instanceof ir){let h=this.preMatch.matched.get(c);if(h!=null&&h!=s)return!1;let d=c.dom;if(!(this.isLocked(d)&&!(t.isText&&c.node&&c.node.isText&&c.nodeDOM.nodeValue==t.text&&c.dirty!=He&&ta(e,c.outerDeco)))&&c.update(t,e,r,i))return this.destroyBetween(this.index,l),c.dom!=d&&(this.changed=!0),this.index++,!0;break}}return!1}addNode(t,e,r,i,s){this.top.children.splice(this.index++,0,ir.create(this.top,t,e,r,i,s)),this.changed=!0}placeWidget(t,e,r){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(i&&i.matchesWidget(t)&&(t==i.widget||!i.widget.type.toDOM.parentNode))this.index++;else{let s=new Jh(this.top,t,e,r);this.top.children.splice(this.index++,0,s),this.changed=!0}}addTextblockHacks(){let t=this.top.children[this.index-1],e=this.top;for(;t instanceof or;)e=t,t=e.children[e.children.length-1];(!t||!(t instanceof vi)||/\n$/.test(t.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(t.node.text))&&((Wt||Lt)&&t&&t.dom.contentEditable=="false"&&this.addHackNode("IMG",e),this.addHackNode("BR",this.top))}addHackNode(t,e){if(e==this.top&&this.index<e.children.length&&e.children[this.index].matchesHack(t))this.index++;else{let r=document.createElement(t);t=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),t=="BR"&&(r.className="ProseMirror-trailingBreak");let i=new Kh(this.top,[],r,null);e!=this.top?e.children.push(i):e.children.splice(this.index++,0,i),this.changed=!0}}isLocked(t){return this.lock&&(t==this.lock||t.nodeType==1&&t.contains(this.lock.parentNode))}}function v1(n,t){let e=t,r=e.children.length,i=n.childCount,s=new Map,l=[];t:for(;i>0;){let c;for(;;)if(r){let d=e.children[r-1];if(d instanceof or)e=d,r=d.children.length;else{c=d,r--;break}}else{if(e==t)break t;r=e.parent.children.indexOf(e),e=e.parent}let h=c.node;if(h){if(h!=n.child(i-1))break;--i,s.set(c,i),l.push(c)}}return{index:i,matched:s,matches:l.reverse()}}function k1(n,t){return n.type.side-t.type.side}function x1(n,t,e,r){let i=t.locals(n),s=0;if(i.length==0){for(let d=0;d<n.childCount;d++){let m=n.child(d);r(m,i,t.forChild(s,m),d),s+=m.nodeSize}return}let l=0,c=[],h=null;for(let d=0;;){if(l<i.length&&i[l].to==s){let C=i[l++],T;for(;l<i.length&&i[l].to==s;)(T||(T=[C])).push(i[l++]);if(T){T.sort(k1);for(let P=0;P<T.length;P++)e(T[P],d,!!h)}else e(C,d,!!h)}let m,y;if(h)y=-1,m=h,h=null;else if(d<n.childCount)y=d,m=n.child(d++);else break;for(let C=0;C<c.length;C++)c[C].to<=s&&c.splice(C--,1);for(;l<i.length&&i[l].from<=s&&i[l].to>s;)c.push(i[l++]);let v=s+m.nodeSize;if(m.isText){let C=v;l<i.length&&i[l].from<C&&(C=i[l].from);for(let T=0;T<c.length;T++)c[T].to<C&&(C=c[T].to);C<v&&(h=m.cut(C-s),m=m.cut(0,C-s),v=C,y=-1)}let b=m.isInline&&!m.isLeaf?c.filter(C=>!C.inline):c.slice();r(m,b,t.forChild(s,m),y),s=v}}function S1(n){if(n.nodeName=="UL"||n.nodeName=="OL"){let t=n.style.cssText;n.style.cssText=t+"; list-style: square !important",window.getComputedStyle(n).listStyle,n.style.cssText=t}}function C1(n,t){for(;;){if(n.nodeType==3)return n;if(n.nodeType==1&&t>0){if(n.childNodes.length>t&&n.childNodes[t].nodeType==3)return n.childNodes[t];n=n.childNodes[t-1],t=Ke(n)}else if(n.nodeType==1&&t<n.childNodes.length)n=n.childNodes[t],t=0;else return null}}function O1(n,t,e,r){for(let i=0,s=0;i<n.childCount&&s<=r;){let l=n.child(i++),c=s;if(s+=l.nodeSize,!l.isText)continue;let h=l.text;for(;i<n.childCount;){let d=n.child(i++);if(s+=d.nodeSize,!d.isText)break;h+=d.text}if(s>=e){let d=c<r?h.lastIndexOf(t,r-c-1):-1;if(d>=0&&d+t.length+c>=e)return c+d;if(e==r&&h.length>=r+t.length-c&&h.slice(r-c,r-c+t.length)==t)return r}}return-1}function ea(n,t,e,r,i){let s=[];for(let l=0,c=0;l<n.length;l++){let h=n[l],d=c,m=c+=h.size;d>=e||m<=t?s.push(h):(d<t&&s.push(h.slice(0,t-d,r)),i&&(s.push(i),i=void 0),m>e&&s.push(h.slice(e-d,h.size,r)))}return s}function na(n,t=null){let e=n.domSelectionRange(),r=n.state.doc;if(!e.focusNode)return null;let i=n.docView.nearestDesc(e.focusNode),s=i&&i.size==0,l=n.docView.posFromDOM(e.focusNode,e.focusOffset,1);if(l<0)return null;let c=r.resolve(l),h,d;if(bi(e)){for(h=c;i&&!i.node;)i=i.parent;let m=i.node;if(i&&m.isAtom&&Q.isSelectable(m)&&i.parent&&!(m.isInline&&Y_(e.focusNode,e.focusOffset,i.dom))){let y=i.posBefore;d=new Q(l==y?c:r.resolve(y))}}else{let m=n.docView.posFromDOM(e.anchorNode,e.anchorOffset,1);if(m<0)return null;h=r.resolve(m)}if(!d){let m=t=="pointer"||n.state.selection.head<c.pos&&!s?1:-1;d=oa(n,h,c,m)}return d}function Xh(n){return n.editable?n.hasFocus():sf(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function gn(n,t=!1){let e=n.state.selection;if(nf(n,e),!!Xh(n)){if(!t&&n.input.mouseDown&&n.input.mouseDown.allowDefault&&Lt){let r=n.domSelectionRange(),i=n.domObserver.currentSelection;if(r.anchorNode&&i.anchorNode&&nr(r.anchorNode,r.anchorOffset,i.anchorNode,i.anchorOffset)){n.input.mouseDown.delayedSelectionSync=!0,n.domObserver.setCurSelection();return}}if(n.domObserver.disconnectSelection(),n.cursorWrapper)A1(n);else{let{anchor:r,head:i}=e,s,l;Qh&&!(e instanceof pt)&&(e.$from.parent.inlineContent||(s=tf(n,e.from)),!e.empty&&!e.$from.parent.inlineContent&&(l=tf(n,e.to))),n.docView.setSelection(r,i,n.root,t),Qh&&(s&&ef(s),l&&ef(l)),e.visible?n.dom.classList.remove("ProseMirror-hideselection"):(n.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&M1(n))}n.domObserver.setCurSelection(),n.domObserver.connectSelection()}}const Qh=Wt||Lt&&t1<63;function tf(n,t){let{node:e,offset:r}=n.docView.domFromPos(t,0),i=r<e.childNodes.length?e.childNodes[r]:null,s=r?e.childNodes[r-1]:null;if(Wt&&i&&i.contentEditable=="false")return ra(i);if((!i||i.contentEditable=="false")&&(!s||s.contentEditable=="false")){if(i)return ra(i);if(s)return ra(s)}}function ra(n){return n.contentEditable="true",Wt&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function ef(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function M1(n){let t=n.dom.ownerDocument;t.removeEventListener("selectionchange",n.input.hideSelectionGuard);let e=n.domSelectionRange(),r=e.anchorNode,i=e.anchorOffset;t.addEventListener("selectionchange",n.input.hideSelectionGuard=()=>{(e.anchorNode!=r||e.anchorOffset!=i)&&(t.removeEventListener("selectionchange",n.input.hideSelectionGuard),setTimeout(()=>{(!Xh(n)||n.state.selection.visible)&&n.dom.classList.remove("ProseMirror-hideselection")},20))})}function A1(n){let t=n.domSelection(),e=document.createRange(),r=n.cursorWrapper.dom,i=r.nodeName=="IMG";i?e.setEnd(r.parentNode,ae(r)+1):e.setEnd(r,0),e.collapse(!1),t.removeAllRanges(),t.addRange(e),!i&&!n.state.selection.visible&&Yt&&Rn<=11&&(r.disabled=!0,r.disabled=!1)}function nf(n,t){if(t instanceof Q){let e=n.docView.descAt(t.from);e!=n.lastSelectedViewDesc&&(rf(n),e&&e.selectNode(),n.lastSelectedViewDesc=e)}else rf(n)}function rf(n){n.lastSelectedViewDesc&&(n.lastSelectedViewDesc.parent&&n.lastSelectedViewDesc.deselectNode(),n.lastSelectedViewDesc=void 0)}function oa(n,t,e,r){return n.someProp("createSelectionBetween",i=>i(n,t,e))||pt.between(t,e,r)}function of(n){return n.editable&&!n.hasFocus()?!1:sf(n)}function sf(n){let t=n.domSelectionRange();if(!t.anchorNode)return!1;try{return n.dom.contains(t.anchorNode.nodeType==3?t.anchorNode.parentNode:t.anchorNode)&&(n.editable||n.dom.contains(t.focusNode.nodeType==3?t.focusNode.parentNode:t.focusNode))}catch{return!1}}function E1(n){let t=n.docView.domFromPos(n.state.selection.anchor,0),e=n.domSelectionRange();return nr(t.node,t.offset,e.anchorNode,e.anchorOffset)}function ia(n,t){let{$anchor:e,$head:r}=n.selection,i=t>0?e.max(r):e.min(r),s=i.parent.inlineContent?i.depth?n.doc.resolve(t>0?i.after():i.before()):null:i;return s&&ht.findFrom(s,t)}function ar(n,t){return n.dispatch(n.state.tr.setSelection(t).scrollIntoView()),!0}function af(n,t,e){let r=n.state.selection;if(r instanceof pt){if(!r.empty||e.indexOf("s")>-1)return!1;if(n.endOfTextblock(t>0?"right":"left")){let i=ia(n.state,t);return i&&i instanceof Q?ar(n,i):!1}else if(!(ye&&e.indexOf("m")>-1)){let i=r.$head,s=i.textOffset?null:t<0?i.nodeBefore:i.nodeAfter,l;if(!s||s.isText)return!1;let c=t<0?i.pos-s.nodeSize:i.pos;return s.isAtom||(l=n.docView.descAt(c))&&!l.contentDOM?Q.isSelectable(s)?ar(n,new Q(t<0?n.state.doc.resolve(i.pos-s.nodeSize):i)):wi?ar(n,new pt(n.state.doc.resolve(t<0?c:c+s.nodeSize))):!1:!1}}else{if(r instanceof Q&&r.node.isInline)return ar(n,new pt(t>0?r.$to:r.$from));{let i=ia(n.state,t);return i?ar(n,i):!1}}}function ki(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function ko(n){let t=n.pmViewDesc;return t&&t.size==0&&(n.nextSibling||n.nodeName!="BR")}function sa(n){let t=n.domSelectionRange(),e=t.focusNode,r=t.focusOffset;if(!e)return;let i,s,l=!1;for(Ne&&e.nodeType==1&&r<ki(e)&&ko(e.childNodes[r])&&(l=!0);;)if(r>0){if(e.nodeType!=1)break;{let c=e.childNodes[r-1];if(ko(c))i=e,s=--r;else if(c.nodeType==3)e=c,r=e.nodeValue.length;else break}}else{if(lf(e))break;{let c=e.previousSibling;for(;c&&ko(c);)i=e.parentNode,s=ae(c),c=c.previousSibling;if(c)e=c,r=ki(e);else{if(e=e.parentNode,e==n.dom)break;r=0}}}l?la(n,e,r):i&&la(n,i,s)}function aa(n){let t=n.domSelectionRange(),e=t.focusNode,r=t.focusOffset;if(!e)return;let i=ki(e),s,l;for(;;)if(r<i){if(e.nodeType!=1)break;let c=e.childNodes[r];if(ko(c))s=e,l=++r;else break}else{if(lf(e))break;{let c=e.nextSibling;for(;c&&ko(c);)s=c.parentNode,l=ae(c)+1,c=c.nextSibling;if(c)e=c,r=0,i=ki(e);else{if(e=e.parentNode,e==n.dom)break;r=i=0}}}s&&la(n,s,l)}function lf(n){let t=n.pmViewDesc;return t&&t.node&&t.node.isBlock}function la(n,t,e){let r=n.domSelection();if(bi(r)){let s=document.createRange();s.setEnd(t,e),s.setStart(t,e),r.removeAllRanges(),r.addRange(s)}else r.extend&&r.extend(t,e);n.domObserver.setCurSelection();let{state:i}=n;setTimeout(()=>{n.state==i&&gn(n)},50)}function cf(n,t,e){let r=n.state.selection;if(r instanceof pt&&!r.empty||e.indexOf("s")>-1||ye&&e.indexOf("m")>-1)return!1;let{$from:i,$to:s}=r;if(!i.parent.inlineContent||n.endOfTextblock(t<0?"up":"down")){let l=ia(n.state,t);if(l&&l instanceof Q)return ar(n,l)}if(!i.parent.inlineContent){let l=t<0?i:s,c=r instanceof se?ht.near(l,t):ht.findFrom(l,t);return c?ar(n,c):!1}return!1}function uf(n,t){if(!(n.state.selection instanceof pt))return!0;let{$head:e,$anchor:r,empty:i}=n.state.selection;if(!e.sameParent(r))return!0;if(!i)return!1;if(n.endOfTextblock(t>0?"forward":"backward"))return!0;let s=!e.textOffset&&(t<0?e.nodeBefore:e.nodeAfter);if(s&&!s.isText){let l=n.state.tr;return t<0?l.delete(e.pos-s.nodeSize,e.pos):l.delete(e.pos,e.pos+s.nodeSize),n.dispatch(l),!0}return!1}function hf(n,t,e){n.domObserver.stop(),t.contentEditable=e,n.domObserver.start()}function T1(n){if(!Wt||n.state.selection.$head.parentOffset>0)return!1;let{focusNode:t,focusOffset:e}=n.domSelectionRange();if(t&&t.nodeType==1&&e==0&&t.firstChild&&t.firstChild.contentEditable=="false"){let r=t.firstChild;hf(n,r,"true"),setTimeout(()=>hf(n,r,"false"),20)}return!1}function N1(n){let t="";return n.ctrlKey&&(t+="c"),n.metaKey&&(t+="m"),n.altKey&&(t+="a"),n.shiftKey&&(t+="s"),t}function D1(n,t){let e=t.keyCode,r=N1(t);return e==8||ye&&e==72&&r=="c"?uf(n,-1)||sa(n):e==46||ye&&e==68&&r=="c"?uf(n,1)||aa(n):e==13||e==27?!0:e==37||ye&&e==66&&r=="c"?af(n,-1,r)||sa(n):e==39||ye&&e==70&&r=="c"?af(n,1,r)||aa(n):e==38||ye&&e==80&&r=="c"?cf(n,-1,r)||sa(n):e==40||ye&&e==78&&r=="c"?T1(n)||cf(n,1,r)||aa(n):r==(ye?"m":"c")&&(e==66||e==73||e==89||e==90)}function ff(n,t){n.someProp("transformCopied",b=>{t=b(t,n)});let e=[],{content:r,openStart:i,openEnd:s}=t;for(;i>1&&s>1&&r.childCount==1&&r.firstChild.childCount==1;){i--,s--;let b=r.firstChild;e.push(b.type.name,b.attrs!=b.type.defaultAttrs?b.attrs:null),r=b.content}let l=n.someProp("clipboardSerializer")||dn.fromSchema(n.state.schema),c=wf(),h=c.createElement("div");h.appendChild(l.serializeFragment(r,{document:c}));let d=h.firstChild,m,y=0;for(;d&&d.nodeType==1&&(m=yf[d.nodeName.toLowerCase()]);){for(let b=m.length-1;b>=0;b--){let C=c.createElement(m[b]);for(;h.firstChild;)C.appendChild(h.firstChild);h.appendChild(C),y++}d=h.firstChild}d&&d.nodeType==1&&d.setAttribute("data-pm-slice",`${i} ${s}${y?` -${y}`:""} ${JSON.stringify(e)}`);let v=n.someProp("clipboardTextSerializer",b=>b(t,n))||t.content.textBetween(0,t.content.size,`

`);return{dom:h,text:v}}function df(n,t,e,r,i){let s=i.parent.type.spec.code,l,c;if(!e&&!t)return null;let h=t&&(r||s||!e);if(h){if(n.someProp("transformPastedText",v=>{t=v(t,s||r,n)}),s)return t?new W(B.from(n.state.schema.text(t.replace(/\r\n?/g,`
`))),0,0):W.empty;let y=n.someProp("clipboardTextParser",v=>v(t,i,r,n));if(y)c=y;else{let v=i.marks(),{schema:b}=n.state,C=dn.fromSchema(b);l=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach(T=>{let P=l.appendChild(document.createElement("p"));T&&P.appendChild(C.serializeNode(b.text(T,v)))})}}else n.someProp("transformPastedHTML",y=>{e=y(e,n)}),l=z1(e),wi&&j1(l);let d=l&&l.querySelector("[data-pm-slice]"),m=d&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(d.getAttribute("data-pm-slice")||"");if(m&&m[3])for(let y=+m[3];y>0;y--){let v=l.firstChild;for(;v&&v.nodeType!=1;)v=v.nextSibling;if(!v)break;l=v}if(c||(c=(n.someProp("clipboardParser")||n.someProp("domParser")||ho.fromSchema(n.state.schema)).parseSlice(l,{preserveWhitespace:!!(h||m),context:i,ruleFromNode(y){return y.nodeName=="BR"&&!y.nextSibling&&y.parentNode&&!R1.test(y.parentNode.nodeName)?{ignore:!0}:null}})),m)c=P1(_f(c,+m[1],+m[2]),m[4]);else if(c=W.maxOpen(I1(c.content,i),!0),c.openStart||c.openEnd){let y=0,v=0;for(let b=c.content.firstChild;y<c.openStart&&!b.type.spec.isolating;y++,b=b.firstChild);for(let b=c.content.lastChild;v<c.openEnd&&!b.type.spec.isolating;v++,b=b.lastChild);c=_f(c,y,v)}return n.someProp("transformPasted",y=>{c=y(c,n)}),c}const R1=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function I1(n,t){if(n.childCount<2)return n;for(let e=t.depth;e>=0;e--){let r=t.node(e).contentMatchAt(t.index(e)),i,s=[];if(n.forEach(l=>{if(!s)return;let c=r.findWrapping(l.type),h;if(!c)return s=null;if(h=s.length&&i.length&&mf(c,i,l,s[s.length-1],0))s[s.length-1]=h;else{s.length&&(s[s.length-1]=gf(s[s.length-1],i.length));let d=pf(l,c);s.push(d),r=r.matchType(d.type),i=c}}),s)return B.from(s)}return n}function pf(n,t,e=0){for(let r=t.length-1;r>=e;r--)n=t[r].create(null,B.from(n));return n}function mf(n,t,e,r,i){if(i<n.length&&i<t.length&&n[i]==t[i]){let s=mf(n,t,e,r.lastChild,i+1);if(s)return r.copy(r.content.replaceChild(r.childCount-1,s));if(r.contentMatchAt(r.childCount).matchType(i==n.length-1?e.type:n[i+1]))return r.copy(r.content.append(B.from(pf(e,n,i+1))))}}function gf(n,t){if(t==0)return n;let e=n.content.replaceChild(n.childCount-1,gf(n.lastChild,t-1)),r=n.contentMatchAt(n.childCount).fillBefore(B.empty,!0);return n.copy(e.append(r))}function ca(n,t,e,r,i,s){let l=t<0?n.firstChild:n.lastChild,c=l.content;return i<r-1&&(c=ca(c,t,e,r,i+1,s)),i>=e&&(c=t<0?l.contentMatchAt(0).fillBefore(c,n.childCount>1||s<=i).append(c):c.append(l.contentMatchAt(l.childCount).fillBefore(B.empty,!0))),n.replaceChild(t<0?0:n.childCount-1,l.copy(c))}function _f(n,t,e){return t<n.openStart&&(n=new W(ca(n.content,-1,t,n.openStart,0,n.openEnd),t,n.openEnd)),e<n.openEnd&&(n=new W(ca(n.content,1,e,n.openEnd,0,0),n.openStart,e)),n}const yf={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let bf=null;function wf(){return bf||(bf=document.implementation.createHTMLDocument("title"))}function z1(n){let t=/^(\s*<meta [^>]*>)*/.exec(n);t&&(n=n.slice(t[0].length));let e=wf().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(n),i;if((i=r&&yf[r[1].toLowerCase()])&&(n=i.map(s=>"<"+s+">").join("")+n+i.map(s=>"</"+s+">").reverse().join("")),e.innerHTML=n,i)for(let s=0;s<i.length;s++)e=e.querySelector(i[s])||e;return e}function j1(n){let t=n.querySelectorAll(Lt?"span:not([class]):not([style])":"span.Apple-converted-space");for(let e=0;e<t.length;e++){let r=t[e];r.childNodes.length==1&&r.textContent=="\xA0"&&r.parentNode&&r.parentNode.replaceChild(n.ownerDocument.createTextNode(" "),r)}}function P1(n,t){if(!n.size)return n;let e=n.content.firstChild.type.schema,r;try{r=JSON.parse(t)}catch{return n}let{content:i,openStart:s,openEnd:l}=n;for(let c=r.length-2;c>=0;c-=2){let h=e.nodes[r[c]];if(!h||h.hasRequiredAttrs())break;i=B.from(h.create(r[c+1],i)),s++,l++}return new W(i,s,l)}const qt={},Jt={},B1={touchstart:!0,touchmove:!0};class $1{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastAndroidDelete=0,this.composing=!1,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function F1(n){for(let t in qt){let e=qt[t];n.dom.addEventListener(t,n.input.eventHandlers[t]=r=>{L1(n,r)&&!ha(n,r)&&(n.editable||!(r.type in Jt))&&e(n,r)},B1[t]?{passive:!0}:void 0)}Wt&&n.dom.addEventListener("input",()=>null),ua(n)}function jn(n,t){n.input.lastSelectionOrigin=t,n.input.lastSelectionTime=Date.now()}function V1(n){n.domObserver.stop();for(let t in n.input.eventHandlers)n.dom.removeEventListener(t,n.input.eventHandlers[t]);clearTimeout(n.input.composingTimeout),clearTimeout(n.input.lastIOSEnterFallbackTimeout)}function ua(n){n.someProp("handleDOMEvents",t=>{for(let e in t)n.input.eventHandlers[e]||n.dom.addEventListener(e,n.input.eventHandlers[e]=r=>ha(n,r))})}function ha(n,t){return n.someProp("handleDOMEvents",e=>{let r=e[t.type];return r?r(n,t)||t.defaultPrevented:!1})}function L1(n,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let e=t.target;e!=n.dom;e=e.parentNode)if(!e||e.nodeType==11||e.pmViewDesc&&e.pmViewDesc.stopEvent(t))return!1;return!0}function W1(n,t){!ha(n,t)&&qt[t.type]&&(n.editable||!(t.type in Jt))&&qt[t.type](n,t)}Jt.keydown=(n,t)=>{let e=t;if(n.input.shiftKey=e.keyCode==16||e.shiftKey,!kf(n,e)&&(n.input.lastKeyCode=e.keyCode,n.input.lastKeyCodeTime=Date.now(),!(De&&Lt&&e.keyCode==13)))if(e.keyCode!=229&&n.domObserver.forceFlush(),Tr&&e.keyCode==13&&!e.ctrlKey&&!e.altKey&&!e.metaKey){let r=Date.now();n.input.lastIOSEnter=r,n.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{n.input.lastIOSEnter==r&&(n.someProp("handleKeyDown",i=>i(n,rr(13,"Enter"))),n.input.lastIOSEnter=0)},200)}else n.someProp("handleKeyDown",r=>r(n,e))||D1(n,e)?e.preventDefault():jn(n,"key")},Jt.keyup=(n,t)=>{t.keyCode==16&&(n.input.shiftKey=!1)},Jt.keypress=(n,t)=>{let e=t;if(kf(n,e)||!e.charCode||e.ctrlKey&&!e.altKey||ye&&e.metaKey)return;if(n.someProp("handleKeyPress",i=>i(n,e))){e.preventDefault();return}let r=n.state.selection;if(!(r instanceof pt)||!r.$from.sameParent(r.$to)){let i=String.fromCharCode(e.charCode);!/[\r\n]/.test(i)&&!n.someProp("handleTextInput",s=>s(n,r.$from.pos,r.$to.pos,i))&&n.dispatch(n.state.tr.insertText(i).scrollIntoView()),e.preventDefault()}};function xi(n){return{left:n.clientX,top:n.clientY}}function q1(n,t){let e=t.x-n.clientX,r=t.y-n.clientY;return e*e+r*r<100}function fa(n,t,e,r,i){if(r==-1)return!1;let s=n.state.doc.resolve(r);for(let l=s.depth+1;l>0;l--)if(n.someProp(t,c=>l>s.depth?c(n,e,s.nodeAfter,s.before(l),i,!0):c(n,e,s.node(l),s.before(l),i,!1)))return!0;return!1}function Rr(n,t,e){n.focused||n.focus();let r=n.state.tr.setSelection(t);e=="pointer"&&r.setMeta("pointer",!0),n.dispatch(r)}function J1(n,t){if(t==-1)return!1;let e=n.state.doc.resolve(t),r=e.nodeAfter;return r&&r.isAtom&&Q.isSelectable(r)?(Rr(n,new Q(e),"pointer"),!0):!1}function U1(n,t){if(t==-1)return!1;let e=n.state.selection,r,i;e instanceof Q&&(r=e.node);let s=n.state.doc.resolve(t);for(let l=s.depth+1;l>0;l--){let c=l>s.depth?s.nodeAfter:s.node(l);if(Q.isSelectable(c)){r&&e.$from.depth>0&&l>=e.$from.depth&&s.before(e.$from.depth+1)==e.$from.pos?i=s.before(e.$from.depth):i=s.before(l);break}}return i!=null?(Rr(n,Q.create(n.state.doc,i),"pointer"),!0):!1}function K1(n,t,e,r,i){return fa(n,"handleClickOn",t,e,r)||n.someProp("handleClick",s=>s(n,t,r))||(i?U1(n,e):J1(n,e))}function H1(n,t,e,r){return fa(n,"handleDoubleClickOn",t,e,r)||n.someProp("handleDoubleClick",i=>i(n,t,r))}function G1(n,t,e,r){return fa(n,"handleTripleClickOn",t,e,r)||n.someProp("handleTripleClick",i=>i(n,t,r))||Z1(n,e,r)}function Z1(n,t,e){if(e.button!=0)return!1;let r=n.state.doc;if(t==-1)return r.inlineContent?(Rr(n,pt.create(r,0,r.content.size),"pointer"),!0):!1;let i=r.resolve(t);for(let s=i.depth+1;s>0;s--){let l=s>i.depth?i.nodeAfter:i.node(s),c=i.before(s);if(l.inlineContent)Rr(n,pt.create(r,c+1,c+1+l.content.size),"pointer");else if(Q.isSelectable(l))Rr(n,Q.create(r,c),"pointer");else continue;return!0}}function da(n){return Si(n)}const vf=ye?"metaKey":"ctrlKey";qt.mousedown=(n,t)=>{let e=t;n.input.shiftKey=e.shiftKey;let r=da(n),i=Date.now(),s="singleClick";i-n.input.lastClick.time<500&&q1(e,n.input.lastClick)&&!e[vf]&&(n.input.lastClick.type=="singleClick"?s="doubleClick":n.input.lastClick.type=="doubleClick"&&(s="tripleClick")),n.input.lastClick={time:i,x:e.clientX,y:e.clientY,type:s};let l=n.posAtCoords(xi(e));!l||(s=="singleClick"?(n.input.mouseDown&&n.input.mouseDown.done(),n.input.mouseDown=new Y1(n,l,e,!!r)):(s=="doubleClick"?H1:G1)(n,l.pos,l.inside,e)?e.preventDefault():jn(n,"pointer"))};class Y1{constructor(t,e,r,i){this.view=t,this.pos=e,this.event=r,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=t.state.doc,this.selectNode=!!r[vf],this.allowDefault=r.shiftKey;let s,l;if(e.inside>-1)s=t.state.doc.nodeAt(e.inside),l=e.inside;else{let m=t.state.doc.resolve(e.pos);s=m.parent,l=m.depth?m.before():0}const c=i?null:r.target,h=c?t.docView.nearestDesc(c,!0):null;this.target=h?h.dom:null;let{selection:d}=t.state;(r.button==0&&s.type.spec.draggable&&s.type.spec.selectable!==!1||d instanceof Q&&d.from<=l&&d.to>l)&&(this.mightDrag={node:s,pos:l,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Ne&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),t.root.addEventListener("mouseup",this.up=this.up.bind(this)),t.root.addEventListener("mousemove",this.move=this.move.bind(this)),jn(t,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>gn(this.view)),this.view.input.mouseDown=null}up(t){if(this.done(),!this.view.dom.contains(t.target))return;let e=this.pos;this.view.state.doc!=this.startDoc&&(e=this.view.posAtCoords(xi(t))),this.updateAllowDefault(t),this.allowDefault||!e?jn(this.view,"pointer"):K1(this.view,e.pos,e.inside,t,this.selectNode)?t.preventDefault():t.button==0&&(this.flushed||Wt&&this.mightDrag&&!this.mightDrag.node.isAtom||Lt&&!this.view.state.selection.visible&&Math.min(Math.abs(e.pos-this.view.state.selection.from),Math.abs(e.pos-this.view.state.selection.to))<=2)?(Rr(this.view,ht.near(this.view.state.doc.resolve(e.pos)),"pointer"),t.preventDefault()):jn(this.view,"pointer")}move(t){this.updateAllowDefault(t),jn(this.view,"pointer"),t.buttons==0&&this.done()}updateAllowDefault(t){!this.allowDefault&&(Math.abs(this.event.x-t.clientX)>4||Math.abs(this.event.y-t.clientY)>4)&&(this.allowDefault=!0)}}qt.touchstart=n=>{n.input.lastTouch=Date.now(),da(n),jn(n,"pointer")},qt.touchmove=n=>{n.input.lastTouch=Date.now(),jn(n,"pointer")},qt.contextmenu=n=>da(n);function kf(n,t){return n.composing?!0:Wt&&Math.abs(t.timeStamp-n.input.compositionEndedAt)<500?(n.input.compositionEndedAt=-2e8,!0):!1}const X1=De?5e3:-1;Jt.compositionstart=Jt.compositionupdate=n=>{if(!n.composing){n.domObserver.flush();let{state:t}=n,e=t.selection.$from;if(t.selection.empty&&(t.storedMarks||!e.textOffset&&e.parentOffset&&e.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))n.markCursor=n.state.storedMarks||e.marks(),Si(n,!0),n.markCursor=null;else if(Si(n),Ne&&t.selection.empty&&e.parentOffset&&!e.textOffset&&e.nodeBefore.marks.length){let r=n.domSelectionRange();for(let i=r.focusNode,s=r.focusOffset;i&&i.nodeType==1&&s!=0;){let l=s<0?i.lastChild:i.childNodes[s-1];if(!l)break;if(l.nodeType==3){n.domSelection().collapse(l,l.nodeValue.length);break}else i=l,s=-1}}n.input.composing=!0}xf(n,X1)},Jt.compositionend=(n,t)=>{n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=t.timeStamp,xf(n,20))};function xf(n,t){clearTimeout(n.input.composingTimeout),t>-1&&(n.input.composingTimeout=setTimeout(()=>Si(n),t))}function Sf(n){for(n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=Q1());n.input.compositionNodes.length>0;)n.input.compositionNodes.pop().markParentsDirty()}function Q1(){let n=document.createEvent("Event");return n.initEvent("event",!0,!0),n.timeStamp}function Si(n,t=!1){if(!(De&&n.domObserver.flushingSoon>=0)){if(n.domObserver.forceFlush(),Sf(n),t||n.docView&&n.docView.dirty){let e=na(n);return e&&!e.eq(n.state.selection)?n.dispatch(n.state.tr.setSelection(e)):n.updateState(n.state),!0}return!1}}function ty(n,t){if(!n.dom.parentNode)return;let e=n.dom.parentNode.appendChild(document.createElement("div"));e.appendChild(t),e.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),i=document.createRange();i.selectNodeContents(t),n.dom.blur(),r.removeAllRanges(),r.addRange(i),setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e),n.focus()},50)}const Ir=Yt&&Rn<15||Tr&&e1<604;qt.copy=Jt.cut=(n,t)=>{let e=t,r=n.state.selection,i=e.type=="cut";if(r.empty)return;let s=Ir?null:e.clipboardData,l=r.content(),{dom:c,text:h}=ff(n,l);s?(e.preventDefault(),s.clearData(),s.setData("text/html",c.innerHTML),s.setData("text/plain",h)):ty(n,c),i&&n.dispatch(n.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function ey(n){return n.openStart==0&&n.openEnd==0&&n.content.childCount==1?n.content.firstChild:null}function ny(n,t){if(!n.dom.parentNode)return;let e=n.input.shiftKey||n.state.selection.$from.parent.type.spec.code,r=n.dom.parentNode.appendChild(document.createElement(e?"textarea":"div"));e||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus(),setTimeout(()=>{n.focus(),r.parentNode&&r.parentNode.removeChild(r),e?xo(n,r.value,null,n.input.shiftKey,t):xo(n,r.textContent,r.innerHTML,n.input.shiftKey,t)},50)}function xo(n,t,e,r,i){let s=df(n,t,e,r,n.state.selection.$from);if(n.someProp("handlePaste",h=>h(n,i,s||W.empty)))return!0;if(!s)return!1;let l=ey(s),c=l?n.state.tr.replaceSelectionWith(l,n.input.shiftKey):n.state.tr.replaceSelection(s);return n.dispatch(c.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}Jt.paste=(n,t)=>{let e=t;if(n.composing&&!De)return;let r=Ir?null:e.clipboardData;r&&xo(n,r.getData("text/plain"),r.getData("text/html"),n.input.shiftKey,e)?e.preventDefault():ny(n,e)};class ry{constructor(t,e){this.slice=t,this.move=e}}const Cf=ye?"altKey":"ctrlKey";qt.dragstart=(n,t)=>{let e=t,r=n.input.mouseDown;if(r&&r.done(),!e.dataTransfer)return;let i=n.state.selection,s=i.empty?null:n.posAtCoords(xi(e));if(!(s&&s.pos>=i.from&&s.pos<=(i instanceof Q?i.to-1:i.to))){if(r&&r.mightDrag)n.dispatch(n.state.tr.setSelection(Q.create(n.state.doc,r.mightDrag.pos)));else if(e.target&&e.target.nodeType==1){let d=n.docView.nearestDesc(e.target,!0);d&&d.node.type.spec.draggable&&d!=n.docView&&n.dispatch(n.state.tr.setSelection(Q.create(n.state.doc,d.posBefore)))}}let l=n.state.selection.content(),{dom:c,text:h}=ff(n,l);e.dataTransfer.clearData(),e.dataTransfer.setData(Ir?"Text":"text/html",c.innerHTML),e.dataTransfer.effectAllowed="copyMove",Ir||e.dataTransfer.setData("text/plain",h),n.dragging=new ry(l,!e[Cf])},qt.dragend=n=>{let t=n.dragging;window.setTimeout(()=>{n.dragging==t&&(n.dragging=null)},50)},Jt.dragover=Jt.dragenter=(n,t)=>t.preventDefault(),Jt.drop=(n,t)=>{let e=t,r=n.dragging;if(n.dragging=null,!e.dataTransfer)return;let i=n.posAtCoords(xi(e));if(!i)return;let s=n.state.doc.resolve(i.pos),l=r&&r.slice;l?n.someProp("transformPasted",C=>{l=C(l,n)}):l=df(n,e.dataTransfer.getData(Ir?"Text":"text/plain"),Ir?null:e.dataTransfer.getData("text/html"),!1,s);let c=!!(r&&!e[Cf]);if(n.someProp("handleDrop",C=>C(n,e,l||W.empty,c))){e.preventDefault();return}if(!l)return;e.preventDefault();let h=l?j_(n.state.doc,s.pos,l):s.pos;h==null&&(h=s.pos);let d=n.state.tr;c&&d.deleteSelection();let m=d.mapping.map(h),y=l.openStart==0&&l.openEnd==0&&l.content.childCount==1,v=d.doc;if(y?d.replaceRangeWith(m,m,l.content.firstChild):d.replaceRange(m,m,l),d.doc.eq(v))return;let b=d.doc.resolve(m);if(y&&Q.isSelectable(l.content.firstChild)&&b.nodeAfter&&b.nodeAfter.sameMarkup(l.content.firstChild))d.setSelection(new Q(b));else{let C=d.mapping.map(h);d.mapping.maps[d.mapping.maps.length-1].forEach((T,P,J,mt)=>C=mt),d.setSelection(oa(n,b,d.doc.resolve(C)))}n.focus(),n.dispatch(d.setMeta("uiEvent","drop"))},qt.focus=n=>{n.input.lastFocus=Date.now(),n.focused||(n.domObserver.stop(),n.dom.classList.add("ProseMirror-focused"),n.domObserver.start(),n.focused=!0,setTimeout(()=>{n.docView&&n.hasFocus()&&!n.domObserver.currentSelection.eq(n.domSelectionRange())&&gn(n)},20))},qt.blur=(n,t)=>{let e=t;n.focused&&(n.domObserver.stop(),n.dom.classList.remove("ProseMirror-focused"),n.domObserver.start(),e.relatedTarget&&n.dom.contains(e.relatedTarget)&&n.domObserver.currentSelection.clear(),n.focused=!1)},qt.beforeinput=(n,t)=>{if(Lt&&De&&t.inputType=="deleteContentBackward"){n.domObserver.flushSoon();let{domChangeCount:e}=n.input;setTimeout(()=>{if(n.input.domChangeCount!=e||(n.dom.blur(),n.focus(),n.someProp("handleKeyDown",i=>i(n,rr(8,"Backspace")))))return;let{$cursor:r}=n.state.selection;r&&r.pos>0&&n.dispatch(n.state.tr.delete(r.pos-1,r.pos).scrollIntoView())},50)}};for(let n in Jt)qt[n]=Jt[n];function So(n,t){if(n==t)return!0;for(let e in n)if(n[e]!==t[e])return!1;for(let e in t)if(!(e in n))return!1;return!0}class pa{constructor(t,e){this.toDOM=t,this.spec=e||lr,this.side=this.spec.side||0}map(t,e,r,i){let{pos:s,deleted:l}=t.mapResult(e.from+i,this.side<0?-1:1);return l?null:new Ie(s-r,s-r,this)}valid(){return!0}eq(t){return this==t||t instanceof pa&&(this.spec.key&&this.spec.key==t.spec.key||this.toDOM==t.toDOM&&So(this.spec,t.spec))}destroy(t){this.spec.destroy&&this.spec.destroy(t)}}class Pn{constructor(t,e){this.attrs=t,this.spec=e||lr}map(t,e,r,i){let s=t.map(e.from+i,this.spec.inclusiveStart?-1:1)-r,l=t.map(e.to+i,this.spec.inclusiveEnd?1:-1)-r;return s>=l?null:new Ie(s,l,this)}valid(t,e){return e.from<e.to}eq(t){return this==t||t instanceof Pn&&So(this.attrs,t.attrs)&&So(this.spec,t.spec)}static is(t){return t.type instanceof Pn}destroy(){}}class ma{constructor(t,e){this.attrs=t,this.spec=e||lr}map(t,e,r,i){let s=t.mapResult(e.from+i,1);if(s.deleted)return null;let l=t.mapResult(e.to+i,-1);return l.deleted||l.pos<=s.pos?null:new Ie(s.pos-r,l.pos-r,this)}valid(t,e){let{index:r,offset:i}=t.content.findIndex(e.from),s;return i==e.from&&!(s=t.child(r)).isText&&i+s.nodeSize==e.to}eq(t){return this==t||t instanceof ma&&So(this.attrs,t.attrs)&&So(this.spec,t.spec)}destroy(){}}class Ie{constructor(t,e,r){this.from=t,this.to=e,this.type=r}copy(t,e){return new Ie(t,e,this.type)}eq(t,e=0){return this.type.eq(t.type)&&this.from+e==t.from&&this.to+e==t.to}map(t,e,r){return this.type.map(t,this,e,r)}static widget(t,e,r){return new Ie(t,t,new pa(e,r))}static inline(t,e,r,i){return new Ie(t,e,new Pn(r,i))}static node(t,e,r,i){return new Ie(t,e,new ma(r,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof Pn}}const zr=[],lr={};class Et{constructor(t,e){this.local=t.length?t:zr,this.children=e.length?e:zr}static create(t,e){return e.length?Ci(e,t,0,lr):$t}find(t,e,r){let i=[];return this.findInner(t!=null?t:0,e!=null?e:1e9,i,0,r),i}findInner(t,e,r,i,s){for(let l=0;l<this.local.length;l++){let c=this.local[l];c.from<=e&&c.to>=t&&(!s||s(c.spec))&&r.push(c.copy(c.from+i,c.to+i))}for(let l=0;l<this.children.length;l+=3)if(this.children[l]<e&&this.children[l+1]>t){let c=this.children[l]+1;this.children[l+2].findInner(t-c,e-c,r,i+c,s)}}map(t,e,r){return this==$t||t.maps.length==0?this:this.mapInner(t,e,0,0,r||lr)}mapInner(t,e,r,i,s){let l;for(let c=0;c<this.local.length;c++){let h=this.local[c].map(t,r,i);h&&h.type.valid(e,h)?(l||(l=[])).push(h):s.onRemove&&s.onRemove(this.local[c].spec)}return this.children.length?oy(this.children,l||[],t,e,r,i,s):l?new Et(l.sort(cr),zr):$t}add(t,e){return e.length?this==$t?Et.create(t,e):this.addInner(t,e,0):this}addInner(t,e,r){let i,s=0;t.forEach((c,h)=>{let d=h+r,m;if(m=Mf(e,c,d)){for(i||(i=this.children.slice());s<i.length&&i[s]<h;)s+=3;i[s]==h?i[s+2]=i[s+2].addInner(c,m,d+1):i.splice(s,0,h,h+c.nodeSize,Ci(m,c,d+1,lr)),s+=3}});let l=Of(s?Af(e):e,-r);for(let c=0;c<l.length;c++)l[c].type.valid(t,l[c])||l.splice(c--,1);return new Et(l.length?this.local.concat(l).sort(cr):this.local,i||this.children)}remove(t){return t.length==0||this==$t?this:this.removeInner(t,0)}removeInner(t,e){let r=this.children,i=this.local;for(let s=0;s<r.length;s+=3){let l,c=r[s]+e,h=r[s+1]+e;for(let m=0,y;m<t.length;m++)(y=t[m])&&y.from>c&&y.to<h&&(t[m]=null,(l||(l=[])).push(y));if(!l)continue;r==this.children&&(r=this.children.slice());let d=r[s+2].removeInner(l,c+1);d!=$t?r[s+2]=d:(r.splice(s,3),s-=3)}if(i.length){for(let s=0,l;s<t.length;s++)if(l=t[s])for(let c=0;c<i.length;c++)i[c].eq(l,e)&&(i==this.local&&(i=this.local.slice()),i.splice(c--,1))}return r==this.children&&i==this.local?this:i.length||r.length?new Et(i,r):$t}forChild(t,e){if(this==$t)return this;if(e.isLeaf)return Et.empty;let r,i;for(let c=0;c<this.children.length;c+=3)if(this.children[c]>=t){this.children[c]==t&&(r=this.children[c+2]);break}let s=t+1,l=s+e.content.size;for(let c=0;c<this.local.length;c++){let h=this.local[c];if(h.from<l&&h.to>s&&h.type instanceof Pn){let d=Math.max(s,h.from)-s,m=Math.min(l,h.to)-s;d<m&&(i||(i=[])).push(h.copy(d,m))}}if(i){let c=new Et(i.sort(cr),zr);return r?new Bn([c,r]):c}return r||$t}eq(t){if(this==t)return!0;if(!(t instanceof Et)||this.local.length!=t.local.length||this.children.length!=t.children.length)return!1;for(let e=0;e<this.local.length;e++)if(!this.local[e].eq(t.local[e]))return!1;for(let e=0;e<this.children.length;e+=3)if(this.children[e]!=t.children[e]||this.children[e+1]!=t.children[e+1]||!this.children[e+2].eq(t.children[e+2]))return!1;return!0}locals(t){return ga(this.localsInner(t))}localsInner(t){if(this==$t)return zr;if(t.inlineContent||!this.local.some(Pn.is))return this.local;let e=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof Pn||e.push(this.local[r]);return e}}Et.empty=new Et([],[]),Et.removeOverlap=ga;const $t=Et.empty;class Bn{constructor(t){this.members=t}map(t,e){const r=this.members.map(i=>i.map(t,e,lr));return Bn.from(r)}forChild(t,e){if(e.isLeaf)return Et.empty;let r=[];for(let i=0;i<this.members.length;i++){let s=this.members[i].forChild(t,e);s!=$t&&(s instanceof Bn?r=r.concat(s.members):r.push(s))}return Bn.from(r)}eq(t){if(!(t instanceof Bn)||t.members.length!=this.members.length)return!1;for(let e=0;e<this.members.length;e++)if(!this.members[e].eq(t.members[e]))return!1;return!0}locals(t){let e,r=!0;for(let i=0;i<this.members.length;i++){let s=this.members[i].localsInner(t);if(s.length)if(!e)e=s;else{r&&(e=e.slice(),r=!1);for(let l=0;l<s.length;l++)e.push(s[l])}}return e?ga(r?e:e.sort(cr)):zr}static from(t){switch(t.length){case 0:return $t;case 1:return t[0];default:return new Bn(t.every(e=>e instanceof Et)?t:t.reduce((e,r)=>e.concat(r instanceof Et?r:r.members),[]))}}}function oy(n,t,e,r,i,s,l){let c=n.slice();for(let d=0,m=s;d<e.maps.length;d++){let y=0;e.maps[d].forEach((v,b,C,T)=>{let P=T-C-(b-v);for(let J=0;J<c.length;J+=3){let mt=c[J+1];if(mt<0||v>mt+m-y)continue;let st=c[J]+m-y;b>=st?c[J+1]=v<=st?-2:-1:C>=i&&P&&(c[J]+=P,c[J+1]+=P)}y+=P}),m=e.maps[d].map(m,-1)}let h=!1;for(let d=0;d<c.length;d+=3)if(c[d+1]<0){if(c[d+1]==-2){h=!0,c[d+1]=-1;continue}let m=e.map(n[d]+s),y=m-i;if(y<0||y>=r.content.size){h=!0;continue}let v=e.map(n[d+1]+s,-1),b=v-i,{index:C,offset:T}=r.content.findIndex(y),P=r.maybeChild(C);if(P&&T==y&&T+P.nodeSize==b){let J=c[d+2].mapInner(e,P,m+1,n[d]+s+1,l);J!=$t?(c[d]=y,c[d+1]=b,c[d+2]=J):(c[d+1]=-2,h=!0)}else h=!0}if(h){let d=iy(c,n,t,e,i,s,l),m=Ci(d,r,0,l);t=m.local;for(let y=0;y<c.length;y+=3)c[y+1]<0&&(c.splice(y,3),y-=3);for(let y=0,v=0;y<m.children.length;y+=3){let b=m.children[y];for(;v<c.length&&c[v]<b;)v+=3;c.splice(v,0,m.children[y],m.children[y+1],m.children[y+2])}}return new Et(t.sort(cr),c)}function Of(n,t){if(!t||!n.length)return n;let e=[];for(let r=0;r<n.length;r++){let i=n[r];e.push(new Ie(i.from+t,i.to+t,i.type))}return e}function iy(n,t,e,r,i,s,l){function c(h,d){for(let m=0;m<h.local.length;m++){let y=h.local[m].map(r,i,d);y?e.push(y):l.onRemove&&l.onRemove(h.local[m].spec)}for(let m=0;m<h.children.length;m+=3)c(h.children[m+2],h.children[m]+d+1)}for(let h=0;h<n.length;h+=3)n[h+1]==-1&&c(n[h+2],t[h]+s+1);return e}function Mf(n,t,e){if(t.isLeaf)return null;let r=e+t.nodeSize,i=null;for(let s=0,l;s<n.length;s++)(l=n[s])&&l.from>e&&l.to<r&&((i||(i=[])).push(l),n[s]=null);return i}function Af(n){let t=[];for(let e=0;e<n.length;e++)n[e]!=null&&t.push(n[e]);return t}function Ci(n,t,e,r){let i=[],s=!1;t.forEach((c,h)=>{let d=Mf(n,c,h+e);if(d){s=!0;let m=Ci(d,c,e+h+1,r);m!=$t&&i.push(h,h+c.nodeSize,m)}});let l=Of(s?Af(n):n,-e).sort(cr);for(let c=0;c<l.length;c++)l[c].type.valid(t,l[c])||(r.onRemove&&r.onRemove(l[c].spec),l.splice(c--,1));return l.length||i.length?new Et(l,i):$t}function cr(n,t){return n.from-t.from||n.to-t.to}function ga(n){let t=n;for(let e=0;e<t.length-1;e++){let r=t[e];if(r.from!=r.to)for(let i=e+1;i<t.length;i++){let s=t[i];if(s.from==r.from){s.to!=r.to&&(t==n&&(t=n.slice()),t[i]=s.copy(s.from,r.to),Ef(t,i+1,s.copy(r.to,s.to)));continue}else{s.from<r.to&&(t==n&&(t=n.slice()),t[e]=r.copy(r.from,s.from),Ef(t,i,r.copy(s.from,r.to)));break}}}return t}function Ef(n,t,e){for(;t<n.length&&cr(e,n[t])>0;)t++;n.splice(t,0,e)}function _a(n){let t=[];return n.someProp("decorations",e=>{let r=e(n.state);r&&r!=$t&&t.push(r)}),n.cursorWrapper&&t.push(Et.create(n.state.doc,[n.cursorWrapper.deco])),Bn.from(t)}const sy={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},ay=Yt&&Rn<=11;class ly{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(t){this.anchorNode=t.anchorNode,this.anchorOffset=t.anchorOffset,this.focusNode=t.focusNode,this.focusOffset=t.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(t){return t.anchorNode==this.anchorNode&&t.anchorOffset==this.anchorOffset&&t.focusNode==this.focusNode&&t.focusOffset==this.focusOffset}}class cy{constructor(t,e){this.view=t,this.handleDOMChange=e,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new ly,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let i=0;i<r.length;i++)this.queue.push(r[i]);Yt&&Rn<=11&&r.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),ay&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,sy)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let t=this.observer.takeRecords();if(t.length){for(let e=0;e<t.length;e++)this.queue.push(t[e]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(of(this.view)){if(this.suppressingSelectionUpdates)return gn(this.view);if(Yt&&Rn<=11&&!this.view.state.selection.empty){let t=this.view.domSelectionRange();if(t.focusNode&&nr(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(t){if(!t.focusNode)return!0;let e=new Set,r;for(let s=t.focusNode;s;s=yo(s))e.add(s);for(let s=t.anchorNode;s;s=yo(s))if(e.has(s)){r=s;break}let i=r&&this.view.docView.nearestDesc(r);if(i&&i.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}flush(){let{view:t}=this;if(!t.docView||this.flushingSoon>-1)return;let e=this.observer?this.observer.takeRecords():[];this.queue.length&&(e=this.queue.concat(e),this.queue.length=0);let r=t.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&of(t)&&!this.ignoreSelectionChange(r),s=-1,l=-1,c=!1,h=[];if(t.editable)for(let m=0;m<e.length;m++){let y=this.registerMutation(e[m],h);y&&(s=s<0?y.from:Math.min(y.from,s),l=l<0?y.to:Math.max(y.to,l),y.typeOver&&(c=!0))}if(Ne&&h.length>1){let m=h.filter(y=>y.nodeName=="BR");if(m.length==2){let y=m[0],v=m[1];y.parentNode&&y.parentNode.parentNode==v.parentNode?v.remove():y.remove()}}let d=null;s<0&&i&&t.input.lastFocus>Date.now()-200&&Math.max(t.input.lastTouch,t.input.lastClick.time)<Date.now()-300&&bi(r)&&(d=na(t))&&d.eq(ht.near(t.state.doc.resolve(0),1))?(t.input.lastFocus=0,gn(t),this.currentSelection.set(r),t.scrollToSelection()):(s>-1||i)&&(s>-1&&(t.docView.markDirty(s,l),uy(t)),this.handleDOMChange(s,l,c,h),t.docView&&t.docView.dirty?t.updateState(t.state):this.currentSelection.eq(r)||gn(t),this.currentSelection.set(r))}registerMutation(t,e){if(e.indexOf(t.target)>-1)return null;let r=this.view.docView.nearestDesc(t.target);if(t.type=="attributes"&&(r==this.view.docView||t.attributeName=="contenteditable"||t.attributeName=="style"&&!t.oldValue&&!t.target.getAttribute("style"))||!r||r.ignoreMutation(t))return null;if(t.type=="childList"){for(let m=0;m<t.addedNodes.length;m++)e.push(t.addedNodes[m]);if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(t.target))return{from:r.posBefore,to:r.posAfter};let i=t.previousSibling,s=t.nextSibling;if(Yt&&Rn<=11&&t.addedNodes.length)for(let m=0;m<t.addedNodes.length;m++){let{previousSibling:y,nextSibling:v}=t.addedNodes[m];(!y||Array.prototype.indexOf.call(t.addedNodes,y)<0)&&(i=y),(!v||Array.prototype.indexOf.call(t.addedNodes,v)<0)&&(s=v)}let l=i&&i.parentNode==t.target?ae(i)+1:0,c=r.localPosFromDOM(t.target,l,-1),h=s&&s.parentNode==t.target?ae(s):t.target.childNodes.length,d=r.localPosFromDOM(t.target,h,1);return{from:c,to:d}}else return t.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:{from:r.posAtStart,to:r.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}}}let Tf=new WeakMap,Nf=!1;function uy(n){if(!Tf.has(n)&&(Tf.set(n,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(n.dom).whiteSpace)!==-1)){if(n.requiresGeckoHackNode=Ne,Nf)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),Nf=!0}}function hy(n){let t;function e(h){h.preventDefault(),h.stopImmediatePropagation(),t=h.getTargetRanges()[0]}n.dom.addEventListener("beforeinput",e,!0),document.execCommand("indent"),n.dom.removeEventListener("beforeinput",e,!0);let r=t.startContainer,i=t.startOffset,s=t.endContainer,l=t.endOffset,c=n.domAtPos(n.state.selection.anchor);return nr(c.node,c.offset,s,l)&&([r,i,s,l]=[s,l,r,i]),{anchorNode:r,anchorOffset:i,focusNode:s,focusOffset:l}}function fy(n,t,e){let{node:r,fromOffset:i,toOffset:s,from:l,to:c}=n.docView.parseRange(t,e),h=n.domSelectionRange(),d,m=h.anchorNode;if(m&&n.dom.contains(m.nodeType==1?m:m.parentNode)&&(d=[{node:m,offset:h.anchorOffset}],bi(h)||d.push({node:h.focusNode,offset:h.focusOffset})),Lt&&n.input.lastKeyCode===8)for(let P=s;P>i;P--){let J=r.childNodes[P-1],mt=J.pmViewDesc;if(J.nodeName=="BR"&&!mt){s=P;break}if(!mt||mt.size)break}let y=n.state.doc,v=n.someProp("domParser")||ho.fromSchema(n.state.schema),b=y.resolve(l),C=null,T=v.parse(r,{topNode:b.parent,topMatch:b.parent.contentMatchAt(b.index()),topOpen:!0,from:i,to:s,preserveWhitespace:b.parent.type.whitespace=="pre"?"full":!0,findPositions:d,ruleFromNode:dy,context:b});if(d&&d[0].pos!=null){let P=d[0].pos,J=d[1]&&d[1].pos;J==null&&(J=P),C={anchor:P+l,head:J+l}}return{doc:T,sel:C,from:l,to:c}}function dy(n){let t=n.pmViewDesc;if(t)return t.parseRule();if(n.nodeName=="BR"&&n.parentNode){if(Wt&&/^(ul|ol)$/i.test(n.parentNode.nodeName)){let e=document.createElement("div");return e.appendChild(document.createElement("li")),{skip:e}}else if(n.parentNode.lastChild==n||Wt&&/^(tr|table)$/i.test(n.parentNode.nodeName))return{ignore:!0}}else if(n.nodeName=="IMG"&&n.getAttribute("mark-placeholder"))return{ignore:!0};return null}function py(n,t,e,r,i){if(t<0){let tt=n.input.lastSelectionTime>Date.now()-50?n.input.lastSelectionOrigin:null,yn=na(n,tt);if(yn&&!n.state.selection.eq(yn)){if(Lt&&De&&n.input.lastKeyCode===13&&Date.now()-100<n.input.lastKeyCodeTime&&n.someProp("handleKeyDown",Ea=>Ea(n,rr(13,"Enter"))))return;let Mo=n.state.tr.setSelection(yn);tt=="pointer"?Mo.setMeta("pointer",!0):tt=="key"&&Mo.scrollIntoView(),n.dispatch(Mo)}return}let s=n.state.doc.resolve(t),l=s.sharedDepth(e);t=s.before(l+1),e=n.state.doc.resolve(e).after(l+1);let c=n.state.selection,h=fy(n,t,e),d=n.state.doc,m=d.slice(h.from,h.to),y,v;n.input.lastKeyCode===8&&Date.now()-100<n.input.lastKeyCodeTime?(y=n.state.selection.to,v="end"):(y=n.state.selection.from,v="start"),n.input.lastKeyCode=null;let b=_y(m.content,h.doc.content,h.from,y,v);if((Tr&&n.input.lastIOSEnter>Date.now()-225||De)&&i.some(tt=>tt.nodeName=="DIV"||tt.nodeName=="P"||tt.nodeName=="LI")&&(!b||b.endA>=b.endB)&&n.someProp("handleKeyDown",tt=>tt(n,rr(13,"Enter")))){n.input.lastIOSEnter=0;return}if(!b)if(r&&c instanceof pt&&!c.empty&&c.$head.sameParent(c.$anchor)&&!n.composing&&!(h.sel&&h.sel.anchor!=h.sel.head))b={start:c.from,endA:c.to,endB:c.to};else{if(h.sel){let tt=Df(n,n.state.doc,h.sel);tt&&!tt.eq(n.state.selection)&&n.dispatch(n.state.tr.setSelection(tt))}return}if(Lt&&n.cursorWrapper&&h.sel&&h.sel.anchor==n.cursorWrapper.deco.from&&h.sel.head==h.sel.anchor){let tt=b.endB-b.start;h.sel={anchor:h.sel.anchor+tt,head:h.sel.anchor+tt}}n.input.domChangeCount++,n.state.selection.from<n.state.selection.to&&b.start==b.endB&&n.state.selection instanceof pt&&(b.start>n.state.selection.from&&b.start<=n.state.selection.from+2&&n.state.selection.from>=h.from?b.start=n.state.selection.from:b.endA<n.state.selection.to&&b.endA>=n.state.selection.to-2&&n.state.selection.to<=h.to&&(b.endB+=n.state.selection.to-b.endA,b.endA=n.state.selection.to)),Yt&&Rn<=11&&b.endB==b.start+1&&b.endA==b.start&&b.start>h.from&&h.doc.textBetween(b.start-h.from-1,b.start-h.from+1)==" \xA0"&&(b.start--,b.endA--,b.endB--);let C=h.doc.resolveNoCache(b.start-h.from),T=h.doc.resolveNoCache(b.endB-h.from),P=d.resolve(b.start),J=C.sameParent(T)&&C.parent.inlineContent&&P.end()>=b.endA,mt;if((Tr&&n.input.lastIOSEnter>Date.now()-225&&(!J||i.some(tt=>tt.nodeName=="DIV"||tt.nodeName=="P"))||!J&&C.pos<h.doc.content.size&&(mt=ht.findFrom(h.doc.resolve(C.pos+1),1,!0))&&mt.head==T.pos)&&n.someProp("handleKeyDown",tt=>tt(n,rr(13,"Enter")))){n.input.lastIOSEnter=0;return}if(n.state.selection.anchor>b.start&&gy(d,b.start,b.endA,C,T)&&n.someProp("handleKeyDown",tt=>tt(n,rr(8,"Backspace")))){De&&Lt&&n.domObserver.suppressSelectionUpdates();return}Lt&&De&&b.endB==b.start&&(n.input.lastAndroidDelete=Date.now()),De&&!J&&C.start()!=T.start()&&T.parentOffset==0&&C.depth==T.depth&&h.sel&&h.sel.anchor==h.sel.head&&h.sel.head==b.endA&&(b.endB-=2,T=h.doc.resolveNoCache(b.endB-h.from),setTimeout(()=>{n.someProp("handleKeyDown",function(tt){return tt(n,rr(13,"Enter"))})},20));let st=b.start,ot=b.endA,yt,an,Xt;if(J){if(C.pos==T.pos)Yt&&Rn<=11&&C.parentOffset==0&&(n.domObserver.suppressSelectionUpdates(),setTimeout(()=>gn(n),20)),yt=n.state.tr.delete(st,ot),an=d.resolve(b.start).marksAcross(d.resolve(b.endA));else if(b.endA==b.endB&&(Xt=my(C.parent.content.cut(C.parentOffset,T.parentOffset),P.parent.content.cut(P.parentOffset,b.endA-P.start()))))yt=n.state.tr,Xt.type=="add"?yt.addMark(st,ot,Xt.mark):yt.removeMark(st,ot,Xt.mark);else if(C.parent.child(C.index()).isText&&C.index()==T.index()-(T.textOffset?0:1)){let tt=C.parent.textBetween(C.parentOffset,T.parentOffset);if(n.someProp("handleTextInput",yn=>yn(n,st,ot,tt)))return;yt=n.state.tr.insertText(tt,st,ot)}}if(yt||(yt=n.state.tr.replace(st,ot,h.doc.slice(b.start-h.from,b.endB-h.from))),h.sel){let tt=Df(n,yt.doc,h.sel);tt&&!(Lt&&De&&n.composing&&tt.empty&&(b.start!=b.endB||n.input.lastAndroidDelete<Date.now()-100)&&(tt.head==st||tt.head==yt.mapping.map(ot)-1)||Yt&&tt.empty&&tt.head==st)&&yt.setSelection(tt)}an&&yt.ensureMarks(an),n.dispatch(yt.scrollIntoView())}function Df(n,t,e){return Math.max(e.anchor,e.head)>t.content.size?null:oa(n,t.resolve(e.anchor),t.resolve(e.head))}function my(n,t){let e=n.firstChild.marks,r=t.firstChild.marks,i=e,s=r,l,c,h;for(let m=0;m<r.length;m++)i=r[m].removeFromSet(i);for(let m=0;m<e.length;m++)s=e[m].removeFromSet(s);if(i.length==1&&s.length==0)c=i[0],l="add",h=m=>m.mark(c.addToSet(m.marks));else if(i.length==0&&s.length==1)c=s[0],l="remove",h=m=>m.mark(c.removeFromSet(m.marks));else return null;let d=[];for(let m=0;m<t.childCount;m++)d.push(h(t.child(m)));if(B.from(d).eq(n))return{mark:c,type:l}}function gy(n,t,e,r,i){if(!r.parent.isTextblock||e-t<=i.pos-r.pos||ya(r,!0,!1)<i.pos)return!1;let s=n.resolve(t);if(s.parentOffset<s.parent.content.size||!s.parent.isTextblock)return!1;let l=n.resolve(ya(s,!0,!0));return!l.parent.isTextblock||l.pos>e||ya(l,!0,!1)<e?!1:r.parent.content.cut(r.parentOffset).eq(l.parent.content)}function ya(n,t,e){let r=n.depth,i=t?n.end():n.pos;for(;r>0&&(t||n.indexAfter(r)==n.node(r).childCount);)r--,i++,t=!1;if(e){let s=n.node(r).maybeChild(n.indexAfter(r));for(;s&&!s.isLeaf;)s=s.firstChild,i++}return i}function _y(n,t,e,r,i){let s=n.findDiffStart(t,e);if(s==null)return null;let{a:l,b:c}=n.findDiffEnd(t,e+n.size,e+t.size);if(i=="end"){let h=Math.max(0,s-Math.min(l,c));r-=l+h-s}if(l<s&&n.size<t.size){let h=r<=s&&r>=l?s-r:0;s-=h,c=s+(c-l),l=s}else if(c<s){let h=r<=s&&r>=c?s-r:0;s-=h,l=s+(l-c),c=s}return{start:s,endA:l,endB:c}}class yy{constructor(t,e){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new $1,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=e,this.state=e.state,this.directPlugins=e.plugins||[],this.directPlugins.forEach(Pf),this.dispatch=this.dispatch.bind(this),this.dom=t&&t.mount||document.createElement("div"),t&&(t.appendChild?t.appendChild(this.dom):typeof t=="function"?t(this.dom):t.mount&&(this.mounted=!0)),this.editable=zf(this),If(this),this.nodeViews=jf(this),this.docView=Uh(this.state.doc,Rf(this),_a(this),this.dom,this),this.domObserver=new cy(this,(r,i,s,l)=>py(this,r,i,s,l)),this.domObserver.start(),F1(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let t=this._props;this._props={};for(let e in t)this._props[e]=t[e];this._props.state=this.state}return this._props}update(t){t.handleDOMEvents!=this._props.handleDOMEvents&&ua(this);let e=this._props;this._props=t,t.plugins&&(t.plugins.forEach(Pf),this.directPlugins=t.plugins),this.updateStateInner(t.state,e)}setProps(t){let e={};for(let r in this._props)e[r]=this._props[r];e.state=this.state;for(let r in t)e[r]=t[r];this.update(e)}updateState(t){this.updateStateInner(t,this._props)}updateStateInner(t,e){let r=this.state,i=!1,s=!1;t.storedMarks&&this.composing&&(Sf(this),s=!0),this.state=t;let l=r.plugins!=t.plugins||this._props.plugins!=e.plugins;if(l||this._props.plugins!=e.plugins||this._props.nodeViews!=e.nodeViews){let v=jf(this);wy(v,this.nodeViews)&&(this.nodeViews=v,i=!0)}(l||e.handleDOMEvents!=this._props.handleDOMEvents)&&ua(this),this.editable=zf(this),If(this);let c=_a(this),h=Rf(this),d=r.plugins!=t.plugins&&!r.doc.eq(t.doc)?"reset":t.scrollToSelection>r.scrollToSelection?"to selection":"preserve",m=i||!this.docView.matchesNode(t.doc,h,c);(m||!t.selection.eq(r.selection))&&(s=!0);let y=d=="preserve"&&s&&this.dom.style.overflowAnchor==null&&o1(this);if(s){this.domObserver.stop();let v=m&&(Yt||Lt)&&!this.composing&&!r.selection.empty&&!t.selection.empty&&by(r.selection,t.selection);if(m){let b=Lt?this.trackWrites=this.domSelectionRange().focusNode:null;(i||!this.docView.update(t.doc,h,c,this))&&(this.docView.updateOuterDeco([]),this.docView.destroy(),this.docView=Uh(t.doc,h,c,this.dom,this)),b&&!this.trackWrites&&(v=!0)}v||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&E1(this))?gn(this,v):(nf(this,t.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(r),d=="reset"?this.dom.scrollTop=0:d=="to selection"?this.scrollToSelection():y&&i1(y)}scrollToSelection(){let t=this.domSelectionRange().focusNode;if(!this.someProp("handleScrollToSelection",e=>e(this)))if(this.state.selection instanceof Q){let e=this.docView.domAfterPos(this.state.selection.from);e.nodeType==1&&Ih(this,e.getBoundingClientRect(),t)}else Ih(this,this.coordsAtPos(this.state.selection.head,1),t)}destroyPluginViews(){let t;for(;t=this.pluginViews.pop();)t.destroy&&t.destroy()}updatePluginViews(t){if(!t||t.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let e=0;e<this.directPlugins.length;e++){let r=this.directPlugins[e];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let e=0;e<this.state.plugins.length;e++){let r=this.state.plugins[e];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let e=0;e<this.pluginViews.length;e++){let r=this.pluginViews[e];r.update&&r.update(this,t)}}someProp(t,e){let r=this._props&&this._props[t],i;if(r!=null&&(i=e?e(r):r))return i;for(let l=0;l<this.directPlugins.length;l++){let c=this.directPlugins[l].props[t];if(c!=null&&(i=e?e(c):c))return i}let s=this.state.plugins;if(s)for(let l=0;l<s.length;l++){let c=s[l].props[t];if(c!=null&&(i=e?e(c):c))return i}}hasFocus(){if(Yt){let t=this.root.activeElement;if(t==this.dom)return!0;if(!t||!this.dom.contains(t))return!1;for(;t&&this.dom!=t&&this.dom.contains(t);){if(t.contentEditable=="false")return!1;t=t.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&s1(this.dom),gn(this),this.domObserver.start()}get root(){let t=this._root;if(t==null){for(let e=this.dom.parentNode;e;e=e.parentNode)if(e.nodeType==9||e.nodeType==11&&e.host)return e.getSelection||(Object.getPrototypeOf(e).getSelection=()=>e.ownerDocument.getSelection()),this._root=e}return t||document}posAtCoords(t){return h1(this,t)}coordsAtPos(t,e=1){return $h(this,t,e)}domAtPos(t,e=0){return this.docView.domFromPos(t,e)}nodeDOM(t){let e=this.docView.descAt(t);return e?e.nodeDOM:null}posAtDOM(t,e,r=-1){let i=this.docView.posFromDOM(t,e,r);if(i==null)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(t,e){return g1(this,e||this.state,t)}pasteHTML(t,e){return xo(this,"",t,!1,e||new ClipboardEvent("paste"))}pasteText(t,e){return xo(this,t,null,!0,e||new ClipboardEvent("paste"))}destroy(){!this.docView||(V1(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],_a(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)}get isDestroyed(){return this.docView==null}dispatchEvent(t){return W1(this,t)}dispatch(t){let e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))}domSelectionRange(){return Wt&&this.root.nodeType===11&&Q_(this.dom.ownerDocument)==this.dom?hy(this):this.domSelection()}domSelection(){return this.root.getSelection()}}function Rf(n){let t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(n.editable),t.translate="no",n.someProp("attributes",e=>{if(typeof e=="function"&&(e=e(n.state)),e)for(let r in e)r=="class"&&(t.class+=" "+e[r]),r=="style"?t.style=(t.style?t.style+";":"")+e[r]:!t[r]&&r!="contenteditable"&&r!="nodeName"&&(t[r]=String(e[r]))}),[Ie.node(0,n.state.doc.content.size,t)]}function If(n){if(n.markCursor){let t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),t.setAttribute("alt",""),n.cursorWrapper={dom:t,deco:Ie.widget(n.state.selection.head,t,{raw:!0,marks:n.markCursor})}}else n.cursorWrapper=null}function zf(n){return!n.someProp("editable",t=>t(n.state)===!1)}function by(n,t){let e=Math.min(n.$anchor.sharedDepth(n.head),t.$anchor.sharedDepth(t.head));return n.$anchor.start(e)!=t.$anchor.start(e)}function jf(n){let t=Object.create(null);function e(r){for(let i in r)Object.prototype.hasOwnProperty.call(t,i)||(t[i]=r[i])}return n.someProp("nodeViews",e),n.someProp("markViews",e),t}function wy(n,t){let e=0,r=0;for(let i in n){if(n[i]!=t[i])return!0;e++}for(let i in t)r++;return e!=r}function Pf(n){if(n.spec.state||n.spec.filterTransaction||n.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}const Bf=(n,t)=>n.selection.empty?!1:(t&&t(n.tr.deleteSelection().scrollIntoView()),!0);function vy(n,t){let{$cursor:e}=n.selection;return!e||(t?!t.endOfTextblock("backward",n):e.parentOffset>0)?null:e}const ky=(n,t,e)=>{let r=vy(n,e);if(!r)return!1;let i=$f(r);if(!i){let l=r.blockRange(),c=l&&Fs(l);return c==null?!1:(t&&t(n.tr.lift(l,c).scrollIntoView()),!0)}let s=i.nodeBefore;if(!s.type.spec.isolating&&Vf(n,i,t))return!0;if(r.parent.content.size==0&&(jr(s,"end")||Q.isSelectable(s))){let l=Vs(n.doc,r.before(),r.after(),W.empty);if(l&&l.slice.size<l.to-l.from){if(t){let c=n.tr.step(l);c.setSelection(jr(s,"end")?ht.findFrom(c.doc.resolve(c.mapping.map(i.pos,-1)),-1):Q.create(c.doc,i.pos-s.nodeSize)),t(c.scrollIntoView())}return!0}}return s.isAtom&&i.depth==r.depth-1?(t&&t(n.tr.delete(i.pos-s.nodeSize,i.pos).scrollIntoView()),!0):!1};function jr(n,t,e=!1){for(let r=n;r;r=t=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(e&&r.childCount!=1)return!1}return!1}const xy=(n,t,e)=>{let{$head:r,empty:i}=n.selection,s=r;if(!i)return!1;if(r.parent.isTextblock){if(e?!e.endOfTextblock("backward",n):r.parentOffset>0)return!1;s=$f(r)}let l=s&&s.nodeBefore;return!l||!Q.isSelectable(l)?!1:(t&&t(n.tr.setSelection(Q.create(n.doc,s.pos-l.nodeSize)).scrollIntoView()),!0)};function $f(n){if(!n.parent.type.spec.isolating)for(let t=n.depth-1;t>=0;t--){if(n.index(t)>0)return n.doc.resolve(n.before(t+1));if(n.node(t).type.spec.isolating)break}return null}function Sy(n,t){let{$cursor:e}=n.selection;return!e||(t?!t.endOfTextblock("forward",n):e.parentOffset<e.parent.content.size)?null:e}const Cy=(n,t,e)=>{let r=Sy(n,e);if(!r)return!1;let i=Ff(r);if(!i)return!1;let s=i.nodeAfter;if(Vf(n,i,t))return!0;if(r.parent.content.size==0&&(jr(s,"start")||Q.isSelectable(s))){let l=Vs(n.doc,r.before(),r.after(),W.empty);if(l&&l.slice.size<l.to-l.from){if(t){let c=n.tr.step(l);c.setSelection(jr(s,"start")?ht.findFrom(c.doc.resolve(c.mapping.map(i.pos)),1):Q.create(c.doc,c.mapping.map(i.pos))),t(c.scrollIntoView())}return!0}}return s.isAtom&&i.depth==r.depth-1?(t&&t(n.tr.delete(i.pos,i.pos+s.nodeSize).scrollIntoView()),!0):!1},Oy=(n,t,e)=>{let{$head:r,empty:i}=n.selection,s=r;if(!i)return!1;if(r.parent.isTextblock){if(e?!e.endOfTextblock("forward",n):r.parentOffset<r.parent.content.size)return!1;s=Ff(r)}let l=s&&s.nodeAfter;return!l||!Q.isSelectable(l)?!1:(t&&t(n.tr.setSelection(Q.create(n.doc,s.pos)).scrollIntoView()),!0)};function Ff(n){if(!n.parent.type.spec.isolating)for(let t=n.depth-1;t>=0;t--){let e=n.node(t);if(n.index(t)+1<e.childCount)return n.doc.resolve(n.after(t+1));if(e.type.spec.isolating)break}return null}const My=(n,t)=>{let{$head:e,$anchor:r}=n.selection;return!e.parent.type.spec.code||!e.sameParent(r)?!1:(t&&t(n.tr.insertText(`
`).scrollIntoView()),!0)};function ba(n){for(let t=0;t<n.edgeCount;t++){let{type:e}=n.edge(t);if(e.isTextblock&&!e.hasRequiredAttrs())return e}return null}const Ay=(n,t)=>{let{$head:e,$anchor:r}=n.selection;if(!e.parent.type.spec.code||!e.sameParent(r))return!1;let i=e.node(-1),s=e.indexAfter(-1),l=ba(i.contentMatchAt(s));if(!l||!i.canReplaceWith(s,s,l))return!1;if(t){let c=e.after(),h=n.tr.replaceWith(c,c,l.createAndFill());h.setSelection(ht.near(h.doc.resolve(c),1)),t(h.scrollIntoView())}return!0},Ey=(n,t)=>{let e=n.selection,{$from:r,$to:i}=e;if(e instanceof se||r.parent.inlineContent||i.parent.inlineContent)return!1;let s=ba(i.parent.contentMatchAt(i.indexAfter()));if(!s||!s.isTextblock)return!1;if(t){let l=(!r.parentOffset&&i.index()<i.parent.childCount?r:i).pos,c=n.tr.insert(l,s.createAndFill());c.setSelection(pt.create(c.doc,l+1)),t(c.scrollIntoView())}return!0},Ty=(n,t)=>{let{$cursor:e}=n.selection;if(!e||e.parent.content.size)return!1;if(e.depth>1&&e.after()!=e.end(-1)){let s=e.before();if(gi(n.doc,s))return t&&t(n.tr.split(s).scrollIntoView()),!0}let r=e.blockRange(),i=r&&Fs(r);return i==null?!1:(t&&t(n.tr.lift(r,i).scrollIntoView()),!0)};function Ny(n){return(t,e)=>{let{$from:r,$to:i}=t.selection;if(t.selection instanceof Q&&t.selection.node.isBlock)return!r.parentOffset||!gi(t.doc,r.pos)?!1:(e&&e(t.tr.split(r.pos).scrollIntoView()),!0);if(!r.parent.isBlock)return!1;if(e){let s=i.parentOffset==i.parent.content.size,l=t.tr;(t.selection instanceof pt||t.selection instanceof se)&&l.deleteSelection();let c=r.depth==0?null:ba(r.node(-1).contentMatchAt(r.indexAfter(-1))),h=n&&n(i.parent,s),d=h?[h]:s&&c?[{type:c}]:void 0,m=gi(l.doc,l.mapping.map(r.pos),1,d);if(!d&&!m&&gi(l.doc,l.mapping.map(r.pos),1,c?[{type:c}]:void 0)&&(c&&(d=[{type:c}]),m=!0),m&&(l.split(l.mapping.map(r.pos),1,d),!s&&!r.parentOffset&&r.parent.type!=c)){let y=l.mapping.map(r.before()),v=l.doc.resolve(y);c&&r.node(-1).canReplaceWith(v.index(),v.index()+1,c)&&l.setNodeMarkup(l.mapping.map(r.before()),c)}e(l.scrollIntoView())}return!0}}const Dy=Ny(),Ry=(n,t)=>(t&&t(n.tr.setSelection(new se(n.doc))),!0);function Iy(n,t,e){let r=t.nodeBefore,i=t.nodeAfter,s=t.index();return!r||!i||!r.type.compatibleContent(i.type)?!1:!r.content.size&&t.parent.canReplace(s-1,s)?(e&&e(n.tr.delete(t.pos-r.nodeSize,t.pos).scrollIntoView()),!0):!t.parent.canReplace(s,s+1)||!(i.isTextblock||yh(n.doc,t.pos))?!1:(e&&e(n.tr.clearIncompatible(t.pos,r.type,r.contentMatchAt(r.childCount)).join(t.pos).scrollIntoView()),!0)}function Vf(n,t,e){let r=t.nodeBefore,i=t.nodeAfter,s,l;if(r.type.spec.isolating||i.type.spec.isolating)return!1;if(Iy(n,t,e))return!0;let c=t.parent.canReplace(t.index(),t.index()+1);if(c&&(s=(l=r.contentMatchAt(r.childCount)).findWrapping(i.type))&&l.matchType(s[0]||i.type).validEnd){if(e){let y=t.pos+i.nodeSize,v=B.empty;for(let T=s.length-1;T>=0;T--)v=B.from(s[T].create(null,v));v=B.from(r.copy(v));let b=n.tr.step(new ie(t.pos-1,y,t.pos,y,new W(v,1,0),s.length,!0)),C=y+2*s.length;yh(b.doc,C)&&b.join(C),e(b.scrollIntoView())}return!0}let h=ht.findFrom(t,1),d=h&&h.$from.blockRange(h.$to),m=d&&Fs(d);if(m!=null&&m>=t.depth)return e&&e(n.tr.lift(d,m).scrollIntoView()),!0;if(c&&jr(i,"start",!0)&&jr(r,"end")){let y=r,v=[];for(;v.push(y),!y.isTextblock;)y=y.lastChild;let b=i,C=1;for(;!b.isTextblock;b=b.firstChild)C++;if(y.canReplace(y.childCount,y.childCount,b.content)){if(e){let T=B.empty;for(let J=v.length-1;J>=0;J--)T=B.from(v[J].copy(T));let P=n.tr.step(new ie(t.pos-v.length,t.pos+i.nodeSize,t.pos+C,t.pos+i.nodeSize-C,new W(T,v.length,0),0,!0));e(P.scrollIntoView())}return!0}}return!1}function Lf(n){return function(t,e){let r=t.selection,i=n<0?r.$from:r.$to,s=i.depth;for(;i.node(s).isInline;){if(!s)return!1;s--}return i.node(s).isTextblock?(e&&e(t.tr.setSelection(pt.create(t.doc,n<0?i.start(s):i.end(s)))),!0):!1}}const zy=Lf(-1),jy=Lf(1);function Py(n,t,e){for(let r=0;r<t.length;r++){let{$from:i,$to:s}=t[r],l=i.depth==0?n.inlineContent&&n.type.allowsMarkType(e):!1;if(n.nodesBetween(i.pos,s.pos,c=>{if(l)return!1;l=c.inlineContent&&c.type.allowsMarkType(e)}),l)return!0}return!1}function Wf(n,t=null){return function(e,r){let{empty:i,$cursor:s,ranges:l}=e.selection;if(i&&!s||!Py(e.doc,l,n))return!1;if(r)if(s)n.isInSet(e.storedMarks||s.marks())?r(e.tr.removeStoredMark(n)):r(e.tr.addStoredMark(n.create(t)));else{let c=!1,h=e.tr;for(let d=0;!c&&d<l.length;d++){let{$from:m,$to:y}=l[d];c=e.doc.rangeHasMark(m.pos,y.pos,n)}for(let d=0;d<l.length;d++){let{$from:m,$to:y}=l[d];if(c)h.removeMark(m.pos,y.pos,n);else{let v=m.pos,b=y.pos,C=m.nodeAfter,T=y.nodeBefore,P=C&&C.isText?/^\s*/.exec(C.text)[0].length:0,J=T&&T.isText?/\s*$/.exec(T.text)[0].length:0;v+P<b&&(v+=P,b-=J),h.addMark(v,b,n.create(t))}}r(h.scrollIntoView())}return!0}}function wa(...n){return function(t,e,r){for(let i=0;i<n.length;i++)if(n[i](t,e,r))return!0;return!1}}let va=wa(Bf,ky,xy),qf=wa(Bf,Cy,Oy);const _n={Enter:wa(My,Ey,Ty,Dy),"Mod-Enter":Ay,Backspace:va,"Mod-Backspace":va,"Shift-Backspace":va,Delete:qf,"Mod-Delete":qf,"Mod-a":Ry},Jf={"Ctrl-h":_n.Backspace,"Alt-Backspace":_n["Mod-Backspace"],"Ctrl-d":_n.Delete,"Ctrl-Alt-Backspace":_n["Mod-Delete"],"Alt-Delete":_n["Mod-Delete"],"Alt-d":_n["Mod-Delete"],"Ctrl-a":zy,"Ctrl-e":jy};for(let n in _n)Jf[n]=_n[n];const By=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform?os.platform()=="darwin":!1,$y=By?Jf:_n;var $n={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Oi={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},Uf=typeof navigator<"u"&&/Chrome\/(\d+)/.exec(navigator.userAgent);typeof navigator<"u"&&/Gecko\/\d+/.test(navigator.userAgent);for(var Fy=typeof navigator<"u"&&/Mac/.test(navigator.platform),Vy=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Ly=Fy||Uf&&+Uf[1]<57,Rt=0;Rt<10;Rt++)$n[48+Rt]=$n[96+Rt]=String(Rt);for(var Rt=1;Rt<=24;Rt++)$n[Rt+111]="F"+Rt;for(var Rt=65;Rt<=90;Rt++)$n[Rt]=String.fromCharCode(Rt+32),Oi[Rt]=String.fromCharCode(Rt);for(var ka in $n)Oi.hasOwnProperty(ka)||(Oi[ka]=$n[ka]);function Wy(n){var t=Ly&&(n.ctrlKey||n.altKey||n.metaKey)||Vy&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",e=!t&&n.key||(n.shiftKey?Oi:$n)[n.keyCode]||n.key||"Unidentified";return e=="Esc"&&(e="Escape"),e=="Del"&&(e="Delete"),e=="Left"&&(e="ArrowLeft"),e=="Up"&&(e="ArrowUp"),e=="Right"&&(e="ArrowRight"),e=="Down"&&(e="ArrowDown"),e}const qy=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!1;function Jy(n){let t=n.split(/-(?!$)/),e=t[t.length-1];e=="Space"&&(e=" ");let r,i,s,l;for(let c=0;c<t.length-1;c++){let h=t[c];if(/^(cmd|meta|m)$/i.test(h))l=!0;else if(/^a(lt)?$/i.test(h))r=!0;else if(/^(c|ctrl|control)$/i.test(h))i=!0;else if(/^s(hift)?$/i.test(h))s=!0;else if(/^mod$/i.test(h))qy?l=!0:i=!0;else throw new Error("Unrecognized modifier name: "+h)}return r&&(e="Alt-"+e),i&&(e="Ctrl-"+e),l&&(e="Meta-"+e),s&&(e="Shift-"+e),e}function Uy(n){let t=Object.create(null);for(let e in n)t[Jy(e)]=n[e];return t}function xa(n,t,e=!0){return t.altKey&&(n="Alt-"+n),t.ctrlKey&&(n="Ctrl-"+n),t.metaKey&&(n="Meta-"+n),e&&t.shiftKey&&(n="Shift-"+n),n}function Ky(n){return new H_({props:{handleKeyDown:Hy(n)}})}function Hy(n){let t=Uy(n);return function(e,r){let i=Wy(r),s,l=t[xa(i,r)];if(l&&l(e.state,e.dispatch,e))return!0;if(i.length==1&&i!=" "){if(r.shiftKey){let c=t[xa(i,r,!1)];if(c&&c(e.state,e.dispatch,e))return!0}if((r.shiftKey||r.altKey||r.metaKey||i.charCodeAt(0)>127)&&(s=$n[r.keyCode])&&s!=i){let c=t[xa(s,r)];if(c&&c(e.state,e.dispatch,e))return!0}}return!1}}var Z=globalThis&&globalThis.__classPrivateFieldSet||function(n,t,e){if(!t.has(n))throw new TypeError("attempted to set private field on non-instance");return t.set(n,e),e},V=globalThis&&globalThis.__classPrivateFieldGet||function(n,t){if(!t.has(n))throw new TypeError("attempted to get private field on non-instance");return t.get(n)},Fn,ur,ze,Pr,Co,Ge,Ze,Ye,Xe,Qe,tn,en,nn,hr,Br,Vn,Mi,Ln;const Gy=function(n){var t=131,e=137,r=0;n+="x";var i=Math.floor(9007199254740991/e);for(let s=0;s<n.length;s++)r>i&&(r=Math.floor(r/e)),r=r*t+n.charCodeAt(s);return r},q="0123456789abcdef".split(""),Zy=[-2147483648,8388608,32768,128],je=[24,16,8,0],Ai=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],Tt=[];class Yy{constructor(t=!1,e=!1){Fn.set(this,void 0),ur.set(this,void 0),ze.set(this,void 0),Pr.set(this,void 0),Co.set(this,void 0),Ge.set(this,void 0),Ze.set(this,void 0),Ye.set(this,void 0),Xe.set(this,void 0),Qe.set(this,void 0),tn.set(this,void 0),en.set(this,void 0),nn.set(this,void 0),hr.set(this,void 0),Br.set(this,void 0),Vn.set(this,void 0),Mi.set(this,0),Ln.set(this,void 0),this.init(t,e)}init(t,e){e?(Tt[0]=Tt[16]=Tt[1]=Tt[2]=Tt[3]=Tt[4]=Tt[5]=Tt[6]=Tt[7]=Tt[8]=Tt[9]=Tt[10]=Tt[11]=Tt[12]=Tt[13]=Tt[14]=Tt[15]=0,Z(this,ur,Tt)):Z(this,ur,[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),t?(Z(this,Ge,3238371032),Z(this,Ze,914150663),Z(this,Ye,812702999),Z(this,Xe,4144912697),Z(this,Qe,4290775857),Z(this,tn,1750603025),Z(this,en,1694076839),Z(this,nn,3204075428)):(Z(this,Ge,1779033703),Z(this,Ze,3144134277),Z(this,Ye,1013904242),Z(this,Xe,2773480762),Z(this,Qe,1359893119),Z(this,tn,2600822924),Z(this,en,528734635),Z(this,nn,1541459225)),Z(this,Fn,Z(this,Ln,Z(this,ze,Z(this,Br,0)))),Z(this,Pr,Z(this,hr,!1)),Z(this,Co,!0),Z(this,Vn,t)}update(t){if(V(this,Pr))return this;let e;t instanceof ArrayBuffer?e=new Uint8Array(t):e=t;let r=0;const i=e.length,s=V(this,ur);for(;r<i;){let l;if(V(this,hr)&&(Z(this,hr,!1),s[0]=V(this,Fn),s[16]=s[1]=s[2]=s[3]=s[4]=s[5]=s[6]=s[7]=s[8]=s[9]=s[10]=s[11]=s[12]=s[13]=s[14]=s[15]=0),typeof e!="string")for(l=V(this,Ln);r<i&&l<64;++r)s[l>>2]|=e[r]<<je[l++&3];else for(l=V(this,Ln);r<i&&l<64;++r){let c=e.charCodeAt(r);c<128?s[l>>2]|=c<<je[l++&3]:c<2048?(s[l>>2]|=(192|c>>6)<<je[l++&3],s[l>>2]|=(128|c&63)<<je[l++&3]):c<55296||c>=57344?(s[l>>2]|=(224|c>>12)<<je[l++&3],s[l>>2]|=(128|c>>6&63)<<je[l++&3],s[l>>2]|=(128|c&63)<<je[l++&3]):(c=65536+((c&1023)<<10|e.charCodeAt(++r)&1023),s[l>>2]|=(240|c>>18)<<je[l++&3],s[l>>2]|=(128|c>>12&63)<<je[l++&3],s[l>>2]|=(128|c>>6&63)<<je[l++&3],s[l>>2]|=(128|c&63)<<je[l++&3])}Z(this,Mi,l),Z(this,ze,V(this,ze)+(l-V(this,Ln))),l>=64?(Z(this,Fn,s[16]),Z(this,Ln,l-64),this.hash(),Z(this,hr,!0)):Z(this,Ln,l)}return V(this,ze)>4294967295&&(Z(this,Br,V(this,Br)+(V(this,ze)/4294967296<<0)),Z(this,ze,V(this,ze)%4294967296)),this}finalize(){if(V(this,Pr))return;Z(this,Pr,!0);const t=V(this,ur),e=V(this,Mi);t[16]=V(this,Fn),t[e>>2]|=Zy[e&3],Z(this,Fn,t[16]),e>=56&&(V(this,hr)||this.hash(),t[0]=V(this,Fn),t[16]=t[1]=t[2]=t[3]=t[4]=t[5]=t[6]=t[7]=t[8]=t[9]=t[10]=t[11]=t[12]=t[13]=t[14]=t[15]=0),t[14]=V(this,Br)<<3|V(this,ze)>>>29,t[15]=V(this,ze)<<3,this.hash()}hash(){let t=V(this,Ge),e=V(this,Ze),r=V(this,Ye),i=V(this,Xe),s=V(this,Qe),l=V(this,tn),c=V(this,en),h=V(this,nn);const d=V(this,ur);let m,y,v,b,C,T,P,J,mt,st;for(let ot=16;ot<64;++ot)b=d[ot-15],m=(b>>>7|b<<25)^(b>>>18|b<<14)^b>>>3,b=d[ot-2],y=(b>>>17|b<<15)^(b>>>19|b<<13)^b>>>10,d[ot]=d[ot-16]+m+d[ot-7]+y<<0;st=e&r;for(let ot=0;ot<64;ot+=4)V(this,Co)?(V(this,Vn)?(P=300032,b=d[0]-1413257819,h=b-150054599<<0,i=b+24177077<<0):(P=704751109,b=d[0]-210244248,h=b-1521486534<<0,i=b+143694565<<0),Z(this,Co,!1)):(m=(t>>>2|t<<30)^(t>>>13|t<<19)^(t>>>22|t<<10),y=(s>>>6|s<<26)^(s>>>11|s<<21)^(s>>>25|s<<7),P=t&e,v=P^t&r^st,T=s&l^~s&c,b=h+y+T+Ai[ot]+d[ot],C=m+v,h=i+b<<0,i=b+C<<0),m=(i>>>2|i<<30)^(i>>>13|i<<19)^(i>>>22|i<<10),y=(h>>>6|h<<26)^(h>>>11|h<<21)^(h>>>25|h<<7),J=i&t,v=J^i&e^P,T=h&s^~h&l,b=c+y+T+Ai[ot+1]+d[ot+1],C=m+v,c=r+b<<0,r=b+C<<0,m=(r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10),y=(c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7),mt=r&i,v=mt^r&t^J,T=c&h^~c&s,b=l+y+T+Ai[ot+2]+d[ot+2],C=m+v,l=e+b<<0,e=b+C<<0,m=(e>>>2|e<<30)^(e>>>13|e<<19)^(e>>>22|e<<10),y=(l>>>6|l<<26)^(l>>>11|l<<21)^(l>>>25|l<<7),st=e&r,v=st^e&i^mt,T=l&c^~l&h,b=s+y+T+Ai[ot+3]+d[ot+3],C=m+v,s=t+b<<0,t=b+C<<0;Z(this,Ge,V(this,Ge)+t<<0),Z(this,Ze,V(this,Ze)+e<<0),Z(this,Ye,V(this,Ye)+r<<0),Z(this,Xe,V(this,Xe)+i<<0),Z(this,Qe,V(this,Qe)+s<<0),Z(this,tn,V(this,tn)+l<<0),Z(this,en,V(this,en)+c<<0),Z(this,nn,V(this,nn)+h<<0)}hex(){this.finalize();const t=V(this,Ge),e=V(this,Ze),r=V(this,Ye),i=V(this,Xe),s=V(this,Qe),l=V(this,tn),c=V(this,en),h=V(this,nn);let d=q[t>>28&15]+q[t>>24&15]+q[t>>20&15]+q[t>>16&15]+q[t>>12&15]+q[t>>8&15]+q[t>>4&15]+q[t&15]+q[e>>28&15]+q[e>>24&15]+q[e>>20&15]+q[e>>16&15]+q[e>>12&15]+q[e>>8&15]+q[e>>4&15]+q[e&15]+q[r>>28&15]+q[r>>24&15]+q[r>>20&15]+q[r>>16&15]+q[r>>12&15]+q[r>>8&15]+q[r>>4&15]+q[r&15]+q[i>>28&15]+q[i>>24&15]+q[i>>20&15]+q[i>>16&15]+q[i>>12&15]+q[i>>8&15]+q[i>>4&15]+q[i&15]+q[s>>28&15]+q[s>>24&15]+q[s>>20&15]+q[s>>16&15]+q[s>>12&15]+q[s>>8&15]+q[s>>4&15]+q[s&15]+q[l>>28&15]+q[l>>24&15]+q[l>>20&15]+q[l>>16&15]+q[l>>12&15]+q[l>>8&15]+q[l>>4&15]+q[l&15]+q[c>>28&15]+q[c>>24&15]+q[c>>20&15]+q[c>>16&15]+q[c>>12&15]+q[c>>8&15]+q[c>>4&15]+q[c&15];return V(this,Vn)||(d+=q[h>>28&15]+q[h>>24&15]+q[h>>20&15]+q[h>>16&15]+q[h>>12&15]+q[h>>8&15]+q[h>>4&15]+q[h&15]),d}toString(){return this.hex()}digest(){this.finalize();const t=V(this,Ge),e=V(this,Ze),r=V(this,Ye),i=V(this,Xe),s=V(this,Qe),l=V(this,tn),c=V(this,en),h=V(this,nn),d=[t>>24&255,t>>16&255,t>>8&255,t&255,e>>24&255,e>>16&255,e>>8&255,e&255,r>>24&255,r>>16&255,r>>8&255,r&255,i>>24&255,i>>16&255,i>>8&255,i&255,s>>24&255,s>>16&255,s>>8&255,s&255,l>>24&255,l>>16&255,l>>8&255,l&255,c>>24&255,c>>16&255,c>>8&255,c&255];return V(this,Vn)||d.push(h>>24&255,h>>16&255,h>>8&255,h&255),d}array(){return this.digest()}arrayBuffer(){this.finalize();const t=new ArrayBuffer(V(this,Vn)?28:32),e=new DataView(t);return e.setUint32(0,V(this,Ge)),e.setUint32(4,V(this,Ze)),e.setUint32(8,V(this,Ye)),e.setUint32(12,V(this,Xe)),e.setUint32(16,V(this,Qe)),e.setUint32(20,V(this,tn)),e.setUint32(24,V(this,en)),V(this,Vn)||e.setUint32(28,V(this,nn)),t}}Fn=new WeakMap,ur=new WeakMap,ze=new WeakMap,Pr=new WeakMap,Co=new WeakMap,Ge=new WeakMap,Ze=new WeakMap,Ye=new WeakMap,Xe=new WeakMap,Qe=new WeakMap,tn=new WeakMap,en=new WeakMap,nn=new WeakMap,hr=new WeakMap,Br=new WeakMap,Vn=new WeakMap,Mi=new WeakMap,Ln=new WeakMap;function Xy(n){const t=new Yy;return t.update(n),parseInt(t.hex().substring(0,8),16)}const Qy=function(n){var t="#";return n.forEach(function(e){e<16&&(t+=0),t+=e.toString(16)}),t},tb=function(n,t,e){n/=360;var r=e<.5?e*(1+t):e+t-e*t,i=2*e-r;return[n+1/3,n,n-1/3].map(function(s){return s<0&&s++,s>1&&s--,s<1/6?s=i+(r-i)*6*s:s<.5?s=r:s<2/3?s=i+(r-i)*6*(2/3-s):s=i,Math.round(s*255)})};class eb{constructor(t={}){const[e,r]=[t.lightness,t.saturation].map(function(i){return i=i!==void 0?i:[.35,.5,.65],Array.isArray(i)?i.concat():[i]});this.L=e,this.S=r,typeof t.hue=="number"&&(t.hue={min:t.hue,max:t.hue}),typeof t.hue=="object"&&!Array.isArray(t.hue)&&(t.hue=[t.hue]),typeof t.hue>"u"&&(t.hue=[]),this.hueRanges=t.hue.map(function(i){return{min:typeof i.min>"u"?0:i.min,max:typeof i.max>"u"?360:i.max}}),this.hash=Xy,typeof t.hash=="function"&&(this.hash=t.hash),t.hash==="bkdr"&&(this.hash=Gy)}hsl(t){var e,r,i,s=this.hash(t),l=727;if(this.hueRanges.length){const c=this.hueRanges[s%this.hueRanges.length];e=s/this.hueRanges.length%l*(c.max-c.min)/l+c.min}else e=s%359;return s=Math.ceil(s/360),r=this.S[s%this.S.length],s=Math.ceil(s/this.S.length),i=this.L[s%this.L.length],[e,r,i]}rgb(t){var e=this.hsl(t);return tb.apply(this,e)}hex(t){var e=this.rgb(t);return Qy(e)}}const nb=new eb,rb={doc:{content:"block+"},paragraph:{content:"text*",group:"block",toDOM:()=>["p",0]},text:{}},ob={strong:{toDOM(){return["strong"]},allowMultiple:!1,inclusive:!0},em:{toDOM(){return["em"]},allowMultiple:!1,inclusive:!0},comment:{attrs:{id:{}},inclusive:!1,toDOM(n){return["span",{"data-mark":"comment","data-comment-id":n.attrs.id}]},allowMultiple:!0,excludes:""},link:{attrs:{url:{}},inclusive:!1,allowMultiple:!1,toDOM(n){return["a",{href:n.attrs.url,style:`color: ${nb.hex(n.attrs.url)};`}]}}},ib={...ob,highlightChange:{toDOM(){return["span",{class:"highlight-flash"}]}},unhighlightChange:{toDOM(){return["span",{class:"unhighlight"}]}}};function Kf(n){return n==="strong"||n==="em"||n==="comment"||n==="link"}const sb={nodes:rb,marks:ib};class ab{constructor({interval:t=10,handleFlush:e}){kr(this,"changes",[]);kr(this,"timer");kr(this,"interval");kr(this,"handleFlush");kr(this,"flush",()=>{this.handleFlush(this.changes),this.changes=[]});this.interval=t,this.handleFlush=e}enqueue(...t){this.changes.push(...t)}start(){this.timer=window.setInterval(this.flush,this.interval)}drop(){this.timer!==void 0&&window.clearInterval(this.timer)}}var Oo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ei={exports:{}},Hf=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof window.msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto);if(Hf){var Gf=new Uint8Array(16);Ei.exports=function(){return Hf(Gf),Gf}}else{var Zf=new Array(16);Ei.exports=function(){for(var n=0,t;n<16;n++)(n&3)===0&&(t=Math.random()*4294967296),Zf[n]=t>>>((n&3)<<3)&255;return Zf}}for(var Yf=[],Ti=0;Ti<256;++Ti)Yf[Ti]=(Ti+256).toString(16).substr(1);function lb(n,t){var e=t||0,r=Yf;return[r[n[e++]],r[n[e++]],r[n[e++]],r[n[e++]],"-",r[n[e++]],r[n[e++]],"-",r[n[e++]],r[n[e++]],"-",r[n[e++]],r[n[e++]],"-",r[n[e++]],r[n[e++]],r[n[e++]],r[n[e++]],r[n[e++]],r[n[e++]]].join("")}var Xf=lb,cb=Ei.exports,ub=Xf,Qf,Sa,Ca=0,Oa=0;function hb(n,t,e){var r=t&&e||0,i=t||[];n=n||{};var s=n.node||Qf,l=n.clockseq!==void 0?n.clockseq:Sa;if(s==null||l==null){var c=cb();s==null&&(s=Qf=[c[0]|1,c[1],c[2],c[3],c[4],c[5]]),l==null&&(l=Sa=(c[6]<<8|c[7])&16383)}var h=n.msecs!==void 0?n.msecs:new Date().getTime(),d=n.nsecs!==void 0?n.nsecs:Oa+1,m=h-Ca+(d-Oa)/1e4;if(m<0&&n.clockseq===void 0&&(l=l+1&16383),(m<0||h>Ca)&&n.nsecs===void 0&&(d=0),d>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");Ca=h,Oa=d,Sa=l,h+=122192928e5;var y=((h&268435455)*1e4+d)%4294967296;i[r++]=y>>>24&255,i[r++]=y>>>16&255,i[r++]=y>>>8&255,i[r++]=y&255;var v=h/4294967296*1e4&268435455;i[r++]=v>>>8&255,i[r++]=v&255,i[r++]=v>>>24&15|16,i[r++]=v>>>16&255,i[r++]=l>>>8|128,i[r++]=l&255;for(var b=0;b<6;++b)i[r+b]=s[b];return t||ub(i)}var fb=hb,db=Ei.exports,pb=Xf;function mb(n,t,e){var r=t&&e||0;typeof n=="string"&&(t=n==="binary"?new Array(16):null,n=null),n=n||{};var i=n.random||(n.rng||db)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,t)for(var s=0;s<16;++s)t[r+s]=i[s];return t||pb(i)}var gb=mb,_b=fb,td=gb,Ma=td;Ma.v1=_b,Ma.v4=td;var ed=Ma,Aa={exports:{}};(function(n,t){(function(){var e,r="4.17.21",i=200,s="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",c="Invalid `variable` option passed into `_.template`",h="__lodash_hash_undefined__",d=500,m="__lodash_placeholder__",y=1,v=2,b=4,C=1,T=2,P=1,J=2,mt=4,st=8,ot=16,yt=32,an=64,Xt=128,tt=256,yn=512,Mo=30,Ea="...",Ob=800,Mb=16,md=1,Ab=2,Eb=3,fr=1/0,Wn=9007199254740991,Tb=17976931348623157e292,Di=0/0,ln=4294967295,Nb=ln-1,Db=ln>>>1,Rb=[["ary",Xt],["bind",P],["bindKey",J],["curry",st],["curryRight",ot],["flip",yn],["partial",yt],["partialRight",an],["rearg",tt]],Vr="[object Arguments]",Ri="[object Array]",Ib="[object AsyncFunction]",Ao="[object Boolean]",Eo="[object Date]",zb="[object DOMException]",Ii="[object Error]",zi="[object Function]",gd="[object GeneratorFunction]",Pe="[object Map]",To="[object Number]",jb="[object Null]",bn="[object Object]",_d="[object Promise]",Pb="[object Proxy]",No="[object RegExp]",Be="[object Set]",Do="[object String]",ji="[object Symbol]",Bb="[object Undefined]",Ro="[object WeakMap]",$b="[object WeakSet]",Io="[object ArrayBuffer]",Lr="[object DataView]",Ta="[object Float32Array]",Na="[object Float64Array]",Da="[object Int8Array]",Ra="[object Int16Array]",Ia="[object Int32Array]",za="[object Uint8Array]",ja="[object Uint8ClampedArray]",Pa="[object Uint16Array]",Ba="[object Uint32Array]",Fb=/\b__p \+= '';/g,Vb=/\b(__p \+=) '' \+/g,Lb=/(__e\(.*?\)|\b__t\)) \+\n'';/g,yd=/&(?:amp|lt|gt|quot|#39);/g,bd=/[&<>"']/g,Wb=RegExp(yd.source),qb=RegExp(bd.source),Jb=/<%-([\s\S]+?)%>/g,Ub=/<%([\s\S]+?)%>/g,wd=/<%=([\s\S]+?)%>/g,Kb=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Hb=/^\w*$/,Gb=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,$a=/[\\^$.*+?()[\]{}|]/g,Zb=RegExp($a.source),Fa=/^\s+/,Yb=/\s/,Xb=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Qb=/\{\n\/\* \[wrapped with (.+)\] \*/,tw=/,? & /,ew=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,nw=/[()=,{}\[\]\/\s]/,rw=/\\(\\)?/g,ow=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,vd=/\w*$/,iw=/^[-+]0x[0-9a-f]+$/i,sw=/^0b[01]+$/i,aw=/^\[object .+?Constructor\]$/,lw=/^0o[0-7]+$/i,cw=/^(?:0|[1-9]\d*)$/,uw=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Pi=/($^)/,hw=/['\n\r\u2028\u2029\\]/g,Bi="\uD800-\uDFFF",fw="\\u0300-\\u036f",dw="\\ufe20-\\ufe2f",pw="\\u20d0-\\u20ff",kd=fw+dw+pw,xd="\\u2700-\\u27bf",Sd="a-z\\xdf-\\xf6\\xf8-\\xff",mw="\\xac\\xb1\\xd7\\xf7",gw="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",_w="\\u2000-\\u206f",yw=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Cd="A-Z\\xc0-\\xd6\\xd8-\\xde",Od="\\ufe0e\\ufe0f",Md=mw+gw+_w+yw,Va="['\u2019]",bw="["+Bi+"]",Ad="["+Md+"]",$i="["+kd+"]",Ed="\\d+",ww="["+xd+"]",Td="["+Sd+"]",Nd="[^"+Bi+Md+Ed+xd+Sd+Cd+"]",La="\uD83C[\uDFFB-\uDFFF]",vw="(?:"+$i+"|"+La+")",Dd="[^"+Bi+"]",Wa="(?:\uD83C[\uDDE6-\uDDFF]){2}",qa="[\uD800-\uDBFF][\uDC00-\uDFFF]",Wr="["+Cd+"]",Rd="\\u200d",Id="(?:"+Td+"|"+Nd+")",kw="(?:"+Wr+"|"+Nd+")",zd="(?:"+Va+"(?:d|ll|m|re|s|t|ve))?",jd="(?:"+Va+"(?:D|LL|M|RE|S|T|VE))?",Pd=vw+"?",Bd="["+Od+"]?",xw="(?:"+Rd+"(?:"+[Dd,Wa,qa].join("|")+")"+Bd+Pd+")*",Sw="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Cw="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",$d=Bd+Pd+xw,Ow="(?:"+[ww,Wa,qa].join("|")+")"+$d,Mw="(?:"+[Dd+$i+"?",$i,Wa,qa,bw].join("|")+")",Aw=RegExp(Va,"g"),Ew=RegExp($i,"g"),Ja=RegExp(La+"(?="+La+")|"+Mw+$d,"g"),Tw=RegExp([Wr+"?"+Td+"+"+zd+"(?="+[Ad,Wr,"$"].join("|")+")",kw+"+"+jd+"(?="+[Ad,Wr+Id,"$"].join("|")+")",Wr+"?"+Id+"+"+zd,Wr+"+"+jd,Cw,Sw,Ed,Ow].join("|"),"g"),Nw=RegExp("["+Rd+Bi+kd+Od+"]"),Dw=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Rw=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Iw=-1,bt={};bt[Ta]=bt[Na]=bt[Da]=bt[Ra]=bt[Ia]=bt[za]=bt[ja]=bt[Pa]=bt[Ba]=!0,bt[Vr]=bt[Ri]=bt[Io]=bt[Ao]=bt[Lr]=bt[Eo]=bt[Ii]=bt[zi]=bt[Pe]=bt[To]=bt[bn]=bt[No]=bt[Be]=bt[Do]=bt[Ro]=!1;var _t={};_t[Vr]=_t[Ri]=_t[Io]=_t[Lr]=_t[Ao]=_t[Eo]=_t[Ta]=_t[Na]=_t[Da]=_t[Ra]=_t[Ia]=_t[Pe]=_t[To]=_t[bn]=_t[No]=_t[Be]=_t[Do]=_t[ji]=_t[za]=_t[ja]=_t[Pa]=_t[Ba]=!0,_t[Ii]=_t[zi]=_t[Ro]=!1;var zw={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},jw={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Pw={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Bw={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},$w=parseFloat,Fw=parseInt,Fd=typeof Oo=="object"&&Oo&&Oo.Object===Object&&Oo,Vw=typeof self=="object"&&self&&self.Object===Object&&self,It=Fd||Vw||Function("return this")(),Ua=t&&!t.nodeType&&t,dr=Ua&&!0&&n&&!n.nodeType&&n,Vd=dr&&dr.exports===Ua,Ka=Vd&&Fd.process,we=function(){try{var S=dr&&dr.require&&dr.require("util").types;return S||Ka&&Ka.binding&&Ka.binding("util")}catch{}}(),Ld=we&&we.isArrayBuffer,Wd=we&&we.isDate,qd=we&&we.isMap,Jd=we&&we.isRegExp,Ud=we&&we.isSet,Kd=we&&we.isTypedArray;function ce(S,N,M){switch(M.length){case 0:return S.call(N);case 1:return S.call(N,M[0]);case 2:return S.call(N,M[0],M[1]);case 3:return S.call(N,M[0],M[1],M[2])}return S.apply(N,M)}function Lw(S,N,M,L){for(var Y=-1,ut=S==null?0:S.length;++Y<ut;){var Mt=S[Y];N(L,Mt,M(Mt),S)}return L}function ve(S,N){for(var M=-1,L=S==null?0:S.length;++M<L&&N(S[M],M,S)!==!1;);return S}function Ww(S,N){for(var M=S==null?0:S.length;M--&&N(S[M],M,S)!==!1;);return S}function Hd(S,N){for(var M=-1,L=S==null?0:S.length;++M<L;)if(!N(S[M],M,S))return!1;return!0}function qn(S,N){for(var M=-1,L=S==null?0:S.length,Y=0,ut=[];++M<L;){var Mt=S[M];N(Mt,M,S)&&(ut[Y++]=Mt)}return ut}function Fi(S,N){var M=S==null?0:S.length;return!!M&&qr(S,N,0)>-1}function Ha(S,N,M){for(var L=-1,Y=S==null?0:S.length;++L<Y;)if(M(N,S[L]))return!0;return!1}function wt(S,N){for(var M=-1,L=S==null?0:S.length,Y=Array(L);++M<L;)Y[M]=N(S[M],M,S);return Y}function Jn(S,N){for(var M=-1,L=N.length,Y=S.length;++M<L;)S[Y+M]=N[M];return S}function Ga(S,N,M,L){var Y=-1,ut=S==null?0:S.length;for(L&&ut&&(M=S[++Y]);++Y<ut;)M=N(M,S[Y],Y,S);return M}function qw(S,N,M,L){var Y=S==null?0:S.length;for(L&&Y&&(M=S[--Y]);Y--;)M=N(M,S[Y],Y,S);return M}function Za(S,N){for(var M=-1,L=S==null?0:S.length;++M<L;)if(N(S[M],M,S))return!0;return!1}var Jw=Ya("length");function Uw(S){return S.split("")}function Kw(S){return S.match(ew)||[]}function Gd(S,N,M){var L;return M(S,function(Y,ut,Mt){if(N(Y,ut,Mt))return L=ut,!1}),L}function Vi(S,N,M,L){for(var Y=S.length,ut=M+(L?1:-1);L?ut--:++ut<Y;)if(N(S[ut],ut,S))return ut;return-1}function qr(S,N,M){return N===N?iv(S,N,M):Vi(S,Zd,M)}function Hw(S,N,M,L){for(var Y=M-1,ut=S.length;++Y<ut;)if(L(S[Y],N))return Y;return-1}function Zd(S){return S!==S}function Yd(S,N){var M=S==null?0:S.length;return M?Qa(S,N)/M:Di}function Ya(S){return function(N){return N==null?e:N[S]}}function Xa(S){return function(N){return S==null?e:S[N]}}function Xd(S,N,M,L,Y){return Y(S,function(ut,Mt,gt){M=L?(L=!1,ut):N(M,ut,Mt,gt)}),M}function Gw(S,N){var M=S.length;for(S.sort(N);M--;)S[M]=S[M].value;return S}function Qa(S,N){for(var M,L=-1,Y=S.length;++L<Y;){var ut=N(S[L]);ut!==e&&(M=M===e?ut:M+ut)}return M}function tl(S,N){for(var M=-1,L=Array(S);++M<S;)L[M]=N(M);return L}function Zw(S,N){return wt(N,function(M){return[M,S[M]]})}function Qd(S){return S&&S.slice(0,rp(S)+1).replace(Fa,"")}function ue(S){return function(N){return S(N)}}function el(S,N){return wt(N,function(M){return S[M]})}function zo(S,N){return S.has(N)}function tp(S,N){for(var M=-1,L=S.length;++M<L&&qr(N,S[M],0)>-1;);return M}function ep(S,N){for(var M=S.length;M--&&qr(N,S[M],0)>-1;);return M}function Yw(S,N){for(var M=S.length,L=0;M--;)S[M]===N&&++L;return L}var Xw=Xa(zw),Qw=Xa(jw);function tv(S){return"\\"+Bw[S]}function ev(S,N){return S==null?e:S[N]}function Jr(S){return Nw.test(S)}function nv(S){return Dw.test(S)}function rv(S){for(var N,M=[];!(N=S.next()).done;)M.push(N.value);return M}function nl(S){var N=-1,M=Array(S.size);return S.forEach(function(L,Y){M[++N]=[Y,L]}),M}function np(S,N){return function(M){return S(N(M))}}function Un(S,N){for(var M=-1,L=S.length,Y=0,ut=[];++M<L;){var Mt=S[M];(Mt===N||Mt===m)&&(S[M]=m,ut[Y++]=M)}return ut}function Li(S){var N=-1,M=Array(S.size);return S.forEach(function(L){M[++N]=L}),M}function ov(S){var N=-1,M=Array(S.size);return S.forEach(function(L){M[++N]=[L,L]}),M}function iv(S,N,M){for(var L=M-1,Y=S.length;++L<Y;)if(S[L]===N)return L;return-1}function sv(S,N,M){for(var L=M+1;L--;)if(S[L]===N)return L;return L}function Ur(S){return Jr(S)?lv(S):Jw(S)}function $e(S){return Jr(S)?cv(S):Uw(S)}function rp(S){for(var N=S.length;N--&&Yb.test(S.charAt(N)););return N}var av=Xa(Pw);function lv(S){for(var N=Ja.lastIndex=0;Ja.test(S);)++N;return N}function cv(S){return S.match(Ja)||[]}function uv(S){return S.match(Tw)||[]}var hv=function S(N){N=N==null?It:Kr.defaults(It.Object(),N,Kr.pick(It,Rw));var M=N.Array,L=N.Date,Y=N.Error,ut=N.Function,Mt=N.Math,gt=N.Object,rl=N.RegExp,fv=N.String,ke=N.TypeError,Wi=M.prototype,dv=ut.prototype,Hr=gt.prototype,qi=N["__core-js_shared__"],Ji=dv.toString,dt=Hr.hasOwnProperty,pv=0,op=function(){var o=/[^.]+$/.exec(qi&&qi.keys&&qi.keys.IE_PROTO||"");return o?"Symbol(src)_1."+o:""}(),Ui=Hr.toString,mv=Ji.call(gt),gv=It._,_v=rl("^"+Ji.call(dt).replace($a,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ki=Vd?N.Buffer:e,Kn=N.Symbol,Hi=N.Uint8Array,ip=Ki?Ki.allocUnsafe:e,Gi=np(gt.getPrototypeOf,gt),sp=gt.create,ap=Hr.propertyIsEnumerable,Zi=Wi.splice,lp=Kn?Kn.isConcatSpreadable:e,jo=Kn?Kn.iterator:e,pr=Kn?Kn.toStringTag:e,Yi=function(){try{var o=br(gt,"defineProperty");return o({},"",{}),o}catch{}}(),yv=N.clearTimeout!==It.clearTimeout&&N.clearTimeout,bv=L&&L.now!==It.Date.now&&L.now,wv=N.setTimeout!==It.setTimeout&&N.setTimeout,Xi=Mt.ceil,Qi=Mt.floor,ol=gt.getOwnPropertySymbols,vv=Ki?Ki.isBuffer:e,cp=N.isFinite,kv=Wi.join,xv=np(gt.keys,gt),At=Mt.max,Ft=Mt.min,Sv=L.now,Cv=N.parseInt,up=Mt.random,Ov=Wi.reverse,il=br(N,"DataView"),Po=br(N,"Map"),sl=br(N,"Promise"),Gr=br(N,"Set"),Bo=br(N,"WeakMap"),$o=br(gt,"create"),ts=Bo&&new Bo,Zr={},Mv=wr(il),Av=wr(Po),Ev=wr(sl),Tv=wr(Gr),Nv=wr(Bo),es=Kn?Kn.prototype:e,Fo=es?es.valueOf:e,hp=es?es.toString:e;function g(o){if(xt(o)&&!X(o)&&!(o instanceof at)){if(o instanceof xe)return o;if(dt.call(o,"__wrapped__"))return fm(o)}return new xe(o)}var Yr=function(){function o(){}return function(a){if(!kt(a))return{};if(sp)return sp(a);o.prototype=a;var u=new o;return o.prototype=e,u}}();function ns(){}function xe(o,a){this.__wrapped__=o,this.__actions__=[],this.__chain__=!!a,this.__index__=0,this.__values__=e}g.templateSettings={escape:Jb,evaluate:Ub,interpolate:wd,variable:"",imports:{_:g}},g.prototype=ns.prototype,g.prototype.constructor=g,xe.prototype=Yr(ns.prototype),xe.prototype.constructor=xe;function at(o){this.__wrapped__=o,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ln,this.__views__=[]}function Dv(){var o=new at(this.__wrapped__);return o.__actions__=Qt(this.__actions__),o.__dir__=this.__dir__,o.__filtered__=this.__filtered__,o.__iteratees__=Qt(this.__iteratees__),o.__takeCount__=this.__takeCount__,o.__views__=Qt(this.__views__),o}function Rv(){if(this.__filtered__){var o=new at(this);o.__dir__=-1,o.__filtered__=!0}else o=this.clone(),o.__dir__*=-1;return o}function Iv(){var o=this.__wrapped__.value(),a=this.__dir__,u=X(o),f=a<0,p=u?o.length:0,_=Uk(0,p,this.__views__),w=_.start,k=_.end,O=k-w,D=f?k:w-1,R=this.__iteratees__,I=R.length,$=0,U=Ft(O,this.__takeCount__);if(!u||!f&&p==O&&U==O)return zp(o,this.__actions__);var H=[];t:for(;O--&&$<U;){D+=a;for(var nt=-1,G=o[D];++nt<I;){var it=R[nt],lt=it.iteratee,de=it.type,Ht=lt(G);if(de==Ab)G=Ht;else if(!Ht){if(de==md)continue t;break t}}H[$++]=G}return H}at.prototype=Yr(ns.prototype),at.prototype.constructor=at;function mr(o){var a=-1,u=o==null?0:o.length;for(this.clear();++a<u;){var f=o[a];this.set(f[0],f[1])}}function zv(){this.__data__=$o?$o(null):{},this.size=0}function jv(o){var a=this.has(o)&&delete this.__data__[o];return this.size-=a?1:0,a}function Pv(o){var a=this.__data__;if($o){var u=a[o];return u===h?e:u}return dt.call(a,o)?a[o]:e}function Bv(o){var a=this.__data__;return $o?a[o]!==e:dt.call(a,o)}function $v(o,a){var u=this.__data__;return this.size+=this.has(o)?0:1,u[o]=$o&&a===e?h:a,this}mr.prototype.clear=zv,mr.prototype.delete=jv,mr.prototype.get=Pv,mr.prototype.has=Bv,mr.prototype.set=$v;function wn(o){var a=-1,u=o==null?0:o.length;for(this.clear();++a<u;){var f=o[a];this.set(f[0],f[1])}}function Fv(){this.__data__=[],this.size=0}function Vv(o){var a=this.__data__,u=rs(a,o);if(u<0)return!1;var f=a.length-1;return u==f?a.pop():Zi.call(a,u,1),--this.size,!0}function Lv(o){var a=this.__data__,u=rs(a,o);return u<0?e:a[u][1]}function Wv(o){return rs(this.__data__,o)>-1}function qv(o,a){var u=this.__data__,f=rs(u,o);return f<0?(++this.size,u.push([o,a])):u[f][1]=a,this}wn.prototype.clear=Fv,wn.prototype.delete=Vv,wn.prototype.get=Lv,wn.prototype.has=Wv,wn.prototype.set=qv;function vn(o){var a=-1,u=o==null?0:o.length;for(this.clear();++a<u;){var f=o[a];this.set(f[0],f[1])}}function Jv(){this.size=0,this.__data__={hash:new mr,map:new(Po||wn),string:new mr}}function Uv(o){var a=gs(this,o).delete(o);return this.size-=a?1:0,a}function Kv(o){return gs(this,o).get(o)}function Hv(o){return gs(this,o).has(o)}function Gv(o,a){var u=gs(this,o),f=u.size;return u.set(o,a),this.size+=u.size==f?0:1,this}vn.prototype.clear=Jv,vn.prototype.delete=Uv,vn.prototype.get=Kv,vn.prototype.has=Hv,vn.prototype.set=Gv;function gr(o){var a=-1,u=o==null?0:o.length;for(this.__data__=new vn;++a<u;)this.add(o[a])}function Zv(o){return this.__data__.set(o,h),this}function Yv(o){return this.__data__.has(o)}gr.prototype.add=gr.prototype.push=Zv,gr.prototype.has=Yv;function Fe(o){var a=this.__data__=new wn(o);this.size=a.size}function Xv(){this.__data__=new wn,this.size=0}function Qv(o){var a=this.__data__,u=a.delete(o);return this.size=a.size,u}function tk(o){return this.__data__.get(o)}function ek(o){return this.__data__.has(o)}function nk(o,a){var u=this.__data__;if(u instanceof wn){var f=u.__data__;if(!Po||f.length<i-1)return f.push([o,a]),this.size=++u.size,this;u=this.__data__=new vn(f)}return u.set(o,a),this.size=u.size,this}Fe.prototype.clear=Xv,Fe.prototype.delete=Qv,Fe.prototype.get=tk,Fe.prototype.has=ek,Fe.prototype.set=nk;function fp(o,a){var u=X(o),f=!u&&vr(o),p=!u&&!f&&Xn(o),_=!u&&!f&&!p&&eo(o),w=u||f||p||_,k=w?tl(o.length,fv):[],O=k.length;for(var D in o)(a||dt.call(o,D))&&!(w&&(D=="length"||p&&(D=="offset"||D=="parent")||_&&(D=="buffer"||D=="byteLength"||D=="byteOffset")||Cn(D,O)))&&k.push(D);return k}function dp(o){var a=o.length;return a?o[_l(0,a-1)]:e}function rk(o,a){return _s(Qt(o),_r(a,0,o.length))}function ok(o){return _s(Qt(o))}function al(o,a,u){(u!==e&&!Ve(o[a],u)||u===e&&!(a in o))&&kn(o,a,u)}function Vo(o,a,u){var f=o[a];(!(dt.call(o,a)&&Ve(f,u))||u===e&&!(a in o))&&kn(o,a,u)}function rs(o,a){for(var u=o.length;u--;)if(Ve(o[u][0],a))return u;return-1}function ik(o,a,u,f){return Hn(o,function(p,_,w){a(f,p,u(p),w)}),f}function pp(o,a){return o&&un(a,Nt(a),o)}function sk(o,a){return o&&un(a,ee(a),o)}function kn(o,a,u){a=="__proto__"&&Yi?Yi(o,a,{configurable:!0,enumerable:!0,value:u,writable:!0}):o[a]=u}function ll(o,a){for(var u=-1,f=a.length,p=M(f),_=o==null;++u<f;)p[u]=_?e:Ll(o,a[u]);return p}function _r(o,a,u){return o===o&&(u!==e&&(o=o<=u?o:u),a!==e&&(o=o>=a?o:a)),o}function Se(o,a,u,f,p,_){var w,k=a&y,O=a&v,D=a&b;if(u&&(w=p?u(o,f,p,_):u(o)),w!==e)return w;if(!kt(o))return o;var R=X(o);if(R){if(w=Hk(o),!k)return Qt(o,w)}else{var I=Vt(o),$=I==zi||I==gd;if(Xn(o))return Bp(o,k);if(I==bn||I==Vr||$&&!p){if(w=O||$?{}:rm(o),!k)return O?Pk(o,sk(w,o)):jk(o,pp(w,o))}else{if(!_t[I])return p?o:{};w=Gk(o,I,k)}}_||(_=new Fe);var U=_.get(o);if(U)return U;_.set(o,w),Dm(o)?o.forEach(function(G){w.add(Se(G,a,u,G,o,_))}):Tm(o)&&o.forEach(function(G,it){w.set(it,Se(G,a,u,it,o,_))});var H=D?O?Al:Ml:O?ee:Nt,nt=R?e:H(o);return ve(nt||o,function(G,it){nt&&(it=G,G=o[it]),Vo(w,it,Se(G,a,u,it,o,_))}),w}function ak(o){var a=Nt(o);return function(u){return mp(u,o,a)}}function mp(o,a,u){var f=u.length;if(o==null)return!f;for(o=gt(o);f--;){var p=u[f],_=a[p],w=o[p];if(w===e&&!(p in o)||!_(w))return!1}return!0}function gp(o,a,u){if(typeof o!="function")throw new ke(l);return Ho(function(){o.apply(e,u)},a)}function Lo(o,a,u,f){var p=-1,_=Fi,w=!0,k=o.length,O=[],D=a.length;if(!k)return O;u&&(a=wt(a,ue(u))),f?(_=Ha,w=!1):a.length>=i&&(_=zo,w=!1,a=new gr(a));t:for(;++p<k;){var R=o[p],I=u==null?R:u(R);if(R=f||R!==0?R:0,w&&I===I){for(var $=D;$--;)if(a[$]===I)continue t;O.push(R)}else _(a,I,f)||O.push(R)}return O}var Hn=Wp(cn),_p=Wp(ul,!0);function lk(o,a){var u=!0;return Hn(o,function(f,p,_){return u=!!a(f,p,_),u}),u}function is(o,a,u){for(var f=-1,p=o.length;++f<p;){var _=o[f],w=a(_);if(w!=null&&(k===e?w===w&&!fe(w):u(w,k)))var k=w,O=_}return O}function ck(o,a,u,f){var p=o.length;for(u=et(u),u<0&&(u=-u>p?0:p+u),f=f===e||f>p?p:et(f),f<0&&(f+=p),f=u>f?0:Im(f);u<f;)o[u++]=a;return o}function yp(o,a){var u=[];return Hn(o,function(f,p,_){a(f,p,_)&&u.push(f)}),u}function zt(o,a,u,f,p){var _=-1,w=o.length;for(u||(u=Yk),p||(p=[]);++_<w;){var k=o[_];a>0&&u(k)?a>1?zt(k,a-1,u,f,p):Jn(p,k):f||(p[p.length]=k)}return p}var cl=qp(),bp=qp(!0);function cn(o,a){return o&&cl(o,a,Nt)}function ul(o,a){return o&&bp(o,a,Nt)}function ss(o,a){return qn(a,function(u){return On(o[u])})}function yr(o,a){a=Zn(a,o);for(var u=0,f=a.length;o!=null&&u<f;)o=o[hn(a[u++])];return u&&u==f?o:e}function wp(o,a,u){var f=a(o);return X(o)?f:Jn(f,u(o))}function Ut(o){return o==null?o===e?Bb:jb:pr&&pr in gt(o)?Jk(o):ox(o)}function hl(o,a){return o>a}function uk(o,a){return o!=null&&dt.call(o,a)}function hk(o,a){return o!=null&&a in gt(o)}function fk(o,a,u){return o>=Ft(a,u)&&o<At(a,u)}function fl(o,a,u){for(var f=u?Ha:Fi,p=o[0].length,_=o.length,w=_,k=M(_),O=1/0,D=[];w--;){var R=o[w];w&&a&&(R=wt(R,ue(a))),O=Ft(R.length,O),k[w]=!u&&(a||p>=120&&R.length>=120)?new gr(w&&R):e}R=o[0];var I=-1,$=k[0];t:for(;++I<p&&D.length<O;){var U=R[I],H=a?a(U):U;if(U=u||U!==0?U:0,!($?zo($,H):f(D,H,u))){for(w=_;--w;){var nt=k[w];if(!(nt?zo(nt,H):f(o[w],H,u)))continue t}$&&$.push(H),D.push(U)}}return D}function dk(o,a,u,f){return cn(o,function(p,_,w){a(f,u(p),_,w)}),f}function Wo(o,a,u){a=Zn(a,o),o=am(o,a);var f=o==null?o:o[hn(Oe(a))];return f==null?e:ce(f,o,u)}function vp(o){return xt(o)&&Ut(o)==Vr}function pk(o){return xt(o)&&Ut(o)==Io}function mk(o){return xt(o)&&Ut(o)==Eo}function qo(o,a,u,f,p){return o===a?!0:o==null||a==null||!xt(o)&&!xt(a)?o!==o&&a!==a:gk(o,a,u,f,qo,p)}function gk(o,a,u,f,p,_){var w=X(o),k=X(a),O=w?Ri:Vt(o),D=k?Ri:Vt(a);O=O==Vr?bn:O,D=D==Vr?bn:D;var R=O==bn,I=D==bn,$=O==D;if($&&Xn(o)){if(!Xn(a))return!1;w=!0,R=!1}if($&&!R)return _||(_=new Fe),w||eo(o)?tm(o,a,u,f,p,_):Wk(o,a,O,u,f,p,_);if(!(u&C)){var U=R&&dt.call(o,"__wrapped__"),H=I&&dt.call(a,"__wrapped__");if(U||H){var nt=U?o.value():o,G=H?a.value():a;return _||(_=new Fe),p(nt,G,u,f,_)}}return $?(_||(_=new Fe),qk(o,a,u,f,p,_)):!1}function _k(o){return xt(o)&&Vt(o)==Pe}function dl(o,a,u,f){var p=u.length,_=p,w=!f;if(o==null)return!_;for(o=gt(o);p--;){var k=u[p];if(w&&k[2]?k[1]!==o[k[0]]:!(k[0]in o))return!1}for(;++p<_;){k=u[p];var O=k[0],D=o[O],R=k[1];if(w&&k[2]){if(D===e&&!(O in o))return!1}else{var I=new Fe;if(f)var $=f(D,R,O,o,a,I);if(!($===e?qo(R,D,C|T,f,I):$))return!1}}return!0}function kp(o){if(!kt(o)||Qk(o))return!1;var a=On(o)?_v:aw;return a.test(wr(o))}function yk(o){return xt(o)&&Ut(o)==No}function bk(o){return xt(o)&&Vt(o)==Be}function wk(o){return xt(o)&&xs(o.length)&&!!bt[Ut(o)]}function xp(o){return typeof o=="function"?o:o==null?ne:typeof o=="object"?X(o)?Op(o[0],o[1]):Cp(o):Jm(o)}function pl(o){if(!Ko(o))return xv(o);var a=[];for(var u in gt(o))dt.call(o,u)&&u!="constructor"&&a.push(u);return a}function vk(o){if(!kt(o))return rx(o);var a=Ko(o),u=[];for(var f in o)f=="constructor"&&(a||!dt.call(o,f))||u.push(f);return u}function ml(o,a){return o<a}function Sp(o,a){var u=-1,f=te(o)?M(o.length):[];return Hn(o,function(p,_,w){f[++u]=a(p,_,w)}),f}function Cp(o){var a=Tl(o);return a.length==1&&a[0][2]?im(a[0][0],a[0][1]):function(u){return u===o||dl(u,o,a)}}function Op(o,a){return Dl(o)&&om(a)?im(hn(o),a):function(u){var f=Ll(u,o);return f===e&&f===a?Wl(u,o):qo(a,f,C|T)}}function as(o,a,u,f,p){o!==a&&cl(a,function(_,w){if(p||(p=new Fe),kt(_))kk(o,a,w,u,as,f,p);else{var k=f?f(Il(o,w),_,w+"",o,a,p):e;k===e&&(k=_),al(o,w,k)}},ee)}function kk(o,a,u,f,p,_,w){var k=Il(o,u),O=Il(a,u),D=w.get(O);if(D){al(o,u,D);return}var R=_?_(k,O,u+"",o,a,w):e,I=R===e;if(I){var $=X(O),U=!$&&Xn(O),H=!$&&!U&&eo(O);R=O,$||U||H?X(k)?R=k:St(k)?R=Qt(k):U?(I=!1,R=Bp(O,!0)):H?(I=!1,R=$p(O,!0)):R=[]:Go(O)||vr(O)?(R=k,vr(k)?R=zm(k):(!kt(k)||On(k))&&(R=rm(O))):I=!1}I&&(w.set(O,R),p(R,O,f,_,w),w.delete(O)),al(o,u,R)}function Mp(o,a){var u=o.length;if(u)return a+=a<0?u:0,Cn(a,u)?o[a]:e}function Ap(o,a,u){a.length?a=wt(a,function(_){return X(_)?function(w){return yr(w,_.length===1?_[0]:_)}:_}):a=[ne];var f=-1;a=wt(a,ue(K()));var p=Sp(o,function(_,w,k){var O=wt(a,function(D){return D(_)});return{criteria:O,index:++f,value:_}});return Gw(p,function(_,w){return zk(_,w,u)})}function xk(o,a){return Ep(o,a,function(u,f){return Wl(o,f)})}function Ep(o,a,u){for(var f=-1,p=a.length,_={};++f<p;){var w=a[f],k=yr(o,w);u(k,w)&&Jo(_,Zn(w,o),k)}return _}function Sk(o){return function(a){return yr(a,o)}}function gl(o,a,u,f){var p=f?Hw:qr,_=-1,w=a.length,k=o;for(o===a&&(a=Qt(a)),u&&(k=wt(o,ue(u)));++_<w;)for(var O=0,D=a[_],R=u?u(D):D;(O=p(k,R,O,f))>-1;)k!==o&&Zi.call(k,O,1),Zi.call(o,O,1);return o}function Tp(o,a){for(var u=o?a.length:0,f=u-1;u--;){var p=a[u];if(u==f||p!==_){var _=p;Cn(p)?Zi.call(o,p,1):wl(o,p)}}return o}function _l(o,a){return o+Qi(up()*(a-o+1))}function Ck(o,a,u,f){for(var p=-1,_=At(Xi((a-o)/(u||1)),0),w=M(_);_--;)w[f?_:++p]=o,o+=u;return w}function yl(o,a){var u="";if(!o||a<1||a>Wn)return u;do a%2&&(u+=o),a=Qi(a/2),a&&(o+=o);while(a);return u}function rt(o,a){return zl(sm(o,a,ne),o+"")}function Ok(o){return dp(no(o))}function Mk(o,a){var u=no(o);return _s(u,_r(a,0,u.length))}function Jo(o,a,u,f){if(!kt(o))return o;a=Zn(a,o);for(var p=-1,_=a.length,w=_-1,k=o;k!=null&&++p<_;){var O=hn(a[p]),D=u;if(O==="__proto__"||O==="constructor"||O==="prototype")return o;if(p!=w){var R=k[O];D=f?f(R,O,k):e,D===e&&(D=kt(R)?R:Cn(a[p+1])?[]:{})}Vo(k,O,D),k=k[O]}return o}var Np=ts?function(o,a){return ts.set(o,a),o}:ne,Ak=Yi?function(o,a){return Yi(o,"toString",{configurable:!0,enumerable:!1,value:Jl(a),writable:!0})}:ne;function Ek(o){return _s(no(o))}function Ce(o,a,u){var f=-1,p=o.length;a<0&&(a=-a>p?0:p+a),u=u>p?p:u,u<0&&(u+=p),p=a>u?0:u-a>>>0,a>>>=0;for(var _=M(p);++f<p;)_[f]=o[f+a];return _}function Tk(o,a){var u;return Hn(o,function(f,p,_){return u=a(f,p,_),!u}),!!u}function ls(o,a,u){var f=0,p=o==null?f:o.length;if(typeof a=="number"&&a===a&&p<=Db){for(;f<p;){var _=f+p>>>1,w=o[_];w!==null&&!fe(w)&&(u?w<=a:w<a)?f=_+1:p=_}return p}return bl(o,a,ne,u)}function bl(o,a,u,f){var p=0,_=o==null?0:o.length;if(_===0)return 0;a=u(a);for(var w=a!==a,k=a===null,O=fe(a),D=a===e;p<_;){var R=Qi((p+_)/2),I=u(o[R]),$=I!==e,U=I===null,H=I===I,nt=fe(I);if(w)var G=f||H;else D?G=H&&(f||$):k?G=H&&$&&(f||!U):O?G=H&&$&&!U&&(f||!nt):U||nt?G=!1:G=f?I<=a:I<a;G?p=R+1:_=R}return Ft(_,Nb)}function Dp(o,a){for(var u=-1,f=o.length,p=0,_=[];++u<f;){var w=o[u],k=a?a(w):w;if(!u||!Ve(k,O)){var O=k;_[p++]=w===0?0:w}}return _}function Rp(o){return typeof o=="number"?o:fe(o)?Di:+o}function he(o){if(typeof o=="string")return o;if(X(o))return wt(o,he)+"";if(fe(o))return hp?hp.call(o):"";var a=o+"";return a=="0"&&1/o==-fr?"-0":a}function Gn(o,a,u){var f=-1,p=Fi,_=o.length,w=!0,k=[],O=k;if(u)w=!1,p=Ha;else if(_>=i){var D=a?null:Vk(o);if(D)return Li(D);w=!1,p=zo,O=new gr}else O=a?[]:k;t:for(;++f<_;){var R=o[f],I=a?a(R):R;if(R=u||R!==0?R:0,w&&I===I){for(var $=O.length;$--;)if(O[$]===I)continue t;a&&O.push(I),k.push(R)}else p(O,I,u)||(O!==k&&O.push(I),k.push(R))}return k}function wl(o,a){return a=Zn(a,o),o=am(o,a),o==null||delete o[hn(Oe(a))]}function Ip(o,a,u,f){return Jo(o,a,u(yr(o,a)),f)}function cs(o,a,u,f){for(var p=o.length,_=f?p:-1;(f?_--:++_<p)&&a(o[_],_,o););return u?Ce(o,f?0:_,f?_+1:p):Ce(o,f?_+1:0,f?p:_)}function zp(o,a){var u=o;return u instanceof at&&(u=u.value()),Ga(a,function(f,p){return p.func.apply(p.thisArg,Jn([f],p.args))},u)}function vl(o,a,u){var f=o.length;if(f<2)return f?Gn(o[0]):[];for(var p=-1,_=M(f);++p<f;)for(var w=o[p],k=-1;++k<f;)k!=p&&(_[p]=Lo(_[p]||w,o[k],a,u));return Gn(zt(_,1),a,u)}function jp(o,a,u){for(var f=-1,p=o.length,_=a.length,w={};++f<p;){var k=f<_?a[f]:e;u(w,o[f],k)}return w}function kl(o){return St(o)?o:[]}function xl(o){return typeof o=="function"?o:ne}function Zn(o,a){return X(o)?o:Dl(o,a)?[o]:hm(ft(o))}var Nk=rt;function Yn(o,a,u){var f=o.length;return u=u===e?f:u,!a&&u>=f?o:Ce(o,a,u)}var Pp=yv||function(o){return It.clearTimeout(o)};function Bp(o,a){if(a)return o.slice();var u=o.length,f=ip?ip(u):new o.constructor(u);return o.copy(f),f}function Sl(o){var a=new o.constructor(o.byteLength);return new Hi(a).set(new Hi(o)),a}function Dk(o,a){var u=a?Sl(o.buffer):o.buffer;return new o.constructor(u,o.byteOffset,o.byteLength)}function Rk(o){var a=new o.constructor(o.source,vd.exec(o));return a.lastIndex=o.lastIndex,a}function Ik(o){return Fo?gt(Fo.call(o)):{}}function $p(o,a){var u=a?Sl(o.buffer):o.buffer;return new o.constructor(u,o.byteOffset,o.length)}function Fp(o,a){if(o!==a){var u=o!==e,f=o===null,p=o===o,_=fe(o),w=a!==e,k=a===null,O=a===a,D=fe(a);if(!k&&!D&&!_&&o>a||_&&w&&O&&!k&&!D||f&&w&&O||!u&&O||!p)return 1;if(!f&&!_&&!D&&o<a||D&&u&&p&&!f&&!_||k&&u&&p||!w&&p||!O)return-1}return 0}function zk(o,a,u){for(var f=-1,p=o.criteria,_=a.criteria,w=p.length,k=u.length;++f<w;){var O=Fp(p[f],_[f]);if(O){if(f>=k)return O;var D=u[f];return O*(D=="desc"?-1:1)}}return o.index-a.index}function Vp(o,a,u,f){for(var p=-1,_=o.length,w=u.length,k=-1,O=a.length,D=At(_-w,0),R=M(O+D),I=!f;++k<O;)R[k]=a[k];for(;++p<w;)(I||p<_)&&(R[u[p]]=o[p]);for(;D--;)R[k++]=o[p++];return R}function Lp(o,a,u,f){for(var p=-1,_=o.length,w=-1,k=u.length,O=-1,D=a.length,R=At(_-k,0),I=M(R+D),$=!f;++p<R;)I[p]=o[p];for(var U=p;++O<D;)I[U+O]=a[O];for(;++w<k;)($||p<_)&&(I[U+u[w]]=o[p++]);return I}function Qt(o,a){var u=-1,f=o.length;for(a||(a=M(f));++u<f;)a[u]=o[u];return a}function un(o,a,u,f){var p=!u;u||(u={});for(var _=-1,w=a.length;++_<w;){var k=a[_],O=f?f(u[k],o[k],k,u,o):e;O===e&&(O=o[k]),p?kn(u,k,O):Vo(u,k,O)}return u}function jk(o,a){return un(o,Nl(o),a)}function Pk(o,a){return un(o,em(o),a)}function us(o,a){return function(u,f){var p=X(u)?Lw:ik,_=a?a():{};return p(u,o,K(f,2),_)}}function Xr(o){return rt(function(a,u){var f=-1,p=u.length,_=p>1?u[p-1]:e,w=p>2?u[2]:e;for(_=o.length>3&&typeof _=="function"?(p--,_):e,w&&Kt(u[0],u[1],w)&&(_=p<3?e:_,p=1),a=gt(a);++f<p;){var k=u[f];k&&o(a,k,f,_)}return a})}function Wp(o,a){return function(u,f){if(u==null)return u;if(!te(u))return o(u,f);for(var p=u.length,_=a?p:-1,w=gt(u);(a?_--:++_<p)&&f(w[_],_,w)!==!1;);return u}}function qp(o){return function(a,u,f){for(var p=-1,_=gt(a),w=f(a),k=w.length;k--;){var O=w[o?k:++p];if(u(_[O],O,_)===!1)break}return a}}function Bk(o,a,u){var f=a&P,p=Uo(o);function _(){var w=this&&this!==It&&this instanceof _?p:o;return w.apply(f?u:this,arguments)}return _}function Jp(o){return function(a){a=ft(a);var u=Jr(a)?$e(a):e,f=u?u[0]:a.charAt(0),p=u?Yn(u,1).join(""):a.slice(1);return f[o]()+p}}function Qr(o){return function(a){return Ga(Wm(Lm(a).replace(Aw,"")),o,"")}}function Uo(o){return function(){var a=arguments;switch(a.length){case 0:return new o;case 1:return new o(a[0]);case 2:return new o(a[0],a[1]);case 3:return new o(a[0],a[1],a[2]);case 4:return new o(a[0],a[1],a[2],a[3]);case 5:return new o(a[0],a[1],a[2],a[3],a[4]);case 6:return new o(a[0],a[1],a[2],a[3],a[4],a[5]);case 7:return new o(a[0],a[1],a[2],a[3],a[4],a[5],a[6])}var u=Yr(o.prototype),f=o.apply(u,a);return kt(f)?f:u}}function $k(o,a,u){var f=Uo(o);function p(){for(var _=arguments.length,w=M(_),k=_,O=to(p);k--;)w[k]=arguments[k];var D=_<3&&w[0]!==O&&w[_-1]!==O?[]:Un(w,O);if(_-=D.length,_<u)return Zp(o,a,hs,p.placeholder,e,w,D,e,e,u-_);var R=this&&this!==It&&this instanceof p?f:o;return ce(R,this,w)}return p}function Up(o){return function(a,u,f){var p=gt(a);if(!te(a)){var _=K(u,3);a=Nt(a),u=function(k){return _(p[k],k,p)}}var w=o(a,u,f);return w>-1?p[_?a[w]:w]:e}}function Kp(o){return Sn(function(a){var u=a.length,f=u,p=xe.prototype.thru;for(o&&a.reverse();f--;){var _=a[f];if(typeof _!="function")throw new ke(l);if(p&&!w&&ms(_)=="wrapper")var w=new xe([],!0)}for(f=w?f:u;++f<u;){_=a[f];var k=ms(_),O=k=="wrapper"?El(_):e;O&&Rl(O[0])&&O[1]==(Xt|st|yt|tt)&&!O[4].length&&O[9]==1?w=w[ms(O[0])].apply(w,O[3]):w=_.length==1&&Rl(_)?w[k]():w.thru(_)}return function(){var D=arguments,R=D[0];if(w&&D.length==1&&X(R))return w.plant(R).value();for(var I=0,$=u?a[I].apply(this,D):R;++I<u;)$=a[I].call(this,$);return $}})}function hs(o,a,u,f,p,_,w,k,O,D){var R=a&Xt,I=a&P,$=a&J,U=a&(st|ot),H=a&yn,nt=$?e:Uo(o);function G(){for(var it=arguments.length,lt=M(it),de=it;de--;)lt[de]=arguments[de];if(U)var Ht=to(G),pe=Yw(lt,Ht);if(f&&(lt=Vp(lt,f,p,U)),_&&(lt=Lp(lt,_,w,U)),it-=pe,U&&it<D){var Ct=Un(lt,Ht);return Zp(o,a,hs,G.placeholder,u,lt,Ct,k,O,D-it)}var Le=I?u:this,An=$?Le[o]:o;return it=lt.length,k?lt=ix(lt,k):H&&it>1&&lt.reverse(),R&&O<it&&(lt.length=O),this&&this!==It&&this instanceof G&&(An=nt||Uo(An)),An.apply(Le,lt)}return G}function Hp(o,a){return function(u,f){return dk(u,o,a(f),{})}}function fs(o,a){return function(u,f){var p;if(u===e&&f===e)return a;if(u!==e&&(p=u),f!==e){if(p===e)return f;typeof u=="string"||typeof f=="string"?(u=he(u),f=he(f)):(u=Rp(u),f=Rp(f)),p=o(u,f)}return p}}function Cl(o){return Sn(function(a){return a=wt(a,ue(K())),rt(function(u){var f=this;return o(a,function(p){return ce(p,f,u)})})})}function ds(o,a){a=a===e?" ":he(a);var u=a.length;if(u<2)return u?yl(a,o):a;var f=yl(a,Xi(o/Ur(a)));return Jr(a)?Yn($e(f),0,o).join(""):f.slice(0,o)}function Fk(o,a,u,f){var p=a&P,_=Uo(o);function w(){for(var k=-1,O=arguments.length,D=-1,R=f.length,I=M(R+O),$=this&&this!==It&&this instanceof w?_:o;++D<R;)I[D]=f[D];for(;O--;)I[D++]=arguments[++k];return ce($,p?u:this,I)}return w}function Gp(o){return function(a,u,f){return f&&typeof f!="number"&&Kt(a,u,f)&&(u=f=e),a=Mn(a),u===e?(u=a,a=0):u=Mn(u),f=f===e?a<u?1:-1:Mn(f),Ck(a,u,f,o)}}function ps(o){return function(a,u){return typeof a=="string"&&typeof u=="string"||(a=Me(a),u=Me(u)),o(a,u)}}function Zp(o,a,u,f,p,_,w,k,O,D){var R=a&st,I=R?w:e,$=R?e:w,U=R?_:e,H=R?e:_;a|=R?yt:an,a&=~(R?an:yt),a&mt||(a&=~(P|J));var nt=[o,a,p,U,I,H,$,k,O,D],G=u.apply(e,nt);return Rl(o)&&lm(G,nt),G.placeholder=f,cm(G,o,a)}function Ol(o){var a=Mt[o];return function(u,f){if(u=Me(u),f=f==null?0:Ft(et(f),292),f&&cp(u)){var p=(ft(u)+"e").split("e"),_=a(p[0]+"e"+(+p[1]+f));return p=(ft(_)+"e").split("e"),+(p[0]+"e"+(+p[1]-f))}return a(u)}}var Vk=Gr&&1/Li(new Gr([,-0]))[1]==fr?function(o){return new Gr(o)}:Hl;function Yp(o){return function(a){var u=Vt(a);return u==Pe?nl(a):u==Be?ov(a):Zw(a,o(a))}}function xn(o,a,u,f,p,_,w,k){var O=a&J;if(!O&&typeof o!="function")throw new ke(l);var D=f?f.length:0;if(D||(a&=~(yt|an),f=p=e),w=w===e?w:At(et(w),0),k=k===e?k:et(k),D-=p?p.length:0,a&an){var R=f,I=p;f=p=e}var $=O?e:El(o),U=[o,a,u,f,p,R,I,_,w,k];if($&&nx(U,$),o=U[0],a=U[1],u=U[2],f=U[3],p=U[4],k=U[9]=U[9]===e?O?0:o.length:At(U[9]-D,0),!k&&a&(st|ot)&&(a&=~(st|ot)),!a||a==P)var H=Bk(o,a,u);else a==st||a==ot?H=$k(o,a,k):(a==yt||a==(P|yt))&&!p.length?H=Fk(o,a,u,f):H=hs.apply(e,U);var nt=$?Np:lm;return cm(nt(H,U),o,a)}function Xp(o,a,u,f){return o===e||Ve(o,Hr[u])&&!dt.call(f,u)?a:o}function Qp(o,a,u,f,p,_){return kt(o)&&kt(a)&&(_.set(a,o),as(o,a,e,Qp,_),_.delete(a)),o}function Lk(o){return Go(o)?e:o}function tm(o,a,u,f,p,_){var w=u&C,k=o.length,O=a.length;if(k!=O&&!(w&&O>k))return!1;var D=_.get(o),R=_.get(a);if(D&&R)return D==a&&R==o;var I=-1,$=!0,U=u&T?new gr:e;for(_.set(o,a),_.set(a,o);++I<k;){var H=o[I],nt=a[I];if(f)var G=w?f(nt,H,I,a,o,_):f(H,nt,I,o,a,_);if(G!==e){if(G)continue;$=!1;break}if(U){if(!Za(a,function(it,lt){if(!zo(U,lt)&&(H===it||p(H,it,u,f,_)))return U.push(lt)})){$=!1;break}}else if(!(H===nt||p(H,nt,u,f,_))){$=!1;break}}return _.delete(o),_.delete(a),$}function Wk(o,a,u,f,p,_,w){switch(u){case Lr:if(o.byteLength!=a.byteLength||o.byteOffset!=a.byteOffset)return!1;o=o.buffer,a=a.buffer;case Io:return!(o.byteLength!=a.byteLength||!_(new Hi(o),new Hi(a)));case Ao:case Eo:case To:return Ve(+o,+a);case Ii:return o.name==a.name&&o.message==a.message;case No:case Do:return o==a+"";case Pe:var k=nl;case Be:var O=f&C;if(k||(k=Li),o.size!=a.size&&!O)return!1;var D=w.get(o);if(D)return D==a;f|=T,w.set(o,a);var R=tm(k(o),k(a),f,p,_,w);return w.delete(o),R;case ji:if(Fo)return Fo.call(o)==Fo.call(a)}return!1}function qk(o,a,u,f,p,_){var w=u&C,k=Ml(o),O=k.length,D=Ml(a),R=D.length;if(O!=R&&!w)return!1;for(var I=O;I--;){var $=k[I];if(!(w?$ in a:dt.call(a,$)))return!1}var U=_.get(o),H=_.get(a);if(U&&H)return U==a&&H==o;var nt=!0;_.set(o,a),_.set(a,o);for(var G=w;++I<O;){$=k[I];var it=o[$],lt=a[$];if(f)var de=w?f(lt,it,$,a,o,_):f(it,lt,$,o,a,_);if(!(de===e?it===lt||p(it,lt,u,f,_):de)){nt=!1;break}G||(G=$=="constructor")}if(nt&&!G){var Ht=o.constructor,pe=a.constructor;Ht!=pe&&"constructor"in o&&"constructor"in a&&!(typeof Ht=="function"&&Ht instanceof Ht&&typeof pe=="function"&&pe instanceof pe)&&(nt=!1)}return _.delete(o),_.delete(a),nt}function Sn(o){return zl(sm(o,e,mm),o+"")}function Ml(o){return wp(o,Nt,Nl)}function Al(o){return wp(o,ee,em)}var El=ts?function(o){return ts.get(o)}:Hl;function ms(o){for(var a=o.name+"",u=Zr[a],f=dt.call(Zr,a)?u.length:0;f--;){var p=u[f],_=p.func;if(_==null||_==o)return p.name}return a}function to(o){var a=dt.call(g,"placeholder")?g:o;return a.placeholder}function K(){var o=g.iteratee||Ul;return o=o===Ul?xp:o,arguments.length?o(arguments[0],arguments[1]):o}function gs(o,a){var u=o.__data__;return Xk(a)?u[typeof a=="string"?"string":"hash"]:u.map}function Tl(o){for(var a=Nt(o),u=a.length;u--;){var f=a[u],p=o[f];a[u]=[f,p,om(p)]}return a}function br(o,a){var u=ev(o,a);return kp(u)?u:e}function Jk(o){var a=dt.call(o,pr),u=o[pr];try{o[pr]=e;var f=!0}catch{}var p=Ui.call(o);return f&&(a?o[pr]=u:delete o[pr]),p}var Nl=ol?function(o){return o==null?[]:(o=gt(o),qn(ol(o),function(a){return ap.call(o,a)}))}:Gl,em=ol?function(o){for(var a=[];o;)Jn(a,Nl(o)),o=Gi(o);return a}:Gl,Vt=Ut;(il&&Vt(new il(new ArrayBuffer(1)))!=Lr||Po&&Vt(new Po)!=Pe||sl&&Vt(sl.resolve())!=_d||Gr&&Vt(new Gr)!=Be||Bo&&Vt(new Bo)!=Ro)&&(Vt=function(o){var a=Ut(o),u=a==bn?o.constructor:e,f=u?wr(u):"";if(f)switch(f){case Mv:return Lr;case Av:return Pe;case Ev:return _d;case Tv:return Be;case Nv:return Ro}return a});function Uk(o,a,u){for(var f=-1,p=u.length;++f<p;){var _=u[f],w=_.size;switch(_.type){case"drop":o+=w;break;case"dropRight":a-=w;break;case"take":a=Ft(a,o+w);break;case"takeRight":o=At(o,a-w);break}}return{start:o,end:a}}function Kk(o){var a=o.match(Qb);return a?a[1].split(tw):[]}function nm(o,a,u){a=Zn(a,o);for(var f=-1,p=a.length,_=!1;++f<p;){var w=hn(a[f]);if(!(_=o!=null&&u(o,w)))break;o=o[w]}return _||++f!=p?_:(p=o==null?0:o.length,!!p&&xs(p)&&Cn(w,p)&&(X(o)||vr(o)))}function Hk(o){var a=o.length,u=new o.constructor(a);return a&&typeof o[0]=="string"&&dt.call(o,"index")&&(u.index=o.index,u.input=o.input),u}function rm(o){return typeof o.constructor=="function"&&!Ko(o)?Yr(Gi(o)):{}}function Gk(o,a,u){var f=o.constructor;switch(a){case Io:return Sl(o);case Ao:case Eo:return new f(+o);case Lr:return Dk(o,u);case Ta:case Na:case Da:case Ra:case Ia:case za:case ja:case Pa:case Ba:return $p(o,u);case Pe:return new f;case To:case Do:return new f(o);case No:return Rk(o);case Be:return new f;case ji:return Ik(o)}}function Zk(o,a){var u=a.length;if(!u)return o;var f=u-1;return a[f]=(u>1?"& ":"")+a[f],a=a.join(u>2?", ":" "),o.replace(Xb,`{
/* [wrapped with `+a+`] */
`)}function Yk(o){return X(o)||vr(o)||!!(lp&&o&&o[lp])}function Cn(o,a){var u=typeof o;return a=a!=null?a:Wn,!!a&&(u=="number"||u!="symbol"&&cw.test(o))&&o>-1&&o%1==0&&o<a}function Kt(o,a,u){if(!kt(u))return!1;var f=typeof a;return(f=="number"?te(u)&&Cn(a,u.length):f=="string"&&a in u)?Ve(u[a],o):!1}function Dl(o,a){if(X(o))return!1;var u=typeof o;return u=="number"||u=="symbol"||u=="boolean"||o==null||fe(o)?!0:Hb.test(o)||!Kb.test(o)||a!=null&&o in gt(a)}function Xk(o){var a=typeof o;return a=="string"||a=="number"||a=="symbol"||a=="boolean"?o!=="__proto__":o===null}function Rl(o){var a=ms(o),u=g[a];if(typeof u!="function"||!(a in at.prototype))return!1;if(o===u)return!0;var f=El(u);return!!f&&o===f[0]}function Qk(o){return!!op&&op in o}var tx=qi?On:Zl;function Ko(o){var a=o&&o.constructor,u=typeof a=="function"&&a.prototype||Hr;return o===u}function om(o){return o===o&&!kt(o)}function im(o,a){return function(u){return u==null?!1:u[o]===a&&(a!==e||o in gt(u))}}function ex(o){var a=vs(o,function(f){return u.size===d&&u.clear(),f}),u=a.cache;return a}function nx(o,a){var u=o[1],f=a[1],p=u|f,_=p<(P|J|Xt),w=f==Xt&&u==st||f==Xt&&u==tt&&o[7].length<=a[8]||f==(Xt|tt)&&a[7].length<=a[8]&&u==st;if(!(_||w))return o;f&P&&(o[2]=a[2],p|=u&P?0:mt);var k=a[3];if(k){var O=o[3];o[3]=O?Vp(O,k,a[4]):k,o[4]=O?Un(o[3],m):a[4]}return k=a[5],k&&(O=o[5],o[5]=O?Lp(O,k,a[6]):k,o[6]=O?Un(o[5],m):a[6]),k=a[7],k&&(o[7]=k),f&Xt&&(o[8]=o[8]==null?a[8]:Ft(o[8],a[8])),o[9]==null&&(o[9]=a[9]),o[0]=a[0],o[1]=p,o}function rx(o){var a=[];if(o!=null)for(var u in gt(o))a.push(u);return a}function ox(o){return Ui.call(o)}function sm(o,a,u){return a=At(a===e?o.length-1:a,0),function(){for(var f=arguments,p=-1,_=At(f.length-a,0),w=M(_);++p<_;)w[p]=f[a+p];p=-1;for(var k=M(a+1);++p<a;)k[p]=f[p];return k[a]=u(w),ce(o,this,k)}}function am(o,a){return a.length<2?o:yr(o,Ce(a,0,-1))}function ix(o,a){for(var u=o.length,f=Ft(a.length,u),p=Qt(o);f--;){var _=a[f];o[f]=Cn(_,u)?p[_]:e}return o}function Il(o,a){if(!(a==="constructor"&&typeof o[a]=="function")&&a!="__proto__")return o[a]}var lm=um(Np),Ho=wv||function(o,a){return It.setTimeout(o,a)},zl=um(Ak);function cm(o,a,u){var f=a+"";return zl(o,Zk(f,sx(Kk(f),u)))}function um(o){var a=0,u=0;return function(){var f=Sv(),p=Mb-(f-u);if(u=f,p>0){if(++a>=Ob)return arguments[0]}else a=0;return o.apply(e,arguments)}}function _s(o,a){var u=-1,f=o.length,p=f-1;for(a=a===e?f:a;++u<a;){var _=_l(u,p),w=o[_];o[_]=o[u],o[u]=w}return o.length=a,o}var hm=ex(function(o){var a=[];return o.charCodeAt(0)===46&&a.push(""),o.replace(Gb,function(u,f,p,_){a.push(p?_.replace(rw,"$1"):f||u)}),a});function hn(o){if(typeof o=="string"||fe(o))return o;var a=o+"";return a=="0"&&1/o==-fr?"-0":a}function wr(o){if(o!=null){try{return Ji.call(o)}catch{}try{return o+""}catch{}}return""}function sx(o,a){return ve(Rb,function(u){var f="_."+u[0];a&u[1]&&!Fi(o,f)&&o.push(f)}),o.sort()}function fm(o){if(o instanceof at)return o.clone();var a=new xe(o.__wrapped__,o.__chain__);return a.__actions__=Qt(o.__actions__),a.__index__=o.__index__,a.__values__=o.__values__,a}function ax(o,a,u){(u?Kt(o,a,u):a===e)?a=1:a=At(et(a),0);var f=o==null?0:o.length;if(!f||a<1)return[];for(var p=0,_=0,w=M(Xi(f/a));p<f;)w[_++]=Ce(o,p,p+=a);return w}function lx(o){for(var a=-1,u=o==null?0:o.length,f=0,p=[];++a<u;){var _=o[a];_&&(p[f++]=_)}return p}function cx(){var o=arguments.length;if(!o)return[];for(var a=M(o-1),u=arguments[0],f=o;f--;)a[f-1]=arguments[f];return Jn(X(u)?Qt(u):[u],zt(a,1))}var ux=rt(function(o,a){return St(o)?Lo(o,zt(a,1,St,!0)):[]}),hx=rt(function(o,a){var u=Oe(a);return St(u)&&(u=e),St(o)?Lo(o,zt(a,1,St,!0),K(u,2)):[]}),fx=rt(function(o,a){var u=Oe(a);return St(u)&&(u=e),St(o)?Lo(o,zt(a,1,St,!0),e,u):[]});function dx(o,a,u){var f=o==null?0:o.length;return f?(a=u||a===e?1:et(a),Ce(o,a<0?0:a,f)):[]}function px(o,a,u){var f=o==null?0:o.length;return f?(a=u||a===e?1:et(a),a=f-a,Ce(o,0,a<0?0:a)):[]}function mx(o,a){return o&&o.length?cs(o,K(a,3),!0,!0):[]}function gx(o,a){return o&&o.length?cs(o,K(a,3),!0):[]}function _x(o,a,u,f){var p=o==null?0:o.length;return p?(u&&typeof u!="number"&&Kt(o,a,u)&&(u=0,f=p),ck(o,a,u,f)):[]}function dm(o,a,u){var f=o==null?0:o.length;if(!f)return-1;var p=u==null?0:et(u);return p<0&&(p=At(f+p,0)),Vi(o,K(a,3),p)}function pm(o,a,u){var f=o==null?0:o.length;if(!f)return-1;var p=f-1;return u!==e&&(p=et(u),p=u<0?At(f+p,0):Ft(p,f-1)),Vi(o,K(a,3),p,!0)}function mm(o){var a=o==null?0:o.length;return a?zt(o,1):[]}function yx(o){var a=o==null?0:o.length;return a?zt(o,fr):[]}function bx(o,a){var u=o==null?0:o.length;return u?(a=a===e?1:et(a),zt(o,a)):[]}function wx(o){for(var a=-1,u=o==null?0:o.length,f={};++a<u;){var p=o[a];f[p[0]]=p[1]}return f}function gm(o){return o&&o.length?o[0]:e}function vx(o,a,u){var f=o==null?0:o.length;if(!f)return-1;var p=u==null?0:et(u);return p<0&&(p=At(f+p,0)),qr(o,a,p)}function kx(o){var a=o==null?0:o.length;return a?Ce(o,0,-1):[]}var xx=rt(function(o){var a=wt(o,kl);return a.length&&a[0]===o[0]?fl(a):[]}),Sx=rt(function(o){var a=Oe(o),u=wt(o,kl);return a===Oe(u)?a=e:u.pop(),u.length&&u[0]===o[0]?fl(u,K(a,2)):[]}),Cx=rt(function(o){var a=Oe(o),u=wt(o,kl);return a=typeof a=="function"?a:e,a&&u.pop(),u.length&&u[0]===o[0]?fl(u,e,a):[]});function Ox(o,a){return o==null?"":kv.call(o,a)}function Oe(o){var a=o==null?0:o.length;return a?o[a-1]:e}function Mx(o,a,u){var f=o==null?0:o.length;if(!f)return-1;var p=f;return u!==e&&(p=et(u),p=p<0?At(f+p,0):Ft(p,f-1)),a===a?sv(o,a,p):Vi(o,Zd,p,!0)}function Ax(o,a){return o&&o.length?Mp(o,et(a)):e}var Ex=rt(_m);function _m(o,a){return o&&o.length&&a&&a.length?gl(o,a):o}function Tx(o,a,u){return o&&o.length&&a&&a.length?gl(o,a,K(u,2)):o}function Nx(o,a,u){return o&&o.length&&a&&a.length?gl(o,a,e,u):o}var Dx=Sn(function(o,a){var u=o==null?0:o.length,f=ll(o,a);return Tp(o,wt(a,function(p){return Cn(p,u)?+p:p}).sort(Fp)),f});function Rx(o,a){var u=[];if(!(o&&o.length))return u;var f=-1,p=[],_=o.length;for(a=K(a,3);++f<_;){var w=o[f];a(w,f,o)&&(u.push(w),p.push(f))}return Tp(o,p),u}function jl(o){return o==null?o:Ov.call(o)}function Ix(o,a,u){var f=o==null?0:o.length;return f?(u&&typeof u!="number"&&Kt(o,a,u)?(a=0,u=f):(a=a==null?0:et(a),u=u===e?f:et(u)),Ce(o,a,u)):[]}function zx(o,a){return ls(o,a)}function jx(o,a,u){return bl(o,a,K(u,2))}function Px(o,a){var u=o==null?0:o.length;if(u){var f=ls(o,a);if(f<u&&Ve(o[f],a))return f}return-1}function Bx(o,a){return ls(o,a,!0)}function $x(o,a,u){return bl(o,a,K(u,2),!0)}function Fx(o,a){var u=o==null?0:o.length;if(u){var f=ls(o,a,!0)-1;if(Ve(o[f],a))return f}return-1}function Vx(o){return o&&o.length?Dp(o):[]}function Lx(o,a){return o&&o.length?Dp(o,K(a,2)):[]}function Wx(o){var a=o==null?0:o.length;return a?Ce(o,1,a):[]}function qx(o,a,u){return o&&o.length?(a=u||a===e?1:et(a),Ce(o,0,a<0?0:a)):[]}function Jx(o,a,u){var f=o==null?0:o.length;return f?(a=u||a===e?1:et(a),a=f-a,Ce(o,a<0?0:a,f)):[]}function Ux(o,a){return o&&o.length?cs(o,K(a,3),!1,!0):[]}function Kx(o,a){return o&&o.length?cs(o,K(a,3)):[]}var Hx=rt(function(o){return Gn(zt(o,1,St,!0))}),Gx=rt(function(o){var a=Oe(o);return St(a)&&(a=e),Gn(zt(o,1,St,!0),K(a,2))}),Zx=rt(function(o){var a=Oe(o);return a=typeof a=="function"?a:e,Gn(zt(o,1,St,!0),e,a)});function Yx(o){return o&&o.length?Gn(o):[]}function Xx(o,a){return o&&o.length?Gn(o,K(a,2)):[]}function Qx(o,a){return a=typeof a=="function"?a:e,o&&o.length?Gn(o,e,a):[]}function Pl(o){if(!(o&&o.length))return[];var a=0;return o=qn(o,function(u){if(St(u))return a=At(u.length,a),!0}),tl(a,function(u){return wt(o,Ya(u))})}function ym(o,a){if(!(o&&o.length))return[];var u=Pl(o);return a==null?u:wt(u,function(f){return ce(a,e,f)})}var tS=rt(function(o,a){return St(o)?Lo(o,a):[]}),eS=rt(function(o){return vl(qn(o,St))}),nS=rt(function(o){var a=Oe(o);return St(a)&&(a=e),vl(qn(o,St),K(a,2))}),rS=rt(function(o){var a=Oe(o);return a=typeof a=="function"?a:e,vl(qn(o,St),e,a)}),oS=rt(Pl);function iS(o,a){return jp(o||[],a||[],Vo)}function sS(o,a){return jp(o||[],a||[],Jo)}var aS=rt(function(o){var a=o.length,u=a>1?o[a-1]:e;return u=typeof u=="function"?(o.pop(),u):e,ym(o,u)});function bm(o){var a=g(o);return a.__chain__=!0,a}function lS(o,a){return a(o),o}function ys(o,a){return a(o)}var cS=Sn(function(o){var a=o.length,u=a?o[0]:0,f=this.__wrapped__,p=function(_){return ll(_,o)};return a>1||this.__actions__.length||!(f instanceof at)||!Cn(u)?this.thru(p):(f=f.slice(u,+u+(a?1:0)),f.__actions__.push({func:ys,args:[p],thisArg:e}),new xe(f,this.__chain__).thru(function(_){return a&&!_.length&&_.push(e),_}))});function uS(){return bm(this)}function hS(){return new xe(this.value(),this.__chain__)}function fS(){this.__values__===e&&(this.__values__=Rm(this.value()));var o=this.__index__>=this.__values__.length,a=o?e:this.__values__[this.__index__++];return{done:o,value:a}}function dS(){return this}function pS(o){for(var a,u=this;u instanceof ns;){var f=fm(u);f.__index__=0,f.__values__=e,a?p.__wrapped__=f:a=f;var p=f;u=u.__wrapped__}return p.__wrapped__=o,a}function mS(){var o=this.__wrapped__;if(o instanceof at){var a=o;return this.__actions__.length&&(a=new at(this)),a=a.reverse(),a.__actions__.push({func:ys,args:[jl],thisArg:e}),new xe(a,this.__chain__)}return this.thru(jl)}function gS(){return zp(this.__wrapped__,this.__actions__)}var _S=us(function(o,a,u){dt.call(o,u)?++o[u]:kn(o,u,1)});function yS(o,a,u){var f=X(o)?Hd:lk;return u&&Kt(o,a,u)&&(a=e),f(o,K(a,3))}function bS(o,a){var u=X(o)?qn:yp;return u(o,K(a,3))}var wS=Up(dm),vS=Up(pm);function kS(o,a){return zt(bs(o,a),1)}function xS(o,a){return zt(bs(o,a),fr)}function SS(o,a,u){return u=u===e?1:et(u),zt(bs(o,a),u)}function wm(o,a){var u=X(o)?ve:Hn;return u(o,K(a,3))}function vm(o,a){var u=X(o)?Ww:_p;return u(o,K(a,3))}var CS=us(function(o,a,u){dt.call(o,u)?o[u].push(a):kn(o,u,[a])});function OS(o,a,u,f){o=te(o)?o:no(o),u=u&&!f?et(u):0;var p=o.length;return u<0&&(u=At(p+u,0)),Ss(o)?u<=p&&o.indexOf(a,u)>-1:!!p&&qr(o,a,u)>-1}var MS=rt(function(o,a,u){var f=-1,p=typeof a=="function",_=te(o)?M(o.length):[];return Hn(o,function(w){_[++f]=p?ce(a,w,u):Wo(w,a,u)}),_}),AS=us(function(o,a,u){kn(o,u,a)});function bs(o,a){var u=X(o)?wt:Sp;return u(o,K(a,3))}function ES(o,a,u,f){return o==null?[]:(X(a)||(a=a==null?[]:[a]),u=f?e:u,X(u)||(u=u==null?[]:[u]),Ap(o,a,u))}var TS=us(function(o,a,u){o[u?0:1].push(a)},function(){return[[],[]]});function NS(o,a,u){var f=X(o)?Ga:Xd,p=arguments.length<3;return f(o,K(a,4),u,p,Hn)}function DS(o,a,u){var f=X(o)?qw:Xd,p=arguments.length<3;return f(o,K(a,4),u,p,_p)}function RS(o,a){var u=X(o)?qn:yp;return u(o,ks(K(a,3)))}function IS(o){var a=X(o)?dp:Ok;return a(o)}function zS(o,a,u){(u?Kt(o,a,u):a===e)?a=1:a=et(a);var f=X(o)?rk:Mk;return f(o,a)}function jS(o){var a=X(o)?ok:Ek;return a(o)}function PS(o){if(o==null)return 0;if(te(o))return Ss(o)?Ur(o):o.length;var a=Vt(o);return a==Pe||a==Be?o.size:pl(o).length}function BS(o,a,u){var f=X(o)?Za:Tk;return u&&Kt(o,a,u)&&(a=e),f(o,K(a,3))}var $S=rt(function(o,a){if(o==null)return[];var u=a.length;return u>1&&Kt(o,a[0],a[1])?a=[]:u>2&&Kt(a[0],a[1],a[2])&&(a=[a[0]]),Ap(o,zt(a,1),[])}),ws=bv||function(){return It.Date.now()};function FS(o,a){if(typeof a!="function")throw new ke(l);return o=et(o),function(){if(--o<1)return a.apply(this,arguments)}}function km(o,a,u){return a=u?e:a,a=o&&a==null?o.length:a,xn(o,Xt,e,e,e,e,a)}function xm(o,a){var u;if(typeof a!="function")throw new ke(l);return o=et(o),function(){return--o>0&&(u=a.apply(this,arguments)),o<=1&&(a=e),u}}var Bl=rt(function(o,a,u){var f=P;if(u.length){var p=Un(u,to(Bl));f|=yt}return xn(o,f,a,u,p)}),Sm=rt(function(o,a,u){var f=P|J;if(u.length){var p=Un(u,to(Sm));f|=yt}return xn(a,f,o,u,p)});function Cm(o,a,u){a=u?e:a;var f=xn(o,st,e,e,e,e,e,a);return f.placeholder=Cm.placeholder,f}function Om(o,a,u){a=u?e:a;var f=xn(o,ot,e,e,e,e,e,a);return f.placeholder=Om.placeholder,f}function Mm(o,a,u){var f,p,_,w,k,O,D=0,R=!1,I=!1,$=!0;if(typeof o!="function")throw new ke(l);a=Me(a)||0,kt(u)&&(R=!!u.leading,I="maxWait"in u,_=I?At(Me(u.maxWait)||0,a):_,$="trailing"in u?!!u.trailing:$);function U(Ct){var Le=f,An=p;return f=p=e,D=Ct,w=o.apply(An,Le),w}function H(Ct){return D=Ct,k=Ho(it,a),R?U(Ct):w}function nt(Ct){var Le=Ct-O,An=Ct-D,Um=a-Le;return I?Ft(Um,_-An):Um}function G(Ct){var Le=Ct-O,An=Ct-D;return O===e||Le>=a||Le<0||I&&An>=_}function it(){var Ct=ws();if(G(Ct))return lt(Ct);k=Ho(it,nt(Ct))}function lt(Ct){return k=e,$&&f?U(Ct):(f=p=e,w)}function de(){k!==e&&Pp(k),D=0,f=O=p=k=e}function Ht(){return k===e?w:lt(ws())}function pe(){var Ct=ws(),Le=G(Ct);if(f=arguments,p=this,O=Ct,Le){if(k===e)return H(O);if(I)return Pp(k),k=Ho(it,a),U(O)}return k===e&&(k=Ho(it,a)),w}return pe.cancel=de,pe.flush=Ht,pe}var VS=rt(function(o,a){return gp(o,1,a)}),LS=rt(function(o,a,u){return gp(o,Me(a)||0,u)});function WS(o){return xn(o,yn)}function vs(o,a){if(typeof o!="function"||a!=null&&typeof a!="function")throw new ke(l);var u=function(){var f=arguments,p=a?a.apply(this,f):f[0],_=u.cache;if(_.has(p))return _.get(p);var w=o.apply(this,f);return u.cache=_.set(p,w)||_,w};return u.cache=new(vs.Cache||vn),u}vs.Cache=vn;function ks(o){if(typeof o!="function")throw new ke(l);return function(){var a=arguments;switch(a.length){case 0:return!o.call(this);case 1:return!o.call(this,a[0]);case 2:return!o.call(this,a[0],a[1]);case 3:return!o.call(this,a[0],a[1],a[2])}return!o.apply(this,a)}}function qS(o){return xm(2,o)}var JS=Nk(function(o,a){a=a.length==1&&X(a[0])?wt(a[0],ue(K())):wt(zt(a,1),ue(K()));var u=a.length;return rt(function(f){for(var p=-1,_=Ft(f.length,u);++p<_;)f[p]=a[p].call(this,f[p]);return ce(o,this,f)})}),$l=rt(function(o,a){var u=Un(a,to($l));return xn(o,yt,e,a,u)}),Am=rt(function(o,a){var u=Un(a,to(Am));return xn(o,an,e,a,u)}),US=Sn(function(o,a){return xn(o,tt,e,e,e,a)});function KS(o,a){if(typeof o!="function")throw new ke(l);return a=a===e?a:et(a),rt(o,a)}function HS(o,a){if(typeof o!="function")throw new ke(l);return a=a==null?0:At(et(a),0),rt(function(u){var f=u[a],p=Yn(u,0,a);return f&&Jn(p,f),ce(o,this,p)})}function GS(o,a,u){var f=!0,p=!0;if(typeof o!="function")throw new ke(l);return kt(u)&&(f="leading"in u?!!u.leading:f,p="trailing"in u?!!u.trailing:p),Mm(o,a,{leading:f,maxWait:a,trailing:p})}function ZS(o){return km(o,1)}function YS(o,a){return $l(xl(a),o)}function XS(){if(!arguments.length)return[];var o=arguments[0];return X(o)?o:[o]}function QS(o){return Se(o,b)}function t2(o,a){return a=typeof a=="function"?a:e,Se(o,b,a)}function e2(o){return Se(o,y|b)}function n2(o,a){return a=typeof a=="function"?a:e,Se(o,y|b,a)}function r2(o,a){return a==null||mp(o,a,Nt(a))}function Ve(o,a){return o===a||o!==o&&a!==a}var o2=ps(hl),i2=ps(function(o,a){return o>=a}),vr=vp(function(){return arguments}())?vp:function(o){return xt(o)&&dt.call(o,"callee")&&!ap.call(o,"callee")},X=M.isArray,s2=Ld?ue(Ld):pk;function te(o){return o!=null&&xs(o.length)&&!On(o)}function St(o){return xt(o)&&te(o)}function a2(o){return o===!0||o===!1||xt(o)&&Ut(o)==Ao}var Xn=vv||Zl,l2=Wd?ue(Wd):mk;function c2(o){return xt(o)&&o.nodeType===1&&!Go(o)}function u2(o){if(o==null)return!0;if(te(o)&&(X(o)||typeof o=="string"||typeof o.splice=="function"||Xn(o)||eo(o)||vr(o)))return!o.length;var a=Vt(o);if(a==Pe||a==Be)return!o.size;if(Ko(o))return!pl(o).length;for(var u in o)if(dt.call(o,u))return!1;return!0}function h2(o,a){return qo(o,a)}function f2(o,a,u){u=typeof u=="function"?u:e;var f=u?u(o,a):e;return f===e?qo(o,a,e,u):!!f}function Fl(o){if(!xt(o))return!1;var a=Ut(o);return a==Ii||a==zb||typeof o.message=="string"&&typeof o.name=="string"&&!Go(o)}function d2(o){return typeof o=="number"&&cp(o)}function On(o){if(!kt(o))return!1;var a=Ut(o);return a==zi||a==gd||a==Ib||a==Pb}function Em(o){return typeof o=="number"&&o==et(o)}function xs(o){return typeof o=="number"&&o>-1&&o%1==0&&o<=Wn}function kt(o){var a=typeof o;return o!=null&&(a=="object"||a=="function")}function xt(o){return o!=null&&typeof o=="object"}var Tm=qd?ue(qd):_k;function p2(o,a){return o===a||dl(o,a,Tl(a))}function m2(o,a,u){return u=typeof u=="function"?u:e,dl(o,a,Tl(a),u)}function g2(o){return Nm(o)&&o!=+o}function _2(o){if(tx(o))throw new Y(s);return kp(o)}function y2(o){return o===null}function b2(o){return o==null}function Nm(o){return typeof o=="number"||xt(o)&&Ut(o)==To}function Go(o){if(!xt(o)||Ut(o)!=bn)return!1;var a=Gi(o);if(a===null)return!0;var u=dt.call(a,"constructor")&&a.constructor;return typeof u=="function"&&u instanceof u&&Ji.call(u)==mv}var Vl=Jd?ue(Jd):yk;function w2(o){return Em(o)&&o>=-Wn&&o<=Wn}var Dm=Ud?ue(Ud):bk;function Ss(o){return typeof o=="string"||!X(o)&&xt(o)&&Ut(o)==Do}function fe(o){return typeof o=="symbol"||xt(o)&&Ut(o)==ji}var eo=Kd?ue(Kd):wk;function v2(o){return o===e}function k2(o){return xt(o)&&Vt(o)==Ro}function x2(o){return xt(o)&&Ut(o)==$b}var S2=ps(ml),C2=ps(function(o,a){return o<=a});function Rm(o){if(!o)return[];if(te(o))return Ss(o)?$e(o):Qt(o);if(jo&&o[jo])return rv(o[jo]());var a=Vt(o),u=a==Pe?nl:a==Be?Li:no;return u(o)}function Mn(o){if(!o)return o===0?o:0;if(o=Me(o),o===fr||o===-fr){var a=o<0?-1:1;return a*Tb}return o===o?o:0}function et(o){var a=Mn(o),u=a%1;return a===a?u?a-u:a:0}function Im(o){return o?_r(et(o),0,ln):0}function Me(o){if(typeof o=="number")return o;if(fe(o))return Di;if(kt(o)){var a=typeof o.valueOf=="function"?o.valueOf():o;o=kt(a)?a+"":a}if(typeof o!="string")return o===0?o:+o;o=Qd(o);var u=sw.test(o);return u||lw.test(o)?Fw(o.slice(2),u?2:8):iw.test(o)?Di:+o}function zm(o){return un(o,ee(o))}function O2(o){return o?_r(et(o),-Wn,Wn):o===0?o:0}function ft(o){return o==null?"":he(o)}var M2=Xr(function(o,a){if(Ko(a)||te(a)){un(a,Nt(a),o);return}for(var u in a)dt.call(a,u)&&Vo(o,u,a[u])}),jm=Xr(function(o,a){un(a,ee(a),o)}),Cs=Xr(function(o,a,u,f){un(a,ee(a),o,f)}),A2=Xr(function(o,a,u,f){un(a,Nt(a),o,f)}),E2=Sn(ll);function T2(o,a){var u=Yr(o);return a==null?u:pp(u,a)}var N2=rt(function(o,a){o=gt(o);var u=-1,f=a.length,p=f>2?a[2]:e;for(p&&Kt(a[0],a[1],p)&&(f=1);++u<f;)for(var _=a[u],w=ee(_),k=-1,O=w.length;++k<O;){var D=w[k],R=o[D];(R===e||Ve(R,Hr[D])&&!dt.call(o,D))&&(o[D]=_[D])}return o}),D2=rt(function(o){return o.push(e,Qp),ce(Pm,e,o)});function R2(o,a){return Gd(o,K(a,3),cn)}function I2(o,a){return Gd(o,K(a,3),ul)}function z2(o,a){return o==null?o:cl(o,K(a,3),ee)}function j2(o,a){return o==null?o:bp(o,K(a,3),ee)}function P2(o,a){return o&&cn(o,K(a,3))}function B2(o,a){return o&&ul(o,K(a,3))}function $2(o){return o==null?[]:ss(o,Nt(o))}function F2(o){return o==null?[]:ss(o,ee(o))}function Ll(o,a,u){var f=o==null?e:yr(o,a);return f===e?u:f}function V2(o,a){return o!=null&&nm(o,a,uk)}function Wl(o,a){return o!=null&&nm(o,a,hk)}var L2=Hp(function(o,a,u){a!=null&&typeof a.toString!="function"&&(a=Ui.call(a)),o[a]=u},Jl(ne)),W2=Hp(function(o,a,u){a!=null&&typeof a.toString!="function"&&(a=Ui.call(a)),dt.call(o,a)?o[a].push(u):o[a]=[u]},K),q2=rt(Wo);function Nt(o){return te(o)?fp(o):pl(o)}function ee(o){return te(o)?fp(o,!0):vk(o)}function J2(o,a){var u={};return a=K(a,3),cn(o,function(f,p,_){kn(u,a(f,p,_),f)}),u}function U2(o,a){var u={};return a=K(a,3),cn(o,function(f,p,_){kn(u,p,a(f,p,_))}),u}var K2=Xr(function(o,a,u){as(o,a,u)}),Pm=Xr(function(o,a,u,f){as(o,a,u,f)}),H2=Sn(function(o,a){var u={};if(o==null)return u;var f=!1;a=wt(a,function(_){return _=Zn(_,o),f||(f=_.length>1),_}),un(o,Al(o),u),f&&(u=Se(u,y|v|b,Lk));for(var p=a.length;p--;)wl(u,a[p]);return u});function G2(o,a){return Bm(o,ks(K(a)))}var Z2=Sn(function(o,a){return o==null?{}:xk(o,a)});function Bm(o,a){if(o==null)return{};var u=wt(Al(o),function(f){return[f]});return a=K(a),Ep(o,u,function(f,p){return a(f,p[0])})}function Y2(o,a,u){a=Zn(a,o);var f=-1,p=a.length;for(p||(p=1,o=e);++f<p;){var _=o==null?e:o[hn(a[f])];_===e&&(f=p,_=u),o=On(_)?_.call(o):_}return o}function X2(o,a,u){return o==null?o:Jo(o,a,u)}function Q2(o,a,u,f){return f=typeof f=="function"?f:e,o==null?o:Jo(o,a,u,f)}var $m=Yp(Nt),Fm=Yp(ee);function tC(o,a,u){var f=X(o),p=f||Xn(o)||eo(o);if(a=K(a,4),u==null){var _=o&&o.constructor;p?u=f?new _:[]:kt(o)?u=On(_)?Yr(Gi(o)):{}:u={}}return(p?ve:cn)(o,function(w,k,O){return a(u,w,k,O)}),u}function eC(o,a){return o==null?!0:wl(o,a)}function nC(o,a,u){return o==null?o:Ip(o,a,xl(u))}function rC(o,a,u,f){return f=typeof f=="function"?f:e,o==null?o:Ip(o,a,xl(u),f)}function no(o){return o==null?[]:el(o,Nt(o))}function oC(o){return o==null?[]:el(o,ee(o))}function iC(o,a,u){return u===e&&(u=a,a=e),u!==e&&(u=Me(u),u=u===u?u:0),a!==e&&(a=Me(a),a=a===a?a:0),_r(Me(o),a,u)}function sC(o,a,u){return a=Mn(a),u===e?(u=a,a=0):u=Mn(u),o=Me(o),fk(o,a,u)}function aC(o,a,u){if(u&&typeof u!="boolean"&&Kt(o,a,u)&&(a=u=e),u===e&&(typeof a=="boolean"?(u=a,a=e):typeof o=="boolean"&&(u=o,o=e)),o===e&&a===e?(o=0,a=1):(o=Mn(o),a===e?(a=o,o=0):a=Mn(a)),o>a){var f=o;o=a,a=f}if(u||o%1||a%1){var p=up();return Ft(o+p*(a-o+$w("1e-"+((p+"").length-1))),a)}return _l(o,a)}var lC=Qr(function(o,a,u){return a=a.toLowerCase(),o+(u?Vm(a):a)});function Vm(o){return ql(ft(o).toLowerCase())}function Lm(o){return o=ft(o),o&&o.replace(uw,Xw).replace(Ew,"")}function cC(o,a,u){o=ft(o),a=he(a);var f=o.length;u=u===e?f:_r(et(u),0,f);var p=u;return u-=a.length,u>=0&&o.slice(u,p)==a}function uC(o){return o=ft(o),o&&qb.test(o)?o.replace(bd,Qw):o}function hC(o){return o=ft(o),o&&Zb.test(o)?o.replace($a,"\\$&"):o}var fC=Qr(function(o,a,u){return o+(u?"-":"")+a.toLowerCase()}),dC=Qr(function(o,a,u){return o+(u?" ":"")+a.toLowerCase()}),pC=Jp("toLowerCase");function mC(o,a,u){o=ft(o),a=et(a);var f=a?Ur(o):0;if(!a||f>=a)return o;var p=(a-f)/2;return ds(Qi(p),u)+o+ds(Xi(p),u)}function gC(o,a,u){o=ft(o),a=et(a);var f=a?Ur(o):0;return a&&f<a?o+ds(a-f,u):o}function _C(o,a,u){o=ft(o),a=et(a);var f=a?Ur(o):0;return a&&f<a?ds(a-f,u)+o:o}function yC(o,a,u){return u||a==null?a=0:a&&(a=+a),Cv(ft(o).replace(Fa,""),a||0)}function bC(o,a,u){return(u?Kt(o,a,u):a===e)?a=1:a=et(a),yl(ft(o),a)}function wC(){var o=arguments,a=ft(o[0]);return o.length<3?a:a.replace(o[1],o[2])}var vC=Qr(function(o,a,u){return o+(u?"_":"")+a.toLowerCase()});function kC(o,a,u){return u&&typeof u!="number"&&Kt(o,a,u)&&(a=u=e),u=u===e?ln:u>>>0,u?(o=ft(o),o&&(typeof a=="string"||a!=null&&!Vl(a))&&(a=he(a),!a&&Jr(o))?Yn($e(o),0,u):o.split(a,u)):[]}var xC=Qr(function(o,a,u){return o+(u?" ":"")+ql(a)});function SC(o,a,u){return o=ft(o),u=u==null?0:_r(et(u),0,o.length),a=he(a),o.slice(u,u+a.length)==a}function CC(o,a,u){var f=g.templateSettings;u&&Kt(o,a,u)&&(a=e),o=ft(o),a=Cs({},a,f,Xp);var p=Cs({},a.imports,f.imports,Xp),_=Nt(p),w=el(p,_),k,O,D=0,R=a.interpolate||Pi,I="__p += '",$=rl((a.escape||Pi).source+"|"+R.source+"|"+(R===wd?ow:Pi).source+"|"+(a.evaluate||Pi).source+"|$","g"),U="//# sourceURL="+(dt.call(a,"sourceURL")?(a.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Iw+"]")+`
`;o.replace($,function(G,it,lt,de,Ht,pe){return lt||(lt=de),I+=o.slice(D,pe).replace(hw,tv),it&&(k=!0,I+=`' +
__e(`+it+`) +
'`),Ht&&(O=!0,I+=`';
`+Ht+`;
__p += '`),lt&&(I+=`' +
((__t = (`+lt+`)) == null ? '' : __t) +
'`),D=pe+G.length,G}),I+=`';
`;var H=dt.call(a,"variable")&&a.variable;if(!H)I=`with (obj) {
`+I+`
}
`;else if(nw.test(H))throw new Y(c);I=(O?I.replace(Fb,""):I).replace(Vb,"$1").replace(Lb,"$1;"),I="function("+(H||"obj")+`) {
`+(H?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(k?", __e = _.escape":"")+(O?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+I+`return __p
}`;var nt=qm(function(){return ut(_,U+"return "+I).apply(e,w)});if(nt.source=I,Fl(nt))throw nt;return nt}function OC(o){return ft(o).toLowerCase()}function MC(o){return ft(o).toUpperCase()}function AC(o,a,u){if(o=ft(o),o&&(u||a===e))return Qd(o);if(!o||!(a=he(a)))return o;var f=$e(o),p=$e(a),_=tp(f,p),w=ep(f,p)+1;return Yn(f,_,w).join("")}function EC(o,a,u){if(o=ft(o),o&&(u||a===e))return o.slice(0,rp(o)+1);if(!o||!(a=he(a)))return o;var f=$e(o),p=ep(f,$e(a))+1;return Yn(f,0,p).join("")}function TC(o,a,u){if(o=ft(o),o&&(u||a===e))return o.replace(Fa,"");if(!o||!(a=he(a)))return o;var f=$e(o),p=tp(f,$e(a));return Yn(f,p).join("")}function NC(o,a){var u=Mo,f=Ea;if(kt(a)){var p="separator"in a?a.separator:p;u="length"in a?et(a.length):u,f="omission"in a?he(a.omission):f}o=ft(o);var _=o.length;if(Jr(o)){var w=$e(o);_=w.length}if(u>=_)return o;var k=u-Ur(f);if(k<1)return f;var O=w?Yn(w,0,k).join(""):o.slice(0,k);if(p===e)return O+f;if(w&&(k+=O.length-k),Vl(p)){if(o.slice(k).search(p)){var D,R=O;for(p.global||(p=rl(p.source,ft(vd.exec(p))+"g")),p.lastIndex=0;D=p.exec(R);)var I=D.index;O=O.slice(0,I===e?k:I)}}else if(o.indexOf(he(p),k)!=k){var $=O.lastIndexOf(p);$>-1&&(O=O.slice(0,$))}return O+f}function DC(o){return o=ft(o),o&&Wb.test(o)?o.replace(yd,av):o}var RC=Qr(function(o,a,u){return o+(u?" ":"")+a.toUpperCase()}),ql=Jp("toUpperCase");function Wm(o,a,u){return o=ft(o),a=u?e:a,a===e?nv(o)?uv(o):Kw(o):o.match(a)||[]}var qm=rt(function(o,a){try{return ce(o,e,a)}catch(u){return Fl(u)?u:new Y(u)}}),IC=Sn(function(o,a){return ve(a,function(u){u=hn(u),kn(o,u,Bl(o[u],o))}),o});function zC(o){var a=o==null?0:o.length,u=K();return o=a?wt(o,function(f){if(typeof f[1]!="function")throw new ke(l);return[u(f[0]),f[1]]}):[],rt(function(f){for(var p=-1;++p<a;){var _=o[p];if(ce(_[0],this,f))return ce(_[1],this,f)}})}function jC(o){return ak(Se(o,y))}function Jl(o){return function(){return o}}function PC(o,a){return o==null||o!==o?a:o}var BC=Kp(),$C=Kp(!0);function ne(o){return o}function Ul(o){return xp(typeof o=="function"?o:Se(o,y))}function FC(o){return Cp(Se(o,y))}function VC(o,a){return Op(o,Se(a,y))}var LC=rt(function(o,a){return function(u){return Wo(u,o,a)}}),WC=rt(function(o,a){return function(u){return Wo(o,u,a)}});function Kl(o,a,u){var f=Nt(a),p=ss(a,f);u==null&&!(kt(a)&&(p.length||!f.length))&&(u=a,a=o,o=this,p=ss(a,Nt(a)));var _=!(kt(u)&&"chain"in u)||!!u.chain,w=On(o);return ve(p,function(k){var O=a[k];o[k]=O,w&&(o.prototype[k]=function(){var D=this.__chain__;if(_||D){var R=o(this.__wrapped__),I=R.__actions__=Qt(this.__actions__);return I.push({func:O,args:arguments,thisArg:o}),R.__chain__=D,R}return O.apply(o,Jn([this.value()],arguments))})}),o}function qC(){return It._===this&&(It._=gv),this}function Hl(){}function JC(o){return o=et(o),rt(function(a){return Mp(a,o)})}var UC=Cl(wt),KC=Cl(Hd),HC=Cl(Za);function Jm(o){return Dl(o)?Ya(hn(o)):Sk(o)}function GC(o){return function(a){return o==null?e:yr(o,a)}}var ZC=Gp(),YC=Gp(!0);function Gl(){return[]}function Zl(){return!1}function XC(){return{}}function QC(){return""}function tO(){return!0}function eO(o,a){if(o=et(o),o<1||o>Wn)return[];var u=ln,f=Ft(o,ln);a=K(a),o-=ln;for(var p=tl(f,a);++u<o;)a(u);return p}function nO(o){return X(o)?wt(o,hn):fe(o)?[o]:Qt(hm(ft(o)))}function rO(o){var a=++pv;return ft(o)+a}var oO=fs(function(o,a){return o+a},0),iO=Ol("ceil"),sO=fs(function(o,a){return o/a},1),aO=Ol("floor");function lO(o){return o&&o.length?is(o,ne,hl):e}function cO(o,a){return o&&o.length?is(o,K(a,2),hl):e}function uO(o){return Yd(o,ne)}function hO(o,a){return Yd(o,K(a,2))}function fO(o){return o&&o.length?is(o,ne,ml):e}function dO(o,a){return o&&o.length?is(o,K(a,2),ml):e}var pO=fs(function(o,a){return o*a},1),mO=Ol("round"),gO=fs(function(o,a){return o-a},0);function _O(o){return o&&o.length?Qa(o,ne):0}function yO(o,a){return o&&o.length?Qa(o,K(a,2)):0}return g.after=FS,g.ary=km,g.assign=M2,g.assignIn=jm,g.assignInWith=Cs,g.assignWith=A2,g.at=E2,g.before=xm,g.bind=Bl,g.bindAll=IC,g.bindKey=Sm,g.castArray=XS,g.chain=bm,g.chunk=ax,g.compact=lx,g.concat=cx,g.cond=zC,g.conforms=jC,g.constant=Jl,g.countBy=_S,g.create=T2,g.curry=Cm,g.curryRight=Om,g.debounce=Mm,g.defaults=N2,g.defaultsDeep=D2,g.defer=VS,g.delay=LS,g.difference=ux,g.differenceBy=hx,g.differenceWith=fx,g.drop=dx,g.dropRight=px,g.dropRightWhile=mx,g.dropWhile=gx,g.fill=_x,g.filter=bS,g.flatMap=kS,g.flatMapDeep=xS,g.flatMapDepth=SS,g.flatten=mm,g.flattenDeep=yx,g.flattenDepth=bx,g.flip=WS,g.flow=BC,g.flowRight=$C,g.fromPairs=wx,g.functions=$2,g.functionsIn=F2,g.groupBy=CS,g.initial=kx,g.intersection=xx,g.intersectionBy=Sx,g.intersectionWith=Cx,g.invert=L2,g.invertBy=W2,g.invokeMap=MS,g.iteratee=Ul,g.keyBy=AS,g.keys=Nt,g.keysIn=ee,g.map=bs,g.mapKeys=J2,g.mapValues=U2,g.matches=FC,g.matchesProperty=VC,g.memoize=vs,g.merge=K2,g.mergeWith=Pm,g.method=LC,g.methodOf=WC,g.mixin=Kl,g.negate=ks,g.nthArg=JC,g.omit=H2,g.omitBy=G2,g.once=qS,g.orderBy=ES,g.over=UC,g.overArgs=JS,g.overEvery=KC,g.overSome=HC,g.partial=$l,g.partialRight=Am,g.partition=TS,g.pick=Z2,g.pickBy=Bm,g.property=Jm,g.propertyOf=GC,g.pull=Ex,g.pullAll=_m,g.pullAllBy=Tx,g.pullAllWith=Nx,g.pullAt=Dx,g.range=ZC,g.rangeRight=YC,g.rearg=US,g.reject=RS,g.remove=Rx,g.rest=KS,g.reverse=jl,g.sampleSize=zS,g.set=X2,g.setWith=Q2,g.shuffle=jS,g.slice=Ix,g.sortBy=$S,g.sortedUniq=Vx,g.sortedUniqBy=Lx,g.split=kC,g.spread=HS,g.tail=Wx,g.take=qx,g.takeRight=Jx,g.takeRightWhile=Ux,g.takeWhile=Kx,g.tap=lS,g.throttle=GS,g.thru=ys,g.toArray=Rm,g.toPairs=$m,g.toPairsIn=Fm,g.toPath=nO,g.toPlainObject=zm,g.transform=tC,g.unary=ZS,g.union=Hx,g.unionBy=Gx,g.unionWith=Zx,g.uniq=Yx,g.uniqBy=Xx,g.uniqWith=Qx,g.unset=eC,g.unzip=Pl,g.unzipWith=ym,g.update=nC,g.updateWith=rC,g.values=no,g.valuesIn=oC,g.without=tS,g.words=Wm,g.wrap=YS,g.xor=eS,g.xorBy=nS,g.xorWith=rS,g.zip=oS,g.zipObject=iS,g.zipObjectDeep=sS,g.zipWith=aS,g.entries=$m,g.entriesIn=Fm,g.extend=jm,g.extendWith=Cs,Kl(g,g),g.add=oO,g.attempt=qm,g.camelCase=lC,g.capitalize=Vm,g.ceil=iO,g.clamp=iC,g.clone=QS,g.cloneDeep=e2,g.cloneDeepWith=n2,g.cloneWith=t2,g.conformsTo=r2,g.deburr=Lm,g.defaultTo=PC,g.divide=sO,g.endsWith=cC,g.eq=Ve,g.escape=uC,g.escapeRegExp=hC,g.every=yS,g.find=wS,g.findIndex=dm,g.findKey=R2,g.findLast=vS,g.findLastIndex=pm,g.findLastKey=I2,g.floor=aO,g.forEach=wm,g.forEachRight=vm,g.forIn=z2,g.forInRight=j2,g.forOwn=P2,g.forOwnRight=B2,g.get=Ll,g.gt=o2,g.gte=i2,g.has=V2,g.hasIn=Wl,g.head=gm,g.identity=ne,g.includes=OS,g.indexOf=vx,g.inRange=sC,g.invoke=q2,g.isArguments=vr,g.isArray=X,g.isArrayBuffer=s2,g.isArrayLike=te,g.isArrayLikeObject=St,g.isBoolean=a2,g.isBuffer=Xn,g.isDate=l2,g.isElement=c2,g.isEmpty=u2,g.isEqual=h2,g.isEqualWith=f2,g.isError=Fl,g.isFinite=d2,g.isFunction=On,g.isInteger=Em,g.isLength=xs,g.isMap=Tm,g.isMatch=p2,g.isMatchWith=m2,g.isNaN=g2,g.isNative=_2,g.isNil=b2,g.isNull=y2,g.isNumber=Nm,g.isObject=kt,g.isObjectLike=xt,g.isPlainObject=Go,g.isRegExp=Vl,g.isSafeInteger=w2,g.isSet=Dm,g.isString=Ss,g.isSymbol=fe,g.isTypedArray=eo,g.isUndefined=v2,g.isWeakMap=k2,g.isWeakSet=x2,g.join=Ox,g.kebabCase=fC,g.last=Oe,g.lastIndexOf=Mx,g.lowerCase=dC,g.lowerFirst=pC,g.lt=S2,g.lte=C2,g.max=lO,g.maxBy=cO,g.mean=uO,g.meanBy=hO,g.min=fO,g.minBy=dO,g.stubArray=Gl,g.stubFalse=Zl,g.stubObject=XC,g.stubString=QC,g.stubTrue=tO,g.multiply=pO,g.nth=Ax,g.noConflict=qC,g.noop=Hl,g.now=ws,g.pad=mC,g.padEnd=gC,g.padStart=_C,g.parseInt=yC,g.random=aC,g.reduce=NS,g.reduceRight=DS,g.repeat=bC,g.replace=wC,g.result=Y2,g.round=mO,g.runInContext=S,g.sample=IS,g.size=PS,g.snakeCase=vC,g.some=BS,g.sortedIndex=zx,g.sortedIndexBy=jx,g.sortedIndexOf=Px,g.sortedLastIndex=Bx,g.sortedLastIndexBy=$x,g.sortedLastIndexOf=Fx,g.startCase=xC,g.startsWith=SC,g.subtract=gO,g.sum=_O,g.sumBy=yO,g.template=CC,g.times=eO,g.toFinite=Mn,g.toInteger=et,g.toLength=Im,g.toLower=OC,g.toNumber=Me,g.toSafeInteger=O2,g.toString=ft,g.toUpper=MC,g.trim=AC,g.trimEnd=EC,g.trimStart=TC,g.truncate=NC,g.unescape=DC,g.uniqueId=rO,g.upperCase=RC,g.upperFirst=ql,g.each=wm,g.eachRight=vm,g.first=gm,Kl(g,function(){var o={};return cn(g,function(a,u){dt.call(g.prototype,u)||(o[u]=a)}),o}(),{chain:!1}),g.VERSION=r,ve(["bind","bindKey","curry","curryRight","partial","partialRight"],function(o){g[o].placeholder=g}),ve(["drop","take"],function(o,a){at.prototype[o]=function(u){u=u===e?1:At(et(u),0);var f=this.__filtered__&&!a?new at(this):this.clone();return f.__filtered__?f.__takeCount__=Ft(u,f.__takeCount__):f.__views__.push({size:Ft(u,ln),type:o+(f.__dir__<0?"Right":"")}),f},at.prototype[o+"Right"]=function(u){return this.reverse()[o](u).reverse()}}),ve(["filter","map","takeWhile"],function(o,a){var u=a+1,f=u==md||u==Eb;at.prototype[o]=function(p){var _=this.clone();return _.__iteratees__.push({iteratee:K(p,3),type:u}),_.__filtered__=_.__filtered__||f,_}}),ve(["head","last"],function(o,a){var u="take"+(a?"Right":"");at.prototype[o]=function(){return this[u](1).value()[0]}}),ve(["initial","tail"],function(o,a){var u="drop"+(a?"":"Right");at.prototype[o]=function(){return this.__filtered__?new at(this):this[u](1)}}),at.prototype.compact=function(){return this.filter(ne)},at.prototype.find=function(o){return this.filter(o).head()},at.prototype.findLast=function(o){return this.reverse().find(o)},at.prototype.invokeMap=rt(function(o,a){return typeof o=="function"?new at(this):this.map(function(u){return Wo(u,o,a)})}),at.prototype.reject=function(o){return this.filter(ks(K(o)))},at.prototype.slice=function(o,a){o=et(o);var u=this;return u.__filtered__&&(o>0||a<0)?new at(u):(o<0?u=u.takeRight(-o):o&&(u=u.drop(o)),a!==e&&(a=et(a),u=a<0?u.dropRight(-a):u.take(a-o)),u)},at.prototype.takeRightWhile=function(o){return this.reverse().takeWhile(o).reverse()},at.prototype.toArray=function(){return this.take(ln)},cn(at.prototype,function(o,a){var u=/^(?:filter|find|map|reject)|While$/.test(a),f=/^(?:head|last)$/.test(a),p=g[f?"take"+(a=="last"?"Right":""):a],_=f||/^find/.test(a);!p||(g.prototype[a]=function(){var w=this.__wrapped__,k=f?[1]:arguments,O=w instanceof at,D=k[0],R=O||X(w),I=function(it){var lt=p.apply(g,Jn([it],k));return f&&$?lt[0]:lt};R&&u&&typeof D=="function"&&D.length!=1&&(O=R=!1);var $=this.__chain__,U=!!this.__actions__.length,H=_&&!$,nt=O&&!U;if(!_&&R){w=nt?w:new at(this);var G=o.apply(w,k);return G.__actions__.push({func:ys,args:[I],thisArg:e}),new xe(G,$)}return H&&nt?o.apply(this,k):(G=this.thru(I),H?f?G.value()[0]:G.value():G)})}),ve(["pop","push","shift","sort","splice","unshift"],function(o){var a=Wi[o],u=/^(?:push|sort|unshift)$/.test(o)?"tap":"thru",f=/^(?:pop|shift)$/.test(o);g.prototype[o]=function(){var p=arguments;if(f&&!this.__chain__){var _=this.value();return a.apply(X(_)?_:[],p)}return this[u](function(w){return a.apply(X(w)?w:[],p)})}}),cn(at.prototype,function(o,a){var u=g[a];if(u){var f=u.name+"";dt.call(Zr,f)||(Zr[f]=[]),Zr[f].push({name:a,func:u})}}),Zr[hs(e,J).name]=[{name:"wrapper",func:e}],at.prototype.clone=Dv,at.prototype.reverse=Rv,at.prototype.value=Iv,g.prototype.at=cS,g.prototype.chain=uS,g.prototype.commit=hS,g.prototype.next=fS,g.prototype.plant=pS,g.prototype.reverse=mS,g.prototype.toJSON=g.prototype.valueOf=g.prototype.value=gS,g.prototype.first=g.prototype.head,jo&&(g.prototype[jo]=dS),g},Kr=hv();dr?((dr.exports=Kr)._=Kr,Ua._=Kr):It._=Kr}).call(Oo)})(Aa,Aa.exports);const rn=new p_(sb),le="my_text";function nd(n){const{markType:t,makeAttrs:e}=n;return(r,i)=>{const s=r.tr,{$from:l,$to:c}=r.selection.ranges[0],h=l.pos,d=c.pos;return s.addMark(h,d,rn.marks[t].create(e())),i!==void 0&&i(s),!0}}const yb={...$y,"Mod-b":Wf(rn.marks.strong),"Mod-i":Wf(rn.marks.em),"Mod-e":nd({markType:"comment",makeAttrs:()=>({id:ed.v4()})}),"Mod-k":nd({markType:"link",makeAttrs:()=>({url:`https://www.google.com/search?q=${ed.v4()}`})})},bb=(n,t)=>{let e=Y0({my_text:n});return t&&(e=oi(e,r=>{for(const i of t)if(i.action==="addMark")if(i.markType==="comment"){if(!i.attrs||typeof i.attrs.id!="string")throw new Error("Expected comment mark to have id attrs");Sr(r,le,`${i.markType}:${i.attrs.id}`,Fr(i.markType,i.startIndex,i.endIndex),!0)}else if(i.markType==="link"){if(!i.attrs||typeof i.attrs.url!="string")throw new Error("Expected link mark to have url attrs");Sr(r,le,`${i.markType}`,Fr(i.markType,i.startIndex,i.endIndex),i.attrs.url)}else Sr(r,le,`${i.markType}`,Fr(i.markType,i.startIndex,i.endIndex),!0)}),e=oi(e,r=>{Ts(r,le,n.length,0,"!!")})),[e,Z0(e)]};function rd(n){const[t,e]=n.key.split(":");let r;return t==="link"&&(r={url:n.value}),t==="comment"&&(r={id:e,text:n.value}),{key:t,attr:r}}const od=(n,t,e)=>{console.log("applying patch",e);let r=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;switch(e.action){case"splice":{const[s,l]=e.path,c=be(l);return{transaction:t.replace(c,c,new W(B.from(rn.text(e.value,wb(n,le,c))),0,0)),startPos:c,endPos:c+1}}case"del":{const[s,l]=e.path,c=be(l),h=e.length||1;return{transaction:t.replace(c,c+h,W.empty),startPos:c,endPos:c}}case"mark":{for(const s of e.marks){const{key:l,attr:c}=rd(s);s.value===null||s.value===!1?t=t.removeMark(be(s.start),be(s.end),rn.mark(l,c)):t=t.addMark(be(s.start),be(s.end),rn.mark(l,c)),r=Math.min(r,s.start),i=Math.max(i,s.end)}return{transaction:t,startPos:be(r),endPos:be(i)}}}if(e.action==="unmark"){const{start:s,end:l,key:c}=e;return{transaction:t.removeMark(be(s),be(l),rn.mark(c)),startPos:be(s),endPos:be(l)}}throw new Error(`BUG: Unsupported patch type '${e.action}'`)};function id(n){const{actorId:t,editorNode:e,changesNode:r,publisher:i,handleClickOn:s,onRemotePatchApplied:l,editable:c}=n;let{doc:h}=n;const d=new ab({handleFlush:b=>{i.publish(t,b)}});d.start();const m=b=>{};i.subscribe(t,b=>{if(b.length===0)return;let C=v.state,T=C.tr,P=[];h=H0(h,b,{patchCallback:J=>{P.push(...J)}})[0];for(const J of P){const mt=od(h,T,J);let{transaction:st}=mt;const{startPos:ot,endPos:yt}=mt;l&&(st=l({transaction:st,view:v,startPos:ot,endPos:yt})),T=st}C=C.apply(T),v.updateState(C)});const y=Er.create({schema:rn,plugins:[Ky(yb)],doc:vb({schema:rn,text:h[le].toString()})}),v=new yy(e,{state:y,handleClickOn:s,editable:()=>c,dispatchTransaction:b=>{let C=v.state;const T=kb({doc:h,txn:b}),{change:P,patches:J}=T;if(h=T.doc,P){let mt=C.tr;for(const st of J){const{transaction:ot}=od(h,mt,st);mt=ot}C=C.apply(mt),d.enqueue(P)}b.selectionSet&&(C=C.apply(C.tr.setSelection(new pt(C.doc.resolve(b.selection.anchor),C.doc.resolve(b.selection.head))))),v.updateState(C),console.groupEnd()}});return{view:v,queue:d,outputDebugForChange:m}}function $r(n,t){return Aa.exports.clamp(n-1,0,t.textContent.length)}function be(n){return n+1}function wb(n,t,e){const r=X0(n,t).filter(s=>s.start<=e&&s.end>=e),i=new Map;for(const s of r)s.value===null?i.delete(s.key):i.set(s.key,s);return Array.from(i.values()).map(s=>{const{key:l,attr:c}=rd(s);return rn.marks[l].create(c)})}function vb(n){const{schema:t,text:e}=n;return e===""?t.node("doc",void 0,[t.node("paragraph",[])]):t.node("doc",void 0,[t.node("paragraph",void 0,t.text(e,[]))])}function Fr(n,t,e){switch(n){case"comment":case"link":return`[${t}..${e}]`;case"em":case"strong":return`(${t}..${e})`;default:throw new Error("BUG: unreachable")}}function kb(n){const t=n.doc,{txn:e}=n;if(e.steps.length===0)return{doc:t,change:null,patches:[]};let r=[];const i=oi(t,{patchCallback:l=>{r.push(...l)}},l=>{for(const c of e.steps)if(c instanceof Bt){const h=$r(c.from,e.before),d=$r(c.to,e.before);if(c.slice){const m=c.slice.content.textBetween(0,c.slice.content.size);Ts(l,le,h,d-h,m)}else Ts(l,le,h,d-h)}else if(c instanceof pn){if(!Kf(c.mark.type.name))throw new Error(`Invalid mark type: ${c.mark.type.name}`);const h=$r(c.from,e.before),d=$r(c.to,e.before),m=c.mark.type.name;if(m==="comment"){if(!c.mark.attrs||typeof c.mark.attrs.id!="string")throw new Error("Expected comment mark to have id attrs");Sr(l,le,`${m}:${c.mark.attrs.id}`,Fr(m,h,d),!0)}else if(m==="link"){if(!c.mark.attrs||typeof c.mark.attrs.url!="string")throw new Error("Expected link mark to have url attrs");Sr(l,le,`${m}`,Fr(m,h,d),c.mark.attrs.url)}else Sr(l,le,`${m}`,Fr(m,h,d),!0)}else if(c instanceof Te){if(!Kf(c.mark.type.name))throw new Error(`Invalid mark type: ${c.mark.type.name}`);const h=$r(c.from,e.before),d=$r(c.to,e.before);if(c.mark.type.name==="comment"){if(!c.mark.attrs||typeof c.mark.attrs.id!="string")throw new Error("Expected comment mark to have id attrs");Wu(l,le,`${c.mark.type.name}:${c.mark.attrs.id}`,h,d)}else Wu(l,le,c.mark.type.name,h,d)}}),s=K0(t,i);if(!r)throw new Error("BUG: patches callback has not occurred yet");if(s.length>1)throw new Error("BUG: Expected only one change");return{doc:i,change:s[0],patches:r}}class xb{constructor(){kr(this,"subscribers",{})}subscribe(t,e){if(this.subscribers[t])throw new Error(`Subscriber already exists: ${t}`);this.subscribers[t]=e}unsubscribe(t){if(!this.subscribers[t])throw new Error(`Subscriber not found: ${t}`);delete this.subscribers[t]}publish(t,e){for(const[r,i]of Object.entries(this.subscribers))r!==t&&i(e)}}const sd=new xb,Ni={},ad=(n,t)=>{n.innerHTML=t.map(e=>`\u2022 ${e.type.name} ${Object.keys(e.attrs).length!==0?JSON.stringify(e.attrs):""}`).join("<br/>")},[Sb,Cb]=bb("This is the Peritext editor demo. Press sync to synchronize the editors. Ctrl-B for bold, Ctrl-i for italic, Ctrl-k for link, Ctrl-e for comment",[]),on=document.querySelector("#alice"),ld=on==null?void 0:on.querySelector(".editor"),cd=on==null?void 0:on.querySelector(".changes"),ud=on==null?void 0:on.querySelector(".marks");if(on&&ld&&cd&&ud)Ni.alice=id({actorId:"alice",editorNode:ld,changesNode:cd,doc:Sb,publisher:sd,editable:!0,handleClickOn:(n,t,e,r,i,s)=>{if(!s)return!1;const l=n.state.doc.resolve(t).marks();return ad(ud,l),!1}});else throw new Error("Didn't find expected node in the DOM");const sn=document.querySelector("#bob"),hd=sn==null?void 0:sn.querySelector(".editor"),fd=sn==null?void 0:sn.querySelector(".changes"),dd=sn==null?void 0:sn.querySelector(".marks");if(sn&&hd&&fd&&dd)Ni.bob=id({actorId:"bob",editorNode:hd,changesNode:fd,doc:Cb,publisher:sd,editable:!0,handleClickOn:(n,t,e,r,i,s)=>{if(!s)return!1;const l=n.state.doc.resolve(t).marks();return ad(dd,l),!1}});else throw new Error("Didn't find expected node in the DOM");for(const n of Object.values(Ni))n.queue.drop();(pd=document.querySelector("#sync"))==null||pd.addEventListener("click",()=>{for(const n of Object.values(Ni))n.queue.flush()})})();
