var pO=Object.defineProperty;var mO=(re,oe,jt)=>oe in re?pO(re,oe,{enumerable:!0,configurable:!0,writable:!0,value:jt}):re[oe]=jt;var vr=(re,oe,jt)=>(mO(re,typeof oe!="symbol"?oe+"":oe,jt),jt);(async()=>{var hd;(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))e(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&e(a)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerpolicy&&(i.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?i.credentials="include":r.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function e(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}})();const re=Symbol.for("_am_meta"),oe=Symbol.for("_am_trace"),jt=Symbol.for("_am_objectId"),Ho=Symbol.for("_am_isProxy"),qm=Symbol.for("_am_uint"),Jm=Symbol.for("_am_int"),Hm=Symbol.for("_am_f64"),Gl=Symbol.for("_am_counter"),Km=Symbol.for("_am_text");class On{constructor(t){if(typeof t=="string")this.elems=[...t];else if(Array.isArray(t))this.elems=t;else if(t===void 0)this.elems=[];else throw new TypeError(`Unsupported initial value for Text: ${t}`);Reflect.defineProperty(this,Km,{value:!0})}get length(){return this.elems.length}get(t){return this.elems[t]}[Symbol.iterator](){const t=this.elems;let e=-1;return{next(){return e+=1,e<t.length?{done:!1,value:t[e]}:{done:!0}}}}toString(){if(!this.str){this.str="";for(const t of this.elems)typeof t=="string"?this.str+=t:this.str+="\uFFFC"}return this.str}toSpans(){if(!this.spans){this.spans=[];let t="";for(const e of this.elems)typeof e=="string"?t+=e:(t.length>0&&(this.spans.push(t),t=""),this.spans.push(e));t.length>0&&this.spans.push(t)}return this.spans}toJSON(){return this.toString()}set(t,e){if(this[re])throw new RangeError("object cannot be modified outside of a change block");this.elems[t]=e}insertAt(t,...e){if(this[re])throw new RangeError("object cannot be modified outside of a change block");this.elems.splice(t,0,...e)}deleteAt(t,e=1){if(this[re])throw new RangeError("object cannot be modified outside of a change block");this.elems.splice(t,e)}map(t){this.elems.map(t)}lastIndexOf(t,e){this.elems.lastIndexOf(t,e)}concat(t){return new On(this.elems.concat(t.elems))}every(t){return this.elems.every(t)}filter(t){return new On(this.elems.filter(t))}find(t){return this.elems.find(t)}findIndex(t){return this.elems.findIndex(t)}forEach(t){this.elems.forEach(t)}includes(t){return this.elems.includes(t)}indexOf(t){return this.elems.indexOf(t)}join(t){return this.elems.join(t)}reduce(t){this.elems.reduce(t)}reduceRight(t){this.elems.reduceRight(t)}slice(t,e){new On(this.elems.slice(t,e))}some(t){return this.elems.some(t)}toLocaleString(){this.toString()}}class xs{constructor(t){this.value=t||0,Reflect.defineProperty(this,Gl,{value:!0})}valueOf(){return this.value}toString(){return this.valueOf().toString()}toJSON(){return this.value}}class Um extends xs{constructor(t,e,r,i,a){super(t),this.context=e,this.path=r,this.objectId=i,this.key=a}increment(t){return t=typeof t=="number"?t:1,this.context.increment(this.objectId,this.key,t),this.value+=t,this.value}decrement(t){return this.increment(typeof t=="number"?-t:-1)}}function Gm(n,t,e,r,i){return new Um(n,t,e,r,i)}class Zl{constructor(t){this.val=t}}function Ve(n){if(typeof n=="string"&&/^[0-9]+$/.test(n)&&(n=parseInt(n,10)),typeof n!="number")return n;if(n<0||isNaN(n)||n===1/0||n===-1/0)throw new RangeError("A list index must be positive, but you passed "+n);return n}function pe(n,t){const{context:e,objectId:r,path:i,readonly:a,heads:l,textV2:c}=n,h=e.getWithType(r,t,l);if(h===null)return;const d=h[0],m=h[1];switch(d){case void 0:return;case"map":return eo(e,m,c,[...i,t],a,l);case"list":return Uo(e,m,c,[...i,t],a,l);case"text":return c?e.text(m,l):no(e,m,[...i,t],a,l);case"str":return m;case"uint":return m;case"int":return m;case"f64":return m;case"boolean":return m;case"null":return null;case"bytes":return m;case"timestamp":return m;case"counter":return a?new xs(m):Gm(m,e,i,r,t);default:throw RangeError(`datatype ${d} unimplemented`)}}function Ko(n,t){switch(typeof n){case"object":if(n==null)return[null,"null"];if(n[qm])return[n.value,"uint"];if(n[Jm])return[n.value,"int"];if(n[Hm])return[n.value,"f64"];if(n[Gl])return[n.value,"counter"];if(n instanceof Date)return[n.getTime(),"timestamp"];if(n instanceof Zl)return[n.val,"str"];if(n instanceof On)return[n,"text"];if(n instanceof Uint8Array)return[n,"bytes"];if(n instanceof Array)return[n,"list"];if(Object.getPrototypeOf(n)===Object.getPrototypeOf({}))return[n,"map"];throw n[jt]?new RangeError("Cannot create a reference to an existing document object"):new RangeError(`Cannot assign unknown object: ${n}`);case"boolean":return[n,"boolean"];case"number":return Number.isInteger(n)?[n,"int"]:[n,"f64"];case"string":return t?[n,"text"]:[n,"str"];default:throw new RangeError(`Unsupported type of value: ${typeof n}`)}}const Zm={get(n,t){const{context:e,objectId:r,cache:i}=n;return t===Symbol.toStringTag?n[Symbol.toStringTag]:t===jt?r:t===Ho?!0:t===oe?n.trace:t===re?{handle:e}:(i[t]||(i[t]=pe(n,t)),i[t])},set(n,t,e){const{context:r,objectId:i,path:a,readonly:l,frozen:c,textV2:h}=n;if(n.cache={},e&&e[jt])throw new RangeError("Cannot create a reference to an existing document object");if(t===oe)return n.trace=e,!0;const[d,m]=Ko(e,h);if(c)throw new RangeError("Attempting to use an outdated Automerge document");if(l)throw new RangeError(`Object property "${t}" cannot be modified`);switch(m){case"list":{const y=r.putObject(i,t,[]),v=Uo(r,y,h,[...a,t],l);for(let b=0;b<d.length;b++)v[b]=d[b];break}case"text":{if(h)Go(d),r.putObject(i,t,d);else{Ss(d);const y=r.putObject(i,t,""),v=no(r,y,[...a,t],l);for(let b=0;b<d.length;b++)v[b]=d.get(b)}break}case"map":{const y=r.putObject(i,t,{}),v=eo(r,y,h,[...a,t],l);for(const b in d)v[b]=d[b];break}default:r.put(i,t,d,m)}return!0},deleteProperty(n,t){const{context:e,objectId:r,readonly:i}=n;if(n.cache={},i)throw new RangeError(`Object property "${t}" cannot be modified`);return e.delete(r,t),!0},has(n,t){return this.get(n,t)!==void 0},getOwnPropertyDescriptor(n,t){const e=this.get(n,t);if(typeof e<"u")return{configurable:!0,enumerable:!0,value:e}},ownKeys(n){const{context:t,objectId:e,heads:r}=n,i=t.keys(e,r);return[...new Set(i)]}},Yl={get(n,t){const{context:e,objectId:r,heads:i}=n;return t=Ve(t),t===Symbol.hasInstance?a=>Array.isArray(a):t===Symbol.toStringTag?n[Symbol.toStringTag]:t===jt?r:t===Ho?!0:t===oe?n.trace:t===re?{handle:e}:t==="length"?e.length(r,i):typeof t=="number"?pe(n,t):Ql(n)[t]},set(n,t,e){const{context:r,objectId:i,path:a,readonly:l,frozen:c,textV2:h}=n;if(t=Ve(t),e&&e[jt])throw new RangeError("Cannot create a reference to an existing document object");if(t===oe)return n.trace=e,!0;if(typeof t=="string")throw new RangeError("list index must be a number");const[d,m]=Ko(e,h);if(c)throw new RangeError("Attempting to use an outdated Automerge document");if(l)throw new RangeError(`Object property "${t}" cannot be modified`);switch(m){case"list":{let y;t>=r.length(i)?y=r.insertObject(i,t,[]):y=r.putObject(i,t,[]),Uo(r,y,h,[...a,t],l).splice(0,0,...d);break}case"text":{if(h)Go(d),t>=r.length(i)?r.insertObject(i,t,d):r.putObject(i,t,d);else{let y;Ss(d),t>=r.length(i)?y=r.insertObject(i,t,""):y=r.putObject(i,t,""),no(r,y,[...a,t],l).splice(0,0,...d)}break}case"map":{let y;t>=r.length(i)?y=r.insertObject(i,t,{}):y=r.putObject(i,t,{});const v=eo(r,y,h,[...a,t],l);for(const b in d)v[b]=d[b];break}default:t>=r.length(i)?r.insert(i,t,d,m):r.put(i,t,d,m)}return!0},deleteProperty(n,t){const{context:e,objectId:r}=n;t=Ve(t);const i=e.get(r,t);if(i!=null&&i[0]=="counter")throw new TypeError("Unsupported operation: deleting a counter from a list");return e.delete(r,t),!0},has(n,t){const{context:e,objectId:r,heads:i}=n;return t=Ve(t),typeof t=="number"?t<e.length(r,i):t==="length"},getOwnPropertyDescriptor(n,t){const{context:e,objectId:r,heads:i}=n;return t==="length"?{writable:!0,value:e.length(r,i)}:t===jt?{configurable:!1,enumerable:!1,value:r}:(t=Ve(t),{configurable:!0,enumerable:!0,value:pe(n,t)})},getPrototypeOf(n){return Object.getPrototypeOf(n)},ownKeys(){const n=[];return n.push("length"),n}},Ym=Object.assign({},Yl,{get(n,t){const{context:e,objectId:r,heads:i}=n;return t=Ve(t),t===Symbol.hasInstance?a=>Array.isArray(a):t===Symbol.toStringTag?n[Symbol.toStringTag]:t===jt?r:t===Ho?!0:t===oe?n.trace:t===re?{handle:e}:t==="length"?e.length(r,i):typeof t=="number"?pe(n,t):Xm(n)[t]||Ql(n)[t]},getPrototypeOf(){return Object.getPrototypeOf(new On)}});function eo(n,t,e,r,i,a){const l={context:n,objectId:t,path:r||[],readonly:!!i,frozen:!1,heads:a,cache:{},textV2:e},c={};return Object.assign(c,l),new Proxy(c,Zm)}function Uo(n,t,e,r,i,a){const l={context:n,objectId:t,path:r||[],readonly:!!i,frozen:!1,heads:a,cache:{},textV2:e},c=[];return Object.assign(c,l),new Proxy(c,Yl)}function no(n,t,e,r,i){const a={context:n,objectId:t,path:e||[],readonly:!!r,frozen:!1,heads:i,cache:{},textV2:!1},l={};return Object.assign(l,a),new Proxy(l,Ym)}function Qm(n,t,e){return eo(n,"_root",t,[],!!e)}function Ql(n){const{context:t,objectId:e,path:r,readonly:i,frozen:a,heads:l,textV2:c}=n;return{deleteAt(h,d){return typeof d=="number"?t.splice(e,h,d):t.delete(e,h),this},fill(h,d,m){const[y,v]=Ko(h,c),b=t.length(e);d=Ve(d||0),m=Ve(m||b);for(let C=d;C<Math.min(m,b);C++)if(v==="list"||v==="map")t.putObject(e,C,y);else if(v==="text")if(c)Go(y),t.putObject(e,C,y);else{Ss(y);const N=t.putObject(e,C,""),P=no(t,N,[...r,C],i);for(let J=0;J<y.length;J++)P[J]=y.get(J)}else t.put(e,C,y,v);return this},indexOf(h,d=0){const m=t.length(e);for(let y=d;y<m;y++){const v=t.getWithType(e,y,l);if(v&&(v[1]===h[jt]||v[1]===h))return y}return-1},insertAt(h,...d){return this.splice(h,0,...d),this},pop(){const h=t.length(e);if(h==0)return;const d=pe(n,h-1);return t.delete(e,h-1),d},push(...h){const d=t.length(e);return this.splice(d,0,...h),t.length(e)},shift(){if(t.length(e)==0)return;const h=pe(n,0);return t.delete(e,0),h},splice(h,d,...m){h=Ve(h),d=Ve(d);for(const b of m)if(b&&b[jt])throw new RangeError("Cannot create a reference to an existing document object");if(a)throw new RangeError("Attempting to use an outdated Automerge document");if(i)throw new RangeError("Sequence object cannot be modified outside of a change block");const y=[];for(let b=0;b<d;b++){const C=pe(n,h);C!==void 0&&y.push(C),t.delete(e,h)}const v=m.map(b=>Ko(b,c));for(const[b,C]of v){switch(C){case"list":{const N=t.insertObject(e,h,[]);Uo(t,N,c,[...r,h],i).splice(0,0,...b);break}case"text":{if(c)Go(b),t.insertObject(e,h,b);else{const N=t.insertObject(e,h,"");no(t,N,[...r,h],i).splice(0,0,...b)}break}case"map":{const N=t.insertObject(e,h,{}),P=eo(t,N,c,[...r,h],i);for(const J in b)P[J]=b[J];break}default:t.insert(e,h,b,C)}h+=1}return y},unshift(...h){return this.splice(0,0,...h),t.length(e)},entries(){return{next:()=>{const h=pe(n,0);return h===void 0?{value:void 0,done:!0}:{value:[0,h],done:!1}}}},keys(){let h=0;const d=t.length(e,l);return{next:()=>{let m;return h<d&&(m=h,h++),{value:m,done:!0}}}},values(){return{next:()=>{const h=pe(n,0);return h===void 0?{value:void 0,done:!0}:{value:h,done:!1}}}},toArray(){const h=[];let d;do d=pe(n,h.length),d!==void 0&&h.push(d);while(d!==void 0);return h},map(h){return this.toArray().map(h)},toString(){return this.toArray().toString()},toLocaleString(){return this.toArray().toLocaleString()},forEach(h){return this.toArray().forEach(h)},concat(h){return this.toArray().concat(h)},every(h){return this.toArray().every(h)},filter(h){return this.toArray().filter(h)},find(h){let d=0;for(const m of this){if(h(m,d))return m;d+=1}},findIndex(h){let d=0;for(const m of this){if(h(m,d))return d;d+=1}return-1},includes(h){return this.find(d=>d===h)!==void 0},join(h){return this.toArray().join(h)},reduce(h,d){return this.toArray().reduce(h,d)},reduceRight(h,d){return this.toArray().reduceRight(h,d)},lastIndexOf(h,d=1/0){return this.toArray().lastIndexOf(h,d)},slice(h,d){return this.toArray().slice(h,d)},some(h){let d=0;for(const m of this){if(h(m,d))return!0;d+=1}return!1},[Symbol.iterator]:function*(){let h=0,d=pe(n,h);for(;d!==void 0;)yield d,h+=1,d=pe(n,h)}}}function Xm(n){const{context:t,objectId:e,heads:r}=n;return{set(i,a){return this[i]=a},get(i){return this[i]},toString(){return t.text(e,r).replace(/ï¿¼/g,"")},toSpans(){const i=[];let a="";const l=t.length(e);for(let c=0;c<l;c++){const h=this[c];typeof h=="string"?a+=h:(a.length>0&&(i.push(a),a=""),i.push(h))}return a.length>0&&i.push(a),i},toJSON(){return this.toString()},indexOf(i,a=0){return t.text(e).indexOf(i,a)}}}function Ss(n){if(!(n instanceof On))throw new Error("value was not a Text instance")}function Go(n){if(typeof n!="string")throw new Error("value was not a string")}function tg(n){for(const t in n)Xl[t]=n[t]}const Xl={create(n,t){throw new RangeError("Automerge.use() not called")},load(n,t,e){throw new RangeError("Automerge.use() not called (load)")},encodeChange(n){throw new RangeError("Automerge.use() not called (encodeChange)")},decodeChange(n){throw new RangeError("Automerge.use() not called (decodeChange)")},initSyncState(){throw new RangeError("Automerge.use() not called (initSyncState)")},encodeSyncMessage(n){throw new RangeError("Automerge.use() not called (encodeSyncMessage)")},decodeSyncMessage(n){throw new RangeError("Automerge.use() not called (decodeSyncMessage)")},encodeSyncState(n){throw new RangeError("Automerge.use() not called (encodeSyncState)")},decodeSyncState(n){throw new RangeError("Automerge.use() not called (decodeSyncState)")},exportSyncState(n){throw new RangeError("Automerge.use() not called (exportSyncState)")},importSyncState(n){throw new RangeError("Automerge.use() not called (importSyncState)")}};function Mn(n,t=!0){if(typeof n!="object")throw new RangeError("must be the document root");const e=Reflect.get(n,re);if(e===void 0||e==null||t&&Cs(n)!=="_root")throw new RangeError("must be the document root");return e}function Cs(n){return typeof n!="object"||n===null?null:Reflect.get(n,jt)}function Zo(n){return!!Reflect.get(n,Ho)}const eg=""+new URL("automerge_wasm_bg.89f17edf.wasm",import.meta.url).href,ng=async(n={},t)=>{let e;if(t.startsWith("data:")){const r=t.replace(/^data:.*?base64,/,"");let i;if(typeof Buffer=="function"&&typeof Buffer.from=="function")i=Buffer.from(r,"base64");else if(typeof atob=="function"){const a=atob(r);i=new Uint8Array(a.length);for(let l=0;l<a.length;l++)i[l]=a.charCodeAt(l)}else throw new Error("Cannot decode base64-encoded data URL");e=await WebAssembly.instantiate(i,n)}else{const r=await fetch(t),i=r.headers.get("Content-Type")||"";if("instantiateStreaming"in WebAssembly&&i.startsWith("application/wasm"))e=await WebAssembly.instantiateStreaming(r,n);else{const a=await r.arrayBuffer();e=await WebAssembly.instantiate(a,n)}}return e.instance.exports};let x;function tc(n){x=n}const ln=new Array(128).fill(void 0);ln.push(void 0,null,!0,!1);function z(n){return ln[n]}let Gt=0,Yo=null;function ro(){return(Yo===null||Yo.byteLength===0)&&(Yo=new Uint8Array(x.memory.buffer)),Yo}const rg=typeof TextEncoder>"u"?(0,module.require)("util").TextEncoder:TextEncoder;let Qo=new rg("utf-8");const og=typeof Qo.encodeInto=="function"?function(n,t){return Qo.encodeInto(n,t)}:function(n,t){const e=Qo.encode(n);return t.set(e),{read:n.length,written:e.length}};function me(n,t,e){if(e===void 0){const c=Qo.encode(n),h=t(c.length);return ro().subarray(h,h+c.length).set(c),Gt=c.length,h}let r=n.length,i=t(r);const a=ro();let l=0;for(;l<r;l++){const c=n.charCodeAt(l);if(c>127)break;a[i+l]=c}if(l!==r){l!==0&&(n=n.slice(l)),i=e(i,r,r=l+n.length*3);const c=ro().subarray(i+l,i+r),h=og(n,c);l+=h.written}return Gt=l,i}let Xo=null;function A(){return(Xo===null||Xo.byteLength===0)&&(Xo=new Int32Array(x.memory.buffer)),Xo}function vt(n){return n==null}let ti=null;function Os(){return(ti===null||ti.byteLength===0)&&(ti=new Float64Array(x.memory.buffer)),ti}let oo=ln.length;function T(n){oo===ln.length&&ln.push(ln.length+1);const t=oo;return oo=ln[t],ln[t]=n,t}const ig=typeof TextDecoder>"u"?(0,module.require)("util").TextDecoder:TextDecoder;let ec=new ig("utf-8",{ignoreBOM:!0,fatal:!0});ec.decode();function Oe(n,t){return ec.decode(ro().subarray(n,n+t))}function sg(n){n<132||(ln[n]=oo,oo=n)}function j(n){const t=z(n);return sg(n),t}function Ms(n){const t=typeof n;if(t=="number"||t=="boolean"||n==null)return`${n}`;if(t=="string")return`"${n}"`;if(t=="symbol"){const i=n.description;return i==null?"Symbol":`Symbol(${i})`}if(t=="function"){const i=n.name;return typeof i=="string"&&i.length>0?`Function(${i})`:"Function"}if(Array.isArray(n)){const i=n.length;let a="[";i>0&&(a+=Ms(n[0]));for(let l=1;l<i;l++)a+=", "+Ms(n[l]);return a+="]",a}const e=/\[object ([^\]]+)\]/.exec(toString.call(n));let r;if(e.length>1)r=e[1];else return toString.call(n);if(r=="Object")try{return"Object("+JSON.stringify(n)+")"}catch{return"Object"}return n instanceof Error?`${n.name}: ${n.message}
${n.stack}`:r}function kr(n,t){if(!(n instanceof t))throw new Error(`expected instance of ${t.name}`);return n.ptr}function ag(n,t){try{const c=x.__wbindgen_add_to_stack_pointer(-16);var e=vt(t)?0:me(t,x.__wbindgen_malloc,x.__wbindgen_realloc),r=Gt;x.create(c,n,e,r);var i=A()[c/4+0],a=A()[c/4+1],l=A()[c/4+2];if(l)throw j(a);return Le.__wrap(i)}finally{x.__wbindgen_add_to_stack_pointer(16)}}function lg(n,t,e){try{const h=x.__wbindgen_add_to_stack_pointer(-16);var r=vt(e)?0:me(e,x.__wbindgen_malloc,x.__wbindgen_realloc),i=Gt;x.load(h,T(n),t,r,i);var a=A()[h/4+0],l=A()[h/4+1],c=A()[h/4+2];if(c)throw j(l);return Le.__wrap(a)}finally{x.__wbindgen_add_to_stack_pointer(16)}}function cg(n){try{const i=x.__wbindgen_add_to_stack_pointer(-16);x.encodeChange(i,T(n));var t=A()[i/4+0],e=A()[i/4+1],r=A()[i/4+2];if(r)throw j(e);return j(t)}finally{x.__wbindgen_add_to_stack_pointer(16)}}function ug(n){try{const i=x.__wbindgen_add_to_stack_pointer(-16);x.decodeChange(i,T(n));var t=A()[i/4+0],e=A()[i/4+1],r=A()[i/4+2];if(r)throw j(e);return j(t)}finally{x.__wbindgen_add_to_stack_pointer(16)}}function hg(){const n=x.initSyncState();return Me.__wrap(n)}function fg(n){try{const i=x.__wbindgen_add_to_stack_pointer(-16);x.importSyncState(i,T(n));var t=A()[i/4+0],e=A()[i/4+1],r=A()[i/4+2];if(r)throw j(e);return Me.__wrap(t)}finally{x.__wbindgen_add_to_stack_pointer(16)}}function dg(n){kr(n,Me);const t=x.exportSyncState(n.ptr);return j(t)}function pg(n){try{const i=x.__wbindgen_add_to_stack_pointer(-16);x.encodeSyncMessage(i,T(n));var t=A()[i/4+0],e=A()[i/4+1],r=A()[i/4+2];if(r)throw j(e);return j(t)}finally{x.__wbindgen_add_to_stack_pointer(16)}}function mg(n){try{const i=x.__wbindgen_add_to_stack_pointer(-16);x.decodeSyncMessage(i,T(n));var t=A()[i/4+0],e=A()[i/4+1],r=A()[i/4+2];if(r)throw j(e);return j(t)}finally{x.__wbindgen_add_to_stack_pointer(16)}}function gg(n){kr(n,Me);const t=x.encodeSyncState(n.ptr);return j(t)}function _g(n){try{const i=x.__wbindgen_add_to_stack_pointer(-16);x.decodeSyncState(i,T(n));var t=A()[i/4+0],e=A()[i/4+1],r=A()[i/4+2];if(r)throw j(e);return Me.__wrap(t)}finally{x.__wbindgen_add_to_stack_pointer(16)}}function Pt(n,t){try{return n.apply(this,t)}catch(e){x.__wbindgen_exn_store(T(e))}}function yg(n,t){return ro().subarray(n/1,n/1+t)}const bg=Object.freeze({Array:0,0:"Array",String:1,1:"String"}),nc=new FinalizationRegistry(n=>x.__wbg_automerge_free(n));class Le{static __wrap(t){const e=Object.create(Le.prototype);return e.ptr=t,nc.register(e,e.ptr,e),e}__destroy_into_raw(){const t=this.ptr;return this.ptr=0,nc.unregister(this),t}free(){const t=this.__destroy_into_raw();x.__wbg_automerge_free(t)}static new(t,e){try{const h=x.__wbindgen_add_to_stack_pointer(-16);var r=vt(t)?0:me(t,x.__wbindgen_malloc,x.__wbindgen_realloc),i=Gt;x.automerge_new(h,r,i,e);var a=A()[h/4+0],l=A()[h/4+1],c=A()[h/4+2];if(c)throw j(l);return Le.__wrap(a)}finally{x.__wbindgen_add_to_stack_pointer(16)}}clone(t){try{const c=x.__wbindgen_add_to_stack_pointer(-16);var e=vt(t)?0:me(t,x.__wbindgen_malloc,x.__wbindgen_realloc),r=Gt;x.automerge_clone(c,this.ptr,e,r);var i=A()[c/4+0],a=A()[c/4+1],l=A()[c/4+2];if(l)throw j(a);return Le.__wrap(i)}finally{x.__wbindgen_add_to_stack_pointer(16)}}fork(t,e){try{const h=x.__wbindgen_add_to_stack_pointer(-16);var r=vt(t)?0:me(t,x.__wbindgen_malloc,x.__wbindgen_realloc),i=Gt;x.automerge_fork(h,this.ptr,r,i,T(e));var a=A()[h/4+0],l=A()[h/4+1],c=A()[h/4+2];if(c)throw j(l);return Le.__wrap(a)}finally{x.__wbindgen_add_to_stack_pointer(16)}}pendingOps(){const t=x.automerge_pendingOps(this.ptr);return j(t)}commit(t,e){var r=vt(t)?0:me(t,x.__wbindgen_malloc,x.__wbindgen_realloc),i=Gt;const a=x.automerge_commit(this.ptr,r,i,!vt(e),vt(e)?0:e);return j(a)}merge(t){try{const a=x.__wbindgen_add_to_stack_pointer(-16);kr(t,Le),x.automerge_merge(a,this.ptr,t.ptr);var e=A()[a/4+0],r=A()[a/4+1],i=A()[a/4+2];if(i)throw j(r);return j(e)}finally{x.__wbindgen_add_to_stack_pointer(16)}}rollback(){return x.automerge_rollback(this.ptr)}keys(t,e){try{const l=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_keys(l,this.ptr,T(t),vt(e)?0:T(e));var r=A()[l/4+0],i=A()[l/4+1],a=A()[l/4+2];if(a)throw j(i);return j(r)}finally{x.__wbindgen_add_to_stack_pointer(16)}}text(t,e){try{const d=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_text(d,this.ptr,T(t),vt(e)?0:T(e));var r=A()[d/4+0],i=A()[d/4+1],a=A()[d/4+2],l=A()[d/4+3],c=r,h=i;if(l)throw c=0,h=0,j(a);return Oe(c,h)}finally{x.__wbindgen_add_to_stack_pointer(16),x.__wbindgen_free(c,h)}}splice(t,e,r,i){try{const c=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_splice(c,this.ptr,T(t),e,r,T(i));var a=A()[c/4+0],l=A()[c/4+1];if(l)throw j(a)}finally{x.__wbindgen_add_to_stack_pointer(16)}}push(t,e,r){try{const l=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_push(l,this.ptr,T(t),T(e),T(r));var i=A()[l/4+0],a=A()[l/4+1];if(a)throw j(i)}finally{x.__wbindgen_add_to_stack_pointer(16)}}pushObject(t,e){try{const c=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_pushObject(c,this.ptr,T(t),T(e));var r=A()[c/4+0],i=A()[c/4+1],a=A()[c/4+2],l=A()[c/4+3];if(l)throw j(a);let h;return r!==0&&(h=Oe(r,i).slice(),x.__wbindgen_free(r,i*1)),h}finally{x.__wbindgen_add_to_stack_pointer(16)}}insert(t,e,r,i){try{const c=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_insert(c,this.ptr,T(t),e,T(r),T(i));var a=A()[c/4+0],l=A()[c/4+1];if(l)throw j(a)}finally{x.__wbindgen_add_to_stack_pointer(16)}}insertObject(t,e,r){try{const h=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_insertObject(h,this.ptr,T(t),e,T(r));var i=A()[h/4+0],a=A()[h/4+1],l=A()[h/4+2],c=A()[h/4+3];if(c)throw j(l);let d;return i!==0&&(d=Oe(i,a).slice(),x.__wbindgen_free(i,a*1)),d}finally{x.__wbindgen_add_to_stack_pointer(16)}}put(t,e,r,i){try{const c=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_put(c,this.ptr,T(t),T(e),T(r),T(i));var a=A()[c/4+0],l=A()[c/4+1];if(l)throw j(a)}finally{x.__wbindgen_add_to_stack_pointer(16)}}putObject(t,e,r){try{const c=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_putObject(c,this.ptr,T(t),T(e),T(r));var i=A()[c/4+0],a=A()[c/4+1],l=A()[c/4+2];if(l)throw j(a);return j(i)}finally{x.__wbindgen_add_to_stack_pointer(16)}}increment(t,e,r){try{const l=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_increment(l,this.ptr,T(t),T(e),T(r));var i=A()[l/4+0],a=A()[l/4+1];if(a)throw j(i)}finally{x.__wbindgen_add_to_stack_pointer(16)}}get(t,e,r){try{const c=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_get(c,this.ptr,T(t),T(e),vt(r)?0:T(r));var i=A()[c/4+0],a=A()[c/4+1],l=A()[c/4+2];if(l)throw j(a);return j(i)}finally{x.__wbindgen_add_to_stack_pointer(16)}}getWithType(t,e,r){try{const c=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_getWithType(c,this.ptr,T(t),T(e),vt(r)?0:T(r));var i=A()[c/4+0],a=A()[c/4+1],l=A()[c/4+2];if(l)throw j(a);return j(i)}finally{x.__wbindgen_add_to_stack_pointer(16)}}getAll(t,e,r){try{const c=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_getAll(c,this.ptr,T(t),T(e),vt(r)?0:T(r));var i=A()[c/4+0],a=A()[c/4+1],l=A()[c/4+2];if(l)throw j(a);return j(i)}finally{x.__wbindgen_add_to_stack_pointer(16)}}enableFreeze(t){try{const a=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_enableFreeze(a,this.ptr,T(t));var e=A()[a/4+0],r=A()[a/4+1],i=A()[a/4+2];if(i)throw j(r);return j(e)}finally{x.__wbindgen_add_to_stack_pointer(16)}}enablePatches(t){try{const a=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_enablePatches(a,this.ptr,T(t));var e=A()[a/4+0],r=A()[a/4+1],i=A()[a/4+2];if(i)throw j(r);return j(e)}finally{x.__wbindgen_add_to_stack_pointer(16)}}registerDatatype(t,e){try{const a=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_registerDatatype(a,this.ptr,T(t),T(e));var r=A()[a/4+0],i=A()[a/4+1];if(i)throw j(r)}finally{x.__wbindgen_add_to_stack_pointer(16)}}applyPatches(t,e,r){try{const c=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_applyPatches(c,this.ptr,T(t),T(e),T(r));var i=A()[c/4+0],a=A()[c/4+1],l=A()[c/4+2];if(l)throw j(a);return j(i)}finally{x.__wbindgen_add_to_stack_pointer(16)}}popPatches(){try{const i=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_popPatches(i,this.ptr);var t=A()[i/4+0],e=A()[i/4+1],r=A()[i/4+2];if(r)throw j(e);return j(t)}finally{x.__wbindgen_add_to_stack_pointer(16)}}length(t,e){try{const l=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_length(l,this.ptr,T(t),vt(e)?0:T(e));var r=Os()[l/8+0],i=A()[l/4+2],a=A()[l/4+3];if(a)throw j(i);return r}finally{x.__wbindgen_add_to_stack_pointer(16)}}delete(t,e){try{const a=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_delete(a,this.ptr,T(t),T(e));var r=A()[a/4+0],i=A()[a/4+1];if(i)throw j(r)}finally{x.__wbindgen_add_to_stack_pointer(16)}}save(){const t=x.automerge_save(this.ptr);return j(t)}saveIncremental(){const t=x.automerge_saveIncremental(this.ptr);return j(t)}loadIncremental(t){try{const a=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_loadIncremental(a,this.ptr,T(t));var e=Os()[a/8+0],r=A()[a/4+2],i=A()[a/4+3];if(i)throw j(r);return e}finally{x.__wbindgen_add_to_stack_pointer(16)}}applyChanges(t){try{const i=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_applyChanges(i,this.ptr,T(t));var e=A()[i/4+0],r=A()[i/4+1];if(r)throw j(e)}finally{x.__wbindgen_add_to_stack_pointer(16)}}getChanges(t){try{const a=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_getChanges(a,this.ptr,T(t));var e=A()[a/4+0],r=A()[a/4+1],i=A()[a/4+2];if(i)throw j(r);return j(e)}finally{x.__wbindgen_add_to_stack_pointer(16)}}getChangeByHash(t){try{const a=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_getChangeByHash(a,this.ptr,T(t));var e=A()[a/4+0],r=A()[a/4+1],i=A()[a/4+2];if(i)throw j(r);return j(e)}finally{x.__wbindgen_add_to_stack_pointer(16)}}getChangesAdded(t){kr(t,Le);const e=x.automerge_getChangesAdded(this.ptr,t.ptr);return j(e)}getHeads(){const t=x.automerge_getHeads(this.ptr);return j(t)}getActorId(){try{const r=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_getActorId(r,this.ptr);var t=A()[r/4+0],e=A()[r/4+1];return Oe(t,e)}finally{x.__wbindgen_add_to_stack_pointer(16),x.__wbindgen_free(t,e)}}getLastLocalChange(){const t=x.automerge_getLastLocalChange(this.ptr);return j(t)}dump(){x.automerge_dump(this.ptr)}getMissingDeps(t){try{const a=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_getMissingDeps(a,this.ptr,vt(t)?0:T(t));var e=A()[a/4+0],r=A()[a/4+1],i=A()[a/4+2];if(i)throw j(r);return j(e)}finally{x.__wbindgen_add_to_stack_pointer(16)}}receiveSyncMessage(t,e){try{const a=x.__wbindgen_add_to_stack_pointer(-16);kr(t,Me),x.automerge_receiveSyncMessage(a,this.ptr,t.ptr,T(e));var r=A()[a/4+0],i=A()[a/4+1];if(i)throw j(r)}finally{x.__wbindgen_add_to_stack_pointer(16)}}generateSyncMessage(t){kr(t,Me);const e=x.automerge_generateSyncMessage(this.ptr,t.ptr);return j(e)}toJS(t){try{const a=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_toJS(a,this.ptr,T(t));var e=A()[a/4+0],r=A()[a/4+1],i=A()[a/4+2];if(i)throw j(r);return j(e)}finally{x.__wbindgen_add_to_stack_pointer(16)}}materialize(t,e,r){try{const c=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_materialize(c,this.ptr,T(t),vt(e)?0:T(e),T(r));var i=A()[c/4+0],a=A()[c/4+1],l=A()[c/4+2];if(l)throw j(a);return j(i)}finally{x.__wbindgen_add_to_stack_pointer(16)}}emptyChange(t,e){var r=vt(t)?0:me(t,x.__wbindgen_malloc,x.__wbindgen_realloc),i=Gt;const a=x.automerge_emptyChange(this.ptr,r,i,!vt(e),vt(e)?0:e);return j(a)}mark(t,e,r,i,a){try{const h=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_mark(h,this.ptr,T(t),T(e),T(r),T(i),T(a));var l=A()[h/4+0],c=A()[h/4+1];if(c)throw j(l)}finally{x.__wbindgen_add_to_stack_pointer(16)}}unmark(t,e,r,i){try{const c=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_unmark(c,this.ptr,T(t),T(e),r,i);var a=A()[c/4+0],l=A()[c/4+1];if(l)throw j(a)}finally{x.__wbindgen_add_to_stack_pointer(16)}}marks(t,e){try{const l=x.__wbindgen_add_to_stack_pointer(-16);x.automerge_marks(l,this.ptr,T(t),vt(e)?0:T(e));var r=A()[l/4+0],i=A()[l/4+1],a=A()[l/4+2];if(a)throw j(i);return j(r)}finally{x.__wbindgen_add_to_stack_pointer(16)}}}const rc=new FinalizationRegistry(n=>x.__wbg_syncstate_free(n));class Me{static __wrap(t){const e=Object.create(Me.prototype);return e.ptr=t,rc.register(e,e.ptr,e),e}__destroy_into_raw(){const t=this.ptr;return this.ptr=0,rc.unregister(this),t}free(){const t=this.__destroy_into_raw();x.__wbg_syncstate_free(t)}get sharedHeads(){const t=x.syncstate_sharedHeads(this.ptr);return j(t)}get lastSentHeads(){const t=x.syncstate_lastSentHeads(this.ptr);return j(t)}set lastSentHeads(t){try{const i=x.__wbindgen_add_to_stack_pointer(-16);x.syncstate_set_lastSentHeads(i,this.ptr,T(t));var e=A()[i/4+0],r=A()[i/4+1];if(r)throw j(e)}finally{x.__wbindgen_add_to_stack_pointer(16)}}set sentHashes(t){try{const i=x.__wbindgen_add_to_stack_pointer(-16);x.syncstate_set_sentHashes(i,this.ptr,T(t));var e=A()[i/4+0],r=A()[i/4+1];if(r)throw j(e)}finally{x.__wbindgen_add_to_stack_pointer(16)}}clone(){const t=x.syncstate_clone(this.ptr);return Me.__wrap(t)}}function oc(n,t){const e=z(t),r=JSON.stringify(e===void 0?null:e),i=me(r,x.__wbindgen_malloc,x.__wbindgen_realloc),a=Gt;A()[n/4+1]=a,A()[n/4+0]=i}function ic(n){return z(n)===void 0}function sc(n,t){const e=z(t),r=typeof e=="number"?e:void 0;Os()[n/8+1]=vt(r)?0:r,A()[n/4+0]=!vt(r)}function ac(n){const t=z(n);return typeof t=="boolean"?t?1:0:2}function lc(n){return z(n)===null}function cc(n){return T(n)}function uc(n,t){const e=Oe(n,t);return T(e)}function hc(n,t){const e=z(t),r=typeof e=="string"?e:void 0;var i=vt(r)?0:me(r,x.__wbindgen_malloc,x.__wbindgen_realloc),a=Gt;A()[n/4+1]=a,A()[n/4+0]=i}function fc(n){return typeof z(n)=="string"}function dc(n){const t=z(n);return T(t)}function pc(n,t){try{console.error(Oe(n,t))}finally{x.__wbindgen_free(n,t)}}function mc(){const n=new Error;return T(n)}function gc(n,t){const e=z(t).stack,r=me(e,x.__wbindgen_malloc,x.__wbindgen_realloc),i=Gt;A()[n/4+1]=i,A()[n/4+0]=r}function _c(n){j(n)}function yc(n,t){const e=new Error(Oe(n,t));return T(e)}function bc(n,t){return z(n)==z(t)}function wc(n){const t=z(n);return typeof t=="object"&&t!==null}function vc(n){return T(n)}function kc(n){const t=BigInt.asUintN(64,n);return T(t)}function xc(n,t,e){z(n)[j(t)]=j(e)}function Sc(n,t){const e=String(z(t)),r=me(e,x.__wbindgen_malloc,x.__wbindgen_realloc),i=Gt;A()[n/4+1]=i,A()[n/4+0]=r}function Cc(n){const t=z(n).crypto;return T(t)}function Oc(n){const t=z(n).msCrypto;return T(t)}function Mc(){return Pt(function(n,t){z(n).getRandomValues(z(t))},arguments)}function Ac(){return Pt(function(n,t,e){z(n).randomFillSync(yg(t,e))},arguments)}function Tc(){return Pt(function(){const n=module.require;return T(n)},arguments)}function Nc(n){const t=z(n).process;return T(t)}function Ec(n){const t=z(n).versions;return T(t)}function Dc(n){const t=z(n).node;return T(t)}function Rc(n){console.log(z(n))}function Ic(n,t){console.log(z(n),z(t))}function zc(){const n=new Array;return T(n)}function jc(n,t){const e=z(n)[t>>>0];return T(e)}function Pc(n,t,e){z(n)[t>>>0]=j(e)}function Bc(n){const t=Array.from(z(n));return T(t)}function $c(n){return Array.isArray(z(n))}function Fc(n){return z(n).length}function Vc(n,t){return z(n).push(z(t))}function Lc(n,t){return z(n).unshift(z(t))}function Wc(n){let t;try{t=z(n)instanceof ArrayBuffer}catch{t=!1}return t}function qc(n,t){const e=new Error(Oe(n,t));return T(e)}function Jc(n,t){const e=new Function(Oe(n,t));return T(e)}function Hc(){return Pt(function(n,t){const e=z(n).call(z(t));return T(e)},arguments)}function Kc(){return Pt(function(n,t,e){const r=z(n).call(z(t),z(e));return T(r)},arguments)}function Uc(){return Pt(function(n,t,e,r){const i=z(n).call(z(t),z(e),z(r));return T(i)},arguments)}function Gc(){return Pt(function(n){const t=z(n).next();return T(t)},arguments)}function Zc(n){const t=z(n).next;return T(t)}function Yc(n){return z(n).done}function Qc(n){const t=z(n).value;return T(t)}function Xc(n){let t;try{t=z(n)instanceof Date}catch{t=!1}return t}function tu(n){return z(n).getTime()}function eu(n){const t=new Date(z(n));return T(t)}function nu(n){let t;try{t=z(n)instanceof Object}catch{t=!1}return t}function ru(n,t){const e=Object.assign(z(n),z(t));return T(e)}function ou(n,t,e){const r=Object.defineProperty(z(n),z(t),z(e));return T(r)}function iu(n){const t=Object.entries(z(n));return T(t)}function su(n){const t=Object.freeze(z(n));return T(t)}function au(n){const t=Object.keys(z(n));return T(t)}function lu(){const n=new Object;return T(n)}function cu(n){const t=Object.values(z(n));return T(t)}function uu(n){return z(n).length}function hu(n,t){const e=z(n).concat(z(t));return T(e)}function fu(n,t,e){const r=z(n).slice(t>>>0,e>>>0);return T(r)}function du(){return T(Symbol.iterator)}function pu(n,t){const e=Symbol.for(Oe(n,t));return T(e)}function mu(n){const t=z(n).toString();return T(t)}function gu(){return Pt(function(){const n=globalThis.globalThis;return T(n)},arguments)}function _u(){return Pt(function(){const n=self.self;return T(n)},arguments)}function yu(){return Pt(function(){const n=window.window;return T(n)},arguments)}function bu(){return Pt(function(){const n=global.global;return T(n)},arguments)}function wu(n){let t;try{t=z(n)instanceof Uint8Array}catch{t=!1}return t}function vu(n){const t=new Uint8Array(z(n));return T(t)}function ku(n){const t=new Uint8Array(n>>>0);return T(t)}function xu(n,t,e){const r=new Uint8Array(z(n),t>>>0,e>>>0);return T(r)}function Su(n,t,e){const r=z(n).subarray(t>>>0,e>>>0);return T(r)}function Cu(n){return z(n).length}function Ou(n,t,e){z(n).set(z(t),e>>>0)}function Mu(){return Pt(function(n,t,e){const r=Reflect.apply(z(n),z(t),z(e));return T(r)},arguments)}function Au(){return Pt(function(n,t){return Reflect.deleteProperty(z(n),z(t))},arguments)}function Tu(){return Pt(function(n,t){const e=Reflect.get(z(n),z(t));return T(e)},arguments)}function Nu(){return Pt(function(n){const t=Reflect.ownKeys(z(n));return T(t)},arguments)}function Eu(){return Pt(function(n,t,e){return Reflect.set(z(n),z(t),z(e))},arguments)}function Du(n){return typeof z(n)=="function"}function Ru(n){const t=z(n).buffer;return T(t)}function Iu(n,t){const e=Ms(z(t)),r=me(e,x.__wbindgen_malloc,x.__wbindgen_realloc),i=Gt;A()[n/4+1]=i,A()[n/4+0]=r}function zu(n,t){throw new Error(Oe(n,t))}function ju(){const n=x.memory;return T(n)}URL=globalThis.URL;const F=await ng({"./automerge_wasm_bg.js":{__wbindgen_json_serialize:oc,__wbindgen_is_undefined:ic,__wbindgen_number_get:sc,__wbindgen_boolean_get:ac,__wbindgen_is_null:lc,__wbindgen_number_new:cc,__wbindgen_string_new:uc,__wbindgen_string_get:hc,__wbindgen_is_string:fc,__wbindgen_object_clone_ref:dc,__wbg_error_f851667af71bcfc6:pc,__wbg_new_abda76e883ba8a5f:mc,__wbg_stack_658279fe44541cf6:gc,__wbindgen_object_drop_ref:_c,__wbindgen_error_new:yc,__wbindgen_jsval_loose_eq:bc,__wbindgen_is_object:wc,__wbindgen_bigint_from_i64:vc,__wbindgen_bigint_from_u64:kc,__wbg_set_20cbc34131e76824:xc,__wbg_String_91fba7ded13ba54c:Sc,__wbg_crypto_e1d53a1d73fb10b8:Cc,__wbg_msCrypto_6e7d3e1f92610cbb:Oc,__wbg_getRandomValues_805f1c3d65988a5a:Mc,__wbg_randomFillSync_6894564c2c334c42:Ac,__wbg_require_78a3dcfbdba9cbce:Tc,__wbg_process_038c26bf42b093f8:Nc,__wbg_versions_ab37218d2f0b24a8:Ec,__wbg_node_080f4b19d15bc1fe:Dc,__wbg_log_7bb108d119bafbc1:Rc,__wbg_log_d047cf0648d2678e:Ic,__wbg_new_b525de17f44a8943:zc,__wbg_get_27fe3dac1c4d0224:jc,__wbg_set_17224bc548dd1d7b:Pc,__wbg_from_67ca20fa722467e6:Bc,__wbg_isArray_39d28997bf6b96b4:$c,__wbg_length_e498fbc24f9c1d4f:Fc,__wbg_push_49c286f04dd3bf59:Vc,__wbg_unshift_06a94bcbcb492eb3:Lc,__wbg_instanceof_ArrayBuffer_a69f02ee4c4f5065:Wc,__wbg_new_15d3966e9981a196:qc,__wbg_newnoargs_2b8b6bd7753c76ba:Jc,__wbg_call_95d1ea488d03e4e8:Hc,__wbg_call_9495de66fdbe016b:Kc,__wbg_call_96878afb7a8201ca:Uc,__wbg_next_88560ec06a094dea:Gc,__wbg_next_b7d530c04fd8b217:Zc,__wbg_done_1ebec03bbd919843:Yc,__wbg_value_6ac8da5cc5b3efda:Qc,__wbg_instanceof_Date_e353425d719aa266:Xc,__wbg_getTime_7c59072d1651a3cf:tu,__wbg_new_f127e324c1313064:eu,__wbg_instanceof_Object_f5a826c4da0d4a94:nu,__wbg_assign_b0b6530984f36574:ru,__wbg_defineProperty_4926f24c724d5310:ou,__wbg_entries_4e1315b774245952:iu,__wbg_freeze_4dcdbf0b5d9b50f4:su,__wbg_keys_60443f4f867207f9:au,__wbg_new_f9876326328f45ed:lu,__wbg_values_7444c4c2ccefdc9b:cu,__wbg_length_ea0846e494e3b16e:uu,__wbg_concat_040af6c9ba38dd98:hu,__wbg_slice_47202b1d012cdc55:fu,__wbg_iterator_55f114446221aa5a:du,__wbg_for_9a885d0d6d415e40:pu,__wbg_toString_7a3e0cd68ea2a337:mu,__wbg_globalThis_87cbb8506fecf3a9:gu,__wbg_self_e7c1f827057f6584:_u,__wbg_window_a09ec664e14b1b81:yu,__wbg_global_c85a9259e621f3db:bu,__wbg_instanceof_Uint8Array_01cebe79ca606cca:wu,__wbg_new_537b7341ce90bb31:vu,__wbg_newwithlength_b56c882b57805732:ku,__wbg_newwithbyteoffsetandlength_9fb2f11355ecadf5:xu,__wbg_subarray_7526649b91a252a6:Su,__wbg_length_27a2afe8ab42b09f:Cu,__wbg_set_17499e8aa4003ebd:Ou,__wbg_apply_5435e78b95a524a6:Mu,__wbg_deleteProperty_31090878b92a7c0e:Au,__wbg_get_baf4855f9a986186:Tu,__wbg_ownKeys_9efe69be404540aa:Nu,__wbg_set_6aa458a4ebdb65cb:Eu,__wbindgen_is_function:Du,__wbg_buffer_cf65c07de34b9a08:Ru,__wbindgen_debug_string:Iu,__wbindgen_throw:zu,__wbindgen_memory:ju}},eg),wg=F.memory,vg=F.__wbg_syncstate_free,kg=F.syncstate_sharedHeads,xg=F.syncstate_lastSentHeads,Sg=F.syncstate_set_lastSentHeads,Cg=F.syncstate_set_sentHashes,Og=F.syncstate_clone,Mg=F.__wbg_automerge_free,Ag=F.automerge_new,Tg=F.automerge_clone,Ng=F.automerge_fork,Eg=F.automerge_pendingOps,Dg=F.automerge_commit,Rg=F.automerge_merge,Ig=F.automerge_rollback,zg=F.automerge_keys,jg=F.automerge_text,Pg=F.automerge_splice,Bg=F.automerge_push,$g=F.automerge_pushObject,Fg=F.automerge_insert,Vg=F.automerge_insertObject,Lg=F.automerge_put,Wg=F.automerge_putObject,qg=F.automerge_increment,Jg=F.automerge_get,Hg=F.automerge_getWithType,Kg=F.automerge_getAll,Ug=F.automerge_enableFreeze,Gg=F.automerge_enablePatches,Zg=F.automerge_registerDatatype,Yg=F.automerge_applyPatches,Qg=F.automerge_popPatches,Xg=F.automerge_length,t0=F.automerge_delete,e0=F.automerge_save,n0=F.automerge_saveIncremental,r0=F.automerge_loadIncremental,o0=F.automerge_applyChanges,i0=F.automerge_getChanges,s0=F.automerge_getChangeByHash,a0=F.automerge_getChangesAdded,l0=F.automerge_getHeads,c0=F.automerge_getActorId,u0=F.automerge_getLastLocalChange,h0=F.automerge_dump,f0=F.automerge_getMissingDeps,d0=F.automerge_receiveSyncMessage,p0=F.automerge_generateSyncMessage,m0=F.automerge_toJS,g0=F.automerge_materialize,_0=F.automerge_emptyChange,y0=F.automerge_mark,b0=F.automerge_unmark,w0=F.automerge_marks,v0=F.create,k0=F.load,x0=F.encodeChange,S0=F.decodeChange,C0=F.initSyncState,O0=F.importSyncState,M0=F.exportSyncState,A0=F.encodeSyncMessage,T0=F.decodeSyncMessage,N0=F.encodeSyncState,E0=F.decodeSyncState,D0=F.__wbindgen_malloc,R0=F.__wbindgen_realloc,I0=F.__wbindgen_add_to_stack_pointer,z0=F.__wbindgen_free,j0=F.__wbindgen_exn_store,P0=Object.freeze(Object.defineProperty({__proto__:null,memory:wg,__wbg_syncstate_free:vg,syncstate_sharedHeads:kg,syncstate_lastSentHeads:xg,syncstate_set_lastSentHeads:Sg,syncstate_set_sentHashes:Cg,syncstate_clone:Og,__wbg_automerge_free:Mg,automerge_new:Ag,automerge_clone:Tg,automerge_fork:Ng,automerge_pendingOps:Eg,automerge_commit:Dg,automerge_merge:Rg,automerge_rollback:Ig,automerge_keys:zg,automerge_text:jg,automerge_splice:Pg,automerge_push:Bg,automerge_pushObject:$g,automerge_insert:Fg,automerge_insertObject:Vg,automerge_put:Lg,automerge_putObject:Wg,automerge_increment:qg,automerge_get:Jg,automerge_getWithType:Hg,automerge_getAll:Kg,automerge_enableFreeze:Ug,automerge_enablePatches:Gg,automerge_registerDatatype:Zg,automerge_applyPatches:Yg,automerge_popPatches:Qg,automerge_length:Xg,automerge_delete:t0,automerge_save:e0,automerge_saveIncremental:n0,automerge_loadIncremental:r0,automerge_applyChanges:o0,automerge_getChanges:i0,automerge_getChangeByHash:s0,automerge_getChangesAdded:a0,automerge_getHeads:l0,automerge_getActorId:c0,automerge_getLastLocalChange:u0,automerge_dump:h0,automerge_getMissingDeps:f0,automerge_receiveSyncMessage:d0,automerge_generateSyncMessage:p0,automerge_toJS:m0,automerge_materialize:g0,automerge_emptyChange:_0,automerge_mark:y0,automerge_unmark:b0,automerge_marks:w0,create:v0,load:k0,encodeChange:x0,decodeChange:S0,initSyncState:C0,importSyncState:O0,exportSyncState:M0,encodeSyncMessage:A0,decodeSyncMessage:T0,encodeSyncState:N0,decodeSyncState:E0,__wbindgen_malloc:D0,__wbindgen_realloc:R0,__wbindgen_add_to_stack_pointer:I0,__wbindgen_free:z0,__wbindgen_exn_store:j0},Symbol.toStringTag,{value:"Module"}));tc(P0);const B0=Object.freeze(Object.defineProperty({__proto__:null,__wbg_set_wasm:tc,create:ag,load:lg,encodeChange:cg,decodeChange:ug,initSyncState:hg,importSyncState:fg,exportSyncState:dg,encodeSyncMessage:pg,decodeSyncMessage:mg,encodeSyncState:gg,decodeSyncState:_g,TextRepresentation:bg,Automerge:Le,SyncState:Me,__wbindgen_json_serialize:oc,__wbindgen_is_undefined:ic,__wbindgen_number_get:sc,__wbindgen_boolean_get:ac,__wbindgen_is_null:lc,__wbindgen_number_new:cc,__wbindgen_string_new:uc,__wbindgen_string_get:hc,__wbindgen_is_string:fc,__wbindgen_object_clone_ref:dc,__wbg_error_f851667af71bcfc6:pc,__wbg_new_abda76e883ba8a5f:mc,__wbg_stack_658279fe44541cf6:gc,__wbindgen_object_drop_ref:_c,__wbindgen_error_new:yc,__wbindgen_jsval_loose_eq:bc,__wbindgen_is_object:wc,__wbindgen_bigint_from_i64:vc,__wbindgen_bigint_from_u64:kc,__wbg_set_20cbc34131e76824:xc,__wbg_String_91fba7ded13ba54c:Sc,__wbg_crypto_e1d53a1d73fb10b8:Cc,__wbg_msCrypto_6e7d3e1f92610cbb:Oc,__wbg_getRandomValues_805f1c3d65988a5a:Mc,__wbg_randomFillSync_6894564c2c334c42:Ac,__wbg_require_78a3dcfbdba9cbce:Tc,__wbg_process_038c26bf42b093f8:Nc,__wbg_versions_ab37218d2f0b24a8:Ec,__wbg_node_080f4b19d15bc1fe:Dc,__wbg_log_7bb108d119bafbc1:Rc,__wbg_log_d047cf0648d2678e:Ic,__wbg_new_b525de17f44a8943:zc,__wbg_get_27fe3dac1c4d0224:jc,__wbg_set_17224bc548dd1d7b:Pc,__wbg_from_67ca20fa722467e6:Bc,__wbg_isArray_39d28997bf6b96b4:$c,__wbg_length_e498fbc24f9c1d4f:Fc,__wbg_push_49c286f04dd3bf59:Vc,__wbg_unshift_06a94bcbcb492eb3:Lc,__wbg_instanceof_ArrayBuffer_a69f02ee4c4f5065:Wc,__wbg_new_15d3966e9981a196:qc,__wbg_newnoargs_2b8b6bd7753c76ba:Jc,__wbg_call_95d1ea488d03e4e8:Hc,__wbg_call_9495de66fdbe016b:Kc,__wbg_call_96878afb7a8201ca:Uc,__wbg_next_88560ec06a094dea:Gc,__wbg_next_b7d530c04fd8b217:Zc,__wbg_done_1ebec03bbd919843:Yc,__wbg_value_6ac8da5cc5b3efda:Qc,__wbg_instanceof_Date_e353425d719aa266:Xc,__wbg_getTime_7c59072d1651a3cf:tu,__wbg_new_f127e324c1313064:eu,__wbg_instanceof_Object_f5a826c4da0d4a94:nu,__wbg_assign_b0b6530984f36574:ru,__wbg_defineProperty_4926f24c724d5310:ou,__wbg_entries_4e1315b774245952:iu,__wbg_freeze_4dcdbf0b5d9b50f4:su,__wbg_keys_60443f4f867207f9:au,__wbg_new_f9876326328f45ed:lu,__wbg_values_7444c4c2ccefdc9b:cu,__wbg_length_ea0846e494e3b16e:uu,__wbg_concat_040af6c9ba38dd98:hu,__wbg_slice_47202b1d012cdc55:fu,__wbg_iterator_55f114446221aa5a:du,__wbg_for_9a885d0d6d415e40:pu,__wbg_toString_7a3e0cd68ea2a337:mu,__wbg_globalThis_87cbb8506fecf3a9:gu,__wbg_self_e7c1f827057f6584:_u,__wbg_window_a09ec664e14b1b81:yu,__wbg_global_c85a9259e621f3db:bu,__wbg_instanceof_Uint8Array_01cebe79ca606cca:wu,__wbg_new_537b7341ce90bb31:vu,__wbg_newwithlength_b56c882b57805732:ku,__wbg_newwithbyteoffsetandlength_9fb2f11355ecadf5:xu,__wbg_subarray_7526649b91a252a6:Su,__wbg_length_27a2afe8ab42b09f:Cu,__wbg_set_17499e8aa4003ebd:Ou,__wbg_apply_5435e78b95a524a6:Mu,__wbg_deleteProperty_31090878b92a7c0e:Au,__wbg_get_baf4855f9a986186:Tu,__wbg_ownKeys_9efe69be404540aa:Nu,__wbg_set_6aa458a4ebdb65cb:Eu,__wbindgen_is_function:Du,__wbg_buffer_cf65c07de34b9a08:Ru,__wbindgen_debug_string:Iu,__wbindgen_throw:zu,__wbindgen_memory:ju},Symbol.toStringTag,{value:"Module"}));var $0=globalThis&&globalThis.__rest||function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(e[r[i]]=n[r[i]]);return e};function F0(n){tg(n)}F0(B0);function Pu(n){return typeof n=="object"?n:{actor:n}}function V0(n){const t=Pu(n),e=!!t.freeze,r=t.patchCallback,i=Xl.create(t.enableTextV2||!1,t.actor);i.enablePatches(!0),i.enableFreeze(!!t.freeze),i.registerDatatype("counter",l=>new xs(l));const a=t.enableTextV2||!1;return a?i.registerDatatype("str",l=>new Zl(l)):i.registerDatatype("text",l=>new On(l)),i.materialize("/",void 0,{handle:i,heads:void 0,freeze:e,patchCallback:r,textV2:a})}function L0(n,t){const e=Mn(n),r=e.heads,i=Pu(t),a=e.handle.fork(i.actor,r),l=$0(e,["heads"]);return a.applyPatches(n,Object.assign(Object.assign({},l),{handle:a}))}function W0(n,t){return As(V0(t),e=>Object.assign(e,n))}function As(n,t,e){if(typeof t=="function")return $u(n,{},t);if(typeof e=="function")return typeof t=="string"&&(t={message:t}),$u(n,t,e);throw RangeError("Invalid args for change")}function Bu(n,t,e){if(t==null)return n;const r=Mn(n),i=Object.assign(Object.assign({},r),{heads:void 0}),a=r.handle.applyPatches(n,i,e);return r.heads=t,a}function $u(n,t,e){if(typeof e!="function")throw new RangeError("invalid change function");const r=Mn(n);if(n===void 0||r===void 0)throw new RangeError("must be the document root");if(r.heads)throw new RangeError("Attempting to change an outdated document.  Use Automerge.clone() if you wish to make a writable copy.");if(Zo(n))throw new RangeError("Calls to Automerge.change cannot be nested");const i=r.handle.getHeads();try{r.heads=i;const a=Qm(r.handle,r.textV2);return e(a),r.handle.pendingOps()===0?(r.heads=void 0,n):(r.handle.commit(t.message,t.time),Bu(n,i,t.patchCallback||r.patchCallback))}catch(a){throw r.heads=void 0,r.handle.rollback(),a}}function q0(n,t){return Mn(t).handle.getChanges(H0(n))}function J0(n,t,e){const r=Mn(n);if(e||(e={}),r.heads)throw new RangeError("Attempting to change an outdated document.  Use Automerge.clone() if you wish to make a writable copy.");if(Zo(n))throw new RangeError("Calls to Automerge.change cannot be nested");const i=r.handle.getHeads();return r.handle.applyChanges(t),r.heads=i,[Bu(n,i,e.patchCallback||r.patchCallback)]}function H0(n){const t=Mn(n);return t.heads||t.handle.getHeads()}function K0(n,t){const e=Fu(t);return e.enableTextV2=!0,L0(n,e)}function U0(n,t){const e=Fu(t);return e.enableTextV2=!0,W0(n,e)}function Fu(n){return typeof n=="object"?n:{actor:n}}function ei(n,t,e,r,i){if(!Zo(n))throw new RangeError("object cannot be modified outside of a change block");const a=Mn(n,!1),l=Cs(n);if(!l)throw new RangeError("invalid object for mark");const c=`${l}/${t}`;try{return a.handle.mark(c,r,e,i)}catch(h){throw new RangeError(`Cannot mark: ${h}`)}}function Vu(n,t,e,r,i){if(!Zo(n))throw new RangeError("object cannot be modified outside of a change block");const a=Mn(n,!1),l=Cs(n);if(!l)throw new RangeError("invalid object for unmark");const c=`${l}/${t}`;try{return a.handle.unmark(c,e,r,i)}catch(h){throw new RangeError(`Cannot unmark: ${h}`)}}function Dt(n){this.content=n}Dt.prototype={constructor:Dt,find:function(n){for(var t=0;t<this.content.length;t+=2)if(this.content[t]===n)return t;return-1},get:function(n){var t=this.find(n);return t==-1?void 0:this.content[t+1]},update:function(n,t,e){var r=e&&e!=n?this.remove(e):this,i=r.find(n),a=r.content.slice();return i==-1?a.push(e||n,t):(a[i+1]=t,e&&(a[i]=e)),new Dt(a)},remove:function(n){var t=this.find(n);if(t==-1)return this;var e=this.content.slice();return e.splice(t,2),new Dt(e)},addToStart:function(n,t){return new Dt([n,t].concat(this.remove(n).content))},addToEnd:function(n,t){var e=this.remove(n).content.slice();return e.push(n,t),new Dt(e)},addBefore:function(n,t,e){var r=this.remove(t),i=r.content.slice(),a=r.find(n);return i.splice(a==-1?i.length:a,0,t,e),new Dt(i)},forEach:function(n){for(var t=0;t<this.content.length;t+=2)n(this.content[t],this.content[t+1])},prepend:function(n){return n=Dt.from(n),n.size?new Dt(n.content.concat(this.subtract(n).content)):this},append:function(n){return n=Dt.from(n),n.size?new Dt(this.subtract(n).content.concat(n.content)):this},subtract:function(n){var t=this;n=Dt.from(n);for(var e=0;e<n.content.length;e+=2)t=t.remove(n.content[e]);return t},toObject:function(){var n={};return this.forEach(function(t,e){n[t]=e}),n},get size(){return this.content.length>>1}},Dt.from=function(n){if(n instanceof Dt)return n;var t=[];if(n)for(var e in n)t.push(e,n[e]);return new Dt(t)};function Lu(n,t,e){for(let r=0;;r++){if(r==n.childCount||r==t.childCount)return n.childCount==t.childCount?null:e;let i=n.child(r),a=t.child(r);if(i==a){e+=i.nodeSize;continue}if(!i.sameMarkup(a))return e;if(i.isText&&i.text!=a.text){for(let l=0;i.text[l]==a.text[l];l++)e++;return e}if(i.content.size||a.content.size){let l=Lu(i.content,a.content,e+1);if(l!=null)return l}e+=i.nodeSize}}function Wu(n,t,e,r){for(let i=n.childCount,a=t.childCount;;){if(i==0||a==0)return i==a?null:{a:e,b:r};let l=n.child(--i),c=t.child(--a),h=l.nodeSize;if(l==c){e-=h,r-=h;continue}if(!l.sameMarkup(c))return{a:e,b:r};if(l.isText&&l.text!=c.text){let d=0,m=Math.min(l.text.length,c.text.length);for(;d<m&&l.text[l.text.length-d-1]==c.text[c.text.length-d-1];)d++,e--,r--;return{a:e,b:r}}if(l.content.size||c.content.size){let d=Wu(l.content,c.content,e-1,r-1);if(d)return d}e-=h,r-=h}}class B{constructor(t,e){if(this.content=t,this.size=e||0,e==null)for(let r=0;r<t.length;r++)this.size+=t[r].nodeSize}nodesBetween(t,e,r,i=0,a){for(let l=0,c=0;c<e;l++){let h=this.content[l],d=c+h.nodeSize;if(d>t&&r(h,i+c,a||null,l)!==!1&&h.content.size){let m=c+1;h.nodesBetween(Math.max(0,t-m),Math.min(h.content.size,e-m),r,i+m)}c=d}}descendants(t){this.nodesBetween(0,this.size,t)}textBetween(t,e,r,i){let a="",l=!0;return this.nodesBetween(t,e,(c,h)=>{c.isText?(a+=c.text.slice(Math.max(t,h)-h,e-h),l=!r):c.isLeaf?(i?a+=typeof i=="function"?i(c):i:c.type.spec.leafText&&(a+=c.type.spec.leafText(c)),l=!r):!l&&c.isBlock&&(a+=r,l=!0)},0),a}append(t){if(!t.size)return this;if(!this.size)return t;let e=this.lastChild,r=t.firstChild,i=this.content.slice(),a=0;for(e.isText&&e.sameMarkup(r)&&(i[i.length-1]=e.withText(e.text+r.text),a=1);a<t.content.length;a++)i.push(t.content[a]);return new B(i,this.size+t.size)}cut(t,e=this.size){if(t==0&&e==this.size)return this;let r=[],i=0;if(e>t)for(let a=0,l=0;l<e;a++){let c=this.content[a],h=l+c.nodeSize;h>t&&((l<t||h>e)&&(c.isText?c=c.cut(Math.max(0,t-l),Math.min(c.text.length,e-l)):c=c.cut(Math.max(0,t-l-1),Math.min(c.content.size,e-l-1))),r.push(c),i+=c.nodeSize),l=h}return new B(r,i)}cutByIndex(t,e){return t==e?B.empty:t==0&&e==this.content.length?this:new B(this.content.slice(t,e))}replaceChild(t,e){let r=this.content[t];if(r==e)return this;let i=this.content.slice(),a=this.size+e.nodeSize-r.nodeSize;return i[t]=e,new B(i,a)}addToStart(t){return new B([t].concat(this.content),this.size+t.nodeSize)}addToEnd(t){return new B(this.content.concat(t),this.size+t.nodeSize)}eq(t){if(this.content.length!=t.content.length)return!1;for(let e=0;e<this.content.length;e++)if(!this.content[e].eq(t.content[e]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(t){let e=this.content[t];if(!e)throw new RangeError("Index "+t+" out of range for "+this);return e}maybeChild(t){return this.content[t]||null}forEach(t){for(let e=0,r=0;e<this.content.length;e++){let i=this.content[e];t(i,r,e),r+=i.nodeSize}}findDiffStart(t,e=0){return Lu(this,t,e)}findDiffEnd(t,e=this.size,r=t.size){return Wu(this,t,e,r)}findIndex(t,e=-1){if(t==0)return ni(0,t);if(t==this.size)return ni(this.content.length,t);if(t>this.size||t<0)throw new RangeError(`Position ${t} outside of fragment (${this})`);for(let r=0,i=0;;r++){let a=this.child(r),l=i+a.nodeSize;if(l>=t)return l==t||e>0?ni(r+1,l):ni(r,i);i=l}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(t=>t.toJSON()):null}static fromJSON(t,e){if(!e)return B.empty;if(!Array.isArray(e))throw new RangeError("Invalid input for Fragment.fromJSON");return new B(e.map(t.nodeFromJSON))}static fromArray(t){if(!t.length)return B.empty;let e,r=0;for(let i=0;i<t.length;i++){let a=t[i];r+=a.nodeSize,i&&a.isText&&t[i-1].sameMarkup(a)?(e||(e=t.slice(0,i)),e[e.length-1]=a.withText(e[e.length-1].text+a.text)):e&&e.push(a)}return new B(e||t,r)}static from(t){if(!t)return B.empty;if(t instanceof B)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new B([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}B.empty=new B([],0);const Ts={index:0,offset:0};function ni(n,t){return Ts.index=n,Ts.offset=t,Ts}function ri(n,t){if(n===t)return!0;if(!(n&&typeof n=="object")||!(t&&typeof t=="object"))return!1;let e=Array.isArray(n);if(Array.isArray(t)!=e)return!1;if(e){if(n.length!=t.length)return!1;for(let r=0;r<n.length;r++)if(!ri(n[r],t[r]))return!1}else{for(let r in n)if(!(r in t)||!ri(n[r],t[r]))return!1;for(let r in t)if(!(r in n))return!1}return!0}class ct{constructor(t,e){this.type=t,this.attrs=e}addToSet(t){let e,r=!1;for(let i=0;i<t.length;i++){let a=t[i];if(this.eq(a))return t;if(this.type.excludes(a.type))e||(e=t.slice(0,i));else{if(a.type.excludes(this.type))return t;!r&&a.type.rank>this.type.rank&&(e||(e=t.slice(0,i)),e.push(this),r=!0),e&&e.push(a)}}return e||(e=t.slice()),r||e.push(this),e}removeFromSet(t){for(let e=0;e<t.length;e++)if(this.eq(t[e]))return t.slice(0,e).concat(t.slice(e+1));return t}isInSet(t){for(let e=0;e<t.length;e++)if(this.eq(t[e]))return!0;return!1}eq(t){return this==t||this.type==t.type&&ri(this.attrs,t.attrs)}toJSON(){let t={type:this.type.name};for(let e in this.attrs){t.attrs=this.attrs;break}return t}static fromJSON(t,e){if(!e)throw new RangeError("Invalid input for Mark.fromJSON");let r=t.marks[e.type];if(!r)throw new RangeError(`There is no mark type ${e.type} in this schema`);return r.create(e.attrs)}static sameSet(t,e){if(t==e)return!0;if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!t[r].eq(e[r]))return!1;return!0}static setFrom(t){if(!t||Array.isArray(t)&&t.length==0)return ct.none;if(t instanceof ct)return[t];let e=t.slice();return e.sort((r,i)=>r.type.rank-i.type.rank),e}}ct.none=[];class oi extends Error{}class q{constructor(t,e,r){this.content=t,this.openStart=e,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(t,e){let r=Ju(this.content,t+this.openStart,e);return r&&new q(r,this.openStart,this.openEnd)}removeBetween(t,e){return new q(qu(this.content,t+this.openStart,e+this.openStart),this.openStart,this.openEnd)}eq(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t}static fromJSON(t,e){if(!e)return q.empty;let r=e.openStart||0,i=e.openEnd||0;if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new q(B.fromJSON(t,e.content),r,i)}static maxOpen(t,e=!0){let r=0,i=0;for(let a=t.firstChild;a&&!a.isLeaf&&(e||!a.type.spec.isolating);a=a.firstChild)r++;for(let a=t.lastChild;a&&!a.isLeaf&&(e||!a.type.spec.isolating);a=a.lastChild)i++;return new q(t,r,i)}}q.empty=new q(B.empty,0,0);function qu(n,t,e){let{index:r,offset:i}=n.findIndex(t),a=n.maybeChild(r),{index:l,offset:c}=n.findIndex(e);if(i==t||a.isText){if(c!=e&&!n.child(l).isText)throw new RangeError("Removing non-flat range");return n.cut(0,t).append(n.cut(e))}if(r!=l)throw new RangeError("Removing non-flat range");return n.replaceChild(r,a.copy(qu(a.content,t-i-1,e-i-1)))}function Ju(n,t,e,r){let{index:i,offset:a}=n.findIndex(t),l=n.maybeChild(i);if(a==t||l.isText)return r&&!r.canReplace(i,i,e)?null:n.cut(0,t).append(e).append(n.cut(t));let c=Ju(l.content,t-a-1,e);return c&&n.replaceChild(i,l.copy(c))}function G0(n,t,e){if(e.openStart>n.depth)throw new oi("Inserted content deeper than insertion position");if(n.depth-e.openStart!=t.depth-e.openEnd)throw new oi("Inconsistent open depths");return Hu(n,t,e,0)}function Hu(n,t,e,r){let i=n.index(r),a=n.node(r);if(i==t.index(r)&&r<n.depth-e.openStart){let l=Hu(n,t,e,r+1);return a.copy(a.content.replaceChild(i,l))}else if(e.content.size)if(!e.openStart&&!e.openEnd&&n.depth==r&&t.depth==r){let l=n.parent,c=l.content;return Qn(l,c.cut(0,n.parentOffset).append(e.content).append(c.cut(t.parentOffset)))}else{let{start:l,end:c}=Z0(e,n);return Qn(a,Uu(n,l,c,t,r))}else return Qn(a,ii(n,t,r))}function Ku(n,t){if(!t.type.compatibleContent(n.type))throw new oi("Cannot join "+t.type.name+" onto "+n.type.name)}function Ns(n,t,e){let r=n.node(e);return Ku(r,t.node(e)),r}function Yn(n,t){let e=t.length-1;e>=0&&n.isText&&n.sameMarkup(t[e])?t[e]=n.withText(t[e].text+n.text):t.push(n)}function io(n,t,e,r){let i=(t||n).node(e),a=0,l=t?t.index(e):i.childCount;n&&(a=n.index(e),n.depth>e?a++:n.textOffset&&(Yn(n.nodeAfter,r),a++));for(let c=a;c<l;c++)Yn(i.child(c),r);t&&t.depth==e&&t.textOffset&&Yn(t.nodeBefore,r)}function Qn(n,t){return n.type.checkContent(t),n.copy(t)}function Uu(n,t,e,r,i){let a=n.depth>i&&Ns(n,t,i+1),l=r.depth>i&&Ns(e,r,i+1),c=[];return io(null,n,i,c),a&&l&&t.index(i)==e.index(i)?(Ku(a,l),Yn(Qn(a,Uu(n,t,e,r,i+1)),c)):(a&&Yn(Qn(a,ii(n,t,i+1)),c),io(t,e,i,c),l&&Yn(Qn(l,ii(e,r,i+1)),c)),io(r,null,i,c),new B(c)}function ii(n,t,e){let r=[];if(io(null,n,e,r),n.depth>e){let i=Ns(n,t,e+1);Yn(Qn(i,ii(n,t,e+1)),r)}return io(t,null,e,r),new B(r)}function Z0(n,t){let e=t.depth-n.openStart,r=t.node(e).copy(n.content);for(let i=e-1;i>=0;i--)r=t.node(i).copy(B.from(r));return{start:r.resolveNoCache(n.openStart+e),end:r.resolveNoCache(r.content.size-n.openEnd-e)}}class so{constructor(t,e,r){this.pos=t,this.path=e,this.parentOffset=r,this.depth=e.length/3-1}resolveDepth(t){return t==null?this.depth:t<0?this.depth+t:t}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(t){return this.path[this.resolveDepth(t)*3]}index(t){return this.path[this.resolveDepth(t)*3+1]}indexAfter(t){return t=this.resolveDepth(t),this.index(t)+(t==this.depth&&!this.textOffset?0:1)}start(t){return t=this.resolveDepth(t),t==0?0:this.path[t*3-1]+1}end(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size}before(t){if(t=this.resolveDepth(t),!t)throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[t*3-1]}after(t){if(t=this.resolveDepth(t),!t)throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[t*3-1]+this.path[t*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let t=this.parent,e=this.index(this.depth);if(e==t.childCount)return null;let r=this.pos-this.path[this.path.length-1],i=t.child(e);return r?t.child(e).cut(r):i}get nodeBefore(){let t=this.index(this.depth),e=this.pos-this.path[this.path.length-1];return e?this.parent.child(t).cut(0,e):t==0?null:this.parent.child(t-1)}posAtIndex(t,e){e=this.resolveDepth(e);let r=this.path[e*3],i=e==0?0:this.path[e*3-1]+1;for(let a=0;a<t;a++)i+=r.child(a).nodeSize;return i}marks(){let t=this.parent,e=this.index();if(t.content.size==0)return ct.none;if(this.textOffset)return t.child(e).marks;let r=t.maybeChild(e-1),i=t.maybeChild(e);if(!r){let c=r;r=i,i=c}let a=r.marks;for(var l=0;l<a.length;l++)a[l].type.spec.inclusive===!1&&(!i||!a[l].isInSet(i.marks))&&(a=a[l--].removeFromSet(a));return a}marksAcross(t){let e=this.parent.maybeChild(this.index());if(!e||!e.isInline)return null;let r=e.marks,i=t.parent.maybeChild(t.index());for(var a=0;a<r.length;a++)r[a].type.spec.inclusive===!1&&(!i||!r[a].isInSet(i.marks))&&(r=r[a--].removeFromSet(r));return r}sharedDepth(t){for(let e=this.depth;e>0;e--)if(this.start(e)<=t&&this.end(e)>=t)return e;return 0}blockRange(t=this,e){if(t.pos<this.pos)return t.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);r>=0;r--)if(t.pos<=this.end(r)&&(!e||e(this.node(r))))return new Q0(this,t,r);return null}sameParent(t){return this.pos-this.parentOffset==t.pos-t.parentOffset}max(t){return t.pos>this.pos?t:this}min(t){return t.pos<this.pos?t:this}toString(){let t="";for(let e=1;e<=this.depth;e++)t+=(t?"/":"")+this.node(e).type.name+"_"+this.index(e-1);return t+":"+this.parentOffset}static resolve(t,e){if(!(e>=0&&e<=t.content.size))throw new RangeError("Position "+e+" out of range");let r=[],i=0,a=e;for(let l=t;;){let{index:c,offset:h}=l.content.findIndex(a),d=a-h;if(r.push(l,c,i+h),!d||(l=l.child(c),l.isText))break;a=d-1,i+=h+1}return new so(e,r,a)}static resolveCached(t,e){for(let i=0;i<Es.length;i++){let a=Es[i];if(a.pos==e&&a.doc==t)return a}let r=Es[Ds]=so.resolve(t,e);return Ds=(Ds+1)%Y0,r}}let Es=[],Ds=0,Y0=12;class Q0{constructor(t,e,r){this.$from=t,this.$to=e,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const X0=Object.create(null);class We{constructor(t,e,r,i=ct.none){this.type=t,this.attrs=e,this.marks=i,this.content=r||B.empty}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(t){return this.content.child(t)}maybeChild(t){return this.content.maybeChild(t)}forEach(t){this.content.forEach(t)}nodesBetween(t,e,r,i=0){this.content.nodesBetween(t,e,r,i,this)}descendants(t){this.nodesBetween(0,this.content.size,t)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(t,e,r,i){return this.content.textBetween(t,e,r,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)}sameMarkup(t){return this.hasMarkup(t.type,t.attrs,t.marks)}hasMarkup(t,e,r){return this.type==t&&ri(this.attrs,e||t.defaultAttrs||X0)&&ct.sameSet(this.marks,r||ct.none)}copy(t=null){return t==this.content?this:new We(this.type,this.attrs,t,this.marks)}mark(t){return t==this.marks?this:new We(this.type,this.attrs,this.content,t)}cut(t,e=this.content.size){return t==0&&e==this.content.size?this:this.copy(this.content.cut(t,e))}slice(t,e=this.content.size,r=!1){if(t==e)return q.empty;let i=this.resolve(t),a=this.resolve(e),l=r?0:i.sharedDepth(e),c=i.start(l),h=i.node(l).content.cut(i.pos-c,a.pos-c);return new q(h,i.depth-l,a.depth-l)}replace(t,e,r){return G0(this.resolve(t),this.resolve(e),r)}nodeAt(t){for(let e=this;;){let{index:r,offset:i}=e.content.findIndex(t);if(e=e.maybeChild(r),!e)return null;if(i==t||e.isText)return e;t-=i+1}}childAfter(t){let{index:e,offset:r}=this.content.findIndex(t);return{node:this.content.maybeChild(e),index:e,offset:r}}childBefore(t){if(t==0)return{node:null,index:0,offset:0};let{index:e,offset:r}=this.content.findIndex(t);if(r<t)return{node:this.content.child(e),index:e,offset:r};let i=this.content.child(e-1);return{node:i,index:e-1,offset:r-i.nodeSize}}resolve(t){return so.resolveCached(this,t)}resolveNoCache(t){return so.resolve(this,t)}rangeHasMark(t,e,r){let i=!1;return e>t&&this.nodesBetween(t,e,a=>(r.isInSet(a.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),Gu(this.marks,t)}contentMatchAt(t){let e=this.type.contentMatch.matchFragment(this.content,0,t);if(!e)throw new Error("Called contentMatchAt on a node with invalid content");return e}canReplace(t,e,r=B.empty,i=0,a=r.childCount){let l=this.contentMatchAt(t).matchFragment(r,i,a),c=l&&l.matchFragment(this.content,e);if(!c||!c.validEnd)return!1;for(let h=i;h<a;h++)if(!this.type.allowsMarks(r.child(h).marks))return!1;return!0}canReplaceWith(t,e,r,i){if(i&&!this.type.allowsMarks(i))return!1;let a=this.contentMatchAt(t).matchType(r),l=a&&a.matchFragment(this.content,e);return l?l.validEnd:!1}canAppend(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)}check(){this.type.checkContent(this.content);let t=ct.none;for(let e=0;e<this.marks.length;e++)t=this.marks[e].addToSet(t);if(!ct.sameSet(t,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(e=>e.type.name)}`);this.content.forEach(e=>e.check())}toJSON(){let t={type:this.type.name};for(let e in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map(e=>e.toJSON())),t}static fromJSON(t,e){if(!e)throw new RangeError("Invalid input for Node.fromJSON");let r=null;if(e.marks){if(!Array.isArray(e.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=e.marks.map(t.markFromJSON)}if(e.type=="text"){if(typeof e.text!="string")throw new RangeError("Invalid text node in JSON");return t.text(e.text,r)}let i=B.fromJSON(t,e.content);return t.nodeType(e.type).create(e.attrs,i,r)}}We.prototype.text=void 0;class si extends We{constructor(t,e,r,i){if(super(t,e,null,i),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):Gu(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(t,e){return this.text.slice(t,e)}get nodeSize(){return this.text.length}mark(t){return t==this.marks?this:new si(this.type,this.attrs,this.text,t)}withText(t){return t==this.text?this:new si(this.type,this.attrs,t,this.marks)}cut(t=0,e=this.text.length){return t==0&&e==this.text.length?this:this.withText(this.text.slice(t,e))}eq(t){return this.sameMarkup(t)&&this.text==t.text}toJSON(){let t=super.toJSON();return t.text=this.text,t}}function Gu(n,t){for(let e=n.length-1;e>=0;e--)t=n[e].type.name+"("+t+")";return t}class Xn{constructor(t){this.validEnd=t,this.next=[],this.wrapCache=[]}static parse(t,e){let r=new t_(t,e);if(r.next==null)return Xn.empty;let i=Zu(r);r.next&&r.err("Unexpected trailing text");let a=a_(s_(i));return l_(a,r),a}matchType(t){for(let e=0;e<this.next.length;e++)if(this.next[e].type==t)return this.next[e].next;return null}matchFragment(t,e=0,r=t.childCount){let i=this;for(let a=e;i&&a<r;a++)i=i.matchType(t.child(a).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let t=0;t<this.next.length;t++){let{type:e}=this.next[t];if(!(e.isText||e.hasRequiredAttrs()))return e}return null}compatible(t){for(let e=0;e<this.next.length;e++)for(let r=0;r<t.next.length;r++)if(this.next[e].type==t.next[r].type)return!0;return!1}fillBefore(t,e=!1,r=0){let i=[this];function a(l,c){let h=l.matchFragment(t,r);if(h&&(!e||h.validEnd))return B.from(c.map(d=>d.createAndFill()));for(let d=0;d<l.next.length;d++){let{type:m,next:y}=l.next[d];if(!(m.isText||m.hasRequiredAttrs())&&i.indexOf(y)==-1){i.push(y);let v=a(y,c.concat(m));if(v)return v}}return null}return a(this,[])}findWrapping(t){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==t)return this.wrapCache[r+1];let e=this.computeWrapping(t);return this.wrapCache.push(t,e),e}computeWrapping(t){let e=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let i=r.shift(),a=i.match;if(a.matchType(t)){let l=[];for(let c=i;c.type;c=c.via)l.push(c.type);return l.reverse()}for(let l=0;l<a.next.length;l++){let{type:c,next:h}=a.next[l];!c.isLeaf&&!c.hasRequiredAttrs()&&!(c.name in e)&&(!i.type||h.validEnd)&&(r.push({match:c.contentMatch,type:c,via:i}),e[c.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(t){if(t>=this.next.length)throw new RangeError(`There's no ${t}th edge in this content match`);return this.next[t]}toString(){let t=[];function e(r){t.push(r);for(let i=0;i<r.next.length;i++)t.indexOf(r.next[i].next)==-1&&e(r.next[i].next)}return e(this),t.map((r,i)=>{let a=i+(r.validEnd?"*":" ")+" ";for(let l=0;l<r.next.length;l++)a+=(l?", ":"")+r.next[l].type.name+"->"+t.indexOf(r.next[l].next);return a}).join(`
`)}}Xn.empty=new Xn(!0);class t_{constructor(t,e){this.string=t,this.nodeTypes=e,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(t){return this.next==t&&(this.pos++||!0)}err(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")}}function Zu(n){let t=[];do t.push(e_(n));while(n.eat("|"));return t.length==1?t[0]:{type:"choice",exprs:t}}function e_(n){let t=[];do t.push(n_(n));while(n.next&&n.next!=")"&&n.next!="|");return t.length==1?t[0]:{type:"seq",exprs:t}}function n_(n){let t=i_(n);for(;;)if(n.eat("+"))t={type:"plus",expr:t};else if(n.eat("*"))t={type:"star",expr:t};else if(n.eat("?"))t={type:"opt",expr:t};else if(n.eat("{"))t=r_(n,t);else break;return t}function Yu(n){/\D/.test(n.next)&&n.err("Expected number, got '"+n.next+"'");let t=Number(n.next);return n.pos++,t}function r_(n,t){let e=Yu(n),r=e;return n.eat(",")&&(n.next!="}"?r=Yu(n):r=-1),n.eat("}")||n.err("Unclosed braced range"),{type:"range",min:e,max:r,expr:t}}function o_(n,t){let e=n.nodeTypes,r=e[t];if(r)return[r];let i=[];for(let a in e){let l=e[a];l.groups.indexOf(t)>-1&&i.push(l)}return i.length==0&&n.err("No node type or group '"+t+"' found"),i}function i_(n){if(n.eat("(")){let t=Zu(n);return n.eat(")")||n.err("Missing closing paren"),t}else if(/\W/.test(n.next))n.err("Unexpected token '"+n.next+"'");else{let t=o_(n,n.next).map(e=>(n.inline==null?n.inline=e.isInline:n.inline!=e.isInline&&n.err("Mixing inline and block content"),{type:"name",value:e}));return n.pos++,t.length==1?t[0]:{type:"choice",exprs:t}}}function s_(n){let t=[[]];return i(a(n,0),e()),t;function e(){return t.push([])-1}function r(l,c,h){let d={term:h,to:c};return t[l].push(d),d}function i(l,c){l.forEach(h=>h.to=c)}function a(l,c){if(l.type=="choice")return l.exprs.reduce((h,d)=>h.concat(a(d,c)),[]);if(l.type=="seq")for(let h=0;;h++){let d=a(l.exprs[h],c);if(h==l.exprs.length-1)return d;i(d,c=e())}else if(l.type=="star"){let h=e();return r(c,h),i(a(l.expr,h),h),[r(h)]}else if(l.type=="plus"){let h=e();return i(a(l.expr,c),h),i(a(l.expr,h),h),[r(h)]}else{if(l.type=="opt")return[r(c)].concat(a(l.expr,c));if(l.type=="range"){let h=c;for(let d=0;d<l.min;d++){let m=e();i(a(l.expr,h),m),h=m}if(l.max==-1)i(a(l.expr,h),h);else for(let d=l.min;d<l.max;d++){let m=e();r(h,m),i(a(l.expr,h),m),h=m}return[r(h)]}else{if(l.type=="name")return[r(c,void 0,l.value)];throw new Error("Unknown expr type")}}}}function Qu(n,t){return t-n}function Xu(n,t){let e=[];return r(t),e.sort(Qu);function r(i){let a=n[i];if(a.length==1&&!a[0].term)return r(a[0].to);e.push(i);for(let l=0;l<a.length;l++){let{term:c,to:h}=a[l];!c&&e.indexOf(h)==-1&&r(h)}}}function a_(n){let t=Object.create(null);return e(Xu(n,0));function e(r){let i=[];r.forEach(l=>{n[l].forEach(({term:c,to:h})=>{if(!c)return;let d;for(let m=0;m<i.length;m++)i[m][0]==c&&(d=i[m][1]);Xu(n,h).forEach(m=>{d||i.push([c,d=[]]),d.indexOf(m)==-1&&d.push(m)})})});let a=t[r.join(",")]=new Xn(r.indexOf(n.length-1)>-1);for(let l=0;l<i.length;l++){let c=i[l][1].sort(Qu);a.next.push({type:i[l][0],next:t[c.join(",")]||e(c)})}return a}}function l_(n,t){for(let e=0,r=[n];e<r.length;e++){let i=r[e],a=!i.validEnd,l=[];for(let c=0;c<i.next.length;c++){let{type:h,next:d}=i.next[c];l.push(h.name),a&&!(h.isText||h.hasRequiredAttrs())&&(a=!1),r.indexOf(d)==-1&&r.push(d)}a&&t.err("Only non-generatable nodes ("+l.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function th(n){let t=Object.create(null);for(let e in n){let r=n[e];if(!r.hasDefault)return null;t[e]=r.default}return t}function eh(n,t){let e=Object.create(null);for(let r in n){let i=t&&t[r];if(i===void 0){let a=n[r];if(a.hasDefault)i=a.default;else throw new RangeError("No value supplied for attribute "+r)}e[r]=i}return e}function nh(n){let t=Object.create(null);if(n)for(let e in n)t[e]=new c_(n[e]);return t}class ai{constructor(t,e,r){this.name=t,this.schema=e,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=nh(r.attrs),this.defaultAttrs=th(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||t=="text"),this.isText=t=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Xn.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1}compatibleContent(t){return this==t||this.contentMatch.compatible(t.contentMatch)}computeAttrs(t){return!t&&this.defaultAttrs?this.defaultAttrs:eh(this.attrs,t)}create(t=null,e,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new We(this,this.computeAttrs(t),B.from(e),ct.setFrom(r))}createChecked(t=null,e,r){return e=B.from(e),this.checkContent(e),new We(this,this.computeAttrs(t),e,ct.setFrom(r))}createAndFill(t=null,e,r){if(t=this.computeAttrs(t),e=B.from(e),e.size){let l=this.contentMatch.fillBefore(e);if(!l)return null;e=l.append(e)}let i=this.contentMatch.matchFragment(e),a=i&&i.fillBefore(B.empty,!0);return a?new We(this,t,e.append(a),ct.setFrom(r)):null}validContent(t){let e=this.contentMatch.matchFragment(t);if(!e||!e.validEnd)return!1;for(let r=0;r<t.childCount;r++)if(!this.allowsMarks(t.child(r).marks))return!1;return!0}checkContent(t){if(!this.validContent(t))throw new RangeError(`Invalid content for node ${this.name}: ${t.toString().slice(0,50)}`)}allowsMarkType(t){return this.markSet==null||this.markSet.indexOf(t)>-1}allowsMarks(t){if(this.markSet==null)return!0;for(let e=0;e<t.length;e++)if(!this.allowsMarkType(t[e].type))return!1;return!0}allowedMarks(t){if(this.markSet==null)return t;let e;for(let r=0;r<t.length;r++)this.allowsMarkType(t[r].type)?e&&e.push(t[r]):e||(e=t.slice(0,r));return e?e.length?e:ct.none:t}static compile(t,e){let r=Object.create(null);t.forEach((a,l)=>r[a]=new ai(a,e,l));let i=e.spec.topNode||"doc";if(!r[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let a in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}}class c_{constructor(t){this.hasDefault=Object.prototype.hasOwnProperty.call(t,"default"),this.default=t.default}get isRequired(){return!this.hasDefault}}class li{constructor(t,e,r,i){this.name=t,this.rank=e,this.schema=r,this.spec=i,this.attrs=nh(i.attrs),this.excluded=null;let a=th(this.attrs);this.instance=a?new ct(this,a):null}create(t=null){return!t&&this.instance?this.instance:new ct(this,eh(this.attrs,t))}static compile(t,e){let r=Object.create(null),i=0;return t.forEach((a,l)=>r[a]=new li(a,i++,e,l)),r}removeFromSet(t){for(var e=0;e<t.length;e++)t[e].type==this&&(t=t.slice(0,e).concat(t.slice(e+1)),e--);return t}isInSet(t){for(let e=0;e<t.length;e++)if(t[e].type==this)return t[e]}excludes(t){return this.excluded.indexOf(t)>-1}}class u_{constructor(t){this.cached=Object.create(null);let e=this.spec={};for(let i in t)e[i]=t[i];e.nodes=Dt.from(t.nodes),e.marks=Dt.from(t.marks||{}),this.nodes=ai.compile(this.spec.nodes,this),this.marks=li.compile(this.spec.marks,this);let r=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let a=this.nodes[i],l=a.spec.content||"",c=a.spec.marks;a.contentMatch=r[l]||(r[l]=Xn.parse(l,this.nodes)),a.inlineContent=a.contentMatch.inlineContent,a.markSet=c=="_"?null:c?rh(this,c.split(" ")):c==""||!a.inlineContent?[]:null}for(let i in this.marks){let a=this.marks[i],l=a.spec.excludes;a.excluded=l==null?[a]:l==""?[]:rh(this,l.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(t,e=null,r,i){if(typeof t=="string")t=this.nodeType(t);else if(t instanceof ai){if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}else throw new RangeError("Invalid node type: "+t);return t.createChecked(e,r,i)}text(t,e){let r=this.nodes.text;return new si(r,r.defaultAttrs,t,ct.setFrom(e))}mark(t,e){return typeof t=="string"&&(t=this.marks[t]),t.create(e)}nodeFromJSON(t){return We.fromJSON(this,t)}markFromJSON(t){return ct.fromJSON(this,t)}nodeType(t){let e=this.nodes[t];if(!e)throw new RangeError("Unknown node type: "+t);return e}}function rh(n,t){let e=[];for(let r=0;r<t.length;r++){let i=t[r],a=n.marks[i],l=a;if(a)e.push(a);else for(let c in n.marks){let h=n.marks[c];(i=="_"||h.spec.group&&h.spec.group.split(" ").indexOf(i)>-1)&&e.push(l=h)}if(!l)throw new SyntaxError("Unknown mark type: '"+t[r]+"'")}return e}class ao{constructor(t,e){this.schema=t,this.rules=e,this.tags=[],this.styles=[],e.forEach(r=>{r.tag?this.tags.push(r):r.style&&this.styles.push(r)}),this.normalizeLists=!this.tags.some(r=>{if(!/^(ul|ol)\b/.test(r.tag)||!r.node)return!1;let i=t.nodes[r.node];return i.contentMatch.matchType(i)})}parse(t,e={}){let r=new ah(this,e,!1);return r.addAll(t,e.from,e.to),r.finish()}parseSlice(t,e={}){let r=new ah(this,e,!0);return r.addAll(t,e.from,e.to),q.maxOpen(r.finish())}matchTag(t,e,r){for(let i=r?this.tags.indexOf(r)+1:0;i<this.tags.length;i++){let a=this.tags[i];if(d_(t,a.tag)&&(a.namespace===void 0||t.namespaceURI==a.namespace)&&(!a.context||e.matchesContext(a.context))){if(a.getAttrs){let l=a.getAttrs(t);if(l===!1)continue;a.attrs=l||void 0}return a}}}matchStyle(t,e,r,i){for(let a=i?this.styles.indexOf(i)+1:0;a<this.styles.length;a++){let l=this.styles[a],c=l.style;if(!(c.indexOf(t)!=0||l.context&&!r.matchesContext(l.context)||c.length>t.length&&(c.charCodeAt(t.length)!=61||c.slice(t.length+1)!=e))){if(l.getAttrs){let h=l.getAttrs(e);if(h===!1)continue;l.attrs=h||void 0}return l}}}static schemaRules(t){let e=[];function r(i){let a=i.priority==null?50:i.priority,l=0;for(;l<e.length;l++){let c=e[l];if((c.priority==null?50:c.priority)<a)break}e.splice(l,0,i)}for(let i in t.marks){let a=t.marks[i].spec.parseDOM;a&&a.forEach(l=>{r(l=lh(l)),l.mark||l.ignore||l.clearMark||(l.mark=i)})}for(let i in t.nodes){let a=t.nodes[i].spec.parseDOM;a&&a.forEach(l=>{r(l=lh(l)),l.node||l.ignore||l.mark||(l.node=i)})}return e}static fromSchema(t){return t.cached.domParser||(t.cached.domParser=new ao(t,ao.schemaRules(t)))}}const oh={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},h_={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},ih={ol:!0,ul:!0},ci=1,ui=2,lo=4;function sh(n,t,e){return t!=null?(t?ci:0)|(t==="full"?ui:0):n&&n.whitespace=="pre"?ci|ui:e&~lo}class hi{constructor(t,e,r,i,a,l,c){this.type=t,this.attrs=e,this.marks=r,this.pendingMarks=i,this.solid=a,this.options=c,this.content=[],this.activeMarks=ct.none,this.stashMarks=[],this.match=l||(c&lo?null:t.contentMatch)}findWrapping(t){if(!this.match){if(!this.type)return[];let e=this.type.contentMatch.fillBefore(B.from(t));if(e)this.match=this.type.contentMatch.matchFragment(e);else{let r=this.type.contentMatch,i;return(i=r.findWrapping(t.type))?(this.match=r,i):null}}return this.match.findWrapping(t.type)}finish(t){if(!(this.options&ci)){let r=this.content[this.content.length-1],i;if(r&&r.isText&&(i=/[ \t\r\n\u000c]+$/.exec(r.text))){let a=r;r.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=a.withText(a.text.slice(0,a.text.length-i[0].length))}}let e=B.from(this.content);return!t&&this.match&&(e=e.append(this.match.fillBefore(B.empty,!0))),this.type?this.type.create(this.attrs,e,this.marks):e}popFromStashMark(t){for(let e=this.stashMarks.length-1;e>=0;e--)if(t.eq(this.stashMarks[e]))return this.stashMarks.splice(e,1)[0]}applyPending(t){for(let e=0,r=this.pendingMarks;e<r.length;e++){let i=r[e];(this.type?this.type.allowsMarkType(i.type):m_(i.type,t))&&!i.isInSet(this.activeMarks)&&(this.activeMarks=i.addToSet(this.activeMarks),this.pendingMarks=i.removeFromSet(this.pendingMarks))}}inlineContext(t){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:t.parentNode&&!oh.hasOwnProperty(t.parentNode.nodeName.toLowerCase())}}class ah{constructor(t,e,r){this.parser=t,this.options=e,this.isOpen=r,this.open=0;let i=e.topNode,a,l=sh(null,e.preserveWhitespace,0)|(r?lo:0);i?a=new hi(i.type,i.attrs,ct.none,ct.none,!0,e.topMatch||i.type.contentMatch,l):r?a=new hi(null,null,ct.none,ct.none,!0,null,l):a=new hi(t.schema.topNodeType,null,ct.none,ct.none,!0,null,l),this.nodes=[a],this.find=e.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(t){if(t.nodeType==3)this.addTextNode(t);else if(t.nodeType==1){let e=t.getAttribute("style");if(!e)this.addElement(t);else{let r=this.readStyles(p_(e));if(!r)return;let[i,a]=r,l=this.top;for(let c=0;c<a.length;c++)this.removePendingMark(a[c],l);for(let c=0;c<i.length;c++)this.addPendingMark(i[c]);this.addElement(t);for(let c=0;c<i.length;c++)this.removePendingMark(i[c],l);for(let c=0;c<a.length;c++)this.addPendingMark(a[c])}}}addTextNode(t){let e=t.nodeValue,r=this.top;if(r.options&ui||r.inlineContext(t)||/[^ \t\r\n\u000c]/.test(e)){if(r.options&ci)r.options&ui?e=e.replace(/\r\n?/g,`
`):e=e.replace(/\r?\n|\r/g," ");else if(e=e.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(e)&&this.open==this.nodes.length-1){let i=r.content[r.content.length-1],a=t.previousSibling;(!i||a&&a.nodeName=="BR"||i.isText&&/[ \t\r\n\u000c]$/.test(i.text))&&(e=e.slice(1))}e&&this.insertNode(this.parser.schema.text(e)),this.findInText(t)}else this.findInside(t)}addElement(t,e){let r=t.nodeName.toLowerCase(),i;ih.hasOwnProperty(r)&&this.parser.normalizeLists&&f_(t);let a=this.options.ruleFromNode&&this.options.ruleFromNode(t)||(i=this.parser.matchTag(t,this,e));if(a?a.ignore:h_.hasOwnProperty(r))this.findInside(t),this.ignoreFallback(t);else if(!a||a.skip||a.closeParent){a&&a.closeParent?this.open=Math.max(0,this.open-1):a&&a.skip.nodeType&&(t=a.skip);let l,c=this.top,h=this.needsBlock;if(oh.hasOwnProperty(r))c.content.length&&c.content[0].isInline&&this.open&&(this.open--,c=this.top),l=!0,c.type||(this.needsBlock=!0);else if(!t.firstChild){this.leafFallback(t);return}this.addAll(t),l&&this.sync(c),this.needsBlock=h}else this.addElementByRule(t,a,a.consuming===!1?i:void 0)}leafFallback(t){t.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode(`
`))}ignoreFallback(t){t.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"))}readStyles(t){let e=ct.none,r=ct.none;t:for(let i=0;i<t.length;i+=2)for(let a=void 0;;){let l=this.parser.matchStyle(t[i],t[i+1],this,a);if(!l)continue t;if(l.ignore)return null;if(l.clearMark?this.top.pendingMarks.forEach(c=>{l.clearMark(c)&&(r=c.addToSet(r))}):e=this.parser.schema.marks[l.mark].create(l.attrs).addToSet(e),l.consuming===!1)a=l;else break}return[e,r]}addElementByRule(t,e,r){let i,a,l;e.node?(a=this.parser.schema.nodes[e.node],a.isLeaf?this.insertNode(a.create(e.attrs))||this.leafFallback(t):i=this.enter(a,e.attrs||null,e.preserveWhitespace)):(l=this.parser.schema.marks[e.mark].create(e.attrs),this.addPendingMark(l));let c=this.top;if(a&&a.isLeaf)this.findInside(t);else if(r)this.addElement(t,r);else if(e.getContent)this.findInside(t),e.getContent(t,this.parser.schema).forEach(h=>this.insertNode(h));else{let h=t;typeof e.contentElement=="string"?h=t.querySelector(e.contentElement):typeof e.contentElement=="function"?h=e.contentElement(t):e.contentElement&&(h=e.contentElement),this.findAround(t,h,!0),this.addAll(h)}i&&this.sync(c)&&this.open--,l&&this.removePendingMark(l,c)}addAll(t,e,r){let i=e||0;for(let a=e?t.childNodes[e]:t.firstChild,l=r==null?null:t.childNodes[r];a!=l;a=a.nextSibling,++i)this.findAtPoint(t,i),this.addDOM(a);this.findAtPoint(t,i)}findPlace(t){let e,r;for(let i=this.open;i>=0;i--){let a=this.nodes[i],l=a.findWrapping(t);if(l&&(!e||e.length>l.length)&&(e=l,r=a,!l.length)||a.solid)break}if(!e)return!1;this.sync(r);for(let i=0;i<e.length;i++)this.enterInner(e[i],null,!1);return!0}insertNode(t){if(t.isInline&&this.needsBlock&&!this.top.type){let e=this.textblockFromContext();e&&this.enterInner(e)}if(this.findPlace(t)){this.closeExtra();let e=this.top;e.applyPending(t.type),e.match&&(e.match=e.match.matchType(t.type));let r=e.activeMarks;for(let i=0;i<t.marks.length;i++)(!e.type||e.type.allowsMarkType(t.marks[i].type))&&(r=t.marks[i].addToSet(r));return e.content.push(t.mark(r)),!0}return!1}enter(t,e,r){let i=this.findPlace(t.create(e));return i&&this.enterInner(t,e,!0,r),i}enterInner(t,e=null,r=!1,i){this.closeExtra();let a=this.top;a.applyPending(t),a.match=a.match&&a.match.matchType(t);let l=sh(t,i,a.options);a.options&lo&&a.content.length==0&&(l|=lo),this.nodes.push(new hi(t,e,a.activeMarks,a.pendingMarks,r,null,l)),this.open++}closeExtra(t=!1){let e=this.nodes.length-1;if(e>this.open){for(;e>this.open;e--)this.nodes[e-1].content.push(this.nodes[e].finish(t));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)}sync(t){for(let e=this.open;e>=0;e--)if(this.nodes[e]==t)return this.open=e,!0;return!1}get currentPos(){this.closeExtra();let t=0;for(let e=this.open;e>=0;e--){let r=this.nodes[e].content;for(let i=r.length-1;i>=0;i--)t+=r[i].nodeSize;e&&t++}return t}findAtPoint(t,e){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==t&&this.find[r].offset==e&&(this.find[r].pos=this.currentPos)}findInside(t){if(this.find)for(let e=0;e<this.find.length;e++)this.find[e].pos==null&&t.nodeType==1&&t.contains(this.find[e].node)&&(this.find[e].pos=this.currentPos)}findAround(t,e,r){if(t!=e&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&t.nodeType==1&&t.contains(this.find[i].node)&&e.compareDocumentPosition(this.find[i].node)&(r?2:4)&&(this.find[i].pos=this.currentPos)}findInText(t){if(this.find)for(let e=0;e<this.find.length;e++)this.find[e].node==t&&(this.find[e].pos=this.currentPos-(t.nodeValue.length-this.find[e].offset))}matchesContext(t){if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);let e=t.split("/"),r=this.options.context,i=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),a=-(r?r.depth+1:0)+(i?0:1),l=(c,h)=>{for(;c>=0;c--){let d=e[c];if(d==""){if(c==e.length-1||c==0)continue;for(;h>=a;h--)if(l(c-1,h))return!0;return!1}else{let m=h>0||h==0&&i?this.nodes[h].type:r&&h>=a?r.node(h-a).type:null;if(!m||m.name!=d&&m.groups.indexOf(d)==-1)return!1;h--}}return!0};return l(e.length-1,this.open)}textblockFromContext(){let t=this.options.context;if(t)for(let e=t.depth;e>=0;e--){let r=t.node(e).contentMatchAt(t.indexAfter(e)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let e in this.parser.schema.nodes){let r=this.parser.schema.nodes[e];if(r.isTextblock&&r.defaultAttrs)return r}}addPendingMark(t){let e=g_(t,this.top.pendingMarks);e&&this.top.stashMarks.push(e),this.top.pendingMarks=t.addToSet(this.top.pendingMarks)}removePendingMark(t,e){for(let r=this.open;r>=0;r--){let i=this.nodes[r];if(i.pendingMarks.lastIndexOf(t)>-1)i.pendingMarks=t.removeFromSet(i.pendingMarks);else{i.activeMarks=t.removeFromSet(i.activeMarks);let a=i.popFromStashMark(t);a&&i.type&&i.type.allowsMarkType(a.type)&&(i.activeMarks=a.addToSet(i.activeMarks))}if(i==e)break}}}function f_(n){for(let t=n.firstChild,e=null;t;t=t.nextSibling){let r=t.nodeType==1?t.nodeName.toLowerCase():null;r&&ih.hasOwnProperty(r)&&e?(e.appendChild(t),t=e):r=="li"?e=t:r&&(e=null)}}function d_(n,t){return(n.matches||n.msMatchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector).call(n,t)}function p_(n){let t=/\s*([\w-]+)\s*:\s*([^;]+)/g,e,r=[];for(;e=t.exec(n);)r.push(e[1],e[2].trim());return r}function lh(n){let t={};for(let e in n)t[e]=n[e];return t}function m_(n,t){let e=t.schema.nodes;for(let r in e){let i=e[r];if(!i.allowsMarkType(n))continue;let a=[],l=c=>{a.push(c);for(let h=0;h<c.edgeCount;h++){let{type:d,next:m}=c.edge(h);if(d==t||a.indexOf(m)<0&&l(m))return!0}};if(l(i.contentMatch))return!0}}function g_(n,t){for(let e=0;e<t.length;e++)if(n.eq(t[e]))return t[e]}class cn{constructor(t,e){this.nodes=t,this.marks=e}serializeFragment(t,e={},r){r||(r=Rs(e).createDocumentFragment());let i=r,a=[];return t.forEach(l=>{if(a.length||l.marks.length){let c=0,h=0;for(;c<a.length&&h<l.marks.length;){let d=l.marks[h];if(!this.marks[d.type.name]){h++;continue}if(!d.eq(a[c][0])||d.type.spec.spanning===!1)break;c++,h++}for(;c<a.length;)i=a.pop()[1];for(;h<l.marks.length;){let d=l.marks[h++],m=this.serializeMark(d,l.isInline,e);m&&(a.push([d,i]),i.appendChild(m.dom),i=m.contentDOM||m.dom)}}i.appendChild(this.serializeNodeInner(l,e))}),r}serializeNodeInner(t,e){let{dom:r,contentDOM:i}=cn.renderSpec(Rs(e),this.nodes[t.type.name](t));if(i){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(t.content,e,i)}return r}serializeNode(t,e={}){let r=this.serializeNodeInner(t,e);for(let i=t.marks.length-1;i>=0;i--){let a=this.serializeMark(t.marks[i],t.isInline,e);a&&((a.contentDOM||a.dom).appendChild(r),r=a.dom)}return r}serializeMark(t,e,r={}){let i=this.marks[t.type.name];return i&&cn.renderSpec(Rs(r),i(t,e))}static renderSpec(t,e,r=null){if(typeof e=="string")return{dom:t.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let i=e[0],a=i.indexOf(" ");a>0&&(r=i.slice(0,a),i=i.slice(a+1));let l,c=r?t.createElementNS(r,i):t.createElement(i),h=e[1],d=1;if(h&&typeof h=="object"&&h.nodeType==null&&!Array.isArray(h)){d=2;for(let m in h)if(h[m]!=null){let y=m.indexOf(" ");y>0?c.setAttributeNS(m.slice(0,y),m.slice(y+1),h[m]):c.setAttribute(m,h[m])}}for(let m=d;m<e.length;m++){let y=e[m];if(y===0){if(m<e.length-1||m>d)throw new RangeError("Content hole must be the only child of its parent node");return{dom:c,contentDOM:c}}else{let{dom:v,contentDOM:b}=cn.renderSpec(t,y,r);if(c.appendChild(v),b){if(l)throw new RangeError("Multiple content holes");l=b}}}return{dom:c,contentDOM:l}}static fromSchema(t){return t.cached.domSerializer||(t.cached.domSerializer=new cn(this.nodesFromSchema(t),this.marksFromSchema(t)))}static nodesFromSchema(t){let e=ch(t.nodes);return e.text||(e.text=r=>r.text),e}static marksFromSchema(t){return ch(t.marks)}}function ch(n){let t={};for(let e in n){let r=n[e].spec.toDOM;r&&(t[e]=r)}return t}function Rs(n){return n.document||window.document}const uh=65535,hh=Math.pow(2,16);function __(n,t){return n+t*hh}function fh(n){return n&uh}function y_(n){return(n-(n&uh))/hh}const dh=1,ph=2,fi=4,mh=8;class Is{constructor(t,e,r){this.pos=t,this.delInfo=e,this.recover=r}get deleted(){return(this.delInfo&mh)>0}get deletedBefore(){return(this.delInfo&(dh|fi))>0}get deletedAfter(){return(this.delInfo&(ph|fi))>0}get deletedAcross(){return(this.delInfo&fi)>0}}class ge{constructor(t,e=!1){if(this.ranges=t,this.inverted=e,!t.length&&ge.empty)return ge.empty}recover(t){let e=0,r=fh(t);if(!this.inverted)for(let i=0;i<r;i++)e+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+e+y_(t)}mapResult(t,e=1){return this._map(t,e,!1)}map(t,e=1){return this._map(t,e,!0)}_map(t,e,r){let i=0,a=this.inverted?2:1,l=this.inverted?1:2;for(let c=0;c<this.ranges.length;c+=3){let h=this.ranges[c]-(this.inverted?i:0);if(h>t)break;let d=this.ranges[c+a],m=this.ranges[c+l],y=h+d;if(t<=y){let v=d?t==h?-1:t==y?1:e:e,b=h+i+(v<0?0:m);if(r)return b;let C=t==(e<0?h:y)?null:__(c/3,t-h),N=t==h?ph:t==y?dh:fi;return(e<0?t!=h:t!=y)&&(N|=mh),new Is(b,N,C)}i+=m-d}return r?t+i:new Is(t+i,0,null)}touches(t,e){let r=0,i=fh(e),a=this.inverted?2:1,l=this.inverted?1:2;for(let c=0;c<this.ranges.length;c+=3){let h=this.ranges[c]-(this.inverted?r:0);if(h>t)break;let d=this.ranges[c+a],m=h+d;if(t<=m&&c==i*3)return!0;r+=this.ranges[c+l]-d}return!1}forEach(t){let e=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,a=0;i<this.ranges.length;i+=3){let l=this.ranges[i],c=l-(this.inverted?a:0),h=l+(this.inverted?0:a),d=this.ranges[i+e],m=this.ranges[i+r];t(c,c+d,h,h+m),a+=m-d}}invert(){return new ge(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(t){return t==0?ge.empty:new ge(t<0?[0,-t,0]:[0,0,t])}}ge.empty=new ge([]);class co{constructor(t=[],e,r=0,i=t.length){this.maps=t,this.mirror=e,this.from=r,this.to=i}slice(t=0,e=this.maps.length){return new co(this.maps,this.mirror,t,e)}copy(){return new co(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(t,e){this.to=this.maps.push(t),e!=null&&this.setMirror(this.maps.length-1,e)}appendMapping(t){for(let e=0,r=this.maps.length;e<t.maps.length;e++){let i=t.getMirror(e);this.appendMap(t.maps[e],i!=null&&i<e?r+i:void 0)}}getMirror(t){if(this.mirror){for(let e=0;e<this.mirror.length;e++)if(this.mirror[e]==t)return this.mirror[e+(e%2?-1:1)]}}setMirror(t,e){this.mirror||(this.mirror=[]),this.mirror.push(t,e)}appendMappingInverted(t){for(let e=t.maps.length-1,r=this.maps.length+t.maps.length;e>=0;e--){let i=t.getMirror(e);this.appendMap(t.maps[e].invert(),i!=null&&i>e?r-i-1:void 0)}}invert(){let t=new co;return t.appendMappingInverted(this),t}map(t,e=1){if(this.mirror)return this._map(t,e,!0);for(let r=this.from;r<this.to;r++)t=this.maps[r].map(t,e);return t}mapResult(t,e=1){return this._map(t,e,!1)}_map(t,e,r){let i=0;for(let a=this.from;a<this.to;a++){let l=this.maps[a],c=l.mapResult(t,e);if(c.recover!=null){let h=this.getMirror(a);if(h!=null&&h>a&&h<this.to){a=h,t=this.maps[h].recover(c.recover);continue}}i|=c.delInfo,t=c.pos}return r?t:new Is(t,i,null)}}const zs=Object.create(null);class Zt{getMap(){return ge.empty}merge(t){return null}static fromJSON(t,e){if(!e||!e.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=zs[e.stepType];if(!r)throw new RangeError(`No step type ${e.stepType} defined`);return r.fromJSON(t,e)}static jsonID(t,e){if(t in zs)throw new RangeError("Duplicate use of step JSON ID "+t);return zs[t]=e,e.prototype.jsonID=t,e}}class Ot{constructor(t,e){this.doc=t,this.failed=e}static ok(t){return new Ot(t,null)}static fail(t){return new Ot(null,t)}static fromReplace(t,e,r,i){try{return Ot.ok(t.replace(e,r,i))}catch(a){if(a instanceof oi)return Ot.fail(a.message);throw a}}}function js(n,t,e){let r=[];for(let i=0;i<n.childCount;i++){let a=n.child(i);a.content.size&&(a=a.copy(js(a.content,t,a))),a.isInline&&(a=t(a,e,i)),r.push(a)}return B.fromArray(r)}class un extends Zt{constructor(t,e,r){super(),this.from=t,this.to=e,this.mark=r}apply(t){let e=t.slice(this.from,this.to),r=t.resolve(this.from),i=r.node(r.sharedDepth(this.to)),a=new q(js(e.content,(l,c)=>!l.isAtom||!c.type.allowsMarkType(this.mark.type)?l:l.mark(this.mark.addToSet(l.marks)),i),e.openStart,e.openEnd);return Ot.fromReplace(t,this.from,this.to,a)}invert(){return new Ae(this.from,this.to,this.mark)}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return e.deleted&&r.deleted||e.pos>=r.pos?null:new un(e.pos,r.pos,this.mark)}merge(t){return t instanceof un&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new un(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,e){if(typeof e.from!="number"||typeof e.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new un(e.from,e.to,t.markFromJSON(e.mark))}}Zt.jsonID("addMark",un);class Ae extends Zt{constructor(t,e,r){super(),this.from=t,this.to=e,this.mark=r}apply(t){let e=t.slice(this.from,this.to),r=new q(js(e.content,i=>i.mark(this.mark.removeFromSet(i.marks)),t),e.openStart,e.openEnd);return Ot.fromReplace(t,this.from,this.to,r)}invert(){return new un(this.from,this.to,this.mark)}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return e.deleted&&r.deleted||e.pos>=r.pos?null:new Ae(e.pos,r.pos,this.mark)}merge(t){return t instanceof Ae&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new Ae(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,e){if(typeof e.from!="number"||typeof e.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Ae(e.from,e.to,t.markFromJSON(e.mark))}}Zt.jsonID("removeMark",Ae);class An extends Zt{constructor(t,e){super(),this.pos=t,this.mark=e}apply(t){let e=t.nodeAt(this.pos);if(!e)return Ot.fail("No node at mark step's position");let r=e.type.create(e.attrs,null,this.mark.addToSet(e.marks));return Ot.fromReplace(t,this.pos,this.pos+1,new q(B.from(r),0,e.isLeaf?0:1))}invert(t){let e=t.nodeAt(this.pos);if(e){let r=this.mark.addToSet(e.marks);if(r.length==e.marks.length){for(let i=0;i<e.marks.length;i++)if(!e.marks[i].isInSet(r))return new An(this.pos,e.marks[i]);return new An(this.pos,this.mark)}}return new xr(this.pos,this.mark)}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new An(e.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,e){if(typeof e.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new An(e.pos,t.markFromJSON(e.mark))}}Zt.jsonID("addNodeMark",An);class xr extends Zt{constructor(t,e){super(),this.pos=t,this.mark=e}apply(t){let e=t.nodeAt(this.pos);if(!e)return Ot.fail("No node at mark step's position");let r=e.type.create(e.attrs,null,this.mark.removeFromSet(e.marks));return Ot.fromReplace(t,this.pos,this.pos+1,new q(B.from(r),0,e.isLeaf?0:1))}invert(t){let e=t.nodeAt(this.pos);return!e||!this.mark.isInSet(e.marks)?this:new An(this.pos,this.mark)}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new xr(e.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,e){if(typeof e.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new xr(e.pos,t.markFromJSON(e.mark))}}Zt.jsonID("removeNodeMark",xr);class Bt extends Zt{constructor(t,e,r,i=!1){super(),this.from=t,this.to=e,this.slice=r,this.structure=i}apply(t){return this.structure&&Ps(t,this.from,this.to)?Ot.fail("Structure replace would overwrite content"):Ot.fromReplace(t,this.from,this.to,this.slice)}getMap(){return new ge([this.from,this.to-this.from,this.slice.size])}invert(t){return new Bt(this.from,this.from+this.slice.size,t.slice(this.from,this.to))}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1);return e.deletedAcross&&r.deletedAcross?null:new Bt(e.pos,Math.max(e.pos,r.pos),this.slice)}merge(t){if(!(t instanceof Bt)||t.structure||this.structure)return null;if(this.from+this.slice.size==t.from&&!this.slice.openEnd&&!t.slice.openStart){let e=this.slice.size+t.slice.size==0?q.empty:new q(this.slice.content.append(t.slice.content),this.slice.openStart,t.slice.openEnd);return new Bt(this.from,this.to+(t.to-t.from),e,this.structure)}else if(t.to==this.from&&!this.slice.openStart&&!t.slice.openEnd){let e=this.slice.size+t.slice.size==0?q.empty:new q(t.slice.content.append(this.slice.content),t.slice.openStart,this.slice.openEnd);return new Bt(t.from,this.to,e,this.structure)}else return null}toJSON(){let t={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,e){if(typeof e.from!="number"||typeof e.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Bt(e.from,e.to,q.fromJSON(t,e.slice),!!e.structure)}}Zt.jsonID("replace",Bt);class ie extends Zt{constructor(t,e,r,i,a,l,c=!1){super(),this.from=t,this.to=e,this.gapFrom=r,this.gapTo=i,this.slice=a,this.insert=l,this.structure=c}apply(t){if(this.structure&&(Ps(t,this.from,this.gapFrom)||Ps(t,this.gapTo,this.to)))return Ot.fail("Structure gap-replace would overwrite content");let e=t.slice(this.gapFrom,this.gapTo);if(e.openStart||e.openEnd)return Ot.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,e.content);return r?Ot.fromReplace(t,this.from,this.to,r):Ot.fail("Content does not fit in gap")}getMap(){return new ge([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(t){let e=this.gapTo-this.gapFrom;return new ie(this.from,this.from+this.slice.size+e,this.from+this.insert,this.from+this.insert+e,t.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(t){let e=t.mapResult(this.from,1),r=t.mapResult(this.to,-1),i=t.map(this.gapFrom,-1),a=t.map(this.gapTo,1);return e.deletedAcross&&r.deletedAcross||i<e.pos||a>r.pos?null:new ie(e.pos,r.pos,i,a,this.slice,this.insert,this.structure)}toJSON(){let t={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,e){if(typeof e.from!="number"||typeof e.to!="number"||typeof e.gapFrom!="number"||typeof e.gapTo!="number"||typeof e.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new ie(e.from,e.to,e.gapFrom,e.gapTo,q.fromJSON(t,e.slice),e.insert,!!e.structure)}}Zt.jsonID("replaceAround",ie);function Ps(n,t,e){let r=n.resolve(t),i=e-t,a=r.depth;for(;i>0&&a>0&&r.indexAfter(a)==r.node(a).childCount;)a--,i--;if(i>0){let l=r.node(a).maybeChild(r.indexAfter(a));for(;i>0;){if(!l||l.isLeaf)return!0;l=l.firstChild,i--}}return!1}function b_(n,t,e,r){let i=[],a=[],l,c;n.doc.nodesBetween(t,e,(h,d,m)=>{if(!h.isInline)return;let y=h.marks;if(!r.isInSet(y)&&m.type.allowsMarkType(r.type)){let v=Math.max(d,t),b=Math.min(d+h.nodeSize,e),C=r.addToSet(y);for(let N=0;N<y.length;N++)y[N].isInSet(C)||(l&&l.to==v&&l.mark.eq(y[N])?l.to=b:i.push(l=new Ae(v,b,y[N])));c&&c.to==v?c.to=b:a.push(c=new un(v,b,r))}}),i.forEach(h=>n.step(h)),a.forEach(h=>n.step(h))}function w_(n,t,e,r){let i=[],a=0;n.doc.nodesBetween(t,e,(l,c)=>{if(!l.isInline)return;a++;let h=null;if(r instanceof li){let d=l.marks,m;for(;m=r.isInSet(d);)(h||(h=[])).push(m),d=m.removeFromSet(d)}else r?r.isInSet(l.marks)&&(h=[r]):h=l.marks;if(h&&h.length){let d=Math.min(c+l.nodeSize,e);for(let m=0;m<h.length;m++){let y=h[m],v;for(let b=0;b<i.length;b++){let C=i[b];C.step==a-1&&y.eq(i[b].style)&&(v=C)}v?(v.to=d,v.step=a):i.push({style:y,from:Math.max(c,t),to:d,step:a})}}}),i.forEach(l=>n.step(new Ae(l.from,l.to,l.style)))}function v_(n,t,e,r=e.contentMatch){let i=n.doc.nodeAt(t),a=[],l=t+1;for(let c=0;c<i.childCount;c++){let h=i.child(c),d=l+h.nodeSize,m=r.matchType(h.type);if(!m)a.push(new Bt(l,d,q.empty));else{r=m;for(let y=0;y<h.marks.length;y++)e.allowsMarkType(h.marks[y].type)||n.step(new Ae(l,d,h.marks[y]))}l=d}if(!r.validEnd){let c=r.fillBefore(B.empty,!0);n.replace(l,l,new q(c,0,0))}for(let c=a.length-1;c>=0;c--)n.step(a[c])}function k_(n,t,e){return(t==0||n.canReplace(t,n.childCount))&&(e==n.childCount||n.canReplace(0,e))}function Bs(n){let t=n.parent.content.cutByIndex(n.startIndex,n.endIndex);for(let e=n.depth;;--e){let r=n.$from.node(e),i=n.$from.index(e),a=n.$to.indexAfter(e);if(e<n.depth&&r.canReplace(i,a,t))return e;if(e==0||r.type.spec.isolating||!k_(r,i,a))break}return null}function x_(n,t,e){let{$from:r,$to:i,depth:a}=t,l=r.before(a+1),c=i.after(a+1),h=l,d=c,m=B.empty,y=0;for(let C=a,N=!1;C>e;C--)N||r.index(C)>0?(N=!0,m=B.from(r.node(C).copy(m)),y++):h--;let v=B.empty,b=0;for(let C=a,N=!1;C>e;C--)N||i.after(C+1)<i.end(C)?(N=!0,v=B.from(i.node(C).copy(v)),b++):d++;n.step(new ie(h,d,l,c,new q(m.append(v),y,b),m.size-y,!0))}function S_(n,t,e){let r=B.empty;for(let l=e.length-1;l>=0;l--){if(r.size){let c=e[l].type.contentMatch.matchFragment(r);if(!c||!c.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=B.from(e[l].type.create(e[l].attrs,r))}let i=t.start,a=t.end;n.step(new ie(i,a,i,a,new q(r,0,0),e.length,!0))}function C_(n,t,e,r,i){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let a=n.steps.length;n.doc.nodesBetween(t,e,(l,c)=>{if(l.isTextblock&&!l.hasMarkup(r,i)&&O_(n.doc,n.mapping.slice(a).map(c),r)){n.clearIncompatible(n.mapping.slice(a).map(c,1),r);let h=n.mapping.slice(a),d=h.map(c,1),m=h.map(c+l.nodeSize,1);return n.step(new ie(d,m,d+1,m-1,new q(B.from(r.create(i,null,l.marks)),0,0),1,!0)),!1}})}function O_(n,t,e){let r=n.resolve(t),i=r.index();return r.parent.canReplaceWith(i,i+1,e)}function M_(n,t,e,r,i){let a=n.doc.nodeAt(t);if(!a)throw new RangeError("No node at given position");e||(e=a.type);let l=e.create(r,null,i||a.marks);if(a.isLeaf)return n.replaceWith(t,t+a.nodeSize,l);if(!e.validContent(a.content))throw new RangeError("Invalid content for node type "+e.name);n.step(new ie(t,t+a.nodeSize,t+1,t+a.nodeSize-1,new q(B.from(l),0,0),1,!0))}function di(n,t,e=1,r){let i=n.resolve(t),a=i.depth-e,l=r&&r[r.length-1]||i.parent;if(a<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!l.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let d=i.depth-1,m=e-2;d>a;d--,m--){let y=i.node(d),v=i.index(d);if(y.type.spec.isolating)return!1;let b=y.content.cutByIndex(v,y.childCount),C=r&&r[m]||y;if(C!=y&&(b=b.replaceChild(0,C.type.create(C.attrs))),!y.canReplace(v+1,y.childCount)||!C.type.validContent(b))return!1}let c=i.indexAfter(a),h=r&&r[0];return i.node(a).canReplaceWith(c,c,h?h.type:i.node(a+1).type)}function A_(n,t,e=1,r){let i=n.doc.resolve(t),a=B.empty,l=B.empty;for(let c=i.depth,h=i.depth-e,d=e-1;c>h;c--,d--){a=B.from(i.node(c).copy(a));let m=r&&r[d];l=B.from(m?m.type.create(m.attrs,l):i.node(c).copy(l))}n.step(new Bt(t,t,new q(a.append(l),e,e),!0))}function gh(n,t){let e=n.resolve(t),r=e.index();return T_(e.nodeBefore,e.nodeAfter)&&e.parent.canReplace(r,r+1)}function T_(n,t){return!!(n&&t&&!n.isLeaf&&n.canAppend(t))}function N_(n,t,e){let r=new Bt(t-e,t+e,q.empty,!0);n.step(r)}function E_(n,t,e){let r=n.resolve(t);if(r.parent.canReplaceWith(r.index(),r.index(),e))return t;if(r.parentOffset==0)for(let i=r.depth-1;i>=0;i--){let a=r.index(i);if(r.node(i).canReplaceWith(a,a,e))return r.before(i+1);if(a>0)return null}if(r.parentOffset==r.parent.content.size)for(let i=r.depth-1;i>=0;i--){let a=r.indexAfter(i);if(r.node(i).canReplaceWith(a,a,e))return r.after(i+1);if(a<r.node(i).childCount)return null}return null}function D_(n,t,e){let r=n.resolve(t);if(!e.content.size)return t;let i=e.content;for(let a=0;a<e.openStart;a++)i=i.firstChild.content;for(let a=1;a<=(e.openStart==0&&e.size?2:1);a++)for(let l=r.depth;l>=0;l--){let c=l==r.depth?0:r.pos<=(r.start(l+1)+r.end(l+1))/2?-1:1,h=r.index(l)+(c>0?1:0),d=r.node(l),m=!1;if(a==1)m=d.canReplace(h,h,i);else{let y=d.contentMatchAt(h).findWrapping(i.firstChild.type);m=y&&d.canReplaceWith(h,h,y[0])}if(m)return c==0?r.pos:c<0?r.before(l+1):r.after(l+1)}return null}function $s(n,t,e=t,r=q.empty){if(t==e&&!r.size)return null;let i=n.resolve(t),a=n.resolve(e);return _h(i,a,r)?new Bt(t,e,r):new R_(i,a,r).fit()}function _h(n,t,e){return!e.openStart&&!e.openEnd&&n.start()==t.start()&&n.parent.canReplace(n.index(),t.index(),e.content)}class R_{constructor(t,e,r){this.$from=t,this.$to=e,this.unplaced=r,this.frontier=[],this.placed=B.empty;for(let i=0;i<=t.depth;i++){let a=t.node(i);this.frontier.push({type:a.type,match:a.contentMatchAt(t.indexAfter(i))})}for(let i=t.depth;i>0;i--)this.placed=B.from(t.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let d=this.findFittable();d?this.placeNodes(d):this.openMore()||this.dropNode()}let t=this.mustMoveInline(),e=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(t<0?this.$to:r.doc.resolve(t));if(!i)return null;let a=this.placed,l=r.depth,c=i.depth;for(;l&&c&&a.childCount==1;)a=a.firstChild.content,l--,c--;let h=new q(a,l,c);return t>-1?new ie(r.pos,t,this.$to.pos,this.$to.end(),h,e):h.size||r.pos!=this.$to.pos?new Bt(r.pos,i.pos,h):null}findFittable(){let t=this.unplaced.openStart;for(let e=this.unplaced.content,r=0,i=this.unplaced.openEnd;r<t;r++){let a=e.firstChild;if(e.childCount>1&&(i=0),a.type.spec.isolating&&i<=r){t=r;break}e=a.content}for(let e=1;e<=2;e++)for(let r=e==1?t:this.unplaced.openStart;r>=0;r--){let i,a=null;r?(a=Fs(this.unplaced.content,r-1).firstChild,i=a.content):i=this.unplaced.content;let l=i.firstChild;for(let c=this.depth;c>=0;c--){let{type:h,match:d}=this.frontier[c],m,y=null;if(e==1&&(l?d.matchType(l.type)||(y=d.fillBefore(B.from(l),!1)):a&&h.compatibleContent(a.type)))return{sliceDepth:r,frontierDepth:c,parent:a,inject:y};if(e==2&&l&&(m=d.findWrapping(l.type)))return{sliceDepth:r,frontierDepth:c,parent:a,wrap:m};if(a&&d.matchType(a.type))break}}}openMore(){let{content:t,openStart:e,openEnd:r}=this.unplaced,i=Fs(t,e);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new q(t,e+1,Math.max(r,i.size+e>=t.size-r?e+1:0)),!0)}dropNode(){let{content:t,openStart:e,openEnd:r}=this.unplaced,i=Fs(t,e);if(i.childCount<=1&&e>0){let a=t.size-e<=e+i.size;this.unplaced=new q(uo(t,e-1,1),e-1,a?e-1:r)}else this.unplaced=new q(uo(t,e,1),e,r)}placeNodes({sliceDepth:t,frontierDepth:e,parent:r,inject:i,wrap:a}){for(;this.depth>e;)this.closeFrontierNode();if(a)for(let N=0;N<a.length;N++)this.openFrontierNode(a[N]);let l=this.unplaced,c=r?r.content:l.content,h=l.openStart-t,d=0,m=[],{match:y,type:v}=this.frontier[e];if(i){for(let N=0;N<i.childCount;N++)m.push(i.child(N));y=y.matchFragment(i)}let b=c.size+t-(l.content.size-l.openEnd);for(;d<c.childCount;){let N=c.child(d),P=y.matchType(N.type);if(!P)break;d++,(d>1||h==0||N.content.size)&&(y=P,m.push(yh(N.mark(v.allowedMarks(N.marks)),d==1?h:0,d==c.childCount?b:-1)))}let C=d==c.childCount;C||(b=-1),this.placed=ho(this.placed,e,B.from(m)),this.frontier[e].match=y,C&&b<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let N=0,P=c;N<b;N++){let J=P.lastChild;this.frontier.push({type:J.type,match:J.contentMatchAt(J.childCount)}),P=J.content}this.unplaced=C?t==0?q.empty:new q(uo(l.content,t-1,1),t-1,b<0?l.openEnd:t-1):new q(uo(l.content,t,d),l.openStart,l.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let t=this.frontier[this.depth],e;if(!t.type.isTextblock||!Vs(this.$to,this.$to.depth,t.type,t.match,!1)||this.$to.depth==this.depth&&(e=this.findCloseLevel(this.$to))&&e.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(t){t:for(let e=Math.min(this.depth,t.depth);e>=0;e--){let{match:r,type:i}=this.frontier[e],a=e<t.depth&&t.end(e+1)==t.pos+(t.depth-(e+1)),l=Vs(t,e,i,r,a);if(l){for(let c=e-1;c>=0;c--){let{match:h,type:d}=this.frontier[c],m=Vs(t,c,d,h,!0);if(!m||m.childCount)continue t}return{depth:e,fit:l,move:a?t.doc.resolve(t.after(e+1)):t}}}}close(t){let e=this.findCloseLevel(t);if(!e)return null;for(;this.depth>e.depth;)this.closeFrontierNode();e.fit.childCount&&(this.placed=ho(this.placed,e.depth,e.fit)),t=e.move;for(let r=e.depth+1;r<=t.depth;r++){let i=t.node(r),a=i.type.contentMatch.fillBefore(i.content,!0,t.index(r));this.openFrontierNode(i.type,i.attrs,a)}return t}openFrontierNode(t,e=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(t),this.placed=ho(this.placed,this.depth,B.from(t.create(e,r))),this.frontier.push({type:t,match:t.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(B.empty,!0);t.childCount&&(this.placed=ho(this.placed,this.frontier.length,t))}}function uo(n,t,e){return t==0?n.cutByIndex(e,n.childCount):n.replaceChild(0,n.firstChild.copy(uo(n.firstChild.content,t-1,e)))}function ho(n,t,e){return t==0?n.append(e):n.replaceChild(n.childCount-1,n.lastChild.copy(ho(n.lastChild.content,t-1,e)))}function Fs(n,t){for(let e=0;e<t;e++)n=n.firstChild.content;return n}function yh(n,t,e){if(t<=0)return n;let r=n.content;return t>1&&(r=r.replaceChild(0,yh(r.firstChild,t-1,r.childCount==1?e-1:0))),t>0&&(r=n.type.contentMatch.fillBefore(r).append(r),e<=0&&(r=r.append(n.type.contentMatch.matchFragment(r).fillBefore(B.empty,!0)))),n.copy(r)}function Vs(n,t,e,r,i){let a=n.node(t),l=i?n.indexAfter(t):n.index(t);if(l==a.childCount&&!e.compatibleContent(a.type))return null;let c=r.fillBefore(a.content,!0,l);return c&&!I_(e,a.content,l)?c:null}function I_(n,t,e){for(let r=e;r<t.childCount;r++)if(!n.allowsMarks(t.child(r).marks))return!0;return!1}function z_(n){return n.spec.defining||n.spec.definingForContent}function j_(n,t,e,r){if(!r.size)return n.deleteRange(t,e);let i=n.doc.resolve(t),a=n.doc.resolve(e);if(_h(i,a,r))return n.step(new Bt(t,e,r));let l=wh(i,n.doc.resolve(e));l[l.length-1]==0&&l.pop();let c=-(i.depth+1);l.unshift(c);for(let v=i.depth,b=i.pos-1;v>0;v--,b--){let C=i.node(v).type.spec;if(C.defining||C.definingAsContext||C.isolating)break;l.indexOf(v)>-1?c=v:i.before(v)==b&&l.splice(1,0,-v)}let h=l.indexOf(c),d=[],m=r.openStart;for(let v=r.content,b=0;;b++){let C=v.firstChild;if(d.push(C),b==r.openStart)break;v=C.content}for(let v=m-1;v>=0;v--){let b=d[v].type,C=z_(b);if(C&&i.node(h).type!=b)m=v;else if(C||!b.isTextblock)break}for(let v=r.openStart;v>=0;v--){let b=(v+m+1)%(r.openStart+1),C=d[b];if(C)for(let N=0;N<l.length;N++){let P=l[(N+h)%l.length],J=!0;P<0&&(J=!1,P=-P);let mt=i.node(P-1),st=i.index(P-1);if(mt.canReplaceWith(st,st,C.type,C.marks))return n.replace(i.before(P),J?a.after(P):e,new q(bh(r.content,0,r.openStart,b),b,r.openEnd))}}let y=n.steps.length;for(let v=l.length-1;v>=0&&(n.replace(t,e,r),!(n.steps.length>y));v--){let b=l[v];b<0||(t=i.before(b),e=a.after(b))}}function bh(n,t,e,r,i){if(t<e){let a=n.firstChild;n=n.replaceChild(0,a.copy(bh(a.content,t+1,e,r,a)))}if(t>r){let a=i.contentMatchAt(0),l=a.fillBefore(n).append(n);n=l.append(a.matchFragment(l).fillBefore(B.empty,!0))}return n}function P_(n,t,e,r){if(!r.isInline&&t==e&&n.doc.resolve(t).parent.content.size){let i=E_(n.doc,t,r.type);i!=null&&(t=e=i)}n.replaceRange(t,e,new q(B.from(r),0,0))}function B_(n,t,e){let r=n.doc.resolve(t),i=n.doc.resolve(e),a=wh(r,i);for(let l=0;l<a.length;l++){let c=a[l],h=l==a.length-1;if(h&&c==0||r.node(c).type.contentMatch.validEnd)return n.delete(r.start(c),i.end(c));if(c>0&&(h||r.node(c-1).canReplace(r.index(c-1),i.indexAfter(c-1))))return n.delete(r.before(c),i.after(c))}for(let l=1;l<=r.depth&&l<=i.depth;l++)if(t-r.start(l)==r.depth-l&&e>r.end(l)&&i.end(l)-e!=i.depth-l)return n.delete(r.before(l),e);n.delete(t,e)}function wh(n,t){let e=[],r=Math.min(n.depth,t.depth);for(let i=r;i>=0;i--){let a=n.start(i);if(a<n.pos-(n.depth-i)||t.end(i)>t.pos+(t.depth-i)||n.node(i).type.spec.isolating||t.node(i).type.spec.isolating)break;(a==t.start(i)||i==n.depth&&i==t.depth&&n.parent.inlineContent&&t.parent.inlineContent&&i&&t.start(i-1)==a-1)&&e.push(i)}return e}class Sr extends Zt{constructor(t,e,r){super(),this.pos=t,this.attr=e,this.value=r}apply(t){let e=t.nodeAt(this.pos);if(!e)return Ot.fail("No node at attribute step's position");let r=Object.create(null);for(let a in e.attrs)r[a]=e.attrs[a];r[this.attr]=this.value;let i=e.type.create(r,null,e.marks);return Ot.fromReplace(t,this.pos,this.pos+1,new q(B.from(i),0,e.isLeaf?0:1))}getMap(){return ge.empty}invert(t){return new Sr(this.pos,this.attr,t.nodeAt(this.pos).attrs[this.attr])}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new Sr(e.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(t,e){if(typeof e.pos!="number"||typeof e.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Sr(e.pos,e.attr,e.value)}}Zt.jsonID("attr",Sr);let Cr=class extends Error{};Cr=function n(t){let e=Error.call(this,t);return e.__proto__=n.prototype,e},Cr.prototype=Object.create(Error.prototype),Cr.prototype.constructor=Cr,Cr.prototype.name="TransformError";class $_{constructor(t){this.doc=t,this.steps=[],this.docs=[],this.mapping=new co}get before(){return this.docs.length?this.docs[0]:this.doc}step(t){let e=this.maybeStep(t);if(e.failed)throw new Cr(e.failed);return this}maybeStep(t){let e=t.apply(this.doc);return e.failed||this.addStep(t,e.doc),e}get docChanged(){return this.steps.length>0}addStep(t,e){this.docs.push(this.doc),this.steps.push(t),this.mapping.appendMap(t.getMap()),this.doc=e}replace(t,e=t,r=q.empty){let i=$s(this.doc,t,e,r);return i&&this.step(i),this}replaceWith(t,e,r){return this.replace(t,e,new q(B.from(r),0,0))}delete(t,e){return this.replace(t,e,q.empty)}insert(t,e){return this.replaceWith(t,t,e)}replaceRange(t,e,r){return j_(this,t,e,r),this}replaceRangeWith(t,e,r){return P_(this,t,e,r),this}deleteRange(t,e){return B_(this,t,e),this}lift(t,e){return x_(this,t,e),this}join(t,e=1){return N_(this,t,e),this}wrap(t,e){return S_(this,t,e),this}setBlockType(t,e=t,r,i=null){return C_(this,t,e,r,i),this}setNodeMarkup(t,e,r=null,i){return M_(this,t,e,r,i),this}setNodeAttribute(t,e,r){return this.step(new Sr(t,e,r)),this}addNodeMark(t,e){return this.step(new An(t,e)),this}removeNodeMark(t,e){if(!(e instanceof ct)){let r=this.doc.nodeAt(t);if(!r)throw new RangeError("No node at position "+t);if(e=e.isInSet(r.marks),!e)return this}return this.step(new xr(t,e)),this}split(t,e=1,r){return A_(this,t,e,r),this}addMark(t,e,r){return b_(this,t,e,r),this}removeMark(t,e,r){return w_(this,t,e,r),this}clearIncompatible(t,e,r){return v_(this,t,e,r),this}}const Ls=Object.create(null);class ht{constructor(t,e,r){this.$anchor=t,this.$head=e,this.ranges=r||[new F_(t.min(e),t.max(e))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let t=this.ranges;for(let e=0;e<t.length;e++)if(t[e].$from.pos!=t[e].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(t,e=q.empty){let r=e.content.lastChild,i=null;for(let c=0;c<e.openEnd;c++)i=r,r=r.lastChild;let a=t.steps.length,l=this.ranges;for(let c=0;c<l.length;c++){let{$from:h,$to:d}=l[c],m=t.mapping.slice(a);t.replaceRange(m.map(h.pos),m.map(d.pos),c?q.empty:e),c==0&&xh(t,a,(r?r.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(t,e){let r=t.steps.length,i=this.ranges;for(let a=0;a<i.length;a++){let{$from:l,$to:c}=i[a],h=t.mapping.slice(r),d=h.map(l.pos),m=h.map(c.pos);a?t.deleteRange(d,m):(t.replaceRangeWith(d,m,e),xh(t,r,e.isInline?-1:1))}}static findFrom(t,e,r=!1){let i=t.parent.inlineContent?new pt(t):Or(t.node(0),t.parent,t.pos,t.index(),e,r);if(i)return i;for(let a=t.depth-1;a>=0;a--){let l=e<0?Or(t.node(0),t.node(a),t.before(a+1),t.index(a),e,r):Or(t.node(0),t.node(a),t.after(a+1),t.index(a)+1,e,r);if(l)return l}return null}static near(t,e=1){return this.findFrom(t,e)||this.findFrom(t,-e)||new se(t.node(0))}static atStart(t){return Or(t,t,0,0,1)||new se(t)}static atEnd(t){return Or(t,t,t.content.size,t.childCount,-1)||new se(t)}static fromJSON(t,e){if(!e||!e.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=Ls[e.type];if(!r)throw new RangeError(`No selection type ${e.type} defined`);return r.fromJSON(t,e)}static jsonID(t,e){if(t in Ls)throw new RangeError("Duplicate use of selection JSON ID "+t);return Ls[t]=e,e.prototype.jsonID=t,e}getBookmark(){return pt.between(this.$anchor,this.$head).getBookmark()}}ht.prototype.visible=!0;class F_{constructor(t,e){this.$from=t,this.$to=e}}let vh=!1;function kh(n){!vh&&!n.parent.inlineContent&&(vh=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+n.parent.type.name+")"))}class pt extends ht{constructor(t,e=t){kh(t),kh(e),super(t,e)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(t,e){let r=t.resolve(e.map(this.head));if(!r.parent.inlineContent)return ht.near(r);let i=t.resolve(e.map(this.anchor));return new pt(i.parent.inlineContent?i:r,r)}replace(t,e=q.empty){if(super.replace(t,e),e==q.empty){let r=this.$from.marksAcross(this.$to);r&&t.ensureMarks(r)}}eq(t){return t instanceof pt&&t.anchor==this.anchor&&t.head==this.head}getBookmark(){return new pi(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(t,e){if(typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new pt(t.resolve(e.anchor),t.resolve(e.head))}static create(t,e,r=e){let i=t.resolve(e);return new this(i,r==e?i:t.resolve(r))}static between(t,e,r){let i=t.pos-e.pos;if((!r||i)&&(r=i>=0?1:-1),!e.parent.inlineContent){let a=ht.findFrom(e,r,!0)||ht.findFrom(e,-r,!0);if(a)e=a.$head;else return ht.near(e,r)}return t.parent.inlineContent||(i==0?t=e:(t=(ht.findFrom(t,-r,!0)||ht.findFrom(t,r,!0)).$anchor,t.pos<e.pos!=i<0&&(t=e))),new pt(t,e)}}ht.jsonID("text",pt);class pi{constructor(t,e){this.anchor=t,this.head=e}map(t){return new pi(t.map(this.anchor),t.map(this.head))}resolve(t){return pt.between(t.resolve(this.anchor),t.resolve(this.head))}}class X extends ht{constructor(t){let e=t.nodeAfter,r=t.node(0).resolve(t.pos+e.nodeSize);super(t,r),this.node=e}map(t,e){let{deleted:r,pos:i}=e.mapResult(this.anchor),a=t.resolve(i);return r?ht.near(a):new X(a)}content(){return new q(B.from(this.node),0,0)}eq(t){return t instanceof X&&t.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new Ws(this.anchor)}static fromJSON(t,e){if(typeof e.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new X(t.resolve(e.anchor))}static create(t,e){return new X(t.resolve(e))}static isSelectable(t){return!t.isText&&t.type.spec.selectable!==!1}}X.prototype.visible=!1,ht.jsonID("node",X);class Ws{constructor(t){this.anchor=t}map(t){let{deleted:e,pos:r}=t.mapResult(this.anchor);return e?new pi(r,r):new Ws(r)}resolve(t){let e=t.resolve(this.anchor),r=e.nodeAfter;return r&&X.isSelectable(r)?new X(e):ht.near(e)}}class se extends ht{constructor(t){super(t.resolve(0),t.resolve(t.content.size))}replace(t,e=q.empty){if(e==q.empty){t.delete(0,t.doc.content.size);let r=ht.atStart(t.doc);r.eq(t.selection)||t.setSelection(r)}else super.replace(t,e)}toJSON(){return{type:"all"}}static fromJSON(t){return new se(t)}map(t){return new se(t)}eq(t){return t instanceof se}getBookmark(){return V_}}ht.jsonID("all",se);const V_={map(){return this},resolve(n){return new se(n)}};function Or(n,t,e,r,i,a=!1){if(t.inlineContent)return pt.create(n,e);for(let l=r-(i>0?0:1);i>0?l<t.childCount:l>=0;l+=i){let c=t.child(l);if(c.isAtom){if(!a&&X.isSelectable(c))return X.create(n,e-(i<0?c.nodeSize:0))}else{let h=Or(n,c,e+i,i<0?c.childCount:0,i,a);if(h)return h}e+=c.nodeSize*i}return null}function xh(n,t,e){let r=n.steps.length-1;if(r<t)return;let i=n.steps[r];if(!(i instanceof Bt||i instanceof ie))return;let a=n.mapping.maps[r],l;a.forEach((c,h,d,m)=>{l==null&&(l=m)}),n.setSelection(ht.near(n.doc.resolve(l),e))}const Sh=1,mi=2,Ch=4;class L_ extends $_{constructor(t){super(t.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=t.selection,this.storedMarks=t.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(t){if(t.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=t,this.curSelectionFor=this.steps.length,this.updated=(this.updated|Sh)&~mi,this.storedMarks=null,this}get selectionSet(){return(this.updated&Sh)>0}setStoredMarks(t){return this.storedMarks=t,this.updated|=mi,this}ensureMarks(t){return ct.sameSet(this.storedMarks||this.selection.$from.marks(),t)||this.setStoredMarks(t),this}addStoredMark(t){return this.ensureMarks(t.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(t){return this.ensureMarks(t.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&mi)>0}addStep(t,e){super.addStep(t,e),this.updated=this.updated&~mi,this.storedMarks=null}setTime(t){return this.time=t,this}replaceSelection(t){return this.selection.replace(this,t),this}replaceSelectionWith(t,e=!0){let r=this.selection;return e&&(t=t.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||ct.none))),r.replaceWith(this,t),this}deleteSelection(){return this.selection.replace(this),this}insertText(t,e,r){let i=this.doc.type.schema;if(e==null)return t?this.replaceSelectionWith(i.text(t),!0):this.deleteSelection();{if(r==null&&(r=e),r=r!=null?r:e,!t)return this.deleteRange(e,r);let a=this.storedMarks;if(!a){let l=this.doc.resolve(e);a=r==e?l.marks():l.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(e,r,i.text(t,a)),this.selection.empty||this.setSelection(ht.near(this.selection.$to)),this}}setMeta(t,e){return this.meta[typeof t=="string"?t:t.key]=e,this}getMeta(t){return this.meta[typeof t=="string"?t:t.key]}get isGeneric(){for(let t in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=Ch,this}get scrolledIntoView(){return(this.updated&Ch)>0}}function Oh(n,t){return!t||!n?n:n.bind(t)}class fo{constructor(t,e,r){this.name=t,this.init=Oh(e.init,r),this.apply=Oh(e.apply,r)}}const W_=[new fo("doc",{init(n){return n.doc||n.schema.topNodeType.createAndFill()},apply(n){return n.doc}}),new fo("selection",{init(n,t){return n.selection||ht.atStart(t.doc)},apply(n){return n.selection}}),new fo("storedMarks",{init(n){return n.storedMarks||null},apply(n,t,e,r){return r.selection.$cursor?n.storedMarks:null}}),new fo("scrollToSelection",{init(){return 0},apply(n,t){return n.scrolledIntoView?t+1:t}})];class qs{constructor(t,e){this.schema=t,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=W_.slice(),e&&e.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new fo(r.key,r.spec.state,r))})}}class Mr{constructor(t){this.config=t}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(t){return this.applyTransaction(t).state}filterTransaction(t,e=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=e){let i=this.config.plugins[r];if(i.spec.filterTransaction&&!i.spec.filterTransaction.call(i,t,this))return!1}return!0}applyTransaction(t){if(!this.filterTransaction(t))return{state:this,transactions:[]};let e=[t],r=this.applyInner(t),i=null;for(;;){let a=!1;for(let l=0;l<this.config.plugins.length;l++){let c=this.config.plugins[l];if(c.spec.appendTransaction){let h=i?i[l].n:0,d=i?i[l].state:this,m=h<e.length&&c.spec.appendTransaction.call(c,h?e.slice(h):e,d,r);if(m&&r.filterTransaction(m,l)){if(m.setMeta("appendedTransaction",t),!i){i=[];for(let y=0;y<this.config.plugins.length;y++)i.push(y<l?{state:r,n:e.length}:{state:this,n:0})}e.push(m),r=r.applyInner(m),a=!0}i&&(i[l]={state:r,n:e.length})}}if(!a)return{state:r,transactions:e}}}applyInner(t){if(!t.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let e=new Mr(this.config),r=this.config.fields;for(let i=0;i<r.length;i++){let a=r[i];e[a.name]=a.apply(t,this[a.name],this,e)}return e}get tr(){return new L_(this)}static create(t){let e=new qs(t.doc?t.doc.type.schema:t.schema,t.plugins),r=new Mr(e);for(let i=0;i<e.fields.length;i++)r[e.fields[i].name]=e.fields[i].init(t,r);return r}reconfigure(t){let e=new qs(this.schema,t.plugins),r=e.fields,i=new Mr(e);for(let a=0;a<r.length;a++){let l=r[a].name;i[l]=this.hasOwnProperty(l)?this[l]:r[a].init(t,i)}return i}toJSON(t){let e={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(e.storedMarks=this.storedMarks.map(r=>r.toJSON())),t&&typeof t=="object")for(let r in t){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=t[r],a=i.spec.state;a&&a.toJSON&&(e[r]=a.toJSON.call(i,this[i.key]))}return e}static fromJSON(t,e,r){if(!e)throw new RangeError("Invalid input for EditorState.fromJSON");if(!t.schema)throw new RangeError("Required config field 'schema' missing");let i=new qs(t.schema,t.plugins),a=new Mr(i);return i.fields.forEach(l=>{if(l.name=="doc")a.doc=We.fromJSON(t.schema,e.doc);else if(l.name=="selection")a.selection=ht.fromJSON(a.doc,e.selection);else if(l.name=="storedMarks")e.storedMarks&&(a.storedMarks=e.storedMarks.map(t.schema.markFromJSON));else{if(r)for(let c in r){let h=r[c],d=h.spec.state;if(h.key==l.name&&d&&d.fromJSON&&Object.prototype.hasOwnProperty.call(e,c)){a[l.name]=d.fromJSON.call(h,t,e[c],a);return}}a[l.name]=l.init(t,a)}}),a}}function Mh(n,t,e){for(let r in n){let i=n[r];i instanceof Function?i=i.bind(t):r=="handleDOMEvents"&&(i=Mh(i,t,{})),e[r]=i}return e}class q_{constructor(t){this.spec=t,this.props={},t.props&&Mh(t.props,this,this.props),this.key=t.key?t.key.key:J_("plugin")}getState(t){return t[this.key]}}const Js=Object.create(null);function J_(n){return n in Js?n+"$"+ ++Js[n]:(Js[n]=0,n+"$")}const ae=function(n){for(var t=0;;t++)if(n=n.previousSibling,!n)return t},po=function(n){let t=n.assignedSlot||n.parentNode;return t&&t.nodeType==11?t.host:t};let Ah=null;const hn=function(n,t,e){let r=Ah||(Ah=document.createRange());return r.setEnd(n,e!=null?e:n.nodeValue.length),r.setStart(n,t||0),r},tr=function(n,t,e,r){return e&&(Th(n,t,e,r,-1)||Th(n,t,e,r,1))},H_=/^(img|br|input|textarea|hr)$/i;function Th(n,t,e,r,i){for(;;){if(n==e&&t==r)return!0;if(t==(i<0?0:qe(n))){let a=n.parentNode;if(!a||a.nodeType!=1||U_(n)||H_.test(n.nodeName)||n.contentEditable=="false")return!1;t=ae(n)+(i<0?0:1),n=a}else if(n.nodeType==1){if(n=n.childNodes[t+(i<0?-1:0)],n.contentEditable=="false")return!1;t=i<0?qe(n):0}else return!1}}function qe(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function K_(n,t,e){for(let r=t==0,i=t==qe(n);r||i;){if(n==e)return!0;let a=ae(n);if(n=n.parentNode,!n)return!1;r=r&&a==0,i=i&&a==qe(n)}}function U_(n){let t;for(let e=n;e&&!(t=e.pmViewDesc);e=e.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==n||t.contentDOM==n)}const gi=function(n){return n.focusNode&&tr(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)};function er(n,t){let e=document.createEvent("Event");return e.initEvent("keydown",!0,!0),e.keyCode=n,e.key=e.code=t,e}function G_(n){let t=n.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}const Tn=typeof navigator<"u"?navigator:null,Nh=typeof document<"u"?document:null,Nn=Tn&&Tn.userAgent||"",Hs=/Edge\/(\d+)/.exec(Nn),Eh=/MSIE \d/.exec(Nn),Ks=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Nn),Yt=!!(Eh||Ks||Hs),En=Eh?document.documentMode:Ks?+Ks[1]:Hs?+Hs[1]:0,Te=!Yt&&/gecko\/(\d+)/i.test(Nn);Te&&+(/Firefox\/(\d+)/.exec(Nn)||[0,0])[1];const Us=!Yt&&/Chrome\/(\d+)/.exec(Nn),Lt=!!Us,Z_=Us?+Us[1]:0,Wt=!Yt&&!!Tn&&/Apple Computer/.test(Tn.vendor),Ar=Wt&&(/Mobile\/\w+/.test(Nn)||!!Tn&&Tn.maxTouchPoints>2),_e=Ar||(Tn?/Mac/.test(Tn.platform):!1),Ne=/Android \d/.test(Nn),_i=!!Nh&&"webkitFontSmoothing"in Nh.documentElement.style,Y_=_i?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function Q_(n){return{left:0,right:n.documentElement.clientWidth,top:0,bottom:n.documentElement.clientHeight}}function Dn(n,t){return typeof n=="number"?n:n[t]}function X_(n){let t=n.getBoundingClientRect(),e=t.width/n.offsetWidth||1,r=t.height/n.offsetHeight||1;return{left:t.left,right:t.left+n.clientWidth*e,top:t.top,bottom:t.top+n.clientHeight*r}}function Dh(n,t,e){let r=n.someProp("scrollThreshold")||0,i=n.someProp("scrollMargin")||5,a=n.dom.ownerDocument;for(let l=e||n.dom;l;l=po(l)){if(l.nodeType!=1)continue;let c=l,h=c==a.body,d=h?Q_(a):X_(c),m=0,y=0;if(t.top<d.top+Dn(r,"top")?y=-(d.top-t.top+Dn(i,"top")):t.bottom>d.bottom-Dn(r,"bottom")&&(y=t.bottom-d.bottom+Dn(i,"bottom")),t.left<d.left+Dn(r,"left")?m=-(d.left-t.left+Dn(i,"left")):t.right>d.right-Dn(r,"right")&&(m=t.right-d.right+Dn(i,"right")),m||y)if(h)a.defaultView.scrollBy(m,y);else{let v=c.scrollLeft,b=c.scrollTop;y&&(c.scrollTop+=y),m&&(c.scrollLeft+=m);let C=c.scrollLeft-v,N=c.scrollTop-b;t={left:t.left-C,top:t.top-N,right:t.right-C,bottom:t.bottom-N}}if(h)break}}function t1(n){let t=n.dom.getBoundingClientRect(),e=Math.max(0,t.top),r,i;for(let a=(t.left+t.right)/2,l=e+1;l<Math.min(innerHeight,t.bottom);l+=5){let c=n.root.elementFromPoint(a,l);if(!c||c==n.dom||!n.dom.contains(c))continue;let h=c.getBoundingClientRect();if(h.top>=e-20){r=c,i=h.top;break}}return{refDOM:r,refTop:i,stack:Rh(n.dom)}}function Rh(n){let t=[],e=n.ownerDocument;for(let r=n;r&&(t.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),n!=e);r=po(r));return t}function e1({refDOM:n,refTop:t,stack:e}){let r=n?n.getBoundingClientRect().top:0;Ih(e,r==0?0:r-t)}function Ih(n,t){for(let e=0;e<n.length;e++){let{dom:r,top:i,left:a}=n[e];r.scrollTop!=i+t&&(r.scrollTop=i+t),r.scrollLeft!=a&&(r.scrollLeft=a)}}let Tr=null;function n1(n){if(n.setActive)return n.setActive();if(Tr)return n.focus(Tr);let t=Rh(n);n.focus(Tr==null?{get preventScroll(){return Tr={preventScroll:!0},!0}}:void 0),Tr||(Tr=!1,Ih(t,0))}function zh(n,t){let e,r=2e8,i,a=0,l=t.top,c=t.top;for(let h=n.firstChild,d=0;h;h=h.nextSibling,d++){let m;if(h.nodeType==1)m=h.getClientRects();else if(h.nodeType==3)m=hn(h).getClientRects();else continue;for(let y=0;y<m.length;y++){let v=m[y];if(v.top<=l&&v.bottom>=c){l=Math.max(v.bottom,l),c=Math.min(v.top,c);let b=v.left>t.left?v.left-t.left:v.right<t.left?t.left-v.right:0;if(b<r){e=h,r=b,i=b&&e.nodeType==3?{left:v.right<t.left?v.right:v.left,top:t.top}:t,h.nodeType==1&&b&&(a=d+(t.left>=(v.left+v.right)/2?1:0));continue}}!e&&(t.left>=v.right&&t.top>=v.top||t.left>=v.left&&t.top>=v.bottom)&&(a=d+1)}}return e&&e.nodeType==3?r1(e,i):!e||r&&e.nodeType==1?{node:n,offset:a}:zh(e,i)}function r1(n,t){let e=n.nodeValue.length,r=document.createRange();for(let i=0;i<e;i++){r.setEnd(n,i+1),r.setStart(n,i);let a=Rn(r,1);if(a.top!=a.bottom&&Gs(t,a))return{node:n,offset:i+(t.left>=(a.left+a.right)/2?1:0)}}return{node:n,offset:0}}function Gs(n,t){return n.left>=t.left-1&&n.left<=t.right+1&&n.top>=t.top-1&&n.top<=t.bottom+1}function o1(n,t){let e=n.parentNode;return e&&/^li$/i.test(e.nodeName)&&t.left<n.getBoundingClientRect().left?e:n}function i1(n,t,e){let{node:r,offset:i}=zh(t,e),a=-1;if(r.nodeType==1&&!r.firstChild){let l=r.getBoundingClientRect();a=l.left!=l.right&&e.left>(l.left+l.right)/2?1:-1}return n.docView.posFromDOM(r,i,a)}function s1(n,t,e,r){let i=-1;for(let a=t;a!=n.dom;){let l=n.docView.nearestDesc(a,!0);if(!l)return null;if(l.dom.nodeType==1&&(l.node.isBlock&&l.parent||!l.contentDOM)){let c=l.dom.getBoundingClientRect();if(l.node.isBlock&&l.parent&&(c.left>r.left||c.top>r.top?i=l.posBefore:(c.right<r.left||c.bottom<r.top)&&(i=l.posAfter)),!l.contentDOM&&i<0)return(l.node.isBlock?r.top<(c.top+c.bottom)/2:r.left<(c.left+c.right)/2)?l.posBefore:l.posAfter}a=l.dom.parentNode}return i>-1?i:n.docView.posFromDOM(t,e,-1)}function jh(n,t,e){let r=n.childNodes.length;if(r&&e.top<e.bottom)for(let i=Math.max(0,Math.min(r-1,Math.floor(r*(t.top-e.top)/(e.bottom-e.top))-2)),a=i;;){let l=n.childNodes[a];if(l.nodeType==1){let c=l.getClientRects();for(let h=0;h<c.length;h++){let d=c[h];if(Gs(t,d))return jh(l,t,d)}}if((a=(a+1)%r)==i)break}return n}function a1(n,t){let e=n.dom.ownerDocument,r,i=0;if(e.caretPositionFromPoint)try{let h=e.caretPositionFromPoint(t.left,t.top);h&&({offsetNode:r,offset:i}=h)}catch{}if(!r&&e.caretRangeFromPoint){let h=e.caretRangeFromPoint(t.left,t.top);h&&({startContainer:r,startOffset:i}=h)}let a=(n.root.elementFromPoint?n.root:e).elementFromPoint(t.left,t.top),l;if(!a||!n.dom.contains(a.nodeType!=1?a.parentNode:a)){let h=n.dom.getBoundingClientRect();if(!Gs(t,h)||(a=jh(n.dom,t,h),!a))return null}if(Wt)for(let h=a;r&&h;h=po(h))h.draggable&&(r=void 0);if(a=o1(a,t),r){if(Te&&r.nodeType==1&&(i=Math.min(i,r.childNodes.length),i<r.childNodes.length)){let h=r.childNodes[i],d;h.nodeName=="IMG"&&(d=h.getBoundingClientRect()).right<=t.left&&d.bottom>t.top&&i++}r==n.dom&&i==r.childNodes.length-1&&r.lastChild.nodeType==1&&t.top>r.lastChild.getBoundingClientRect().bottom?l=n.state.doc.content.size:(i==0||r.nodeType!=1||r.childNodes[i-1].nodeName!="BR")&&(l=s1(n,r,i,t))}l==null&&(l=i1(n,a,t));let c=n.docView.nearestDesc(a,!0);return{pos:l,inside:c?c.posAtStart-c.border:-1}}function Rn(n,t){let e=n.getClientRects();return e.length?e[t<0?0:e.length-1]:n.getBoundingClientRect()}const l1=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function Ph(n,t,e){let{node:r,offset:i,atom:a}=n.docView.domFromPos(t,e<0?-1:1),l=_i||Te;if(r.nodeType==3)if(l&&(l1.test(r.nodeValue)||(e<0?!i:i==r.nodeValue.length))){let c=Rn(hn(r,i,i),e);if(Te&&i&&/\s/.test(r.nodeValue[i-1])&&i<r.nodeValue.length){let h=Rn(hn(r,i-1,i-1),-1);if(h.top==c.top){let d=Rn(hn(r,i,i+1),-1);if(d.top!=c.top)return mo(d,d.left<h.left)}}return c}else{let c=i,h=i,d=e<0?1:-1;return e<0&&!i?(h++,d=-1):e>=0&&i==r.nodeValue.length?(c--,d=1):e<0?c--:h++,mo(Rn(hn(r,c,h),1),d<0)}if(!n.state.doc.resolve(t-(a||0)).parent.inlineContent){if(a==null&&i&&(e<0||i==qe(r))){let c=r.childNodes[i-1];if(c.nodeType==1)return Zs(c.getBoundingClientRect(),!1)}if(a==null&&i<qe(r)){let c=r.childNodes[i];if(c.nodeType==1)return Zs(c.getBoundingClientRect(),!0)}return Zs(r.getBoundingClientRect(),e>=0)}if(a==null&&i&&(e<0||i==qe(r))){let c=r.childNodes[i-1],h=c.nodeType==3?hn(c,qe(c)-(l?0:1)):c.nodeType==1&&(c.nodeName!="BR"||!c.nextSibling)?c:null;if(h)return mo(Rn(h,1),!1)}if(a==null&&i<qe(r)){let c=r.childNodes[i];for(;c.pmViewDesc&&c.pmViewDesc.ignoreForCoords;)c=c.nextSibling;let h=c?c.nodeType==3?hn(c,0,l?0:1):c.nodeType==1?c:null:null;if(h)return mo(Rn(h,-1),!0)}return mo(Rn(r.nodeType==3?hn(r):r,-e),e>=0)}function mo(n,t){if(n.width==0)return n;let e=t?n.left:n.right;return{top:n.top,bottom:n.bottom,left:e,right:e}}function Zs(n,t){if(n.height==0)return n;let e=t?n.top:n.bottom;return{top:e,bottom:e,left:n.left,right:n.right}}function Bh(n,t,e){let r=n.state,i=n.root.activeElement;r!=t&&n.updateState(t),i!=n.dom&&n.focus();try{return e()}finally{r!=t&&n.updateState(r),i!=n.dom&&i&&i.focus()}}function c1(n,t,e){let r=t.selection,i=e=="up"?r.$from:r.$to;return Bh(n,t,()=>{let{node:a}=n.docView.domFromPos(i.pos,e=="up"?-1:1);for(;;){let c=n.docView.nearestDesc(a,!0);if(!c)break;if(c.node.isBlock){a=c.contentDOM||c.dom;break}a=c.dom.parentNode}let l=Ph(n,i.pos,1);for(let c=a.firstChild;c;c=c.nextSibling){let h;if(c.nodeType==1)h=c.getClientRects();else if(c.nodeType==3)h=hn(c,0,c.nodeValue.length).getClientRects();else continue;for(let d=0;d<h.length;d++){let m=h[d];if(m.bottom>m.top+1&&(e=="up"?l.top-m.top>(m.bottom-l.top)*2:m.bottom-l.bottom>(l.bottom-m.top)*2))return!1}}return!0})}const u1=/[\u0590-\u08ac]/;function h1(n,t,e){let{$head:r}=t.selection;if(!r.parent.isTextblock)return!1;let i=r.parentOffset,a=!i,l=i==r.parent.content.size,c=n.domSelection();return!u1.test(r.parent.textContent)||!c.modify?e=="left"||e=="backward"?a:l:Bh(n,t,()=>{let{focusNode:h,focusOffset:d,anchorNode:m,anchorOffset:y}=n.domSelectionRange(),v=c.caretBidiLevel;c.modify("move",e,"character");let b=r.depth?n.docView.domAfterPos(r.before()):n.dom,{focusNode:C,focusOffset:N}=n.domSelectionRange(),P=C&&!b.contains(C.nodeType==1?C:C.parentNode)||h==C&&d==N;try{c.collapse(m,y),h&&(h!=m||d!=y)&&c.extend&&c.extend(h,d)}catch{}return v!=null&&(c.caretBidiLevel=v),P})}let $h=null,Fh=null,Vh=!1;function f1(n,t,e){return $h==t&&Fh==e?Vh:($h=t,Fh=e,Vh=e=="up"||e=="down"?c1(n,t,e):h1(n,t,e))}const Ee=0,Lh=1,Nr=2,Je=3;class go{constructor(t,e,r,i){this.parent=t,this.children=e,this.dom=r,this.contentDOM=i,this.dirty=Ee,r.pmViewDesc=this}matchesWidget(t){return!1}matchesMark(t){return!1}matchesNode(t,e,r){return!1}matchesHack(t){return!1}parseRule(){return null}stopEvent(t){return!1}get size(){let t=0;for(let e=0;e<this.children.length;e++)t+=this.children[e].size;return t}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let t=0;t<this.children.length;t++)this.children[t].destroy()}posBeforeChild(t){for(let e=0,r=this.posAtStart;;e++){let i=this.children[e];if(i==t)return r;r+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(t,e,r){if(this.contentDOM&&this.contentDOM.contains(t.nodeType==1?t:t.parentNode))if(r<0){let a,l;if(t==this.contentDOM)a=t.childNodes[e-1];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;a=t.previousSibling}for(;a&&!((l=a.pmViewDesc)&&l.parent==this);)a=a.previousSibling;return a?this.posBeforeChild(l)+l.size:this.posAtStart}else{let a,l;if(t==this.contentDOM)a=t.childNodes[e];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;a=t.nextSibling}for(;a&&!((l=a.pmViewDesc)&&l.parent==this);)a=a.nextSibling;return a?this.posBeforeChild(l):this.posAtEnd}let i;if(t==this.dom&&this.contentDOM)i=e>ae(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=t.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(e==0)for(let a=t;;a=a.parentNode){if(a==this.dom){i=!1;break}if(a.previousSibling)break}if(i==null&&e==t.childNodes.length)for(let a=t;;a=a.parentNode){if(a==this.dom){i=!0;break}if(a.nextSibling)break}}return(i!=null?i:r>0)?this.posAtEnd:this.posAtStart}nearestDesc(t,e=!1){for(let r=!0,i=t;i;i=i.parentNode){let a=this.getDesc(i),l;if(a&&(!e||a.node))if(r&&(l=a.nodeDOM)&&!(l.nodeType==1?l.contains(t.nodeType==1?t:t.parentNode):l==t))r=!1;else return a}}getDesc(t){let e=t.pmViewDesc;for(let r=e;r;r=r.parent)if(r==this)return e}posFromDOM(t,e,r){for(let i=t;i;i=i.parentNode){let a=this.getDesc(i);if(a)return a.localPosFromDOM(t,e,r)}return-1}descAt(t){for(let e=0,r=0;e<this.children.length;e++){let i=this.children[e],a=r+i.size;if(r==t&&a!=r){for(;!i.border&&i.children.length;)i=i.children[0];return i}if(t<a)return i.descAt(t-r-i.border);r=a}}domFromPos(t,e){if(!this.contentDOM)return{node:this.dom,offset:0,atom:t+1};let r=0,i=0;for(let a=0;r<this.children.length;r++){let l=this.children[r],c=a+l.size;if(c>t||l instanceof Jh){i=t-a;break}a=c}if(i)return this.children[r].domFromPos(i-this.children[r].border,e);for(let a;r&&!(a=this.children[r-1]).size&&a instanceof Wh&&a.side>=0;r--);if(e<=0){let a,l=!0;for(;a=r?this.children[r-1]:null,!(!a||a.dom.parentNode==this.contentDOM);r--,l=!1);return a&&e&&l&&!a.border&&!a.domAtom?a.domFromPos(a.size,e):{node:this.contentDOM,offset:a?ae(a.dom)+1:0}}else{let a,l=!0;for(;a=r<this.children.length?this.children[r]:null,!(!a||a.dom.parentNode==this.contentDOM);r++,l=!1);return a&&l&&!a.border&&!a.domAtom?a.domFromPos(0,e):{node:this.contentDOM,offset:a?ae(a.dom):this.contentDOM.childNodes.length}}}parseRange(t,e,r=0){if(this.children.length==0)return{node:this.contentDOM,from:t,to:e,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,a=-1;for(let l=r,c=0;;c++){let h=this.children[c],d=l+h.size;if(i==-1&&t<=d){let m=l+h.border;if(t>=m&&e<=d-h.border&&h.node&&h.contentDOM&&this.contentDOM.contains(h.contentDOM))return h.parseRange(t,e,m);t=l;for(let y=c;y>0;y--){let v=this.children[y-1];if(v.size&&v.dom.parentNode==this.contentDOM&&!v.emptyChildAt(1)){i=ae(v.dom)+1;break}t-=v.size}i==-1&&(i=0)}if(i>-1&&(d>e||c==this.children.length-1)){e=d;for(let m=c+1;m<this.children.length;m++){let y=this.children[m];if(y.size&&y.dom.parentNode==this.contentDOM&&!y.emptyChildAt(-1)){a=ae(y.dom);break}e+=y.size}a==-1&&(a=this.contentDOM.childNodes.length);break}l=d}return{node:this.contentDOM,from:t,to:e,fromOffset:i,toOffset:a}}emptyChildAt(t){if(this.border||!this.contentDOM||!this.children.length)return!1;let e=this.children[t<0?0:this.children.length-1];return e.size==0||e.emptyChildAt(t)}domAfterPos(t){let{node:e,offset:r}=this.domFromPos(t,0);if(e.nodeType!=1||r==e.childNodes.length)throw new RangeError("No node after pos "+t);return e.childNodes[r]}setSelection(t,e,r,i=!1){let a=Math.min(t,e),l=Math.max(t,e);for(let v=0,b=0;v<this.children.length;v++){let C=this.children[v],N=b+C.size;if(a>b&&l<N)return C.setSelection(t-b-C.border,e-b-C.border,r,i);b=N}let c=this.domFromPos(t,t?-1:1),h=e==t?c:this.domFromPos(e,e?-1:1),d=r.getSelection(),m=!1;if((Te||Wt)&&t==e){let{node:v,offset:b}=c;if(v.nodeType==3){if(m=!!(b&&v.nodeValue[b-1]==`
`),m&&b==v.nodeValue.length)for(let C=v,N;C;C=C.parentNode){if(N=C.nextSibling){N.nodeName=="BR"&&(c=h={node:N.parentNode,offset:ae(N)+1});break}let P=C.pmViewDesc;if(P&&P.node&&P.node.isBlock)break}}else{let C=v.childNodes[b-1];m=C&&(C.nodeName=="BR"||C.contentEditable=="false")}}if(Te&&d.focusNode&&d.focusNode!=h.node&&d.focusNode.nodeType==1){let v=d.focusNode.childNodes[d.focusOffset];v&&v.contentEditable=="false"&&(i=!0)}if(!(i||m&&Wt)&&tr(c.node,c.offset,d.anchorNode,d.anchorOffset)&&tr(h.node,h.offset,d.focusNode,d.focusOffset))return;let y=!1;if((d.extend||t==e)&&!m){d.collapse(c.node,c.offset);try{t!=e&&d.extend(h.node,h.offset),y=!0}catch{}}if(!y){if(t>e){let b=c;c=h,h=b}let v=document.createRange();v.setEnd(h.node,h.offset),v.setStart(c.node,c.offset),d.removeAllRanges(),d.addRange(v)}}ignoreMutation(t){return!this.contentDOM&&t.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(t,e){for(let r=0,i=0;i<this.children.length;i++){let a=this.children[i],l=r+a.size;if(r==l?t<=l&&e>=r:t<l&&e>r){let c=r+a.border,h=l-a.border;if(t>=c&&e<=h){this.dirty=t==r||e==l?Nr:Lh,t==c&&e==h&&(a.contentLost||a.dom.parentNode!=this.contentDOM)?a.dirty=Je:a.markDirty(t-c,e-c);return}else a.dirty=a.dom==a.contentDOM&&a.dom.parentNode==this.contentDOM&&!a.children.length?Nr:Je}r=l}this.dirty=Nr}markParentsDirty(){let t=1;for(let e=this.parent;e;e=e.parent,t++){let r=t==1?Nr:Lh;e.dirty<r&&(e.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}}class Wh extends go{constructor(t,e,r,i){let a,l=e.type.toDOM;if(typeof l=="function"&&(l=l(r,()=>{if(!a)return i;if(a.parent)return a.parent.posBeforeChild(a)})),!e.type.spec.raw){if(l.nodeType!=1){let c=document.createElement("span");c.appendChild(l),l=c}l.contentEditable="false",l.classList.add("ProseMirror-widget")}super(t,[],l,null),this.widget=e,this.widget=e,a=this}matchesWidget(t){return this.dirty==Ee&&t.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(t){let e=this.widget.spec.stopEvent;return e?e(t):!1}ignoreMutation(t){return t.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class d1 extends go{constructor(t,e,r,i){super(t,[],e,null),this.textDOM=r,this.text=i}get size(){return this.text.length}localPosFromDOM(t,e){return t!=this.textDOM?this.posAtStart+(e?this.size:0):this.posAtStart+e}domFromPos(t){return{node:this.textDOM,offset:t}}ignoreMutation(t){return t.type==="characterData"&&t.target.nodeValue==t.oldValue}}class nr extends go{constructor(t,e,r,i){super(t,[],r,i),this.mark=e}static create(t,e,r,i){let a=i.nodeViews[e.type.name],l=a&&a(e,i,r);return(!l||!l.dom)&&(l=cn.renderSpec(document,e.type.spec.toDOM(e,r))),new nr(t,e,l.dom,l.contentDOM||l.dom)}parseRule(){return this.dirty&Je||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM||void 0}}matchesMark(t){return this.dirty!=Je&&this.mark.eq(t)}markDirty(t,e){if(super.markDirty(t,e),this.dirty!=Ee){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=Ee}}slice(t,e,r){let i=nr.create(this.parent,this.mark,!0,r),a=this.children,l=this.size;e<l&&(a=Xs(a,e,l,r)),t>0&&(a=Xs(a,0,t,r));for(let c=0;c<a.length;c++)a[c].parent=i;return i.children=a,i}}class rr extends go{constructor(t,e,r,i,a,l,c,h,d){super(t,[],a,l),this.node=e,this.outerDeco=r,this.innerDeco=i,this.nodeDOM=c,l&&this.updateChildren(h,d)}static create(t,e,r,i,a,l){let c=a.nodeViews[e.type.name],h,d=c&&c(e,a,()=>{if(!h)return l;if(h.parent)return h.parent.posBeforeChild(h)},r,i),m=d&&d.dom,y=d&&d.contentDOM;if(e.isText){if(!m)m=document.createTextNode(e.text);else if(m.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else m||({dom:m,contentDOM:y}=cn.renderSpec(document,e.type.spec.toDOM(e)));!y&&!e.isText&&m.nodeName!="BR"&&(m.hasAttribute("contenteditable")||(m.contentEditable="false"),e.type.spec.draggable&&(m.draggable=!0));let v=m;return m=Uh(m,r,e),d?h=new p1(t,e,r,i,m,y||null,v,d,a,l+1):e.isText?new yi(t,e,r,i,m,v,a):new rr(t,e,r,i,m,y||null,v,a,l+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let t={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(t.preserveWhitespace="full"),!this.contentDOM)t.getContent=()=>this.node.content;else if(!this.contentLost)t.contentElement=this.contentDOM;else{for(let e=this.children.length-1;e>=0;e--){let r=this.children[e];if(this.dom.contains(r.dom.parentNode)){t.contentElement=r.dom.parentNode;break}}t.contentElement||(t.getContent=()=>B.empty)}return t}matchesNode(t,e,r){return this.dirty==Ee&&t.eq(this.node)&&Qs(e,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(t,e){let r=this.node.inlineContent,i=e,a=t.composing?this.localCompositionInfo(t,e):null,l=a&&a.pos>-1?a:null,c=a&&a.pos<0,h=new g1(this,l&&l.node,t);b1(this.node,this.innerDeco,(d,m,y)=>{d.spec.marks?h.syncToMarks(d.spec.marks,r,t):d.type.side>=0&&!y&&h.syncToMarks(m==this.node.childCount?ct.none:this.node.child(m).marks,r,t),h.placeWidget(d,t,i)},(d,m,y,v)=>{h.syncToMarks(d.marks,r,t);let b;h.findNodeMatch(d,m,y,v)||c&&t.state.selection.from>i&&t.state.selection.to<i+d.nodeSize&&(b=h.findIndexWithChild(a.node))>-1&&h.updateNodeAt(d,m,y,b,t)||h.updateNextNode(d,m,y,t,v)||h.addNode(d,m,y,t,i),i+=d.nodeSize}),h.syncToMarks([],r,t),this.node.isTextblock&&h.addTextblockHacks(),h.destroyRest(),(h.changed||this.dirty==Nr)&&(l&&this.protectLocalComposition(t,l),Hh(this.contentDOM,this.children,t),Ar&&w1(this.dom))}localCompositionInfo(t,e){let{from:r,to:i}=t.state.selection;if(!(t.state.selection instanceof pt)||r<e||i>e+this.node.content.size)return null;let a=t.domSelectionRange(),l=v1(a.focusNode,a.focusOffset);if(!l||!this.dom.contains(l.parentNode))return null;if(this.node.inlineContent){let c=l.nodeValue,h=k1(this.node.content,c,r-e,i-e);return h<0?null:{node:l,pos:h,text:c}}else return{node:l,pos:-1,text:""}}protectLocalComposition(t,{node:e,pos:r,text:i}){if(this.getDesc(e))return;let a=e;for(;a.parentNode!=this.contentDOM;a=a.parentNode){for(;a.previousSibling;)a.parentNode.removeChild(a.previousSibling);for(;a.nextSibling;)a.parentNode.removeChild(a.nextSibling);a.pmViewDesc&&(a.pmViewDesc=void 0)}let l=new d1(this,a,e,i);t.input.compositionNodes.push(l),this.children=Xs(this.children,r,r+i.length,t,l)}update(t,e,r,i){return this.dirty==Je||!t.sameMarkup(this.node)?!1:(this.updateInner(t,e,r,i),!0)}updateInner(t,e,r,i){this.updateOuterDeco(e),this.node=t,this.innerDeco=r,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=Ee}updateOuterDeco(t){if(Qs(t,this.outerDeco))return;let e=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=Kh(this.dom,this.nodeDOM,Ys(this.outerDeco,this.node,e),Ys(t,this.node,e)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=t}selectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable")}get domAtom(){return this.node.isAtom}}function qh(n,t,e,r,i){return Uh(r,t,n),new rr(void 0,n,t,e,r,r,r,i,0)}class yi extends rr{constructor(t,e,r,i,a,l,c){super(t,e,r,i,a,null,l,c,0)}parseRule(){let t=this.nodeDOM.parentNode;for(;t&&t!=this.dom&&!t.pmIsDeco;)t=t.parentNode;return{skip:t||!0}}update(t,e,r,i){return this.dirty==Je||this.dirty!=Ee&&!this.inParent()||!t.sameMarkup(this.node)?!1:(this.updateOuterDeco(e),(this.dirty!=Ee||t.text!=this.node.text)&&t.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=t.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=t,this.dirty=Ee,!0)}inParent(){let t=this.parent.contentDOM;for(let e=this.nodeDOM;e;e=e.parentNode)if(e==t)return!0;return!1}domFromPos(t){return{node:this.nodeDOM,offset:t}}localPosFromDOM(t,e,r){return t==this.nodeDOM?this.posAtStart+Math.min(e,this.node.text.length):super.localPosFromDOM(t,e,r)}ignoreMutation(t){return t.type!="characterData"&&t.type!="selection"}slice(t,e,r){let i=this.node.cut(t,e),a=document.createTextNode(i.text);return new yi(this.parent,i,this.outerDeco,this.innerDeco,a,a,r)}markDirty(t,e){super.markDirty(t,e),this.dom!=this.nodeDOM&&(t==0||e==this.nodeDOM.nodeValue.length)&&(this.dirty=Je)}get domAtom(){return!1}}class Jh extends go{parseRule(){return{ignore:!0}}matchesHack(t){return this.dirty==Ee&&this.dom.nodeName==t}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class p1 extends rr{constructor(t,e,r,i,a,l,c,h,d,m){super(t,e,r,i,a,l,c,d,m),this.spec=h}update(t,e,r,i){if(this.dirty==Je)return!1;if(this.spec.update){let a=this.spec.update(t,e,r);return a&&this.updateInner(t,e,r,i),a}else return!this.contentDOM&&!t.isLeaf?!1:super.update(t,e,r,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(t,e,r,i){this.spec.setSelection?this.spec.setSelection(t,e,r):super.setSelection(t,e,r,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(t){return this.spec.stopEvent?this.spec.stopEvent(t):!1}ignoreMutation(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):super.ignoreMutation(t)}}function Hh(n,t,e){let r=n.firstChild,i=!1;for(let a=0;a<t.length;a++){let l=t[a],c=l.dom;if(c.parentNode==n){for(;c!=r;)r=Gh(r),i=!0;r=r.nextSibling}else i=!0,n.insertBefore(c,r);if(l instanceof nr){let h=r?r.previousSibling:n.lastChild;Hh(l.contentDOM,l.children,e),r=h?h.nextSibling:n.firstChild}}for(;r;)r=Gh(r),i=!0;i&&e.trackWrites==n&&(e.trackWrites=null)}const _o=function(n){n&&(this.nodeName=n)};_o.prototype=Object.create(null);const or=[new _o];function Ys(n,t,e){if(n.length==0)return or;let r=e?or[0]:new _o,i=[r];for(let a=0;a<n.length;a++){let l=n[a].type.attrs;if(l){l.nodeName&&i.push(r=new _o(l.nodeName));for(let c in l){let h=l[c];h!=null&&(e&&i.length==1&&i.push(r=new _o(t.isInline?"span":"div")),c=="class"?r.class=(r.class?r.class+" ":"")+h:c=="style"?r.style=(r.style?r.style+";":"")+h:c!="nodeName"&&(r[c]=h))}}}return i}function Kh(n,t,e,r){if(e==or&&r==or)return t;let i=t;for(let a=0;a<r.length;a++){let l=r[a],c=e[a];if(a){let h;c&&c.nodeName==l.nodeName&&i!=n&&(h=i.parentNode)&&h.nodeName.toLowerCase()==l.nodeName||(h=document.createElement(l.nodeName),h.pmIsDeco=!0,h.appendChild(i),c=or[0]),i=h}m1(i,c||or[0],l)}return i}function m1(n,t,e){for(let r in t)r!="class"&&r!="style"&&r!="nodeName"&&!(r in e)&&n.removeAttribute(r);for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&e[r]!=t[r]&&n.setAttribute(r,e[r]);if(t.class!=e.class){let r=t.class?t.class.split(" ").filter(Boolean):[],i=e.class?e.class.split(" ").filter(Boolean):[];for(let a=0;a<r.length;a++)i.indexOf(r[a])==-1&&n.classList.remove(r[a]);for(let a=0;a<i.length;a++)r.indexOf(i[a])==-1&&n.classList.add(i[a]);n.classList.length==0&&n.removeAttribute("class")}if(t.style!=e.style){if(t.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,i;for(;i=r.exec(t.style);)n.style.removeProperty(i[1])}e.style&&(n.style.cssText+=e.style)}}function Uh(n,t,e){return Kh(n,n,or,Ys(t,e,n.nodeType!=1))}function Qs(n,t){if(n.length!=t.length)return!1;for(let e=0;e<n.length;e++)if(!n[e].type.eq(t[e].type))return!1;return!0}function Gh(n){let t=n.nextSibling;return n.parentNode.removeChild(n),t}class g1{constructor(t,e,r){this.lock=e,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=t,this.preMatch=_1(t.node.content,t)}destroyBetween(t,e){if(t!=e){for(let r=t;r<e;r++)this.top.children[r].destroy();this.top.children.splice(t,e-t),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(t,e,r){let i=0,a=this.stack.length>>1,l=Math.min(a,t.length);for(;i<l&&(i==a-1?this.top:this.stack[i+1<<1]).matchesMark(t[i])&&t[i].type.spec.spanning!==!1;)i++;for(;i<a;)this.destroyRest(),this.top.dirty=Ee,this.index=this.stack.pop(),this.top=this.stack.pop(),a--;for(;a<t.length;){this.stack.push(this.top,this.index+1);let c=-1;for(let h=this.index;h<Math.min(this.index+3,this.top.children.length);h++){let d=this.top.children[h];if(d.matchesMark(t[a])&&!this.isLocked(d.dom)){c=h;break}}if(c>-1)c>this.index&&(this.changed=!0,this.destroyBetween(this.index,c)),this.top=this.top.children[this.index];else{let h=nr.create(this.top,t[a],e,r);this.top.children.splice(this.index,0,h),this.top=h,this.changed=!0}this.index=0,a++}}findNodeMatch(t,e,r,i){let a=-1,l;if(i>=this.preMatch.index&&(l=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&l.matchesNode(t,e,r))a=this.top.children.indexOf(l,this.index);else for(let c=this.index,h=Math.min(this.top.children.length,c+5);c<h;c++){let d=this.top.children[c];if(d.matchesNode(t,e,r)&&!this.preMatch.matched.has(d)){a=c;break}}return a<0?!1:(this.destroyBetween(this.index,a),this.index++,!0)}updateNodeAt(t,e,r,i,a){let l=this.top.children[i];return l.dirty==Je&&l.dom==l.contentDOM&&(l.dirty=Nr),l.update(t,e,r,a)?(this.destroyBetween(this.index,i),this.index++,!0):!1}findIndexWithChild(t){for(;;){let e=t.parentNode;if(!e)return-1;if(e==this.top.contentDOM){let r=t.pmViewDesc;if(r){for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==r)return i}return-1}t=e}}updateNextNode(t,e,r,i,a){for(let l=this.index;l<this.top.children.length;l++){let c=this.top.children[l];if(c instanceof rr){let h=this.preMatch.matched.get(c);if(h!=null&&h!=a)return!1;let d=c.dom;if(!(this.isLocked(d)&&!(t.isText&&c.node&&c.node.isText&&c.nodeDOM.nodeValue==t.text&&c.dirty!=Je&&Qs(e,c.outerDeco)))&&c.update(t,e,r,i))return this.destroyBetween(this.index,l),c.dom!=d&&(this.changed=!0),this.index++,!0;break}}return!1}addNode(t,e,r,i,a){this.top.children.splice(this.index++,0,rr.create(this.top,t,e,r,i,a)),this.changed=!0}placeWidget(t,e,r){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(i&&i.matchesWidget(t)&&(t==i.widget||!i.widget.type.toDOM.parentNode))this.index++;else{let a=new Wh(this.top,t,e,r);this.top.children.splice(this.index++,0,a),this.changed=!0}}addTextblockHacks(){let t=this.top.children[this.index-1],e=this.top;for(;t instanceof nr;)e=t,t=e.children[e.children.length-1];(!t||!(t instanceof yi)||/\n$/.test(t.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(t.node.text))&&((Wt||Lt)&&t&&t.dom.contentEditable=="false"&&this.addHackNode("IMG",e),this.addHackNode("BR",this.top))}addHackNode(t,e){if(e==this.top&&this.index<e.children.length&&e.children[this.index].matchesHack(t))this.index++;else{let r=document.createElement(t);t=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),t=="BR"&&(r.className="ProseMirror-trailingBreak");let i=new Jh(this.top,[],r,null);e!=this.top?e.children.push(i):e.children.splice(this.index++,0,i),this.changed=!0}}isLocked(t){return this.lock&&(t==this.lock||t.nodeType==1&&t.contains(this.lock.parentNode))}}function _1(n,t){let e=t,r=e.children.length,i=n.childCount,a=new Map,l=[];t:for(;i>0;){let c;for(;;)if(r){let d=e.children[r-1];if(d instanceof nr)e=d,r=d.children.length;else{c=d,r--;break}}else{if(e==t)break t;r=e.parent.children.indexOf(e),e=e.parent}let h=c.node;if(h){if(h!=n.child(i-1))break;--i,a.set(c,i),l.push(c)}}return{index:i,matched:a,matches:l.reverse()}}function y1(n,t){return n.type.side-t.type.side}function b1(n,t,e,r){let i=t.locals(n),a=0;if(i.length==0){for(let d=0;d<n.childCount;d++){let m=n.child(d);r(m,i,t.forChild(a,m),d),a+=m.nodeSize}return}let l=0,c=[],h=null;for(let d=0;;){if(l<i.length&&i[l].to==a){let C=i[l++],N;for(;l<i.length&&i[l].to==a;)(N||(N=[C])).push(i[l++]);if(N){N.sort(y1);for(let P=0;P<N.length;P++)e(N[P],d,!!h)}else e(C,d,!!h)}let m,y;if(h)y=-1,m=h,h=null;else if(d<n.childCount)y=d,m=n.child(d++);else break;for(let C=0;C<c.length;C++)c[C].to<=a&&c.splice(C--,1);for(;l<i.length&&i[l].from<=a&&i[l].to>a;)c.push(i[l++]);let v=a+m.nodeSize;if(m.isText){let C=v;l<i.length&&i[l].from<C&&(C=i[l].from);for(let N=0;N<c.length;N++)c[N].to<C&&(C=c[N].to);C<v&&(h=m.cut(C-a),m=m.cut(0,C-a),v=C,y=-1)}let b=m.isInline&&!m.isLeaf?c.filter(C=>!C.inline):c.slice();r(m,b,t.forChild(a,m),y),a=v}}function w1(n){if(n.nodeName=="UL"||n.nodeName=="OL"){let t=n.style.cssText;n.style.cssText=t+"; list-style: square !important",window.getComputedStyle(n).listStyle,n.style.cssText=t}}function v1(n,t){for(;;){if(n.nodeType==3)return n;if(n.nodeType==1&&t>0){if(n.childNodes.length>t&&n.childNodes[t].nodeType==3)return n.childNodes[t];n=n.childNodes[t-1],t=qe(n)}else if(n.nodeType==1&&t<n.childNodes.length)n=n.childNodes[t],t=0;else return null}}function k1(n,t,e,r){for(let i=0,a=0;i<n.childCount&&a<=r;){let l=n.child(i++),c=a;if(a+=l.nodeSize,!l.isText)continue;let h=l.text;for(;i<n.childCount;){let d=n.child(i++);if(a+=d.nodeSize,!d.isText)break;h+=d.text}if(a>=e){let d=c<r?h.lastIndexOf(t,r-c-1):-1;if(d>=0&&d+t.length+c>=e)return c+d;if(e==r&&h.length>=r+t.length-c&&h.slice(r-c,r-c+t.length)==t)return r}}return-1}function Xs(n,t,e,r,i){let a=[];for(let l=0,c=0;l<n.length;l++){let h=n[l],d=c,m=c+=h.size;d>=e||m<=t?a.push(h):(d<t&&a.push(h.slice(0,t-d,r)),i&&(a.push(i),i=void 0),m>e&&a.push(h.slice(e-d,h.size,r)))}return a}function ta(n,t=null){let e=n.domSelectionRange(),r=n.state.doc;if(!e.focusNode)return null;let i=n.docView.nearestDesc(e.focusNode),a=i&&i.size==0,l=n.docView.posFromDOM(e.focusNode,e.focusOffset,1);if(l<0)return null;let c=r.resolve(l),h,d;if(gi(e)){for(h=c;i&&!i.node;)i=i.parent;let m=i.node;if(i&&m.isAtom&&X.isSelectable(m)&&i.parent&&!(m.isInline&&K_(e.focusNode,e.focusOffset,i.dom))){let y=i.posBefore;d=new X(l==y?c:r.resolve(y))}}else{let m=n.docView.posFromDOM(e.anchorNode,e.anchorOffset,1);if(m<0)return null;h=r.resolve(m)}if(!d){let m=t=="pointer"||n.state.selection.head<c.pos&&!a?1:-1;d=na(n,h,c,m)}return d}function Zh(n){return n.editable?n.hasFocus():rf(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function fn(n,t=!1){let e=n.state.selection;if(tf(n,e),!!Zh(n)){if(!t&&n.input.mouseDown&&n.input.mouseDown.allowDefault&&Lt){let r=n.domSelectionRange(),i=n.domObserver.currentSelection;if(r.anchorNode&&i.anchorNode&&tr(r.anchorNode,r.anchorOffset,i.anchorNode,i.anchorOffset)){n.input.mouseDown.delayedSelectionSync=!0,n.domObserver.setCurSelection();return}}if(n.domObserver.disconnectSelection(),n.cursorWrapper)S1(n);else{let{anchor:r,head:i}=e,a,l;Yh&&!(e instanceof pt)&&(e.$from.parent.inlineContent||(a=Qh(n,e.from)),!e.empty&&!e.$from.parent.inlineContent&&(l=Qh(n,e.to))),n.docView.setSelection(r,i,n.root,t),Yh&&(a&&Xh(a),l&&Xh(l)),e.visible?n.dom.classList.remove("ProseMirror-hideselection"):(n.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&x1(n))}n.domObserver.setCurSelection(),n.domObserver.connectSelection()}}const Yh=Wt||Lt&&Z_<63;function Qh(n,t){let{node:e,offset:r}=n.docView.domFromPos(t,0),i=r<e.childNodes.length?e.childNodes[r]:null,a=r?e.childNodes[r-1]:null;if(Wt&&i&&i.contentEditable=="false")return ea(i);if((!i||i.contentEditable=="false")&&(!a||a.contentEditable=="false")){if(i)return ea(i);if(a)return ea(a)}}function ea(n){return n.contentEditable="true",Wt&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function Xh(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function x1(n){let t=n.dom.ownerDocument;t.removeEventListener("selectionchange",n.input.hideSelectionGuard);let e=n.domSelectionRange(),r=e.anchorNode,i=e.anchorOffset;t.addEventListener("selectionchange",n.input.hideSelectionGuard=()=>{(e.anchorNode!=r||e.anchorOffset!=i)&&(t.removeEventListener("selectionchange",n.input.hideSelectionGuard),setTimeout(()=>{(!Zh(n)||n.state.selection.visible)&&n.dom.classList.remove("ProseMirror-hideselection")},20))})}function S1(n){let t=n.domSelection(),e=document.createRange(),r=n.cursorWrapper.dom,i=r.nodeName=="IMG";i?e.setEnd(r.parentNode,ae(r)+1):e.setEnd(r,0),e.collapse(!1),t.removeAllRanges(),t.addRange(e),!i&&!n.state.selection.visible&&Yt&&En<=11&&(r.disabled=!0,r.disabled=!1)}function tf(n,t){if(t instanceof X){let e=n.docView.descAt(t.from);e!=n.lastSelectedViewDesc&&(ef(n),e&&e.selectNode(),n.lastSelectedViewDesc=e)}else ef(n)}function ef(n){n.lastSelectedViewDesc&&(n.lastSelectedViewDesc.parent&&n.lastSelectedViewDesc.deselectNode(),n.lastSelectedViewDesc=void 0)}function na(n,t,e,r){return n.someProp("createSelectionBetween",i=>i(n,t,e))||pt.between(t,e,r)}function nf(n){return n.editable&&!n.hasFocus()?!1:rf(n)}function rf(n){let t=n.domSelectionRange();if(!t.anchorNode)return!1;try{return n.dom.contains(t.anchorNode.nodeType==3?t.anchorNode.parentNode:t.anchorNode)&&(n.editable||n.dom.contains(t.focusNode.nodeType==3?t.focusNode.parentNode:t.focusNode))}catch{return!1}}function C1(n){let t=n.docView.domFromPos(n.state.selection.anchor,0),e=n.domSelectionRange();return tr(t.node,t.offset,e.anchorNode,e.anchorOffset)}function ra(n,t){let{$anchor:e,$head:r}=n.selection,i=t>0?e.max(r):e.min(r),a=i.parent.inlineContent?i.depth?n.doc.resolve(t>0?i.after():i.before()):null:i;return a&&ht.findFrom(a,t)}function ir(n,t){return n.dispatch(n.state.tr.setSelection(t).scrollIntoView()),!0}function of(n,t,e){let r=n.state.selection;if(r instanceof pt){if(!r.empty||e.indexOf("s")>-1)return!1;if(n.endOfTextblock(t>0?"right":"left")){let i=ra(n.state,t);return i&&i instanceof X?ir(n,i):!1}else if(!(_e&&e.indexOf("m")>-1)){let i=r.$head,a=i.textOffset?null:t<0?i.nodeBefore:i.nodeAfter,l;if(!a||a.isText)return!1;let c=t<0?i.pos-a.nodeSize:i.pos;return a.isAtom||(l=n.docView.descAt(c))&&!l.contentDOM?X.isSelectable(a)?ir(n,new X(t<0?n.state.doc.resolve(i.pos-a.nodeSize):i)):_i?ir(n,new pt(n.state.doc.resolve(t<0?c:c+a.nodeSize))):!1:!1}}else{if(r instanceof X&&r.node.isInline)return ir(n,new pt(t>0?r.$to:r.$from));{let i=ra(n.state,t);return i?ir(n,i):!1}}}function bi(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function yo(n){let t=n.pmViewDesc;return t&&t.size==0&&(n.nextSibling||n.nodeName!="BR")}function oa(n){let t=n.domSelectionRange(),e=t.focusNode,r=t.focusOffset;if(!e)return;let i,a,l=!1;for(Te&&e.nodeType==1&&r<bi(e)&&yo(e.childNodes[r])&&(l=!0);;)if(r>0){if(e.nodeType!=1)break;{let c=e.childNodes[r-1];if(yo(c))i=e,a=--r;else if(c.nodeType==3)e=c,r=e.nodeValue.length;else break}}else{if(sf(e))break;{let c=e.previousSibling;for(;c&&yo(c);)i=e.parentNode,a=ae(c),c=c.previousSibling;if(c)e=c,r=bi(e);else{if(e=e.parentNode,e==n.dom)break;r=0}}}l?sa(n,e,r):i&&sa(n,i,a)}function ia(n){let t=n.domSelectionRange(),e=t.focusNode,r=t.focusOffset;if(!e)return;let i=bi(e),a,l;for(;;)if(r<i){if(e.nodeType!=1)break;let c=e.childNodes[r];if(yo(c))a=e,l=++r;else break}else{if(sf(e))break;{let c=e.nextSibling;for(;c&&yo(c);)a=c.parentNode,l=ae(c)+1,c=c.nextSibling;if(c)e=c,r=0,i=bi(e);else{if(e=e.parentNode,e==n.dom)break;r=i=0}}}a&&sa(n,a,l)}function sf(n){let t=n.pmViewDesc;return t&&t.node&&t.node.isBlock}function sa(n,t,e){let r=n.domSelection();if(gi(r)){let a=document.createRange();a.setEnd(t,e),a.setStart(t,e),r.removeAllRanges(),r.addRange(a)}else r.extend&&r.extend(t,e);n.domObserver.setCurSelection();let{state:i}=n;setTimeout(()=>{n.state==i&&fn(n)},50)}function af(n,t,e){let r=n.state.selection;if(r instanceof pt&&!r.empty||e.indexOf("s")>-1||_e&&e.indexOf("m")>-1)return!1;let{$from:i,$to:a}=r;if(!i.parent.inlineContent||n.endOfTextblock(t<0?"up":"down")){let l=ra(n.state,t);if(l&&l instanceof X)return ir(n,l)}if(!i.parent.inlineContent){let l=t<0?i:a,c=r instanceof se?ht.near(l,t):ht.findFrom(l,t);return c?ir(n,c):!1}return!1}function lf(n,t){if(!(n.state.selection instanceof pt))return!0;let{$head:e,$anchor:r,empty:i}=n.state.selection;if(!e.sameParent(r))return!0;if(!i)return!1;if(n.endOfTextblock(t>0?"forward":"backward"))return!0;let a=!e.textOffset&&(t<0?e.nodeBefore:e.nodeAfter);if(a&&!a.isText){let l=n.state.tr;return t<0?l.delete(e.pos-a.nodeSize,e.pos):l.delete(e.pos,e.pos+a.nodeSize),n.dispatch(l),!0}return!1}function cf(n,t,e){n.domObserver.stop(),t.contentEditable=e,n.domObserver.start()}function O1(n){if(!Wt||n.state.selection.$head.parentOffset>0)return!1;let{focusNode:t,focusOffset:e}=n.domSelectionRange();if(t&&t.nodeType==1&&e==0&&t.firstChild&&t.firstChild.contentEditable=="false"){let r=t.firstChild;cf(n,r,"true"),setTimeout(()=>cf(n,r,"false"),20)}return!1}function M1(n){let t="";return n.ctrlKey&&(t+="c"),n.metaKey&&(t+="m"),n.altKey&&(t+="a"),n.shiftKey&&(t+="s"),t}function A1(n,t){let e=t.keyCode,r=M1(t);return e==8||_e&&e==72&&r=="c"?lf(n,-1)||oa(n):e==46||_e&&e==68&&r=="c"?lf(n,1)||ia(n):e==13||e==27?!0:e==37||_e&&e==66&&r=="c"?of(n,-1,r)||oa(n):e==39||_e&&e==70&&r=="c"?of(n,1,r)||ia(n):e==38||_e&&e==80&&r=="c"?af(n,-1,r)||oa(n):e==40||_e&&e==78&&r=="c"?O1(n)||af(n,1,r)||ia(n):r==(_e?"m":"c")&&(e==66||e==73||e==89||e==90)}function uf(n,t){n.someProp("transformCopied",b=>{t=b(t,n)});let e=[],{content:r,openStart:i,openEnd:a}=t;for(;i>1&&a>1&&r.childCount==1&&r.firstChild.childCount==1;){i--,a--;let b=r.firstChild;e.push(b.type.name,b.attrs!=b.type.defaultAttrs?b.attrs:null),r=b.content}let l=n.someProp("clipboardSerializer")||cn.fromSchema(n.state.schema),c=yf(),h=c.createElement("div");h.appendChild(l.serializeFragment(r,{document:c}));let d=h.firstChild,m,y=0;for(;d&&d.nodeType==1&&(m=gf[d.nodeName.toLowerCase()]);){for(let b=m.length-1;b>=0;b--){let C=c.createElement(m[b]);for(;h.firstChild;)C.appendChild(h.firstChild);h.appendChild(C),y++}d=h.firstChild}d&&d.nodeType==1&&d.setAttribute("data-pm-slice",`${i} ${a}${y?` -${y}`:""} ${JSON.stringify(e)}`);let v=n.someProp("clipboardTextSerializer",b=>b(t,n))||t.content.textBetween(0,t.content.size,`

`);return{dom:h,text:v}}function hf(n,t,e,r,i){let a=i.parent.type.spec.code,l,c;if(!e&&!t)return null;let h=t&&(r||a||!e);if(h){if(n.someProp("transformPastedText",v=>{t=v(t,a||r,n)}),a)return t?new q(B.from(n.state.schema.text(t.replace(/\r\n?/g,`
`))),0,0):q.empty;let y=n.someProp("clipboardTextParser",v=>v(t,i,r,n));if(y)c=y;else{let v=i.marks(),{schema:b}=n.state,C=cn.fromSchema(b);l=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach(N=>{let P=l.appendChild(document.createElement("p"));N&&P.appendChild(C.serializeNode(b.text(N,v)))})}}else n.someProp("transformPastedHTML",y=>{e=y(e,n)}),l=E1(e),_i&&D1(l);let d=l&&l.querySelector("[data-pm-slice]"),m=d&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(d.getAttribute("data-pm-slice")||"");if(m&&m[3])for(let y=+m[3];y>0;y--){let v=l.firstChild;for(;v&&v.nodeType!=1;)v=v.nextSibling;if(!v)break;l=v}if(c||(c=(n.someProp("clipboardParser")||n.someProp("domParser")||ao.fromSchema(n.state.schema)).parseSlice(l,{preserveWhitespace:!!(h||m),context:i,ruleFromNode(y){return y.nodeName=="BR"&&!y.nextSibling&&y.parentNode&&!T1.test(y.parentNode.nodeName)?{ignore:!0}:null}})),m)c=R1(mf(c,+m[1],+m[2]),m[4]);else if(c=q.maxOpen(N1(c.content,i),!0),c.openStart||c.openEnd){let y=0,v=0;for(let b=c.content.firstChild;y<c.openStart&&!b.type.spec.isolating;y++,b=b.firstChild);for(let b=c.content.lastChild;v<c.openEnd&&!b.type.spec.isolating;v++,b=b.lastChild);c=mf(c,y,v)}return n.someProp("transformPasted",y=>{c=y(c,n)}),c}const T1=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function N1(n,t){if(n.childCount<2)return n;for(let e=t.depth;e>=0;e--){let r=t.node(e).contentMatchAt(t.index(e)),i,a=[];if(n.forEach(l=>{if(!a)return;let c=r.findWrapping(l.type),h;if(!c)return a=null;if(h=a.length&&i.length&&df(c,i,l,a[a.length-1],0))a[a.length-1]=h;else{a.length&&(a[a.length-1]=pf(a[a.length-1],i.length));let d=ff(l,c);a.push(d),r=r.matchType(d.type),i=c}}),a)return B.from(a)}return n}function ff(n,t,e=0){for(let r=t.length-1;r>=e;r--)n=t[r].create(null,B.from(n));return n}function df(n,t,e,r,i){if(i<n.length&&i<t.length&&n[i]==t[i]){let a=df(n,t,e,r.lastChild,i+1);if(a)return r.copy(r.content.replaceChild(r.childCount-1,a));if(r.contentMatchAt(r.childCount).matchType(i==n.length-1?e.type:n[i+1]))return r.copy(r.content.append(B.from(ff(e,n,i+1))))}}function pf(n,t){if(t==0)return n;let e=n.content.replaceChild(n.childCount-1,pf(n.lastChild,t-1)),r=n.contentMatchAt(n.childCount).fillBefore(B.empty,!0);return n.copy(e.append(r))}function aa(n,t,e,r,i,a){let l=t<0?n.firstChild:n.lastChild,c=l.content;return i<r-1&&(c=aa(c,t,e,r,i+1,a)),i>=e&&(c=t<0?l.contentMatchAt(0).fillBefore(c,n.childCount>1||a<=i).append(c):c.append(l.contentMatchAt(l.childCount).fillBefore(B.empty,!0))),n.replaceChild(t<0?0:n.childCount-1,l.copy(c))}function mf(n,t,e){return t<n.openStart&&(n=new q(aa(n.content,-1,t,n.openStart,0,n.openEnd),t,n.openEnd)),e<n.openEnd&&(n=new q(aa(n.content,1,e,n.openEnd,0,0),n.openStart,e)),n}const gf={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let _f=null;function yf(){return _f||(_f=document.implementation.createHTMLDocument("title"))}function E1(n){let t=/^(\s*<meta [^>]*>)*/.exec(n);t&&(n=n.slice(t[0].length));let e=yf().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(n),i;if((i=r&&gf[r[1].toLowerCase()])&&(n=i.map(a=>"<"+a+">").join("")+n+i.map(a=>"</"+a+">").reverse().join("")),e.innerHTML=n,i)for(let a=0;a<i.length;a++)e=e.querySelector(i[a])||e;return e}function D1(n){let t=n.querySelectorAll(Lt?"span:not([class]):not([style])":"span.Apple-converted-space");for(let e=0;e<t.length;e++){let r=t[e];r.childNodes.length==1&&r.textContent=="\xA0"&&r.parentNode&&r.parentNode.replaceChild(n.ownerDocument.createTextNode(" "),r)}}function R1(n,t){if(!n.size)return n;let e=n.content.firstChild.type.schema,r;try{r=JSON.parse(t)}catch{return n}let{content:i,openStart:a,openEnd:l}=n;for(let c=r.length-2;c>=0;c-=2){let h=e.nodes[r[c]];if(!h||h.hasRequiredAttrs())break;i=B.from(h.create(r[c+1],i)),a++,l++}return new q(i,a,l)}const qt={},Jt={},I1={touchstart:!0,touchmove:!0};class z1{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastAndroidDelete=0,this.composing=!1,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function j1(n){for(let t in qt){let e=qt[t];n.dom.addEventListener(t,n.input.eventHandlers[t]=r=>{B1(n,r)&&!ca(n,r)&&(n.editable||!(r.type in Jt))&&e(n,r)},I1[t]?{passive:!0}:void 0)}Wt&&n.dom.addEventListener("input",()=>null),la(n)}function In(n,t){n.input.lastSelectionOrigin=t,n.input.lastSelectionTime=Date.now()}function P1(n){n.domObserver.stop();for(let t in n.input.eventHandlers)n.dom.removeEventListener(t,n.input.eventHandlers[t]);clearTimeout(n.input.composingTimeout),clearTimeout(n.input.lastIOSEnterFallbackTimeout)}function la(n){n.someProp("handleDOMEvents",t=>{for(let e in t)n.input.eventHandlers[e]||n.dom.addEventListener(e,n.input.eventHandlers[e]=r=>ca(n,r))})}function ca(n,t){return n.someProp("handleDOMEvents",e=>{let r=e[t.type];return r?r(n,t)||t.defaultPrevented:!1})}function B1(n,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let e=t.target;e!=n.dom;e=e.parentNode)if(!e||e.nodeType==11||e.pmViewDesc&&e.pmViewDesc.stopEvent(t))return!1;return!0}function $1(n,t){!ca(n,t)&&qt[t.type]&&(n.editable||!(t.type in Jt))&&qt[t.type](n,t)}Jt.keydown=(n,t)=>{let e=t;if(n.input.shiftKey=e.keyCode==16||e.shiftKey,!wf(n,e)&&(n.input.lastKeyCode=e.keyCode,n.input.lastKeyCodeTime=Date.now(),!(Ne&&Lt&&e.keyCode==13)))if(e.keyCode!=229&&n.domObserver.forceFlush(),Ar&&e.keyCode==13&&!e.ctrlKey&&!e.altKey&&!e.metaKey){let r=Date.now();n.input.lastIOSEnter=r,n.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{n.input.lastIOSEnter==r&&(n.someProp("handleKeyDown",i=>i(n,er(13,"Enter"))),n.input.lastIOSEnter=0)},200)}else n.someProp("handleKeyDown",r=>r(n,e))||A1(n,e)?e.preventDefault():In(n,"key")},Jt.keyup=(n,t)=>{t.keyCode==16&&(n.input.shiftKey=!1)},Jt.keypress=(n,t)=>{let e=t;if(wf(n,e)||!e.charCode||e.ctrlKey&&!e.altKey||_e&&e.metaKey)return;if(n.someProp("handleKeyPress",i=>i(n,e))){e.preventDefault();return}let r=n.state.selection;if(!(r instanceof pt)||!r.$from.sameParent(r.$to)){let i=String.fromCharCode(e.charCode);!/[\r\n]/.test(i)&&!n.someProp("handleTextInput",a=>a(n,r.$from.pos,r.$to.pos,i))&&n.dispatch(n.state.tr.insertText(i).scrollIntoView()),e.preventDefault()}};function wi(n){return{left:n.clientX,top:n.clientY}}function F1(n,t){let e=t.x-n.clientX,r=t.y-n.clientY;return e*e+r*r<100}function ua(n,t,e,r,i){if(r==-1)return!1;let a=n.state.doc.resolve(r);for(let l=a.depth+1;l>0;l--)if(n.someProp(t,c=>l>a.depth?c(n,e,a.nodeAfter,a.before(l),i,!0):c(n,e,a.node(l),a.before(l),i,!1)))return!0;return!1}function Er(n,t,e){n.focused||n.focus();let r=n.state.tr.setSelection(t);e=="pointer"&&r.setMeta("pointer",!0),n.dispatch(r)}function V1(n,t){if(t==-1)return!1;let e=n.state.doc.resolve(t),r=e.nodeAfter;return r&&r.isAtom&&X.isSelectable(r)?(Er(n,new X(e),"pointer"),!0):!1}function L1(n,t){if(t==-1)return!1;let e=n.state.selection,r,i;e instanceof X&&(r=e.node);let a=n.state.doc.resolve(t);for(let l=a.depth+1;l>0;l--){let c=l>a.depth?a.nodeAfter:a.node(l);if(X.isSelectable(c)){r&&e.$from.depth>0&&l>=e.$from.depth&&a.before(e.$from.depth+1)==e.$from.pos?i=a.before(e.$from.depth):i=a.before(l);break}}return i!=null?(Er(n,X.create(n.state.doc,i),"pointer"),!0):!1}function W1(n,t,e,r,i){return ua(n,"handleClickOn",t,e,r)||n.someProp("handleClick",a=>a(n,t,r))||(i?L1(n,e):V1(n,e))}function q1(n,t,e,r){return ua(n,"handleDoubleClickOn",t,e,r)||n.someProp("handleDoubleClick",i=>i(n,t,r))}function J1(n,t,e,r){return ua(n,"handleTripleClickOn",t,e,r)||n.someProp("handleTripleClick",i=>i(n,t,r))||H1(n,e,r)}function H1(n,t,e){if(e.button!=0)return!1;let r=n.state.doc;if(t==-1)return r.inlineContent?(Er(n,pt.create(r,0,r.content.size),"pointer"),!0):!1;let i=r.resolve(t);for(let a=i.depth+1;a>0;a--){let l=a>i.depth?i.nodeAfter:i.node(a),c=i.before(a);if(l.inlineContent)Er(n,pt.create(r,c+1,c+1+l.content.size),"pointer");else if(X.isSelectable(l))Er(n,X.create(r,c),"pointer");else continue;return!0}}function ha(n){return vi(n)}const bf=_e?"metaKey":"ctrlKey";qt.mousedown=(n,t)=>{let e=t;n.input.shiftKey=e.shiftKey;let r=ha(n),i=Date.now(),a="singleClick";i-n.input.lastClick.time<500&&F1(e,n.input.lastClick)&&!e[bf]&&(n.input.lastClick.type=="singleClick"?a="doubleClick":n.input.lastClick.type=="doubleClick"&&(a="tripleClick")),n.input.lastClick={time:i,x:e.clientX,y:e.clientY,type:a};let l=n.posAtCoords(wi(e));!l||(a=="singleClick"?(n.input.mouseDown&&n.input.mouseDown.done(),n.input.mouseDown=new K1(n,l,e,!!r)):(a=="doubleClick"?q1:J1)(n,l.pos,l.inside,e)?e.preventDefault():In(n,"pointer"))};class K1{constructor(t,e,r,i){this.view=t,this.pos=e,this.event=r,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=t.state.doc,this.selectNode=!!r[bf],this.allowDefault=r.shiftKey;let a,l;if(e.inside>-1)a=t.state.doc.nodeAt(e.inside),l=e.inside;else{let m=t.state.doc.resolve(e.pos);a=m.parent,l=m.depth?m.before():0}const c=i?null:r.target,h=c?t.docView.nearestDesc(c,!0):null;this.target=h?h.dom:null;let{selection:d}=t.state;(r.button==0&&a.type.spec.draggable&&a.type.spec.selectable!==!1||d instanceof X&&d.from<=l&&d.to>l)&&(this.mightDrag={node:a,pos:l,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Te&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),t.root.addEventListener("mouseup",this.up=this.up.bind(this)),t.root.addEventListener("mousemove",this.move=this.move.bind(this)),In(t,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>fn(this.view)),this.view.input.mouseDown=null}up(t){if(this.done(),!this.view.dom.contains(t.target))return;let e=this.pos;this.view.state.doc!=this.startDoc&&(e=this.view.posAtCoords(wi(t))),this.updateAllowDefault(t),this.allowDefault||!e?In(this.view,"pointer"):W1(this.view,e.pos,e.inside,t,this.selectNode)?t.preventDefault():t.button==0&&(this.flushed||Wt&&this.mightDrag&&!this.mightDrag.node.isAtom||Lt&&!this.view.state.selection.visible&&Math.min(Math.abs(e.pos-this.view.state.selection.from),Math.abs(e.pos-this.view.state.selection.to))<=2)?(Er(this.view,ht.near(this.view.state.doc.resolve(e.pos)),"pointer"),t.preventDefault()):In(this.view,"pointer")}move(t){this.updateAllowDefault(t),In(this.view,"pointer"),t.buttons==0&&this.done()}updateAllowDefault(t){!this.allowDefault&&(Math.abs(this.event.x-t.clientX)>4||Math.abs(this.event.y-t.clientY)>4)&&(this.allowDefault=!0)}}qt.touchstart=n=>{n.input.lastTouch=Date.now(),ha(n),In(n,"pointer")},qt.touchmove=n=>{n.input.lastTouch=Date.now(),In(n,"pointer")},qt.contextmenu=n=>ha(n);function wf(n,t){return n.composing?!0:Wt&&Math.abs(t.timeStamp-n.input.compositionEndedAt)<500?(n.input.compositionEndedAt=-2e8,!0):!1}const U1=Ne?5e3:-1;Jt.compositionstart=Jt.compositionupdate=n=>{if(!n.composing){n.domObserver.flush();let{state:t}=n,e=t.selection.$from;if(t.selection.empty&&(t.storedMarks||!e.textOffset&&e.parentOffset&&e.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))n.markCursor=n.state.storedMarks||e.marks(),vi(n,!0),n.markCursor=null;else if(vi(n),Te&&t.selection.empty&&e.parentOffset&&!e.textOffset&&e.nodeBefore.marks.length){let r=n.domSelectionRange();for(let i=r.focusNode,a=r.focusOffset;i&&i.nodeType==1&&a!=0;){let l=a<0?i.lastChild:i.childNodes[a-1];if(!l)break;if(l.nodeType==3){n.domSelection().collapse(l,l.nodeValue.length);break}else i=l,a=-1}}n.input.composing=!0}vf(n,U1)},Jt.compositionend=(n,t)=>{n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=t.timeStamp,vf(n,20))};function vf(n,t){clearTimeout(n.input.composingTimeout),t>-1&&(n.input.composingTimeout=setTimeout(()=>vi(n),t))}function kf(n){for(n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=G1());n.input.compositionNodes.length>0;)n.input.compositionNodes.pop().markParentsDirty()}function G1(){let n=document.createEvent("Event");return n.initEvent("event",!0,!0),n.timeStamp}function vi(n,t=!1){if(!(Ne&&n.domObserver.flushingSoon>=0)){if(n.domObserver.forceFlush(),kf(n),t||n.docView&&n.docView.dirty){let e=ta(n);return e&&!e.eq(n.state.selection)?n.dispatch(n.state.tr.setSelection(e)):n.updateState(n.state),!0}return!1}}function Z1(n,t){if(!n.dom.parentNode)return;let e=n.dom.parentNode.appendChild(document.createElement("div"));e.appendChild(t),e.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),i=document.createRange();i.selectNodeContents(t),n.dom.blur(),r.removeAllRanges(),r.addRange(i),setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e),n.focus()},50)}const Dr=Yt&&En<15||Ar&&Y_<604;qt.copy=Jt.cut=(n,t)=>{let e=t,r=n.state.selection,i=e.type=="cut";if(r.empty)return;let a=Dr?null:e.clipboardData,l=r.content(),{dom:c,text:h}=uf(n,l);a?(e.preventDefault(),a.clearData(),a.setData("text/html",c.innerHTML),a.setData("text/plain",h)):Z1(n,c),i&&n.dispatch(n.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function Y1(n){return n.openStart==0&&n.openEnd==0&&n.content.childCount==1?n.content.firstChild:null}function Q1(n,t){if(!n.dom.parentNode)return;let e=n.input.shiftKey||n.state.selection.$from.parent.type.spec.code,r=n.dom.parentNode.appendChild(document.createElement(e?"textarea":"div"));e||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus(),setTimeout(()=>{n.focus(),r.parentNode&&r.parentNode.removeChild(r),e?bo(n,r.value,null,n.input.shiftKey,t):bo(n,r.textContent,r.innerHTML,n.input.shiftKey,t)},50)}function bo(n,t,e,r,i){let a=hf(n,t,e,r,n.state.selection.$from);if(n.someProp("handlePaste",h=>h(n,i,a||q.empty)))return!0;if(!a)return!1;let l=Y1(a),c=l?n.state.tr.replaceSelectionWith(l,n.input.shiftKey):n.state.tr.replaceSelection(a);return n.dispatch(c.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}Jt.paste=(n,t)=>{let e=t;if(n.composing&&!Ne)return;let r=Dr?null:e.clipboardData;r&&bo(n,r.getData("text/plain"),r.getData("text/html"),n.input.shiftKey,e)?e.preventDefault():Q1(n,e)};class X1{constructor(t,e){this.slice=t,this.move=e}}const xf=_e?"altKey":"ctrlKey";qt.dragstart=(n,t)=>{let e=t,r=n.input.mouseDown;if(r&&r.done(),!e.dataTransfer)return;let i=n.state.selection,a=i.empty?null:n.posAtCoords(wi(e));if(!(a&&a.pos>=i.from&&a.pos<=(i instanceof X?i.to-1:i.to))){if(r&&r.mightDrag)n.dispatch(n.state.tr.setSelection(X.create(n.state.doc,r.mightDrag.pos)));else if(e.target&&e.target.nodeType==1){let d=n.docView.nearestDesc(e.target,!0);d&&d.node.type.spec.draggable&&d!=n.docView&&n.dispatch(n.state.tr.setSelection(X.create(n.state.doc,d.posBefore)))}}let l=n.state.selection.content(),{dom:c,text:h}=uf(n,l);e.dataTransfer.clearData(),e.dataTransfer.setData(Dr?"Text":"text/html",c.innerHTML),e.dataTransfer.effectAllowed="copyMove",Dr||e.dataTransfer.setData("text/plain",h),n.dragging=new X1(l,!e[xf])},qt.dragend=n=>{let t=n.dragging;window.setTimeout(()=>{n.dragging==t&&(n.dragging=null)},50)},Jt.dragover=Jt.dragenter=(n,t)=>t.preventDefault(),Jt.drop=(n,t)=>{let e=t,r=n.dragging;if(n.dragging=null,!e.dataTransfer)return;let i=n.posAtCoords(wi(e));if(!i)return;let a=n.state.doc.resolve(i.pos),l=r&&r.slice;l?n.someProp("transformPasted",C=>{l=C(l,n)}):l=hf(n,e.dataTransfer.getData(Dr?"Text":"text/plain"),Dr?null:e.dataTransfer.getData("text/html"),!1,a);let c=!!(r&&!e[xf]);if(n.someProp("handleDrop",C=>C(n,e,l||q.empty,c))){e.preventDefault();return}if(!l)return;e.preventDefault();let h=l?D_(n.state.doc,a.pos,l):a.pos;h==null&&(h=a.pos);let d=n.state.tr;c&&d.deleteSelection();let m=d.mapping.map(h),y=l.openStart==0&&l.openEnd==0&&l.content.childCount==1,v=d.doc;if(y?d.replaceRangeWith(m,m,l.content.firstChild):d.replaceRange(m,m,l),d.doc.eq(v))return;let b=d.doc.resolve(m);if(y&&X.isSelectable(l.content.firstChild)&&b.nodeAfter&&b.nodeAfter.sameMarkup(l.content.firstChild))d.setSelection(new X(b));else{let C=d.mapping.map(h);d.mapping.maps[d.mapping.maps.length-1].forEach((N,P,J,mt)=>C=mt),d.setSelection(na(n,b,d.doc.resolve(C)))}n.focus(),n.dispatch(d.setMeta("uiEvent","drop"))},qt.focus=n=>{n.input.lastFocus=Date.now(),n.focused||(n.domObserver.stop(),n.dom.classList.add("ProseMirror-focused"),n.domObserver.start(),n.focused=!0,setTimeout(()=>{n.docView&&n.hasFocus()&&!n.domObserver.currentSelection.eq(n.domSelectionRange())&&fn(n)},20))},qt.blur=(n,t)=>{let e=t;n.focused&&(n.domObserver.stop(),n.dom.classList.remove("ProseMirror-focused"),n.domObserver.start(),e.relatedTarget&&n.dom.contains(e.relatedTarget)&&n.domObserver.currentSelection.clear(),n.focused=!1)},qt.beforeinput=(n,t)=>{if(Lt&&Ne&&t.inputType=="deleteContentBackward"){n.domObserver.flushSoon();let{domChangeCount:e}=n.input;setTimeout(()=>{if(n.input.domChangeCount!=e||(n.dom.blur(),n.focus(),n.someProp("handleKeyDown",i=>i(n,er(8,"Backspace")))))return;let{$cursor:r}=n.state.selection;r&&r.pos>0&&n.dispatch(n.state.tr.delete(r.pos-1,r.pos).scrollIntoView())},50)}};for(let n in Jt)qt[n]=Jt[n];function wo(n,t){if(n==t)return!0;for(let e in n)if(n[e]!==t[e])return!1;for(let e in t)if(!(e in n))return!1;return!0}class fa{constructor(t,e){this.toDOM=t,this.spec=e||sr,this.side=this.spec.side||0}map(t,e,r,i){let{pos:a,deleted:l}=t.mapResult(e.from+i,this.side<0?-1:1);return l?null:new De(a-r,a-r,this)}valid(){return!0}eq(t){return this==t||t instanceof fa&&(this.spec.key&&this.spec.key==t.spec.key||this.toDOM==t.toDOM&&wo(this.spec,t.spec))}destroy(t){this.spec.destroy&&this.spec.destroy(t)}}class zn{constructor(t,e){this.attrs=t,this.spec=e||sr}map(t,e,r,i){let a=t.map(e.from+i,this.spec.inclusiveStart?-1:1)-r,l=t.map(e.to+i,this.spec.inclusiveEnd?1:-1)-r;return a>=l?null:new De(a,l,this)}valid(t,e){return e.from<e.to}eq(t){return this==t||t instanceof zn&&wo(this.attrs,t.attrs)&&wo(this.spec,t.spec)}static is(t){return t.type instanceof zn}destroy(){}}class da{constructor(t,e){this.attrs=t,this.spec=e||sr}map(t,e,r,i){let a=t.mapResult(e.from+i,1);if(a.deleted)return null;let l=t.mapResult(e.to+i,-1);return l.deleted||l.pos<=a.pos?null:new De(a.pos-r,l.pos-r,this)}valid(t,e){let{index:r,offset:i}=t.content.findIndex(e.from),a;return i==e.from&&!(a=t.child(r)).isText&&i+a.nodeSize==e.to}eq(t){return this==t||t instanceof da&&wo(this.attrs,t.attrs)&&wo(this.spec,t.spec)}destroy(){}}class De{constructor(t,e,r){this.from=t,this.to=e,this.type=r}copy(t,e){return new De(t,e,this.type)}eq(t,e=0){return this.type.eq(t.type)&&this.from+e==t.from&&this.to+e==t.to}map(t,e,r){return this.type.map(t,this,e,r)}static widget(t,e,r){return new De(t,t,new fa(e,r))}static inline(t,e,r,i){return new De(t,e,new zn(r,i))}static node(t,e,r,i){return new De(t,e,new da(r,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof zn}}const Rr=[],sr={};class Tt{constructor(t,e){this.local=t.length?t:Rr,this.children=e.length?e:Rr}static create(t,e){return e.length?ki(e,t,0,sr):$t}find(t,e,r){let i=[];return this.findInner(t!=null?t:0,e!=null?e:1e9,i,0,r),i}findInner(t,e,r,i,a){for(let l=0;l<this.local.length;l++){let c=this.local[l];c.from<=e&&c.to>=t&&(!a||a(c.spec))&&r.push(c.copy(c.from+i,c.to+i))}for(let l=0;l<this.children.length;l+=3)if(this.children[l]<e&&this.children[l+1]>t){let c=this.children[l]+1;this.children[l+2].findInner(t-c,e-c,r,i+c,a)}}map(t,e,r){return this==$t||t.maps.length==0?this:this.mapInner(t,e,0,0,r||sr)}mapInner(t,e,r,i,a){let l;for(let c=0;c<this.local.length;c++){let h=this.local[c].map(t,r,i);h&&h.type.valid(e,h)?(l||(l=[])).push(h):a.onRemove&&a.onRemove(this.local[c].spec)}return this.children.length?ty(this.children,l||[],t,e,r,i,a):l?new Tt(l.sort(ar),Rr):$t}add(t,e){return e.length?this==$t?Tt.create(t,e):this.addInner(t,e,0):this}addInner(t,e,r){let i,a=0;t.forEach((c,h)=>{let d=h+r,m;if(m=Cf(e,c,d)){for(i||(i=this.children.slice());a<i.length&&i[a]<h;)a+=3;i[a]==h?i[a+2]=i[a+2].addInner(c,m,d+1):i.splice(a,0,h,h+c.nodeSize,ki(m,c,d+1,sr)),a+=3}});let l=Sf(a?Of(e):e,-r);for(let c=0;c<l.length;c++)l[c].type.valid(t,l[c])||l.splice(c--,1);return new Tt(l.length?this.local.concat(l).sort(ar):this.local,i||this.children)}remove(t){return t.length==0||this==$t?this:this.removeInner(t,0)}removeInner(t,e){let r=this.children,i=this.local;for(let a=0;a<r.length;a+=3){let l,c=r[a]+e,h=r[a+1]+e;for(let m=0,y;m<t.length;m++)(y=t[m])&&y.from>c&&y.to<h&&(t[m]=null,(l||(l=[])).push(y));if(!l)continue;r==this.children&&(r=this.children.slice());let d=r[a+2].removeInner(l,c+1);d!=$t?r[a+2]=d:(r.splice(a,3),a-=3)}if(i.length){for(let a=0,l;a<t.length;a++)if(l=t[a])for(let c=0;c<i.length;c++)i[c].eq(l,e)&&(i==this.local&&(i=this.local.slice()),i.splice(c--,1))}return r==this.children&&i==this.local?this:i.length||r.length?new Tt(i,r):$t}forChild(t,e){if(this==$t)return this;if(e.isLeaf)return Tt.empty;let r,i;for(let c=0;c<this.children.length;c+=3)if(this.children[c]>=t){this.children[c]==t&&(r=this.children[c+2]);break}let a=t+1,l=a+e.content.size;for(let c=0;c<this.local.length;c++){let h=this.local[c];if(h.from<l&&h.to>a&&h.type instanceof zn){let d=Math.max(a,h.from)-a,m=Math.min(l,h.to)-a;d<m&&(i||(i=[])).push(h.copy(d,m))}}if(i){let c=new Tt(i.sort(ar),Rr);return r?new jn([c,r]):c}return r||$t}eq(t){if(this==t)return!0;if(!(t instanceof Tt)||this.local.length!=t.local.length||this.children.length!=t.children.length)return!1;for(let e=0;e<this.local.length;e++)if(!this.local[e].eq(t.local[e]))return!1;for(let e=0;e<this.children.length;e+=3)if(this.children[e]!=t.children[e]||this.children[e+1]!=t.children[e+1]||!this.children[e+2].eq(t.children[e+2]))return!1;return!0}locals(t){return pa(this.localsInner(t))}localsInner(t){if(this==$t)return Rr;if(t.inlineContent||!this.local.some(zn.is))return this.local;let e=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof zn||e.push(this.local[r]);return e}}Tt.empty=new Tt([],[]),Tt.removeOverlap=pa;const $t=Tt.empty;class jn{constructor(t){this.members=t}map(t,e){const r=this.members.map(i=>i.map(t,e,sr));return jn.from(r)}forChild(t,e){if(e.isLeaf)return Tt.empty;let r=[];for(let i=0;i<this.members.length;i++){let a=this.members[i].forChild(t,e);a!=$t&&(a instanceof jn?r=r.concat(a.members):r.push(a))}return jn.from(r)}eq(t){if(!(t instanceof jn)||t.members.length!=this.members.length)return!1;for(let e=0;e<this.members.length;e++)if(!this.members[e].eq(t.members[e]))return!1;return!0}locals(t){let e,r=!0;for(let i=0;i<this.members.length;i++){let a=this.members[i].localsInner(t);if(a.length)if(!e)e=a;else{r&&(e=e.slice(),r=!1);for(let l=0;l<a.length;l++)e.push(a[l])}}return e?pa(r?e:e.sort(ar)):Rr}static from(t){switch(t.length){case 0:return $t;case 1:return t[0];default:return new jn(t.every(e=>e instanceof Tt)?t:t.reduce((e,r)=>e.concat(r instanceof Tt?r:r.members),[]))}}}function ty(n,t,e,r,i,a,l){let c=n.slice();for(let d=0,m=a;d<e.maps.length;d++){let y=0;e.maps[d].forEach((v,b,C,N)=>{let P=N-C-(b-v);for(let J=0;J<c.length;J+=3){let mt=c[J+1];if(mt<0||v>mt+m-y)continue;let st=c[J]+m-y;b>=st?c[J+1]=v<=st?-2:-1:C>=i&&P&&(c[J]+=P,c[J+1]+=P)}y+=P}),m=e.maps[d].map(m,-1)}let h=!1;for(let d=0;d<c.length;d+=3)if(c[d+1]<0){if(c[d+1]==-2){h=!0,c[d+1]=-1;continue}let m=e.map(n[d]+a),y=m-i;if(y<0||y>=r.content.size){h=!0;continue}let v=e.map(n[d+1]+a,-1),b=v-i,{index:C,offset:N}=r.content.findIndex(y),P=r.maybeChild(C);if(P&&N==y&&N+P.nodeSize==b){let J=c[d+2].mapInner(e,P,m+1,n[d]+a+1,l);J!=$t?(c[d]=y,c[d+1]=b,c[d+2]=J):(c[d+1]=-2,h=!0)}else h=!0}if(h){let d=ey(c,n,t,e,i,a,l),m=ki(d,r,0,l);t=m.local;for(let y=0;y<c.length;y+=3)c[y+1]<0&&(c.splice(y,3),y-=3);for(let y=0,v=0;y<m.children.length;y+=3){let b=m.children[y];for(;v<c.length&&c[v]<b;)v+=3;c.splice(v,0,m.children[y],m.children[y+1],m.children[y+2])}}return new Tt(t.sort(ar),c)}function Sf(n,t){if(!t||!n.length)return n;let e=[];for(let r=0;r<n.length;r++){let i=n[r];e.push(new De(i.from+t,i.to+t,i.type))}return e}function ey(n,t,e,r,i,a,l){function c(h,d){for(let m=0;m<h.local.length;m++){let y=h.local[m].map(r,i,d);y?e.push(y):l.onRemove&&l.onRemove(h.local[m].spec)}for(let m=0;m<h.children.length;m+=3)c(h.children[m+2],h.children[m]+d+1)}for(let h=0;h<n.length;h+=3)n[h+1]==-1&&c(n[h+2],t[h]+a+1);return e}function Cf(n,t,e){if(t.isLeaf)return null;let r=e+t.nodeSize,i=null;for(let a=0,l;a<n.length;a++)(l=n[a])&&l.from>e&&l.to<r&&((i||(i=[])).push(l),n[a]=null);return i}function Of(n){let t=[];for(let e=0;e<n.length;e++)n[e]!=null&&t.push(n[e]);return t}function ki(n,t,e,r){let i=[],a=!1;t.forEach((c,h)=>{let d=Cf(n,c,h+e);if(d){a=!0;let m=ki(d,c,e+h+1,r);m!=$t&&i.push(h,h+c.nodeSize,m)}});let l=Sf(a?Of(n):n,-e).sort(ar);for(let c=0;c<l.length;c++)l[c].type.valid(t,l[c])||(r.onRemove&&r.onRemove(l[c].spec),l.splice(c--,1));return l.length||i.length?new Tt(l,i):$t}function ar(n,t){return n.from-t.from||n.to-t.to}function pa(n){let t=n;for(let e=0;e<t.length-1;e++){let r=t[e];if(r.from!=r.to)for(let i=e+1;i<t.length;i++){let a=t[i];if(a.from==r.from){a.to!=r.to&&(t==n&&(t=n.slice()),t[i]=a.copy(a.from,r.to),Mf(t,i+1,a.copy(r.to,a.to)));continue}else{a.from<r.to&&(t==n&&(t=n.slice()),t[e]=r.copy(r.from,a.from),Mf(t,i,r.copy(a.from,r.to)));break}}}return t}function Mf(n,t,e){for(;t<n.length&&ar(e,n[t])>0;)t++;n.splice(t,0,e)}function ma(n){let t=[];return n.someProp("decorations",e=>{let r=e(n.state);r&&r!=$t&&t.push(r)}),n.cursorWrapper&&t.push(Tt.create(n.state.doc,[n.cursorWrapper.deco])),jn.from(t)}const ny={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},ry=Yt&&En<=11;class oy{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(t){this.anchorNode=t.anchorNode,this.anchorOffset=t.anchorOffset,this.focusNode=t.focusNode,this.focusOffset=t.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(t){return t.anchorNode==this.anchorNode&&t.anchorOffset==this.anchorOffset&&t.focusNode==this.focusNode&&t.focusOffset==this.focusOffset}}class iy{constructor(t,e){this.view=t,this.handleDOMChange=e,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new oy,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let i=0;i<r.length;i++)this.queue.push(r[i]);Yt&&En<=11&&r.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),ry&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,ny)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let t=this.observer.takeRecords();if(t.length){for(let e=0;e<t.length;e++)this.queue.push(t[e]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(nf(this.view)){if(this.suppressingSelectionUpdates)return fn(this.view);if(Yt&&En<=11&&!this.view.state.selection.empty){let t=this.view.domSelectionRange();if(t.focusNode&&tr(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(t){if(!t.focusNode)return!0;let e=new Set,r;for(let a=t.focusNode;a;a=po(a))e.add(a);for(let a=t.anchorNode;a;a=po(a))if(e.has(a)){r=a;break}let i=r&&this.view.docView.nearestDesc(r);if(i&&i.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}flush(){let{view:t}=this;if(!t.docView||this.flushingSoon>-1)return;let e=this.observer?this.observer.takeRecords():[];this.queue.length&&(e=this.queue.concat(e),this.queue.length=0);let r=t.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&nf(t)&&!this.ignoreSelectionChange(r),a=-1,l=-1,c=!1,h=[];if(t.editable)for(let m=0;m<e.length;m++){let y=this.registerMutation(e[m],h);y&&(a=a<0?y.from:Math.min(y.from,a),l=l<0?y.to:Math.max(y.to,l),y.typeOver&&(c=!0))}if(Te&&h.length>1){let m=h.filter(y=>y.nodeName=="BR");if(m.length==2){let y=m[0],v=m[1];y.parentNode&&y.parentNode.parentNode==v.parentNode?v.remove():y.remove()}}let d=null;a<0&&i&&t.input.lastFocus>Date.now()-200&&Math.max(t.input.lastTouch,t.input.lastClick.time)<Date.now()-300&&gi(r)&&(d=ta(t))&&d.eq(ht.near(t.state.doc.resolve(0),1))?(t.input.lastFocus=0,fn(t),this.currentSelection.set(r),t.scrollToSelection()):(a>-1||i)&&(a>-1&&(t.docView.markDirty(a,l),sy(t)),this.handleDOMChange(a,l,c,h),t.docView&&t.docView.dirty?t.updateState(t.state):this.currentSelection.eq(r)||fn(t),this.currentSelection.set(r))}registerMutation(t,e){if(e.indexOf(t.target)>-1)return null;let r=this.view.docView.nearestDesc(t.target);if(t.type=="attributes"&&(r==this.view.docView||t.attributeName=="contenteditable"||t.attributeName=="style"&&!t.oldValue&&!t.target.getAttribute("style"))||!r||r.ignoreMutation(t))return null;if(t.type=="childList"){for(let m=0;m<t.addedNodes.length;m++)e.push(t.addedNodes[m]);if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(t.target))return{from:r.posBefore,to:r.posAfter};let i=t.previousSibling,a=t.nextSibling;if(Yt&&En<=11&&t.addedNodes.length)for(let m=0;m<t.addedNodes.length;m++){let{previousSibling:y,nextSibling:v}=t.addedNodes[m];(!y||Array.prototype.indexOf.call(t.addedNodes,y)<0)&&(i=y),(!v||Array.prototype.indexOf.call(t.addedNodes,v)<0)&&(a=v)}let l=i&&i.parentNode==t.target?ae(i)+1:0,c=r.localPosFromDOM(t.target,l,-1),h=a&&a.parentNode==t.target?ae(a):t.target.childNodes.length,d=r.localPosFromDOM(t.target,h,1);return{from:c,to:d}}else return t.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:{from:r.posAtStart,to:r.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}}}let Af=new WeakMap,Tf=!1;function sy(n){if(!Af.has(n)&&(Af.set(n,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(n.dom).whiteSpace)!==-1)){if(n.requiresGeckoHackNode=Te,Tf)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),Tf=!0}}function ay(n){let t;function e(h){h.preventDefault(),h.stopImmediatePropagation(),t=h.getTargetRanges()[0]}n.dom.addEventListener("beforeinput",e,!0),document.execCommand("indent"),n.dom.removeEventListener("beforeinput",e,!0);let r=t.startContainer,i=t.startOffset,a=t.endContainer,l=t.endOffset,c=n.domAtPos(n.state.selection.anchor);return tr(c.node,c.offset,a,l)&&([r,i,a,l]=[a,l,r,i]),{anchorNode:r,anchorOffset:i,focusNode:a,focusOffset:l}}function ly(n,t,e){let{node:r,fromOffset:i,toOffset:a,from:l,to:c}=n.docView.parseRange(t,e),h=n.domSelectionRange(),d,m=h.anchorNode;if(m&&n.dom.contains(m.nodeType==1?m:m.parentNode)&&(d=[{node:m,offset:h.anchorOffset}],gi(h)||d.push({node:h.focusNode,offset:h.focusOffset})),Lt&&n.input.lastKeyCode===8)for(let P=a;P>i;P--){let J=r.childNodes[P-1],mt=J.pmViewDesc;if(J.nodeName=="BR"&&!mt){a=P;break}if(!mt||mt.size)break}let y=n.state.doc,v=n.someProp("domParser")||ao.fromSchema(n.state.schema),b=y.resolve(l),C=null,N=v.parse(r,{topNode:b.parent,topMatch:b.parent.contentMatchAt(b.index()),topOpen:!0,from:i,to:a,preserveWhitespace:b.parent.type.whitespace=="pre"?"full":!0,findPositions:d,ruleFromNode:cy,context:b});if(d&&d[0].pos!=null){let P=d[0].pos,J=d[1]&&d[1].pos;J==null&&(J=P),C={anchor:P+l,head:J+l}}return{doc:N,sel:C,from:l,to:c}}function cy(n){let t=n.pmViewDesc;if(t)return t.parseRule();if(n.nodeName=="BR"&&n.parentNode){if(Wt&&/^(ul|ol)$/i.test(n.parentNode.nodeName)){let e=document.createElement("div");return e.appendChild(document.createElement("li")),{skip:e}}else if(n.parentNode.lastChild==n||Wt&&/^(tr|table)$/i.test(n.parentNode.nodeName))return{ignore:!0}}else if(n.nodeName=="IMG"&&n.getAttribute("mark-placeholder"))return{ignore:!0};return null}function uy(n,t,e,r,i){if(t<0){let tt=n.input.lastSelectionTime>Date.now()-50?n.input.lastSelectionOrigin:null,mn=ta(n,tt);if(mn&&!n.state.selection.eq(mn)){if(Lt&&Ne&&n.input.lastKeyCode===13&&Date.now()-100<n.input.lastKeyCodeTime&&n.someProp("handleKeyDown",Ma=>Ma(n,er(13,"Enter"))))return;let xo=n.state.tr.setSelection(mn);tt=="pointer"?xo.setMeta("pointer",!0):tt=="key"&&xo.scrollIntoView(),n.dispatch(xo)}return}let a=n.state.doc.resolve(t),l=a.sharedDepth(e);t=a.before(l+1),e=n.state.doc.resolve(e).after(l+1);let c=n.state.selection,h=ly(n,t,e),d=n.state.doc,m=d.slice(h.from,h.to),y,v;n.input.lastKeyCode===8&&Date.now()-100<n.input.lastKeyCodeTime?(y=n.state.selection.to,v="end"):(y=n.state.selection.from,v="start"),n.input.lastKeyCode=null;let b=dy(m.content,h.doc.content,h.from,y,v);if((Ar&&n.input.lastIOSEnter>Date.now()-225||Ne)&&i.some(tt=>tt.nodeName=="DIV"||tt.nodeName=="P"||tt.nodeName=="LI")&&(!b||b.endA>=b.endB)&&n.someProp("handleKeyDown",tt=>tt(n,er(13,"Enter")))){n.input.lastIOSEnter=0;return}if(!b)if(r&&c instanceof pt&&!c.empty&&c.$head.sameParent(c.$anchor)&&!n.composing&&!(h.sel&&h.sel.anchor!=h.sel.head))b={start:c.from,endA:c.to,endB:c.to};else{if(h.sel){let tt=Nf(n,n.state.doc,h.sel);tt&&!tt.eq(n.state.selection)&&n.dispatch(n.state.tr.setSelection(tt))}return}if(Lt&&n.cursorWrapper&&h.sel&&h.sel.anchor==n.cursorWrapper.deco.from&&h.sel.head==h.sel.anchor){let tt=b.endB-b.start;h.sel={anchor:h.sel.anchor+tt,head:h.sel.anchor+tt}}n.input.domChangeCount++,n.state.selection.from<n.state.selection.to&&b.start==b.endB&&n.state.selection instanceof pt&&(b.start>n.state.selection.from&&b.start<=n.state.selection.from+2&&n.state.selection.from>=h.from?b.start=n.state.selection.from:b.endA<n.state.selection.to&&b.endA>=n.state.selection.to-2&&n.state.selection.to<=h.to&&(b.endB+=n.state.selection.to-b.endA,b.endA=n.state.selection.to)),Yt&&En<=11&&b.endB==b.start+1&&b.endA==b.start&&b.start>h.from&&h.doc.textBetween(b.start-h.from-1,b.start-h.from+1)==" \xA0"&&(b.start--,b.endA--,b.endB--);let C=h.doc.resolveNoCache(b.start-h.from),N=h.doc.resolveNoCache(b.endB-h.from),P=d.resolve(b.start),J=C.sameParent(N)&&C.parent.inlineContent&&P.end()>=b.endA,mt;if((Ar&&n.input.lastIOSEnter>Date.now()-225&&(!J||i.some(tt=>tt.nodeName=="DIV"||tt.nodeName=="P"))||!J&&C.pos<h.doc.content.size&&(mt=ht.findFrom(h.doc.resolve(C.pos+1),1,!0))&&mt.head==N.pos)&&n.someProp("handleKeyDown",tt=>tt(n,er(13,"Enter")))){n.input.lastIOSEnter=0;return}if(n.state.selection.anchor>b.start&&fy(d,b.start,b.endA,C,N)&&n.someProp("handleKeyDown",tt=>tt(n,er(8,"Backspace")))){Ne&&Lt&&n.domObserver.suppressSelectionUpdates();return}Lt&&Ne&&b.endB==b.start&&(n.input.lastAndroidDelete=Date.now()),Ne&&!J&&C.start()!=N.start()&&N.parentOffset==0&&C.depth==N.depth&&h.sel&&h.sel.anchor==h.sel.head&&h.sel.head==b.endA&&(b.endB-=2,N=h.doc.resolveNoCache(b.endB-h.from),setTimeout(()=>{n.someProp("handleKeyDown",function(tt){return tt(n,er(13,"Enter"))})},20));let st=b.start,ot=b.endA,yt,nn,Qt;if(J){if(C.pos==N.pos)Yt&&En<=11&&C.parentOffset==0&&(n.domObserver.suppressSelectionUpdates(),setTimeout(()=>fn(n),20)),yt=n.state.tr.delete(st,ot),nn=d.resolve(b.start).marksAcross(d.resolve(b.endA));else if(b.endA==b.endB&&(Qt=hy(C.parent.content.cut(C.parentOffset,N.parentOffset),P.parent.content.cut(P.parentOffset,b.endA-P.start()))))yt=n.state.tr,Qt.type=="add"?yt.addMark(st,ot,Qt.mark):yt.removeMark(st,ot,Qt.mark);else if(C.parent.child(C.index()).isText&&C.index()==N.index()-(N.textOffset?0:1)){let tt=C.parent.textBetween(C.parentOffset,N.parentOffset);if(n.someProp("handleTextInput",mn=>mn(n,st,ot,tt)))return;yt=n.state.tr.insertText(tt,st,ot)}}if(yt||(yt=n.state.tr.replace(st,ot,h.doc.slice(b.start-h.from,b.endB-h.from))),h.sel){let tt=Nf(n,yt.doc,h.sel);tt&&!(Lt&&Ne&&n.composing&&tt.empty&&(b.start!=b.endB||n.input.lastAndroidDelete<Date.now()-100)&&(tt.head==st||tt.head==yt.mapping.map(ot)-1)||Yt&&tt.empty&&tt.head==st)&&yt.setSelection(tt)}nn&&yt.ensureMarks(nn),n.dispatch(yt.scrollIntoView())}function Nf(n,t,e){return Math.max(e.anchor,e.head)>t.content.size?null:na(n,t.resolve(e.anchor),t.resolve(e.head))}function hy(n,t){let e=n.firstChild.marks,r=t.firstChild.marks,i=e,a=r,l,c,h;for(let m=0;m<r.length;m++)i=r[m].removeFromSet(i);for(let m=0;m<e.length;m++)a=e[m].removeFromSet(a);if(i.length==1&&a.length==0)c=i[0],l="add",h=m=>m.mark(c.addToSet(m.marks));else if(i.length==0&&a.length==1)c=a[0],l="remove",h=m=>m.mark(c.removeFromSet(m.marks));else return null;let d=[];for(let m=0;m<t.childCount;m++)d.push(h(t.child(m)));if(B.from(d).eq(n))return{mark:c,type:l}}function fy(n,t,e,r,i){if(!r.parent.isTextblock||e-t<=i.pos-r.pos||ga(r,!0,!1)<i.pos)return!1;let a=n.resolve(t);if(a.parentOffset<a.parent.content.size||!a.parent.isTextblock)return!1;let l=n.resolve(ga(a,!0,!0));return!l.parent.isTextblock||l.pos>e||ga(l,!0,!1)<e?!1:r.parent.content.cut(r.parentOffset).eq(l.parent.content)}function ga(n,t,e){let r=n.depth,i=t?n.end():n.pos;for(;r>0&&(t||n.indexAfter(r)==n.node(r).childCount);)r--,i++,t=!1;if(e){let a=n.node(r).maybeChild(n.indexAfter(r));for(;a&&!a.isLeaf;)a=a.firstChild,i++}return i}function dy(n,t,e,r,i){let a=n.findDiffStart(t,e);if(a==null)return null;let{a:l,b:c}=n.findDiffEnd(t,e+n.size,e+t.size);if(i=="end"){let h=Math.max(0,a-Math.min(l,c));r-=l+h-a}if(l<a&&n.size<t.size){let h=r<=a&&r>=l?a-r:0;a-=h,c=a+(c-l),l=a}else if(c<a){let h=r<=a&&r>=c?a-r:0;a-=h,l=a+(l-c),c=a}return{start:a,endA:l,endB:c}}class py{constructor(t,e){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new z1,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=e,this.state=e.state,this.directPlugins=e.plugins||[],this.directPlugins.forEach(zf),this.dispatch=this.dispatch.bind(this),this.dom=t&&t.mount||document.createElement("div"),t&&(t.appendChild?t.appendChild(this.dom):typeof t=="function"?t(this.dom):t.mount&&(this.mounted=!0)),this.editable=Rf(this),Df(this),this.nodeViews=If(this),this.docView=qh(this.state.doc,Ef(this),ma(this),this.dom,this),this.domObserver=new iy(this,(r,i,a,l)=>uy(this,r,i,a,l)),this.domObserver.start(),j1(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let t=this._props;this._props={};for(let e in t)this._props[e]=t[e];this._props.state=this.state}return this._props}update(t){t.handleDOMEvents!=this._props.handleDOMEvents&&la(this);let e=this._props;this._props=t,t.plugins&&(t.plugins.forEach(zf),this.directPlugins=t.plugins),this.updateStateInner(t.state,e)}setProps(t){let e={};for(let r in this._props)e[r]=this._props[r];e.state=this.state;for(let r in t)e[r]=t[r];this.update(e)}updateState(t){this.updateStateInner(t,this._props)}updateStateInner(t,e){let r=this.state,i=!1,a=!1;t.storedMarks&&this.composing&&(kf(this),a=!0),this.state=t;let l=r.plugins!=t.plugins||this._props.plugins!=e.plugins;if(l||this._props.plugins!=e.plugins||this._props.nodeViews!=e.nodeViews){let v=If(this);gy(v,this.nodeViews)&&(this.nodeViews=v,i=!0)}(l||e.handleDOMEvents!=this._props.handleDOMEvents)&&la(this),this.editable=Rf(this),Df(this);let c=ma(this),h=Ef(this),d=r.plugins!=t.plugins&&!r.doc.eq(t.doc)?"reset":t.scrollToSelection>r.scrollToSelection?"to selection":"preserve",m=i||!this.docView.matchesNode(t.doc,h,c);(m||!t.selection.eq(r.selection))&&(a=!0);let y=d=="preserve"&&a&&this.dom.style.overflowAnchor==null&&t1(this);if(a){this.domObserver.stop();let v=m&&(Yt||Lt)&&!this.composing&&!r.selection.empty&&!t.selection.empty&&my(r.selection,t.selection);if(m){let b=Lt?this.trackWrites=this.domSelectionRange().focusNode:null;(i||!this.docView.update(t.doc,h,c,this))&&(this.docView.updateOuterDeco([]),this.docView.destroy(),this.docView=qh(t.doc,h,c,this.dom,this)),b&&!this.trackWrites&&(v=!0)}v||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&C1(this))?fn(this,v):(tf(this,t.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(r),d=="reset"?this.dom.scrollTop=0:d=="to selection"?this.scrollToSelection():y&&e1(y)}scrollToSelection(){let t=this.domSelectionRange().focusNode;if(!this.someProp("handleScrollToSelection",e=>e(this)))if(this.state.selection instanceof X){let e=this.docView.domAfterPos(this.state.selection.from);e.nodeType==1&&Dh(this,e.getBoundingClientRect(),t)}else Dh(this,this.coordsAtPos(this.state.selection.head,1),t)}destroyPluginViews(){let t;for(;t=this.pluginViews.pop();)t.destroy&&t.destroy()}updatePluginViews(t){if(!t||t.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let e=0;e<this.directPlugins.length;e++){let r=this.directPlugins[e];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let e=0;e<this.state.plugins.length;e++){let r=this.state.plugins[e];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let e=0;e<this.pluginViews.length;e++){let r=this.pluginViews[e];r.update&&r.update(this,t)}}someProp(t,e){let r=this._props&&this._props[t],i;if(r!=null&&(i=e?e(r):r))return i;for(let l=0;l<this.directPlugins.length;l++){let c=this.directPlugins[l].props[t];if(c!=null&&(i=e?e(c):c))return i}let a=this.state.plugins;if(a)for(let l=0;l<a.length;l++){let c=a[l].props[t];if(c!=null&&(i=e?e(c):c))return i}}hasFocus(){if(Yt){let t=this.root.activeElement;if(t==this.dom)return!0;if(!t||!this.dom.contains(t))return!1;for(;t&&this.dom!=t&&this.dom.contains(t);){if(t.contentEditable=="false")return!1;t=t.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&n1(this.dom),fn(this),this.domObserver.start()}get root(){let t=this._root;if(t==null){for(let e=this.dom.parentNode;e;e=e.parentNode)if(e.nodeType==9||e.nodeType==11&&e.host)return e.getSelection||(Object.getPrototypeOf(e).getSelection=()=>e.ownerDocument.getSelection()),this._root=e}return t||document}posAtCoords(t){return a1(this,t)}coordsAtPos(t,e=1){return Ph(this,t,e)}domAtPos(t,e=0){return this.docView.domFromPos(t,e)}nodeDOM(t){let e=this.docView.descAt(t);return e?e.nodeDOM:null}posAtDOM(t,e,r=-1){let i=this.docView.posFromDOM(t,e,r);if(i==null)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(t,e){return f1(this,e||this.state,t)}pasteHTML(t,e){return bo(this,"",t,!1,e||new ClipboardEvent("paste"))}pasteText(t,e){return bo(this,t,null,!0,e||new ClipboardEvent("paste"))}destroy(){!this.docView||(P1(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],ma(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)}get isDestroyed(){return this.docView==null}dispatchEvent(t){return $1(this,t)}dispatch(t){let e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))}domSelectionRange(){return Wt&&this.root.nodeType===11&&G_(this.dom.ownerDocument)==this.dom?ay(this):this.domSelection()}domSelection(){return this.root.getSelection()}}function Ef(n){let t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(n.editable),t.translate="no",n.someProp("attributes",e=>{if(typeof e=="function"&&(e=e(n.state)),e)for(let r in e)r=="class"&&(t.class+=" "+e[r]),r=="style"?t.style=(t.style?t.style+";":"")+e[r]:!t[r]&&r!="contenteditable"&&r!="nodeName"&&(t[r]=String(e[r]))}),[De.node(0,n.state.doc.content.size,t)]}function Df(n){if(n.markCursor){let t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),t.setAttribute("alt",""),n.cursorWrapper={dom:t,deco:De.widget(n.state.selection.head,t,{raw:!0,marks:n.markCursor})}}else n.cursorWrapper=null}function Rf(n){return!n.someProp("editable",t=>t(n.state)===!1)}function my(n,t){let e=Math.min(n.$anchor.sharedDepth(n.head),t.$anchor.sharedDepth(t.head));return n.$anchor.start(e)!=t.$anchor.start(e)}function If(n){let t=Object.create(null);function e(r){for(let i in r)Object.prototype.hasOwnProperty.call(t,i)||(t[i]=r[i])}return n.someProp("nodeViews",e),n.someProp("markViews",e),t}function gy(n,t){let e=0,r=0;for(let i in n){if(n[i]!=t[i])return!0;e++}for(let i in t)r++;return e!=r}function zf(n){if(n.spec.state||n.spec.filterTransaction||n.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}const jf=(n,t)=>n.selection.empty?!1:(t&&t(n.tr.deleteSelection().scrollIntoView()),!0);function _y(n,t){let{$cursor:e}=n.selection;return!e||(t?!t.endOfTextblock("backward",n):e.parentOffset>0)?null:e}const yy=(n,t,e)=>{let r=_y(n,e);if(!r)return!1;let i=Pf(r);if(!i){let l=r.blockRange(),c=l&&Bs(l);return c==null?!1:(t&&t(n.tr.lift(l,c).scrollIntoView()),!0)}let a=i.nodeBefore;if(!a.type.spec.isolating&&$f(n,i,t))return!0;if(r.parent.content.size==0&&(Ir(a,"end")||X.isSelectable(a))){let l=$s(n.doc,r.before(),r.after(),q.empty);if(l&&l.slice.size<l.to-l.from){if(t){let c=n.tr.step(l);c.setSelection(Ir(a,"end")?ht.findFrom(c.doc.resolve(c.mapping.map(i.pos,-1)),-1):X.create(c.doc,i.pos-a.nodeSize)),t(c.scrollIntoView())}return!0}}return a.isAtom&&i.depth==r.depth-1?(t&&t(n.tr.delete(i.pos-a.nodeSize,i.pos).scrollIntoView()),!0):!1};function Ir(n,t,e=!1){for(let r=n;r;r=t=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(e&&r.childCount!=1)return!1}return!1}const by=(n,t,e)=>{let{$head:r,empty:i}=n.selection,a=r;if(!i)return!1;if(r.parent.isTextblock){if(e?!e.endOfTextblock("backward",n):r.parentOffset>0)return!1;a=Pf(r)}let l=a&&a.nodeBefore;return!l||!X.isSelectable(l)?!1:(t&&t(n.tr.setSelection(X.create(n.doc,a.pos-l.nodeSize)).scrollIntoView()),!0)};function Pf(n){if(!n.parent.type.spec.isolating)for(let t=n.depth-1;t>=0;t--){if(n.index(t)>0)return n.doc.resolve(n.before(t+1));if(n.node(t).type.spec.isolating)break}return null}function wy(n,t){let{$cursor:e}=n.selection;return!e||(t?!t.endOfTextblock("forward",n):e.parentOffset<e.parent.content.size)?null:e}const vy=(n,t,e)=>{let r=wy(n,e);if(!r)return!1;let i=Bf(r);if(!i)return!1;let a=i.nodeAfter;if($f(n,i,t))return!0;if(r.parent.content.size==0&&(Ir(a,"start")||X.isSelectable(a))){let l=$s(n.doc,r.before(),r.after(),q.empty);if(l&&l.slice.size<l.to-l.from){if(t){let c=n.tr.step(l);c.setSelection(Ir(a,"start")?ht.findFrom(c.doc.resolve(c.mapping.map(i.pos)),1):X.create(c.doc,c.mapping.map(i.pos))),t(c.scrollIntoView())}return!0}}return a.isAtom&&i.depth==r.depth-1?(t&&t(n.tr.delete(i.pos,i.pos+a.nodeSize).scrollIntoView()),!0):!1},ky=(n,t,e)=>{let{$head:r,empty:i}=n.selection,a=r;if(!i)return!1;if(r.parent.isTextblock){if(e?!e.endOfTextblock("forward",n):r.parentOffset<r.parent.content.size)return!1;a=Bf(r)}let l=a&&a.nodeAfter;return!l||!X.isSelectable(l)?!1:(t&&t(n.tr.setSelection(X.create(n.doc,a.pos)).scrollIntoView()),!0)};function Bf(n){if(!n.parent.type.spec.isolating)for(let t=n.depth-1;t>=0;t--){let e=n.node(t);if(n.index(t)+1<e.childCount)return n.doc.resolve(n.after(t+1));if(e.type.spec.isolating)break}return null}const xy=(n,t)=>{let{$head:e,$anchor:r}=n.selection;return!e.parent.type.spec.code||!e.sameParent(r)?!1:(t&&t(n.tr.insertText(`
`).scrollIntoView()),!0)};function _a(n){for(let t=0;t<n.edgeCount;t++){let{type:e}=n.edge(t);if(e.isTextblock&&!e.hasRequiredAttrs())return e}return null}const Sy=(n,t)=>{let{$head:e,$anchor:r}=n.selection;if(!e.parent.type.spec.code||!e.sameParent(r))return!1;let i=e.node(-1),a=e.indexAfter(-1),l=_a(i.contentMatchAt(a));if(!l||!i.canReplaceWith(a,a,l))return!1;if(t){let c=e.after(),h=n.tr.replaceWith(c,c,l.createAndFill());h.setSelection(ht.near(h.doc.resolve(c),1)),t(h.scrollIntoView())}return!0},Cy=(n,t)=>{let e=n.selection,{$from:r,$to:i}=e;if(e instanceof se||r.parent.inlineContent||i.parent.inlineContent)return!1;let a=_a(i.parent.contentMatchAt(i.indexAfter()));if(!a||!a.isTextblock)return!1;if(t){let l=(!r.parentOffset&&i.index()<i.parent.childCount?r:i).pos,c=n.tr.insert(l,a.createAndFill());c.setSelection(pt.create(c.doc,l+1)),t(c.scrollIntoView())}return!0},Oy=(n,t)=>{let{$cursor:e}=n.selection;if(!e||e.parent.content.size)return!1;if(e.depth>1&&e.after()!=e.end(-1)){let a=e.before();if(di(n.doc,a))return t&&t(n.tr.split(a).scrollIntoView()),!0}let r=e.blockRange(),i=r&&Bs(r);return i==null?!1:(t&&t(n.tr.lift(r,i).scrollIntoView()),!0)};function My(n){return(t,e)=>{let{$from:r,$to:i}=t.selection;if(t.selection instanceof X&&t.selection.node.isBlock)return!r.parentOffset||!di(t.doc,r.pos)?!1:(e&&e(t.tr.split(r.pos).scrollIntoView()),!0);if(!r.parent.isBlock)return!1;if(e){let a=i.parentOffset==i.parent.content.size,l=t.tr;(t.selection instanceof pt||t.selection instanceof se)&&l.deleteSelection();let c=r.depth==0?null:_a(r.node(-1).contentMatchAt(r.indexAfter(-1))),h=n&&n(i.parent,a),d=h?[h]:a&&c?[{type:c}]:void 0,m=di(l.doc,l.mapping.map(r.pos),1,d);if(!d&&!m&&di(l.doc,l.mapping.map(r.pos),1,c?[{type:c}]:void 0)&&(c&&(d=[{type:c}]),m=!0),m&&(l.split(l.mapping.map(r.pos),1,d),!a&&!r.parentOffset&&r.parent.type!=c)){let y=l.mapping.map(r.before()),v=l.doc.resolve(y);c&&r.node(-1).canReplaceWith(v.index(),v.index()+1,c)&&l.setNodeMarkup(l.mapping.map(r.before()),c)}e(l.scrollIntoView())}return!0}}const Ay=My(),Ty=(n,t)=>(t&&t(n.tr.setSelection(new se(n.doc))),!0);function Ny(n,t,e){let r=t.nodeBefore,i=t.nodeAfter,a=t.index();return!r||!i||!r.type.compatibleContent(i.type)?!1:!r.content.size&&t.parent.canReplace(a-1,a)?(e&&e(n.tr.delete(t.pos-r.nodeSize,t.pos).scrollIntoView()),!0):!t.parent.canReplace(a,a+1)||!(i.isTextblock||gh(n.doc,t.pos))?!1:(e&&e(n.tr.clearIncompatible(t.pos,r.type,r.contentMatchAt(r.childCount)).join(t.pos).scrollIntoView()),!0)}function $f(n,t,e){let r=t.nodeBefore,i=t.nodeAfter,a,l;if(r.type.spec.isolating||i.type.spec.isolating)return!1;if(Ny(n,t,e))return!0;let c=t.parent.canReplace(t.index(),t.index()+1);if(c&&(a=(l=r.contentMatchAt(r.childCount)).findWrapping(i.type))&&l.matchType(a[0]||i.type).validEnd){if(e){let y=t.pos+i.nodeSize,v=B.empty;for(let N=a.length-1;N>=0;N--)v=B.from(a[N].create(null,v));v=B.from(r.copy(v));let b=n.tr.step(new ie(t.pos-1,y,t.pos,y,new q(v,1,0),a.length,!0)),C=y+2*a.length;gh(b.doc,C)&&b.join(C),e(b.scrollIntoView())}return!0}let h=ht.findFrom(t,1),d=h&&h.$from.blockRange(h.$to),m=d&&Bs(d);if(m!=null&&m>=t.depth)return e&&e(n.tr.lift(d,m).scrollIntoView()),!0;if(c&&Ir(i,"start",!0)&&Ir(r,"end")){let y=r,v=[];for(;v.push(y),!y.isTextblock;)y=y.lastChild;let b=i,C=1;for(;!b.isTextblock;b=b.firstChild)C++;if(y.canReplace(y.childCount,y.childCount,b.content)){if(e){let N=B.empty;for(let J=v.length-1;J>=0;J--)N=B.from(v[J].copy(N));let P=n.tr.step(new ie(t.pos-v.length,t.pos+i.nodeSize,t.pos+C,t.pos+i.nodeSize-C,new q(N,v.length,0),0,!0));e(P.scrollIntoView())}return!0}}return!1}function Ff(n){return function(t,e){let r=t.selection,i=n<0?r.$from:r.$to,a=i.depth;for(;i.node(a).isInline;){if(!a)return!1;a--}return i.node(a).isTextblock?(e&&e(t.tr.setSelection(pt.create(t.doc,n<0?i.start(a):i.end(a)))),!0):!1}}const Ey=Ff(-1),Dy=Ff(1);function Ry(n,t,e){for(let r=0;r<t.length;r++){let{$from:i,$to:a}=t[r],l=i.depth==0?n.inlineContent&&n.type.allowsMarkType(e):!1;if(n.nodesBetween(i.pos,a.pos,c=>{if(l)return!1;l=c.inlineContent&&c.type.allowsMarkType(e)}),l)return!0}return!1}function Vf(n,t=null){return function(e,r){let{empty:i,$cursor:a,ranges:l}=e.selection;if(i&&!a||!Ry(e.doc,l,n))return!1;if(r)if(a)n.isInSet(e.storedMarks||a.marks())?r(e.tr.removeStoredMark(n)):r(e.tr.addStoredMark(n.create(t)));else{let c=!1,h=e.tr;for(let d=0;!c&&d<l.length;d++){let{$from:m,$to:y}=l[d];c=e.doc.rangeHasMark(m.pos,y.pos,n)}for(let d=0;d<l.length;d++){let{$from:m,$to:y}=l[d];if(c)h.removeMark(m.pos,y.pos,n);else{let v=m.pos,b=y.pos,C=m.nodeAfter,N=y.nodeBefore,P=C&&C.isText?/^\s*/.exec(C.text)[0].length:0,J=N&&N.isText?/\s*$/.exec(N.text)[0].length:0;v+P<b&&(v+=P,b-=J),h.addMark(v,b,n.create(t))}}r(h.scrollIntoView())}return!0}}function ya(...n){return function(t,e,r){for(let i=0;i<n.length;i++)if(n[i](t,e,r))return!0;return!1}}let ba=ya(jf,yy,by),Lf=ya(jf,vy,ky);const dn={Enter:ya(xy,Cy,Oy,Ay),"Mod-Enter":Sy,Backspace:ba,"Mod-Backspace":ba,"Shift-Backspace":ba,Delete:Lf,"Mod-Delete":Lf,"Mod-a":Ty},Wf={"Ctrl-h":dn.Backspace,"Alt-Backspace":dn["Mod-Backspace"],"Ctrl-d":dn.Delete,"Ctrl-Alt-Backspace":dn["Mod-Delete"],"Alt-Delete":dn["Mod-Delete"],"Alt-d":dn["Mod-Delete"],"Ctrl-a":Ey,"Ctrl-e":Dy};for(let n in dn)Wf[n]=dn[n];const Iy=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform?os.platform()=="darwin":!1,zy=Iy?Wf:dn;var Pn={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},xi={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},qf=typeof navigator<"u"&&/Chrome\/(\d+)/.exec(navigator.userAgent);typeof navigator<"u"&&/Gecko\/\d+/.test(navigator.userAgent);for(var jy=typeof navigator<"u"&&/Mac/.test(navigator.platform),Py=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),By=jy||qf&&+qf[1]<57,Rt=0;Rt<10;Rt++)Pn[48+Rt]=Pn[96+Rt]=String(Rt);for(var Rt=1;Rt<=24;Rt++)Pn[Rt+111]="F"+Rt;for(var Rt=65;Rt<=90;Rt++)Pn[Rt]=String.fromCharCode(Rt+32),xi[Rt]=String.fromCharCode(Rt);for(var wa in Pn)xi.hasOwnProperty(wa)||(xi[wa]=Pn[wa]);function $y(n){var t=By&&(n.ctrlKey||n.altKey||n.metaKey)||Py&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",e=!t&&n.key||(n.shiftKey?xi:Pn)[n.keyCode]||n.key||"Unidentified";return e=="Esc"&&(e="Escape"),e=="Del"&&(e="Delete"),e=="Left"&&(e="ArrowLeft"),e=="Up"&&(e="ArrowUp"),e=="Right"&&(e="ArrowRight"),e=="Down"&&(e="ArrowDown"),e}const Fy=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!1;function Vy(n){let t=n.split(/-(?!$)/),e=t[t.length-1];e=="Space"&&(e=" ");let r,i,a,l;for(let c=0;c<t.length-1;c++){let h=t[c];if(/^(cmd|meta|m)$/i.test(h))l=!0;else if(/^a(lt)?$/i.test(h))r=!0;else if(/^(c|ctrl|control)$/i.test(h))i=!0;else if(/^s(hift)?$/i.test(h))a=!0;else if(/^mod$/i.test(h))Fy?l=!0:i=!0;else throw new Error("Unrecognized modifier name: "+h)}return r&&(e="Alt-"+e),i&&(e="Ctrl-"+e),l&&(e="Meta-"+e),a&&(e="Shift-"+e),e}function Ly(n){let t=Object.create(null);for(let e in n)t[Vy(e)]=n[e];return t}function va(n,t,e=!0){return t.altKey&&(n="Alt-"+n),t.ctrlKey&&(n="Ctrl-"+n),t.metaKey&&(n="Meta-"+n),e&&t.shiftKey&&(n="Shift-"+n),n}function Wy(n){return new q_({props:{handleKeyDown:qy(n)}})}function qy(n){let t=Ly(n);return function(e,r){let i=$y(r),a,l=t[va(i,r)];if(l&&l(e.state,e.dispatch,e))return!0;if(i.length==1&&i!=" "){if(r.shiftKey){let c=t[va(i,r,!1)];if(c&&c(e.state,e.dispatch,e))return!0}if((r.shiftKey||r.altKey||r.metaKey||i.charCodeAt(0)>127)&&(a=Pn[r.keyCode])&&a!=i){let c=t[va(a,r)];if(c&&c(e.state,e.dispatch,e))return!0}}return!1}}var Z=globalThis&&globalThis.__classPrivateFieldSet||function(n,t,e){if(!t.has(n))throw new TypeError("attempted to set private field on non-instance");return t.set(n,e),e},V=globalThis&&globalThis.__classPrivateFieldGet||function(n,t){if(!t.has(n))throw new TypeError("attempted to get private field on non-instance");return t.get(n)},Bn,lr,Re,zr,vo,He,Ke,Ue,Ge,Ze,Ye,Qe,Xe,cr,jr,$n,Si,Fn;const Jy=function(n){var t=131,e=137,r=0;n+="x";var i=Math.floor(9007199254740991/e);for(let a=0;a<n.length;a++)r>i&&(r=Math.floor(r/e)),r=r*t+n.charCodeAt(a);return r},W="0123456789abcdef".split(""),Hy=[-2147483648,8388608,32768,128],Ie=[24,16,8,0],Ci=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],Nt=[];class Ky{constructor(t=!1,e=!1){Bn.set(this,void 0),lr.set(this,void 0),Re.set(this,void 0),zr.set(this,void 0),vo.set(this,void 0),He.set(this,void 0),Ke.set(this,void 0),Ue.set(this,void 0),Ge.set(this,void 0),Ze.set(this,void 0),Ye.set(this,void 0),Qe.set(this,void 0),Xe.set(this,void 0),cr.set(this,void 0),jr.set(this,void 0),$n.set(this,void 0),Si.set(this,0),Fn.set(this,void 0),this.init(t,e)}init(t,e){e?(Nt[0]=Nt[16]=Nt[1]=Nt[2]=Nt[3]=Nt[4]=Nt[5]=Nt[6]=Nt[7]=Nt[8]=Nt[9]=Nt[10]=Nt[11]=Nt[12]=Nt[13]=Nt[14]=Nt[15]=0,Z(this,lr,Nt)):Z(this,lr,[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),t?(Z(this,He,3238371032),Z(this,Ke,914150663),Z(this,Ue,812702999),Z(this,Ge,4144912697),Z(this,Ze,4290775857),Z(this,Ye,1750603025),Z(this,Qe,1694076839),Z(this,Xe,3204075428)):(Z(this,He,1779033703),Z(this,Ke,3144134277),Z(this,Ue,1013904242),Z(this,Ge,2773480762),Z(this,Ze,1359893119),Z(this,Ye,2600822924),Z(this,Qe,528734635),Z(this,Xe,1541459225)),Z(this,Bn,Z(this,Fn,Z(this,Re,Z(this,jr,0)))),Z(this,zr,Z(this,cr,!1)),Z(this,vo,!0),Z(this,$n,t)}update(t){if(V(this,zr))return this;let e;t instanceof ArrayBuffer?e=new Uint8Array(t):e=t;let r=0;const i=e.length,a=V(this,lr);for(;r<i;){let l;if(V(this,cr)&&(Z(this,cr,!1),a[0]=V(this,Bn),a[16]=a[1]=a[2]=a[3]=a[4]=a[5]=a[6]=a[7]=a[8]=a[9]=a[10]=a[11]=a[12]=a[13]=a[14]=a[15]=0),typeof e!="string")for(l=V(this,Fn);r<i&&l<64;++r)a[l>>2]|=e[r]<<Ie[l++&3];else for(l=V(this,Fn);r<i&&l<64;++r){let c=e.charCodeAt(r);c<128?a[l>>2]|=c<<Ie[l++&3]:c<2048?(a[l>>2]|=(192|c>>6)<<Ie[l++&3],a[l>>2]|=(128|c&63)<<Ie[l++&3]):c<55296||c>=57344?(a[l>>2]|=(224|c>>12)<<Ie[l++&3],a[l>>2]|=(128|c>>6&63)<<Ie[l++&3],a[l>>2]|=(128|c&63)<<Ie[l++&3]):(c=65536+((c&1023)<<10|e.charCodeAt(++r)&1023),a[l>>2]|=(240|c>>18)<<Ie[l++&3],a[l>>2]|=(128|c>>12&63)<<Ie[l++&3],a[l>>2]|=(128|c>>6&63)<<Ie[l++&3],a[l>>2]|=(128|c&63)<<Ie[l++&3])}Z(this,Si,l),Z(this,Re,V(this,Re)+(l-V(this,Fn))),l>=64?(Z(this,Bn,a[16]),Z(this,Fn,l-64),this.hash(),Z(this,cr,!0)):Z(this,Fn,l)}return V(this,Re)>4294967295&&(Z(this,jr,V(this,jr)+(V(this,Re)/4294967296<<0)),Z(this,Re,V(this,Re)%4294967296)),this}finalize(){if(V(this,zr))return;Z(this,zr,!0);const t=V(this,lr),e=V(this,Si);t[16]=V(this,Bn),t[e>>2]|=Hy[e&3],Z(this,Bn,t[16]),e>=56&&(V(this,cr)||this.hash(),t[0]=V(this,Bn),t[16]=t[1]=t[2]=t[3]=t[4]=t[5]=t[6]=t[7]=t[8]=t[9]=t[10]=t[11]=t[12]=t[13]=t[14]=t[15]=0),t[14]=V(this,jr)<<3|V(this,Re)>>>29,t[15]=V(this,Re)<<3,this.hash()}hash(){let t=V(this,He),e=V(this,Ke),r=V(this,Ue),i=V(this,Ge),a=V(this,Ze),l=V(this,Ye),c=V(this,Qe),h=V(this,Xe);const d=V(this,lr);let m,y,v,b,C,N,P,J,mt,st;for(let ot=16;ot<64;++ot)b=d[ot-15],m=(b>>>7|b<<25)^(b>>>18|b<<14)^b>>>3,b=d[ot-2],y=(b>>>17|b<<15)^(b>>>19|b<<13)^b>>>10,d[ot]=d[ot-16]+m+d[ot-7]+y<<0;st=e&r;for(let ot=0;ot<64;ot+=4)V(this,vo)?(V(this,$n)?(P=300032,b=d[0]-1413257819,h=b-150054599<<0,i=b+24177077<<0):(P=704751109,b=d[0]-210244248,h=b-1521486534<<0,i=b+143694565<<0),Z(this,vo,!1)):(m=(t>>>2|t<<30)^(t>>>13|t<<19)^(t>>>22|t<<10),y=(a>>>6|a<<26)^(a>>>11|a<<21)^(a>>>25|a<<7),P=t&e,v=P^t&r^st,N=a&l^~a&c,b=h+y+N+Ci[ot]+d[ot],C=m+v,h=i+b<<0,i=b+C<<0),m=(i>>>2|i<<30)^(i>>>13|i<<19)^(i>>>22|i<<10),y=(h>>>6|h<<26)^(h>>>11|h<<21)^(h>>>25|h<<7),J=i&t,v=J^i&e^P,N=h&a^~h&l,b=c+y+N+Ci[ot+1]+d[ot+1],C=m+v,c=r+b<<0,r=b+C<<0,m=(r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10),y=(c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7),mt=r&i,v=mt^r&t^J,N=c&h^~c&a,b=l+y+N+Ci[ot+2]+d[ot+2],C=m+v,l=e+b<<0,e=b+C<<0,m=(e>>>2|e<<30)^(e>>>13|e<<19)^(e>>>22|e<<10),y=(l>>>6|l<<26)^(l>>>11|l<<21)^(l>>>25|l<<7),st=e&r,v=st^e&i^mt,N=l&c^~l&h,b=a+y+N+Ci[ot+3]+d[ot+3],C=m+v,a=t+b<<0,t=b+C<<0;Z(this,He,V(this,He)+t<<0),Z(this,Ke,V(this,Ke)+e<<0),Z(this,Ue,V(this,Ue)+r<<0),Z(this,Ge,V(this,Ge)+i<<0),Z(this,Ze,V(this,Ze)+a<<0),Z(this,Ye,V(this,Ye)+l<<0),Z(this,Qe,V(this,Qe)+c<<0),Z(this,Xe,V(this,Xe)+h<<0)}hex(){this.finalize();const t=V(this,He),e=V(this,Ke),r=V(this,Ue),i=V(this,Ge),a=V(this,Ze),l=V(this,Ye),c=V(this,Qe),h=V(this,Xe);let d=W[t>>28&15]+W[t>>24&15]+W[t>>20&15]+W[t>>16&15]+W[t>>12&15]+W[t>>8&15]+W[t>>4&15]+W[t&15]+W[e>>28&15]+W[e>>24&15]+W[e>>20&15]+W[e>>16&15]+W[e>>12&15]+W[e>>8&15]+W[e>>4&15]+W[e&15]+W[r>>28&15]+W[r>>24&15]+W[r>>20&15]+W[r>>16&15]+W[r>>12&15]+W[r>>8&15]+W[r>>4&15]+W[r&15]+W[i>>28&15]+W[i>>24&15]+W[i>>20&15]+W[i>>16&15]+W[i>>12&15]+W[i>>8&15]+W[i>>4&15]+W[i&15]+W[a>>28&15]+W[a>>24&15]+W[a>>20&15]+W[a>>16&15]+W[a>>12&15]+W[a>>8&15]+W[a>>4&15]+W[a&15]+W[l>>28&15]+W[l>>24&15]+W[l>>20&15]+W[l>>16&15]+W[l>>12&15]+W[l>>8&15]+W[l>>4&15]+W[l&15]+W[c>>28&15]+W[c>>24&15]+W[c>>20&15]+W[c>>16&15]+W[c>>12&15]+W[c>>8&15]+W[c>>4&15]+W[c&15];return V(this,$n)||(d+=W[h>>28&15]+W[h>>24&15]+W[h>>20&15]+W[h>>16&15]+W[h>>12&15]+W[h>>8&15]+W[h>>4&15]+W[h&15]),d}toString(){return this.hex()}digest(){this.finalize();const t=V(this,He),e=V(this,Ke),r=V(this,Ue),i=V(this,Ge),a=V(this,Ze),l=V(this,Ye),c=V(this,Qe),h=V(this,Xe),d=[t>>24&255,t>>16&255,t>>8&255,t&255,e>>24&255,e>>16&255,e>>8&255,e&255,r>>24&255,r>>16&255,r>>8&255,r&255,i>>24&255,i>>16&255,i>>8&255,i&255,a>>24&255,a>>16&255,a>>8&255,a&255,l>>24&255,l>>16&255,l>>8&255,l&255,c>>24&255,c>>16&255,c>>8&255,c&255];return V(this,$n)||d.push(h>>24&255,h>>16&255,h>>8&255,h&255),d}array(){return this.digest()}arrayBuffer(){this.finalize();const t=new ArrayBuffer(V(this,$n)?28:32),e=new DataView(t);return e.setUint32(0,V(this,He)),e.setUint32(4,V(this,Ke)),e.setUint32(8,V(this,Ue)),e.setUint32(12,V(this,Ge)),e.setUint32(16,V(this,Ze)),e.setUint32(20,V(this,Ye)),e.setUint32(24,V(this,Qe)),V(this,$n)||e.setUint32(28,V(this,Xe)),t}}Bn=new WeakMap,lr=new WeakMap,Re=new WeakMap,zr=new WeakMap,vo=new WeakMap,He=new WeakMap,Ke=new WeakMap,Ue=new WeakMap,Ge=new WeakMap,Ze=new WeakMap,Ye=new WeakMap,Qe=new WeakMap,Xe=new WeakMap,cr=new WeakMap,jr=new WeakMap,$n=new WeakMap,Si=new WeakMap,Fn=new WeakMap;function Uy(n){const t=new Ky;return t.update(n),parseInt(t.hex().substring(0,8),16)}const Gy=function(n){var t="#";return n.forEach(function(e){e<16&&(t+=0),t+=e.toString(16)}),t},Zy=function(n,t,e){n/=360;var r=e<.5?e*(1+t):e+t-e*t,i=2*e-r;return[n+1/3,n,n-1/3].map(function(a){return a<0&&a++,a>1&&a--,a<1/6?a=i+(r-i)*6*a:a<.5?a=r:a<2/3?a=i+(r-i)*6*(2/3-a):a=i,Math.round(a*255)})};class Yy{constructor(t={}){const[e,r]=[t.lightness,t.saturation].map(function(i){return i=i!==void 0?i:[.35,.5,.65],Array.isArray(i)?i.concat():[i]});this.L=e,this.S=r,typeof t.hue=="number"&&(t.hue={min:t.hue,max:t.hue}),typeof t.hue=="object"&&!Array.isArray(t.hue)&&(t.hue=[t.hue]),typeof t.hue>"u"&&(t.hue=[]),this.hueRanges=t.hue.map(function(i){return{min:typeof i.min>"u"?0:i.min,max:typeof i.max>"u"?360:i.max}}),this.hash=Uy,typeof t.hash=="function"&&(this.hash=t.hash),t.hash==="bkdr"&&(this.hash=Jy)}hsl(t){var e,r,i,a=this.hash(t),l=727;if(this.hueRanges.length){const c=this.hueRanges[a%this.hueRanges.length];e=a/this.hueRanges.length%l*(c.max-c.min)/l+c.min}else e=a%359;return a=Math.ceil(a/360),r=this.S[a%this.S.length],a=Math.ceil(a/this.S.length),i=this.L[a%this.L.length],[e,r,i]}rgb(t){var e=this.hsl(t);return Zy.apply(this,e)}hex(t){var e=this.rgb(t);return Gy(e)}}const Qy=new Yy,Xy={doc:{content:"block+"},paragraph:{content:"text*",group:"block",toDOM:()=>["p",0]},text:{}},tb={strong:{toDOM(){return["strong"]},allowMultiple:!1,inclusive:!0},em:{toDOM(){return["em"]},allowMultiple:!1,inclusive:!0},comment:{attrs:{id:{}},inclusive:!1,toDOM(n){return["span",{"data-mark":"comment","data-comment-id":n.attrs.id}]},allowMultiple:!0,excludes:""},link:{attrs:{url:{}},inclusive:!1,allowMultiple:!1,toDOM(n){return["a",{href:n.attrs.url,style:`color: ${Qy.hex(n.attrs.url)};`}]}}},eb={...tb,highlightChange:{toDOM(){return["span",{class:"highlight-flash"}]}},unhighlightChange:{toDOM(){return["span",{class:"unhighlight"}]}}};function Jf(n){return n==="strong"||n==="em"||n==="comment"||n==="link"}const nb={nodes:Xy,marks:eb};class rb{constructor({interval:t=10,handleFlush:e}){vr(this,"changes",[]);vr(this,"timer");vr(this,"interval");vr(this,"handleFlush");vr(this,"flush",()=>{this.handleFlush(this.changes),this.changes=[]});this.interval=t,this.handleFlush=e}enqueue(...t){this.changes.push(...t)}start(){this.timer=window.setInterval(this.flush,this.interval)}drop(){this.timer!==void 0&&window.clearInterval(this.timer)}}var ko=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Oi={exports:{}},Hf=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof window.msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto);if(Hf){var Kf=new Uint8Array(16);Oi.exports=function(){return Hf(Kf),Kf}}else{var Uf=new Array(16);Oi.exports=function(){for(var n=0,t;n<16;n++)(n&3)===0&&(t=Math.random()*4294967296),Uf[n]=t>>>((n&3)<<3)&255;return Uf}}for(var Gf=[],Mi=0;Mi<256;++Mi)Gf[Mi]=(Mi+256).toString(16).substr(1);function ob(n,t){var e=t||0,r=Gf;return[r[n[e++]],r[n[e++]],r[n[e++]],r[n[e++]],"-",r[n[e++]],r[n[e++]],"-",r[n[e++]],r[n[e++]],"-",r[n[e++]],r[n[e++]],"-",r[n[e++]],r[n[e++]],r[n[e++]],r[n[e++]],r[n[e++]],r[n[e++]]].join("")}var Zf=ob,ib=Oi.exports,sb=Zf,Yf,ka,xa=0,Sa=0;function ab(n,t,e){var r=t&&e||0,i=t||[];n=n||{};var a=n.node||Yf,l=n.clockseq!==void 0?n.clockseq:ka;if(a==null||l==null){var c=ib();a==null&&(a=Yf=[c[0]|1,c[1],c[2],c[3],c[4],c[5]]),l==null&&(l=ka=(c[6]<<8|c[7])&16383)}var h=n.msecs!==void 0?n.msecs:new Date().getTime(),d=n.nsecs!==void 0?n.nsecs:Sa+1,m=h-xa+(d-Sa)/1e4;if(m<0&&n.clockseq===void 0&&(l=l+1&16383),(m<0||h>xa)&&n.nsecs===void 0&&(d=0),d>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");xa=h,Sa=d,ka=l,h+=122192928e5;var y=((h&268435455)*1e4+d)%4294967296;i[r++]=y>>>24&255,i[r++]=y>>>16&255,i[r++]=y>>>8&255,i[r++]=y&255;var v=h/4294967296*1e4&268435455;i[r++]=v>>>8&255,i[r++]=v&255,i[r++]=v>>>24&15|16,i[r++]=v>>>16&255,i[r++]=l>>>8|128,i[r++]=l&255;for(var b=0;b<6;++b)i[r+b]=a[b];return t||sb(i)}var lb=ab,cb=Oi.exports,ub=Zf;function hb(n,t,e){var r=t&&e||0;typeof n=="string"&&(t=n==="binary"?new Array(16):null,n=null),n=n||{};var i=n.random||(n.rng||cb)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,t)for(var a=0;a<16;++a)t[r+a]=i[a];return t||ub(i)}var fb=hb,db=lb,Qf=fb,Ca=Qf;Ca.v1=db,Ca.v4=Qf;var Xf=Ca,Oa={exports:{}};(function(n,t){(function(){var e,r="4.17.21",i=200,a="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",c="Invalid `variable` option passed into `_.template`",h="__lodash_hash_undefined__",d=500,m="__lodash_placeholder__",y=1,v=2,b=4,C=1,N=2,P=1,J=2,mt=4,st=8,ot=16,yt=32,nn=64,Qt=128,tt=256,mn=512,xo=30,Ma="...",vb=800,kb=16,fd=1,xb=2,Sb=3,hr=1/0,Vn=9007199254740991,Cb=17976931348623157e292,Ti=0/0,rn=4294967295,Ob=rn-1,Mb=rn>>>1,Ab=[["ary",Qt],["bind",P],["bindKey",J],["curry",st],["curryRight",ot],["flip",mn],["partial",yt],["partialRight",nn],["rearg",tt]],$r="[object Arguments]",Ni="[object Array]",Tb="[object AsyncFunction]",So="[object Boolean]",Co="[object Date]",Nb="[object DOMException]",Ei="[object Error]",Di="[object Function]",dd="[object GeneratorFunction]",ze="[object Map]",Oo="[object Number]",Eb="[object Null]",gn="[object Object]",pd="[object Promise]",Db="[object Proxy]",Mo="[object RegExp]",je="[object Set]",Ao="[object String]",Ri="[object Symbol]",Rb="[object Undefined]",To="[object WeakMap]",Ib="[object WeakSet]",No="[object ArrayBuffer]",Fr="[object DataView]",Aa="[object Float32Array]",Ta="[object Float64Array]",Na="[object Int8Array]",Ea="[object Int16Array]",Da="[object Int32Array]",Ra="[object Uint8Array]",Ia="[object Uint8ClampedArray]",za="[object Uint16Array]",ja="[object Uint32Array]",zb=/\b__p \+= '';/g,jb=/\b(__p \+=) '' \+/g,Pb=/(__e\(.*?\)|\b__t\)) \+\n'';/g,md=/&(?:amp|lt|gt|quot|#39);/g,gd=/[&<>"']/g,Bb=RegExp(md.source),$b=RegExp(gd.source),Fb=/<%-([\s\S]+?)%>/g,Vb=/<%([\s\S]+?)%>/g,_d=/<%=([\s\S]+?)%>/g,Lb=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Wb=/^\w*$/,qb=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Pa=/[\\^$.*+?()[\]{}|]/g,Jb=RegExp(Pa.source),Ba=/^\s+/,Hb=/\s/,Kb=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Ub=/\{\n\/\* \[wrapped with (.+)\] \*/,Gb=/,? & /,Zb=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Yb=/[()=,{}\[\]\/\s]/,Qb=/\\(\\)?/g,Xb=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,yd=/\w*$/,tw=/^[-+]0x[0-9a-f]+$/i,ew=/^0b[01]+$/i,nw=/^\[object .+?Constructor\]$/,rw=/^0o[0-7]+$/i,ow=/^(?:0|[1-9]\d*)$/,iw=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Ii=/($^)/,sw=/['\n\r\u2028\u2029\\]/g,zi="\uD800-\uDFFF",aw="\\u0300-\\u036f",lw="\\ufe20-\\ufe2f",cw="\\u20d0-\\u20ff",bd=aw+lw+cw,wd="\\u2700-\\u27bf",vd="a-z\\xdf-\\xf6\\xf8-\\xff",uw="\\xac\\xb1\\xd7\\xf7",hw="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",fw="\\u2000-\\u206f",dw=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",kd="A-Z\\xc0-\\xd6\\xd8-\\xde",xd="\\ufe0e\\ufe0f",Sd=uw+hw+fw+dw,$a="['\u2019]",pw="["+zi+"]",Cd="["+Sd+"]",ji="["+bd+"]",Od="\\d+",mw="["+wd+"]",Md="["+vd+"]",Ad="[^"+zi+Sd+Od+wd+vd+kd+"]",Fa="\uD83C[\uDFFB-\uDFFF]",gw="(?:"+ji+"|"+Fa+")",Td="[^"+zi+"]",Va="(?:\uD83C[\uDDE6-\uDDFF]){2}",La="[\uD800-\uDBFF][\uDC00-\uDFFF]",Vr="["+kd+"]",Nd="\\u200d",Ed="(?:"+Md+"|"+Ad+")",_w="(?:"+Vr+"|"+Ad+")",Dd="(?:"+$a+"(?:d|ll|m|re|s|t|ve))?",Rd="(?:"+$a+"(?:D|LL|M|RE|S|T|VE))?",Id=gw+"?",zd="["+xd+"]?",yw="(?:"+Nd+"(?:"+[Td,Va,La].join("|")+")"+zd+Id+")*",bw="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",ww="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",jd=zd+Id+yw,vw="(?:"+[mw,Va,La].join("|")+")"+jd,kw="(?:"+[Td+ji+"?",ji,Va,La,pw].join("|")+")",xw=RegExp($a,"g"),Sw=RegExp(ji,"g"),Wa=RegExp(Fa+"(?="+Fa+")|"+kw+jd,"g"),Cw=RegExp([Vr+"?"+Md+"+"+Dd+"(?="+[Cd,Vr,"$"].join("|")+")",_w+"+"+Rd+"(?="+[Cd,Vr+Ed,"$"].join("|")+")",Vr+"?"+Ed+"+"+Dd,Vr+"+"+Rd,ww,bw,Od,vw].join("|"),"g"),Ow=RegExp("["+Nd+zi+bd+xd+"]"),Mw=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Aw=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Tw=-1,bt={};bt[Aa]=bt[Ta]=bt[Na]=bt[Ea]=bt[Da]=bt[Ra]=bt[Ia]=bt[za]=bt[ja]=!0,bt[$r]=bt[Ni]=bt[No]=bt[So]=bt[Fr]=bt[Co]=bt[Ei]=bt[Di]=bt[ze]=bt[Oo]=bt[gn]=bt[Mo]=bt[je]=bt[Ao]=bt[To]=!1;var _t={};_t[$r]=_t[Ni]=_t[No]=_t[Fr]=_t[So]=_t[Co]=_t[Aa]=_t[Ta]=_t[Na]=_t[Ea]=_t[Da]=_t[ze]=_t[Oo]=_t[gn]=_t[Mo]=_t[je]=_t[Ao]=_t[Ri]=_t[Ra]=_t[Ia]=_t[za]=_t[ja]=!0,_t[Ei]=_t[Di]=_t[To]=!1;var Nw={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},Ew={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Dw={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Rw={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Iw=parseFloat,zw=parseInt,Pd=typeof ko=="object"&&ko&&ko.Object===Object&&ko,jw=typeof self=="object"&&self&&self.Object===Object&&self,It=Pd||jw||Function("return this")(),qa=t&&!t.nodeType&&t,fr=qa&&!0&&n&&!n.nodeType&&n,Bd=fr&&fr.exports===qa,Ja=Bd&&Pd.process,ye=function(){try{var S=fr&&fr.require&&fr.require("util").types;return S||Ja&&Ja.binding&&Ja.binding("util")}catch{}}(),$d=ye&&ye.isArrayBuffer,Fd=ye&&ye.isDate,Vd=ye&&ye.isMap,Ld=ye&&ye.isRegExp,Wd=ye&&ye.isSet,qd=ye&&ye.isTypedArray;function le(S,E,M){switch(M.length){case 0:return S.call(E);case 1:return S.call(E,M[0]);case 2:return S.call(E,M[0],M[1]);case 3:return S.call(E,M[0],M[1],M[2])}return S.apply(E,M)}function Pw(S,E,M,L){for(var Y=-1,ut=S==null?0:S.length;++Y<ut;){var Mt=S[Y];E(L,Mt,M(Mt),S)}return L}function be(S,E){for(var M=-1,L=S==null?0:S.length;++M<L&&E(S[M],M,S)!==!1;);return S}function Bw(S,E){for(var M=S==null?0:S.length;M--&&E(S[M],M,S)!==!1;);return S}function Jd(S,E){for(var M=-1,L=S==null?0:S.length;++M<L;)if(!E(S[M],M,S))return!1;return!0}function Ln(S,E){for(var M=-1,L=S==null?0:S.length,Y=0,ut=[];++M<L;){var Mt=S[M];E(Mt,M,S)&&(ut[Y++]=Mt)}return ut}function Pi(S,E){var M=S==null?0:S.length;return!!M&&Lr(S,E,0)>-1}function Ha(S,E,M){for(var L=-1,Y=S==null?0:S.length;++L<Y;)if(M(E,S[L]))return!0;return!1}function wt(S,E){for(var M=-1,L=S==null?0:S.length,Y=Array(L);++M<L;)Y[M]=E(S[M],M,S);return Y}function Wn(S,E){for(var M=-1,L=E.length,Y=S.length;++M<L;)S[Y+M]=E[M];return S}function Ka(S,E,M,L){var Y=-1,ut=S==null?0:S.length;for(L&&ut&&(M=S[++Y]);++Y<ut;)M=E(M,S[Y],Y,S);return M}function $w(S,E,M,L){var Y=S==null?0:S.length;for(L&&Y&&(M=S[--Y]);Y--;)M=E(M,S[Y],Y,S);return M}function Ua(S,E){for(var M=-1,L=S==null?0:S.length;++M<L;)if(E(S[M],M,S))return!0;return!1}var Fw=Ga("length");function Vw(S){return S.split("")}function Lw(S){return S.match(Zb)||[]}function Hd(S,E,M){var L;return M(S,function(Y,ut,Mt){if(E(Y,ut,Mt))return L=ut,!1}),L}function Bi(S,E,M,L){for(var Y=S.length,ut=M+(L?1:-1);L?ut--:++ut<Y;)if(E(S[ut],ut,S))return ut;return-1}function Lr(S,E,M){return E===E?tv(S,E,M):Bi(S,Kd,M)}function Ww(S,E,M,L){for(var Y=M-1,ut=S.length;++Y<ut;)if(L(S[Y],E))return Y;return-1}function Kd(S){return S!==S}function Ud(S,E){var M=S==null?0:S.length;return M?Ya(S,E)/M:Ti}function Ga(S){return function(E){return E==null?e:E[S]}}function Za(S){return function(E){return S==null?e:S[E]}}function Gd(S,E,M,L,Y){return Y(S,function(ut,Mt,gt){M=L?(L=!1,ut):E(M,ut,Mt,gt)}),M}function qw(S,E){var M=S.length;for(S.sort(E);M--;)S[M]=S[M].value;return S}function Ya(S,E){for(var M,L=-1,Y=S.length;++L<Y;){var ut=E(S[L]);ut!==e&&(M=M===e?ut:M+ut)}return M}function Qa(S,E){for(var M=-1,L=Array(S);++M<S;)L[M]=E(M);return L}function Jw(S,E){return wt(E,function(M){return[M,S[M]]})}function Zd(S){return S&&S.slice(0,tp(S)+1).replace(Ba,"")}function ce(S){return function(E){return S(E)}}function Xa(S,E){return wt(E,function(M){return S[M]})}function Eo(S,E){return S.has(E)}function Yd(S,E){for(var M=-1,L=S.length;++M<L&&Lr(E,S[M],0)>-1;);return M}function Qd(S,E){for(var M=S.length;M--&&Lr(E,S[M],0)>-1;);return M}function Hw(S,E){for(var M=S.length,L=0;M--;)S[M]===E&&++L;return L}var Kw=Za(Nw),Uw=Za(Ew);function Gw(S){return"\\"+Rw[S]}function Zw(S,E){return S==null?e:S[E]}function Wr(S){return Ow.test(S)}function Yw(S){return Mw.test(S)}function Qw(S){for(var E,M=[];!(E=S.next()).done;)M.push(E.value);return M}function tl(S){var E=-1,M=Array(S.size);return S.forEach(function(L,Y){M[++E]=[Y,L]}),M}function Xd(S,E){return function(M){return S(E(M))}}function qn(S,E){for(var M=-1,L=S.length,Y=0,ut=[];++M<L;){var Mt=S[M];(Mt===E||Mt===m)&&(S[M]=m,ut[Y++]=M)}return ut}function $i(S){var E=-1,M=Array(S.size);return S.forEach(function(L){M[++E]=L}),M}function Xw(S){var E=-1,M=Array(S.size);return S.forEach(function(L){M[++E]=[L,L]}),M}function tv(S,E,M){for(var L=M-1,Y=S.length;++L<Y;)if(S[L]===E)return L;return-1}function ev(S,E,M){for(var L=M+1;L--;)if(S[L]===E)return L;return L}function qr(S){return Wr(S)?rv(S):Fw(S)}function Pe(S){return Wr(S)?ov(S):Vw(S)}function tp(S){for(var E=S.length;E--&&Hb.test(S.charAt(E)););return E}var nv=Za(Dw);function rv(S){for(var E=Wa.lastIndex=0;Wa.test(S);)++E;return E}function ov(S){return S.match(Wa)||[]}function iv(S){return S.match(Cw)||[]}var sv=function S(E){E=E==null?It:Jr.defaults(It.Object(),E,Jr.pick(It,Aw));var M=E.Array,L=E.Date,Y=E.Error,ut=E.Function,Mt=E.Math,gt=E.Object,el=E.RegExp,av=E.String,we=E.TypeError,Fi=M.prototype,lv=ut.prototype,Hr=gt.prototype,Vi=E["__core-js_shared__"],Li=lv.toString,dt=Hr.hasOwnProperty,cv=0,ep=function(){var o=/[^.]+$/.exec(Vi&&Vi.keys&&Vi.keys.IE_PROTO||"");return o?"Symbol(src)_1."+o:""}(),Wi=Hr.toString,uv=Li.call(gt),hv=It._,fv=el("^"+Li.call(dt).replace(Pa,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),qi=Bd?E.Buffer:e,Jn=E.Symbol,Ji=E.Uint8Array,np=qi?qi.allocUnsafe:e,Hi=Xd(gt.getPrototypeOf,gt),rp=gt.create,op=Hr.propertyIsEnumerable,Ki=Fi.splice,ip=Jn?Jn.isConcatSpreadable:e,Do=Jn?Jn.iterator:e,dr=Jn?Jn.toStringTag:e,Ui=function(){try{var o=yr(gt,"defineProperty");return o({},"",{}),o}catch{}}(),dv=E.clearTimeout!==It.clearTimeout&&E.clearTimeout,pv=L&&L.now!==It.Date.now&&L.now,mv=E.setTimeout!==It.setTimeout&&E.setTimeout,Gi=Mt.ceil,Zi=Mt.floor,nl=gt.getOwnPropertySymbols,gv=qi?qi.isBuffer:e,sp=E.isFinite,_v=Fi.join,yv=Xd(gt.keys,gt),At=Mt.max,Ft=Mt.min,bv=L.now,wv=E.parseInt,ap=Mt.random,vv=Fi.reverse,rl=yr(E,"DataView"),Ro=yr(E,"Map"),ol=yr(E,"Promise"),Kr=yr(E,"Set"),Io=yr(E,"WeakMap"),zo=yr(gt,"create"),Yi=Io&&new Io,Ur={},kv=br(rl),xv=br(Ro),Sv=br(ol),Cv=br(Kr),Ov=br(Io),Qi=Jn?Jn.prototype:e,jo=Qi?Qi.valueOf:e,lp=Qi?Qi.toString:e;function g(o){if(xt(o)&&!Q(o)&&!(o instanceof at)){if(o instanceof ve)return o;if(dt.call(o,"__wrapped__"))return cm(o)}return new ve(o)}var Gr=function(){function o(){}return function(s){if(!kt(s))return{};if(rp)return rp(s);o.prototype=s;var u=new o;return o.prototype=e,u}}();function Xi(){}function ve(o,s){this.__wrapped__=o,this.__actions__=[],this.__chain__=!!s,this.__index__=0,this.__values__=e}g.templateSettings={escape:Fb,evaluate:Vb,interpolate:_d,variable:"",imports:{_:g}},g.prototype=Xi.prototype,g.prototype.constructor=g,ve.prototype=Gr(Xi.prototype),ve.prototype.constructor=ve;function at(o){this.__wrapped__=o,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=rn,this.__views__=[]}function Mv(){var o=new at(this.__wrapped__);return o.__actions__=Xt(this.__actions__),o.__dir__=this.__dir__,o.__filtered__=this.__filtered__,o.__iteratees__=Xt(this.__iteratees__),o.__takeCount__=this.__takeCount__,o.__views__=Xt(this.__views__),o}function Av(){if(this.__filtered__){var o=new at(this);o.__dir__=-1,o.__filtered__=!0}else o=this.clone(),o.__dir__*=-1;return o}function Tv(){var o=this.__wrapped__.value(),s=this.__dir__,u=Q(o),f=s<0,p=u?o.length:0,_=Vk(0,p,this.__views__),w=_.start,k=_.end,O=k-w,D=f?k:w-1,R=this.__iteratees__,I=R.length,$=0,H=Ft(O,this.__takeCount__);if(!u||!f&&p==O&&H==O)return Dp(o,this.__actions__);var U=[];t:for(;O--&&$<H;){D+=s;for(var nt=-1,G=o[D];++nt<I;){var it=R[nt],lt=it.iteratee,fe=it.type,Ut=lt(G);if(fe==xb)G=Ut;else if(!Ut){if(fe==fd)continue t;break t}}U[$++]=G}return U}at.prototype=Gr(Xi.prototype),at.prototype.constructor=at;function pr(o){var s=-1,u=o==null?0:o.length;for(this.clear();++s<u;){var f=o[s];this.set(f[0],f[1])}}function Nv(){this.__data__=zo?zo(null):{},this.size=0}function Ev(o){var s=this.has(o)&&delete this.__data__[o];return this.size-=s?1:0,s}function Dv(o){var s=this.__data__;if(zo){var u=s[o];return u===h?e:u}return dt.call(s,o)?s[o]:e}function Rv(o){var s=this.__data__;return zo?s[o]!==e:dt.call(s,o)}function Iv(o,s){var u=this.__data__;return this.size+=this.has(o)?0:1,u[o]=zo&&s===e?h:s,this}pr.prototype.clear=Nv,pr.prototype.delete=Ev,pr.prototype.get=Dv,pr.prototype.has=Rv,pr.prototype.set=Iv;function _n(o){var s=-1,u=o==null?0:o.length;for(this.clear();++s<u;){var f=o[s];this.set(f[0],f[1])}}function zv(){this.__data__=[],this.size=0}function jv(o){var s=this.__data__,u=ts(s,o);if(u<0)return!1;var f=s.length-1;return u==f?s.pop():Ki.call(s,u,1),--this.size,!0}function Pv(o){var s=this.__data__,u=ts(s,o);return u<0?e:s[u][1]}function Bv(o){return ts(this.__data__,o)>-1}function $v(o,s){var u=this.__data__,f=ts(u,o);return f<0?(++this.size,u.push([o,s])):u[f][1]=s,this}_n.prototype.clear=zv,_n.prototype.delete=jv,_n.prototype.get=Pv,_n.prototype.has=Bv,_n.prototype.set=$v;function yn(o){var s=-1,u=o==null?0:o.length;for(this.clear();++s<u;){var f=o[s];this.set(f[0],f[1])}}function Fv(){this.size=0,this.__data__={hash:new pr,map:new(Ro||_n),string:new pr}}function Vv(o){var s=ds(this,o).delete(o);return this.size-=s?1:0,s}function Lv(o){return ds(this,o).get(o)}function Wv(o){return ds(this,o).has(o)}function qv(o,s){var u=ds(this,o),f=u.size;return u.set(o,s),this.size+=u.size==f?0:1,this}yn.prototype.clear=Fv,yn.prototype.delete=Vv,yn.prototype.get=Lv,yn.prototype.has=Wv,yn.prototype.set=qv;function mr(o){var s=-1,u=o==null?0:o.length;for(this.__data__=new yn;++s<u;)this.add(o[s])}function Jv(o){return this.__data__.set(o,h),this}function Hv(o){return this.__data__.has(o)}mr.prototype.add=mr.prototype.push=Jv,mr.prototype.has=Hv;function Be(o){var s=this.__data__=new _n(o);this.size=s.size}function Kv(){this.__data__=new _n,this.size=0}function Uv(o){var s=this.__data__,u=s.delete(o);return this.size=s.size,u}function Gv(o){return this.__data__.get(o)}function Zv(o){return this.__data__.has(o)}function Yv(o,s){var u=this.__data__;if(u instanceof _n){var f=u.__data__;if(!Ro||f.length<i-1)return f.push([o,s]),this.size=++u.size,this;u=this.__data__=new yn(f)}return u.set(o,s),this.size=u.size,this}Be.prototype.clear=Kv,Be.prototype.delete=Uv,Be.prototype.get=Gv,Be.prototype.has=Zv,Be.prototype.set=Yv;function cp(o,s){var u=Q(o),f=!u&&wr(o),p=!u&&!f&&Zn(o),_=!u&&!f&&!p&&Xr(o),w=u||f||p||_,k=w?Qa(o.length,av):[],O=k.length;for(var D in o)(s||dt.call(o,D))&&!(w&&(D=="length"||p&&(D=="offset"||D=="parent")||_&&(D=="buffer"||D=="byteLength"||D=="byteOffset")||kn(D,O)))&&k.push(D);return k}function up(o){var s=o.length;return s?o[ml(0,s-1)]:e}function Qv(o,s){return ps(Xt(o),gr(s,0,o.length))}function Xv(o){return ps(Xt(o))}function il(o,s,u){(u!==e&&!$e(o[s],u)||u===e&&!(s in o))&&bn(o,s,u)}function Po(o,s,u){var f=o[s];(!(dt.call(o,s)&&$e(f,u))||u===e&&!(s in o))&&bn(o,s,u)}function ts(o,s){for(var u=o.length;u--;)if($e(o[u][0],s))return u;return-1}function tk(o,s,u,f){return Hn(o,function(p,_,w){s(f,p,u(p),w)}),f}function hp(o,s){return o&&sn(s,Et(s),o)}function ek(o,s){return o&&sn(s,ee(s),o)}function bn(o,s,u){s=="__proto__"&&Ui?Ui(o,s,{configurable:!0,enumerable:!0,value:u,writable:!0}):o[s]=u}function sl(o,s){for(var u=-1,f=s.length,p=M(f),_=o==null;++u<f;)p[u]=_?e:Fl(o,s[u]);return p}function gr(o,s,u){return o===o&&(u!==e&&(o=o<=u?o:u),s!==e&&(o=o>=s?o:s)),o}function ke(o,s,u,f,p,_){var w,k=s&y,O=s&v,D=s&b;if(u&&(w=p?u(o,f,p,_):u(o)),w!==e)return w;if(!kt(o))return o;var R=Q(o);if(R){if(w=Wk(o),!k)return Xt(o,w)}else{var I=Vt(o),$=I==Di||I==dd;if(Zn(o))return zp(o,k);if(I==gn||I==$r||$&&!p){if(w=O||$?{}:tm(o),!k)return O?Dk(o,ek(w,o)):Ek(o,hp(w,o))}else{if(!_t[I])return p?o:{};w=qk(o,I,k)}}_||(_=new Be);var H=_.get(o);if(H)return H;_.set(o,w),Tm(o)?o.forEach(function(G){w.add(ke(G,s,u,G,o,_))}):Mm(o)&&o.forEach(function(G,it){w.set(it,ke(G,s,u,it,o,_))});var U=D?O?Ol:Cl:O?ee:Et,nt=R?e:U(o);return be(nt||o,function(G,it){nt&&(it=G,G=o[it]),Po(w,it,ke(G,s,u,it,o,_))}),w}function nk(o){var s=Et(o);return function(u){return fp(u,o,s)}}function fp(o,s,u){var f=u.length;if(o==null)return!f;for(o=gt(o);f--;){var p=u[f],_=s[p],w=o[p];if(w===e&&!(p in o)||!_(w))return!1}return!0}function dp(o,s,u){if(typeof o!="function")throw new we(l);return qo(function(){o.apply(e,u)},s)}function Bo(o,s,u,f){var p=-1,_=Pi,w=!0,k=o.length,O=[],D=s.length;if(!k)return O;u&&(s=wt(s,ce(u))),f?(_=Ha,w=!1):s.length>=i&&(_=Eo,w=!1,s=new mr(s));t:for(;++p<k;){var R=o[p],I=u==null?R:u(R);if(R=f||R!==0?R:0,w&&I===I){for(var $=D;$--;)if(s[$]===I)continue t;O.push(R)}else _(s,I,f)||O.push(R)}return O}var Hn=Fp(on),pp=Fp(ll,!0);function rk(o,s){var u=!0;return Hn(o,function(f,p,_){return u=!!s(f,p,_),u}),u}function es(o,s,u){for(var f=-1,p=o.length;++f<p;){var _=o[f],w=s(_);if(w!=null&&(k===e?w===w&&!he(w):u(w,k)))var k=w,O=_}return O}function ok(o,s,u,f){var p=o.length;for(u=et(u),u<0&&(u=-u>p?0:p+u),f=f===e||f>p?p:et(f),f<0&&(f+=p),f=u>f?0:Em(f);u<f;)o[u++]=s;return o}function mp(o,s){var u=[];return Hn(o,function(f,p,_){s(f,p,_)&&u.push(f)}),u}function zt(o,s,u,f,p){var _=-1,w=o.length;for(u||(u=Hk),p||(p=[]);++_<w;){var k=o[_];s>0&&u(k)?s>1?zt(k,s-1,u,f,p):Wn(p,k):f||(p[p.length]=k)}return p}var al=Vp(),gp=Vp(!0);function on(o,s){return o&&al(o,s,Et)}function ll(o,s){return o&&gp(o,s,Et)}function ns(o,s){return Ln(s,function(u){return xn(o[u])})}function _r(o,s){s=Un(s,o);for(var u=0,f=s.length;o!=null&&u<f;)o=o[an(s[u++])];return u&&u==f?o:e}function _p(o,s,u){var f=s(o);return Q(o)?f:Wn(f,u(o))}function Ht(o){return o==null?o===e?Rb:Eb:dr&&dr in gt(o)?Fk(o):Xk(o)}function cl(o,s){return o>s}function ik(o,s){return o!=null&&dt.call(o,s)}function sk(o,s){return o!=null&&s in gt(o)}function ak(o,s,u){return o>=Ft(s,u)&&o<At(s,u)}function ul(o,s,u){for(var f=u?Ha:Pi,p=o[0].length,_=o.length,w=_,k=M(_),O=1/0,D=[];w--;){var R=o[w];w&&s&&(R=wt(R,ce(s))),O=Ft(R.length,O),k[w]=!u&&(s||p>=120&&R.length>=120)?new mr(w&&R):e}R=o[0];var I=-1,$=k[0];t:for(;++I<p&&D.length<O;){var H=R[I],U=s?s(H):H;if(H=u||H!==0?H:0,!($?Eo($,U):f(D,U,u))){for(w=_;--w;){var nt=k[w];if(!(nt?Eo(nt,U):f(o[w],U,u)))continue t}$&&$.push(U),D.push(H)}}return D}function lk(o,s,u,f){return on(o,function(p,_,w){s(f,u(p),_,w)}),f}function $o(o,s,u){s=Un(s,o),o=om(o,s);var f=o==null?o:o[an(Se(s))];return f==null?e:le(f,o,u)}function yp(o){return xt(o)&&Ht(o)==$r}function ck(o){return xt(o)&&Ht(o)==No}function uk(o){return xt(o)&&Ht(o)==Co}function Fo(o,s,u,f,p){return o===s?!0:o==null||s==null||!xt(o)&&!xt(s)?o!==o&&s!==s:hk(o,s,u,f,Fo,p)}function hk(o,s,u,f,p,_){var w=Q(o),k=Q(s),O=w?Ni:Vt(o),D=k?Ni:Vt(s);O=O==$r?gn:O,D=D==$r?gn:D;var R=O==gn,I=D==gn,$=O==D;if($&&Zn(o)){if(!Zn(s))return!1;w=!0,R=!1}if($&&!R)return _||(_=new Be),w||Xr(o)?Yp(o,s,u,f,p,_):Bk(o,s,O,u,f,p,_);if(!(u&C)){var H=R&&dt.call(o,"__wrapped__"),U=I&&dt.call(s,"__wrapped__");if(H||U){var nt=H?o.value():o,G=U?s.value():s;return _||(_=new Be),p(nt,G,u,f,_)}}return $?(_||(_=new Be),$k(o,s,u,f,p,_)):!1}function fk(o){return xt(o)&&Vt(o)==ze}function hl(o,s,u,f){var p=u.length,_=p,w=!f;if(o==null)return!_;for(o=gt(o);p--;){var k=u[p];if(w&&k[2]?k[1]!==o[k[0]]:!(k[0]in o))return!1}for(;++p<_;){k=u[p];var O=k[0],D=o[O],R=k[1];if(w&&k[2]){if(D===e&&!(O in o))return!1}else{var I=new Be;if(f)var $=f(D,R,O,o,s,I);if(!($===e?Fo(R,D,C|N,f,I):$))return!1}}return!0}function bp(o){if(!kt(o)||Uk(o))return!1;var s=xn(o)?fv:nw;return s.test(br(o))}function dk(o){return xt(o)&&Ht(o)==Mo}function pk(o){return xt(o)&&Vt(o)==je}function mk(o){return xt(o)&&ws(o.length)&&!!bt[Ht(o)]}function wp(o){return typeof o=="function"?o:o==null?ne:typeof o=="object"?Q(o)?xp(o[0],o[1]):kp(o):Lm(o)}function fl(o){if(!Wo(o))return yv(o);var s=[];for(var u in gt(o))dt.call(o,u)&&u!="constructor"&&s.push(u);return s}function gk(o){if(!kt(o))return Qk(o);var s=Wo(o),u=[];for(var f in o)f=="constructor"&&(s||!dt.call(o,f))||u.push(f);return u}function dl(o,s){return o<s}function vp(o,s){var u=-1,f=te(o)?M(o.length):[];return Hn(o,function(p,_,w){f[++u]=s(p,_,w)}),f}function kp(o){var s=Al(o);return s.length==1&&s[0][2]?nm(s[0][0],s[0][1]):function(u){return u===o||hl(u,o,s)}}function xp(o,s){return Nl(o)&&em(s)?nm(an(o),s):function(u){var f=Fl(u,o);return f===e&&f===s?Vl(u,o):Fo(s,f,C|N)}}function rs(o,s,u,f,p){o!==s&&al(s,function(_,w){if(p||(p=new Be),kt(_))_k(o,s,w,u,rs,f,p);else{var k=f?f(Dl(o,w),_,w+"",o,s,p):e;k===e&&(k=_),il(o,w,k)}},ee)}function _k(o,s,u,f,p,_,w){var k=Dl(o,u),O=Dl(s,u),D=w.get(O);if(D){il(o,u,D);return}var R=_?_(k,O,u+"",o,s,w):e,I=R===e;if(I){var $=Q(O),H=!$&&Zn(O),U=!$&&!H&&Xr(O);R=O,$||H||U?Q(k)?R=k:St(k)?R=Xt(k):H?(I=!1,R=zp(O,!0)):U?(I=!1,R=jp(O,!0)):R=[]:Jo(O)||wr(O)?(R=k,wr(k)?R=Dm(k):(!kt(k)||xn(k))&&(R=tm(O))):I=!1}I&&(w.set(O,R),p(R,O,f,_,w),w.delete(O)),il(o,u,R)}function Sp(o,s){var u=o.length;if(u)return s+=s<0?u:0,kn(s,u)?o[s]:e}function Cp(o,s,u){s.length?s=wt(s,function(_){return Q(_)?function(w){return _r(w,_.length===1?_[0]:_)}:_}):s=[ne];var f=-1;s=wt(s,ce(K()));var p=vp(o,function(_,w,k){var O=wt(s,function(D){return D(_)});return{criteria:O,index:++f,value:_}});return qw(p,function(_,w){return Nk(_,w,u)})}function yk(o,s){return Op(o,s,function(u,f){return Vl(o,f)})}function Op(o,s,u){for(var f=-1,p=s.length,_={};++f<p;){var w=s[f],k=_r(o,w);u(k,w)&&Vo(_,Un(w,o),k)}return _}function bk(o){return function(s){return _r(s,o)}}function pl(o,s,u,f){var p=f?Ww:Lr,_=-1,w=s.length,k=o;for(o===s&&(s=Xt(s)),u&&(k=wt(o,ce(u)));++_<w;)for(var O=0,D=s[_],R=u?u(D):D;(O=p(k,R,O,f))>-1;)k!==o&&Ki.call(k,O,1),Ki.call(o,O,1);return o}function Mp(o,s){for(var u=o?s.length:0,f=u-1;u--;){var p=s[u];if(u==f||p!==_){var _=p;kn(p)?Ki.call(o,p,1):yl(o,p)}}return o}function ml(o,s){return o+Zi(ap()*(s-o+1))}function wk(o,s,u,f){for(var p=-1,_=At(Gi((s-o)/(u||1)),0),w=M(_);_--;)w[f?_:++p]=o,o+=u;return w}function gl(o,s){var u="";if(!o||s<1||s>Vn)return u;do s%2&&(u+=o),s=Zi(s/2),s&&(o+=o);while(s);return u}function rt(o,s){return Rl(rm(o,s,ne),o+"")}function vk(o){return up(to(o))}function kk(o,s){var u=to(o);return ps(u,gr(s,0,u.length))}function Vo(o,s,u,f){if(!kt(o))return o;s=Un(s,o);for(var p=-1,_=s.length,w=_-1,k=o;k!=null&&++p<_;){var O=an(s[p]),D=u;if(O==="__proto__"||O==="constructor"||O==="prototype")return o;if(p!=w){var R=k[O];D=f?f(R,O,k):e,D===e&&(D=kt(R)?R:kn(s[p+1])?[]:{})}Po(k,O,D),k=k[O]}return o}var Ap=Yi?function(o,s){return Yi.set(o,s),o}:ne,xk=Ui?function(o,s){return Ui(o,"toString",{configurable:!0,enumerable:!1,value:Wl(s),writable:!0})}:ne;function Sk(o){return ps(to(o))}function xe(o,s,u){var f=-1,p=o.length;s<0&&(s=-s>p?0:p+s),u=u>p?p:u,u<0&&(u+=p),p=s>u?0:u-s>>>0,s>>>=0;for(var _=M(p);++f<p;)_[f]=o[f+s];return _}function Ck(o,s){var u;return Hn(o,function(f,p,_){return u=s(f,p,_),!u}),!!u}function is(o,s,u){var f=0,p=o==null?f:o.length;if(typeof s=="number"&&s===s&&p<=Mb){for(;f<p;){var _=f+p>>>1,w=o[_];w!==null&&!he(w)&&(u?w<=s:w<s)?f=_+1:p=_}return p}return _l(o,s,ne,u)}function _l(o,s,u,f){var p=0,_=o==null?0:o.length;if(_===0)return 0;s=u(s);for(var w=s!==s,k=s===null,O=he(s),D=s===e;p<_;){var R=Zi((p+_)/2),I=u(o[R]),$=I!==e,H=I===null,U=I===I,nt=he(I);if(w)var G=f||U;else D?G=U&&(f||$):k?G=U&&$&&(f||!H):O?G=U&&$&&!H&&(f||!nt):H||nt?G=!1:G=f?I<=s:I<s;G?p=R+1:_=R}return Ft(_,Ob)}function Tp(o,s){for(var u=-1,f=o.length,p=0,_=[];++u<f;){var w=o[u],k=s?s(w):w;if(!u||!$e(k,O)){var O=k;_[p++]=w===0?0:w}}return _}function Np(o){return typeof o=="number"?o:he(o)?Ti:+o}function ue(o){if(typeof o=="string")return o;if(Q(o))return wt(o,ue)+"";if(he(o))return lp?lp.call(o):"";var s=o+"";return s=="0"&&1/o==-hr?"-0":s}function Kn(o,s,u){var f=-1,p=Pi,_=o.length,w=!0,k=[],O=k;if(u)w=!1,p=Ha;else if(_>=i){var D=s?null:jk(o);if(D)return $i(D);w=!1,p=Eo,O=new mr}else O=s?[]:k;t:for(;++f<_;){var R=o[f],I=s?s(R):R;if(R=u||R!==0?R:0,w&&I===I){for(var $=O.length;$--;)if(O[$]===I)continue t;s&&O.push(I),k.push(R)}else p(O,I,u)||(O!==k&&O.push(I),k.push(R))}return k}function yl(o,s){return s=Un(s,o),o=om(o,s),o==null||delete o[an(Se(s))]}function Ep(o,s,u,f){return Vo(o,s,u(_r(o,s)),f)}function ss(o,s,u,f){for(var p=o.length,_=f?p:-1;(f?_--:++_<p)&&s(o[_],_,o););return u?xe(o,f?0:_,f?_+1:p):xe(o,f?_+1:0,f?p:_)}function Dp(o,s){var u=o;return u instanceof at&&(u=u.value()),Ka(s,function(f,p){return p.func.apply(p.thisArg,Wn([f],p.args))},u)}function bl(o,s,u){var f=o.length;if(f<2)return f?Kn(o[0]):[];for(var p=-1,_=M(f);++p<f;)for(var w=o[p],k=-1;++k<f;)k!=p&&(_[p]=Bo(_[p]||w,o[k],s,u));return Kn(zt(_,1),s,u)}function Rp(o,s,u){for(var f=-1,p=o.length,_=s.length,w={};++f<p;){var k=f<_?s[f]:e;u(w,o[f],k)}return w}function wl(o){return St(o)?o:[]}function vl(o){return typeof o=="function"?o:ne}function Un(o,s){return Q(o)?o:Nl(o,s)?[o]:lm(ft(o))}var Ok=rt;function Gn(o,s,u){var f=o.length;return u=u===e?f:u,!s&&u>=f?o:xe(o,s,u)}var Ip=dv||function(o){return It.clearTimeout(o)};function zp(o,s){if(s)return o.slice();var u=o.length,f=np?np(u):new o.constructor(u);return o.copy(f),f}function kl(o){var s=new o.constructor(o.byteLength);return new Ji(s).set(new Ji(o)),s}function Mk(o,s){var u=s?kl(o.buffer):o.buffer;return new o.constructor(u,o.byteOffset,o.byteLength)}function Ak(o){var s=new o.constructor(o.source,yd.exec(o));return s.lastIndex=o.lastIndex,s}function Tk(o){return jo?gt(jo.call(o)):{}}function jp(o,s){var u=s?kl(o.buffer):o.buffer;return new o.constructor(u,o.byteOffset,o.length)}function Pp(o,s){if(o!==s){var u=o!==e,f=o===null,p=o===o,_=he(o),w=s!==e,k=s===null,O=s===s,D=he(s);if(!k&&!D&&!_&&o>s||_&&w&&O&&!k&&!D||f&&w&&O||!u&&O||!p)return 1;if(!f&&!_&&!D&&o<s||D&&u&&p&&!f&&!_||k&&u&&p||!w&&p||!O)return-1}return 0}function Nk(o,s,u){for(var f=-1,p=o.criteria,_=s.criteria,w=p.length,k=u.length;++f<w;){var O=Pp(p[f],_[f]);if(O){if(f>=k)return O;var D=u[f];return O*(D=="desc"?-1:1)}}return o.index-s.index}function Bp(o,s,u,f){for(var p=-1,_=o.length,w=u.length,k=-1,O=s.length,D=At(_-w,0),R=M(O+D),I=!f;++k<O;)R[k]=s[k];for(;++p<w;)(I||p<_)&&(R[u[p]]=o[p]);for(;D--;)R[k++]=o[p++];return R}function $p(o,s,u,f){for(var p=-1,_=o.length,w=-1,k=u.length,O=-1,D=s.length,R=At(_-k,0),I=M(R+D),$=!f;++p<R;)I[p]=o[p];for(var H=p;++O<D;)I[H+O]=s[O];for(;++w<k;)($||p<_)&&(I[H+u[w]]=o[p++]);return I}function Xt(o,s){var u=-1,f=o.length;for(s||(s=M(f));++u<f;)s[u]=o[u];return s}function sn(o,s,u,f){var p=!u;u||(u={});for(var _=-1,w=s.length;++_<w;){var k=s[_],O=f?f(u[k],o[k],k,u,o):e;O===e&&(O=o[k]),p?bn(u,k,O):Po(u,k,O)}return u}function Ek(o,s){return sn(o,Tl(o),s)}function Dk(o,s){return sn(o,Qp(o),s)}function as(o,s){return function(u,f){var p=Q(u)?Pw:tk,_=s?s():{};return p(u,o,K(f,2),_)}}function Zr(o){return rt(function(s,u){var f=-1,p=u.length,_=p>1?u[p-1]:e,w=p>2?u[2]:e;for(_=o.length>3&&typeof _=="function"?(p--,_):e,w&&Kt(u[0],u[1],w)&&(_=p<3?e:_,p=1),s=gt(s);++f<p;){var k=u[f];k&&o(s,k,f,_)}return s})}function Fp(o,s){return function(u,f){if(u==null)return u;if(!te(u))return o(u,f);for(var p=u.length,_=s?p:-1,w=gt(u);(s?_--:++_<p)&&f(w[_],_,w)!==!1;);return u}}function Vp(o){return function(s,u,f){for(var p=-1,_=gt(s),w=f(s),k=w.length;k--;){var O=w[o?k:++p];if(u(_[O],O,_)===!1)break}return s}}function Rk(o,s,u){var f=s&P,p=Lo(o);function _(){var w=this&&this!==It&&this instanceof _?p:o;return w.apply(f?u:this,arguments)}return _}function Lp(o){return function(s){s=ft(s);var u=Wr(s)?Pe(s):e,f=u?u[0]:s.charAt(0),p=u?Gn(u,1).join(""):s.slice(1);return f[o]()+p}}function Yr(o){return function(s){return Ka(Fm($m(s).replace(xw,"")),o,"")}}function Lo(o){return function(){var s=arguments;switch(s.length){case 0:return new o;case 1:return new o(s[0]);case 2:return new o(s[0],s[1]);case 3:return new o(s[0],s[1],s[2]);case 4:return new o(s[0],s[1],s[2],s[3]);case 5:return new o(s[0],s[1],s[2],s[3],s[4]);case 6:return new o(s[0],s[1],s[2],s[3],s[4],s[5]);case 7:return new o(s[0],s[1],s[2],s[3],s[4],s[5],s[6])}var u=Gr(o.prototype),f=o.apply(u,s);return kt(f)?f:u}}function Ik(o,s,u){var f=Lo(o);function p(){for(var _=arguments.length,w=M(_),k=_,O=Qr(p);k--;)w[k]=arguments[k];var D=_<3&&w[0]!==O&&w[_-1]!==O?[]:qn(w,O);if(_-=D.length,_<u)return Kp(o,s,ls,p.placeholder,e,w,D,e,e,u-_);var R=this&&this!==It&&this instanceof p?f:o;return le(R,this,w)}return p}function Wp(o){return function(s,u,f){var p=gt(s);if(!te(s)){var _=K(u,3);s=Et(s),u=function(k){return _(p[k],k,p)}}var w=o(s,u,f);return w>-1?p[_?s[w]:w]:e}}function qp(o){return vn(function(s){var u=s.length,f=u,p=ve.prototype.thru;for(o&&s.reverse();f--;){var _=s[f];if(typeof _!="function")throw new we(l);if(p&&!w&&fs(_)=="wrapper")var w=new ve([],!0)}for(f=w?f:u;++f<u;){_=s[f];var k=fs(_),O=k=="wrapper"?Ml(_):e;O&&El(O[0])&&O[1]==(Qt|st|yt|tt)&&!O[4].length&&O[9]==1?w=w[fs(O[0])].apply(w,O[3]):w=_.length==1&&El(_)?w[k]():w.thru(_)}return function(){var D=arguments,R=D[0];if(w&&D.length==1&&Q(R))return w.plant(R).value();for(var I=0,$=u?s[I].apply(this,D):R;++I<u;)$=s[I].call(this,$);return $}})}function ls(o,s,u,f,p,_,w,k,O,D){var R=s&Qt,I=s&P,$=s&J,H=s&(st|ot),U=s&mn,nt=$?e:Lo(o);function G(){for(var it=arguments.length,lt=M(it),fe=it;fe--;)lt[fe]=arguments[fe];if(H)var Ut=Qr(G),de=Hw(lt,Ut);if(f&&(lt=Bp(lt,f,p,H)),_&&(lt=$p(lt,_,w,H)),it-=de,H&&it<D){var Ct=qn(lt,Ut);return Kp(o,s,ls,G.placeholder,u,lt,Ct,k,O,D-it)}var Fe=I?u:this,Cn=$?Fe[o]:o;return it=lt.length,k?lt=tx(lt,k):U&&it>1&&lt.reverse(),R&&O<it&&(lt.length=O),this&&this!==It&&this instanceof G&&(Cn=nt||Lo(Cn)),Cn.apply(Fe,lt)}return G}function Jp(o,s){return function(u,f){return lk(u,o,s(f),{})}}function cs(o,s){return function(u,f){var p;if(u===e&&f===e)return s;if(u!==e&&(p=u),f!==e){if(p===e)return f;typeof u=="string"||typeof f=="string"?(u=ue(u),f=ue(f)):(u=Np(u),f=Np(f)),p=o(u,f)}return p}}function xl(o){return vn(function(s){return s=wt(s,ce(K())),rt(function(u){var f=this;return o(s,function(p){return le(p,f,u)})})})}function us(o,s){s=s===e?" ":ue(s);var u=s.length;if(u<2)return u?gl(s,o):s;var f=gl(s,Gi(o/qr(s)));return Wr(s)?Gn(Pe(f),0,o).join(""):f.slice(0,o)}function zk(o,s,u,f){var p=s&P,_=Lo(o);function w(){for(var k=-1,O=arguments.length,D=-1,R=f.length,I=M(R+O),$=this&&this!==It&&this instanceof w?_:o;++D<R;)I[D]=f[D];for(;O--;)I[D++]=arguments[++k];return le($,p?u:this,I)}return w}function Hp(o){return function(s,u,f){return f&&typeof f!="number"&&Kt(s,u,f)&&(u=f=e),s=Sn(s),u===e?(u=s,s=0):u=Sn(u),f=f===e?s<u?1:-1:Sn(f),wk(s,u,f,o)}}function hs(o){return function(s,u){return typeof s=="string"&&typeof u=="string"||(s=Ce(s),u=Ce(u)),o(s,u)}}function Kp(o,s,u,f,p,_,w,k,O,D){var R=s&st,I=R?w:e,$=R?e:w,H=R?_:e,U=R?e:_;s|=R?yt:nn,s&=~(R?nn:yt),s&mt||(s&=~(P|J));var nt=[o,s,p,H,I,U,$,k,O,D],G=u.apply(e,nt);return El(o)&&im(G,nt),G.placeholder=f,sm(G,o,s)}function Sl(o){var s=Mt[o];return function(u,f){if(u=Ce(u),f=f==null?0:Ft(et(f),292),f&&sp(u)){var p=(ft(u)+"e").split("e"),_=s(p[0]+"e"+(+p[1]+f));return p=(ft(_)+"e").split("e"),+(p[0]+"e"+(+p[1]-f))}return s(u)}}var jk=Kr&&1/$i(new Kr([,-0]))[1]==hr?function(o){return new Kr(o)}:Hl;function Up(o){return function(s){var u=Vt(s);return u==ze?tl(s):u==je?Xw(s):Jw(s,o(s))}}function wn(o,s,u,f,p,_,w,k){var O=s&J;if(!O&&typeof o!="function")throw new we(l);var D=f?f.length:0;if(D||(s&=~(yt|nn),f=p=e),w=w===e?w:At(et(w),0),k=k===e?k:et(k),D-=p?p.length:0,s&nn){var R=f,I=p;f=p=e}var $=O?e:Ml(o),H=[o,s,u,f,p,R,I,_,w,k];if($&&Yk(H,$),o=H[0],s=H[1],u=H[2],f=H[3],p=H[4],k=H[9]=H[9]===e?O?0:o.length:At(H[9]-D,0),!k&&s&(st|ot)&&(s&=~(st|ot)),!s||s==P)var U=Rk(o,s,u);else s==st||s==ot?U=Ik(o,s,k):(s==yt||s==(P|yt))&&!p.length?U=zk(o,s,u,f):U=ls.apply(e,H);var nt=$?Ap:im;return sm(nt(U,H),o,s)}function Gp(o,s,u,f){return o===e||$e(o,Hr[u])&&!dt.call(f,u)?s:o}function Zp(o,s,u,f,p,_){return kt(o)&&kt(s)&&(_.set(s,o),rs(o,s,e,Zp,_),_.delete(s)),o}function Pk(o){return Jo(o)?e:o}function Yp(o,s,u,f,p,_){var w=u&C,k=o.length,O=s.length;if(k!=O&&!(w&&O>k))return!1;var D=_.get(o),R=_.get(s);if(D&&R)return D==s&&R==o;var I=-1,$=!0,H=u&N?new mr:e;for(_.set(o,s),_.set(s,o);++I<k;){var U=o[I],nt=s[I];if(f)var G=w?f(nt,U,I,s,o,_):f(U,nt,I,o,s,_);if(G!==e){if(G)continue;$=!1;break}if(H){if(!Ua(s,function(it,lt){if(!Eo(H,lt)&&(U===it||p(U,it,u,f,_)))return H.push(lt)})){$=!1;break}}else if(!(U===nt||p(U,nt,u,f,_))){$=!1;break}}return _.delete(o),_.delete(s),$}function Bk(o,s,u,f,p,_,w){switch(u){case Fr:if(o.byteLength!=s.byteLength||o.byteOffset!=s.byteOffset)return!1;o=o.buffer,s=s.buffer;case No:return!(o.byteLength!=s.byteLength||!_(new Ji(o),new Ji(s)));case So:case Co:case Oo:return $e(+o,+s);case Ei:return o.name==s.name&&o.message==s.message;case Mo:case Ao:return o==s+"";case ze:var k=tl;case je:var O=f&C;if(k||(k=$i),o.size!=s.size&&!O)return!1;var D=w.get(o);if(D)return D==s;f|=N,w.set(o,s);var R=Yp(k(o),k(s),f,p,_,w);return w.delete(o),R;case Ri:if(jo)return jo.call(o)==jo.call(s)}return!1}function $k(o,s,u,f,p,_){var w=u&C,k=Cl(o),O=k.length,D=Cl(s),R=D.length;if(O!=R&&!w)return!1;for(var I=O;I--;){var $=k[I];if(!(w?$ in s:dt.call(s,$)))return!1}var H=_.get(o),U=_.get(s);if(H&&U)return H==s&&U==o;var nt=!0;_.set(o,s),_.set(s,o);for(var G=w;++I<O;){$=k[I];var it=o[$],lt=s[$];if(f)var fe=w?f(lt,it,$,s,o,_):f(it,lt,$,o,s,_);if(!(fe===e?it===lt||p(it,lt,u,f,_):fe)){nt=!1;break}G||(G=$=="constructor")}if(nt&&!G){var Ut=o.constructor,de=s.constructor;Ut!=de&&"constructor"in o&&"constructor"in s&&!(typeof Ut=="function"&&Ut instanceof Ut&&typeof de=="function"&&de instanceof de)&&(nt=!1)}return _.delete(o),_.delete(s),nt}function vn(o){return Rl(rm(o,e,fm),o+"")}function Cl(o){return _p(o,Et,Tl)}function Ol(o){return _p(o,ee,Qp)}var Ml=Yi?function(o){return Yi.get(o)}:Hl;function fs(o){for(var s=o.name+"",u=Ur[s],f=dt.call(Ur,s)?u.length:0;f--;){var p=u[f],_=p.func;if(_==null||_==o)return p.name}return s}function Qr(o){var s=dt.call(g,"placeholder")?g:o;return s.placeholder}function K(){var o=g.iteratee||ql;return o=o===ql?wp:o,arguments.length?o(arguments[0],arguments[1]):o}function ds(o,s){var u=o.__data__;return Kk(s)?u[typeof s=="string"?"string":"hash"]:u.map}function Al(o){for(var s=Et(o),u=s.length;u--;){var f=s[u],p=o[f];s[u]=[f,p,em(p)]}return s}function yr(o,s){var u=Zw(o,s);return bp(u)?u:e}function Fk(o){var s=dt.call(o,dr),u=o[dr];try{o[dr]=e;var f=!0}catch{}var p=Wi.call(o);return f&&(s?o[dr]=u:delete o[dr]),p}var Tl=nl?function(o){return o==null?[]:(o=gt(o),Ln(nl(o),function(s){return op.call(o,s)}))}:Kl,Qp=nl?function(o){for(var s=[];o;)Wn(s,Tl(o)),o=Hi(o);return s}:Kl,Vt=Ht;(rl&&Vt(new rl(new ArrayBuffer(1)))!=Fr||Ro&&Vt(new Ro)!=ze||ol&&Vt(ol.resolve())!=pd||Kr&&Vt(new Kr)!=je||Io&&Vt(new Io)!=To)&&(Vt=function(o){var s=Ht(o),u=s==gn?o.constructor:e,f=u?br(u):"";if(f)switch(f){case kv:return Fr;case xv:return ze;case Sv:return pd;case Cv:return je;case Ov:return To}return s});function Vk(o,s,u){for(var f=-1,p=u.length;++f<p;){var _=u[f],w=_.size;switch(_.type){case"drop":o+=w;break;case"dropRight":s-=w;break;case"take":s=Ft(s,o+w);break;case"takeRight":o=At(o,s-w);break}}return{start:o,end:s}}function Lk(o){var s=o.match(Ub);return s?s[1].split(Gb):[]}function Xp(o,s,u){s=Un(s,o);for(var f=-1,p=s.length,_=!1;++f<p;){var w=an(s[f]);if(!(_=o!=null&&u(o,w)))break;o=o[w]}return _||++f!=p?_:(p=o==null?0:o.length,!!p&&ws(p)&&kn(w,p)&&(Q(o)||wr(o)))}function Wk(o){var s=o.length,u=new o.constructor(s);return s&&typeof o[0]=="string"&&dt.call(o,"index")&&(u.index=o.index,u.input=o.input),u}function tm(o){return typeof o.constructor=="function"&&!Wo(o)?Gr(Hi(o)):{}}function qk(o,s,u){var f=o.constructor;switch(s){case No:return kl(o);case So:case Co:return new f(+o);case Fr:return Mk(o,u);case Aa:case Ta:case Na:case Ea:case Da:case Ra:case Ia:case za:case ja:return jp(o,u);case ze:return new f;case Oo:case Ao:return new f(o);case Mo:return Ak(o);case je:return new f;case Ri:return Tk(o)}}function Jk(o,s){var u=s.length;if(!u)return o;var f=u-1;return s[f]=(u>1?"& ":"")+s[f],s=s.join(u>2?", ":" "),o.replace(Kb,`{
/* [wrapped with `+s+`] */
`)}function Hk(o){return Q(o)||wr(o)||!!(ip&&o&&o[ip])}function kn(o,s){var u=typeof o;return s=s!=null?s:Vn,!!s&&(u=="number"||u!="symbol"&&ow.test(o))&&o>-1&&o%1==0&&o<s}function Kt(o,s,u){if(!kt(u))return!1;var f=typeof s;return(f=="number"?te(u)&&kn(s,u.length):f=="string"&&s in u)?$e(u[s],o):!1}function Nl(o,s){if(Q(o))return!1;var u=typeof o;return u=="number"||u=="symbol"||u=="boolean"||o==null||he(o)?!0:Wb.test(o)||!Lb.test(o)||s!=null&&o in gt(s)}function Kk(o){var s=typeof o;return s=="string"||s=="number"||s=="symbol"||s=="boolean"?o!=="__proto__":o===null}function El(o){var s=fs(o),u=g[s];if(typeof u!="function"||!(s in at.prototype))return!1;if(o===u)return!0;var f=Ml(u);return!!f&&o===f[0]}function Uk(o){return!!ep&&ep in o}var Gk=Vi?xn:Ul;function Wo(o){var s=o&&o.constructor,u=typeof s=="function"&&s.prototype||Hr;return o===u}function em(o){return o===o&&!kt(o)}function nm(o,s){return function(u){return u==null?!1:u[o]===s&&(s!==e||o in gt(u))}}function Zk(o){var s=ys(o,function(f){return u.size===d&&u.clear(),f}),u=s.cache;return s}function Yk(o,s){var u=o[1],f=s[1],p=u|f,_=p<(P|J|Qt),w=f==Qt&&u==st||f==Qt&&u==tt&&o[7].length<=s[8]||f==(Qt|tt)&&s[7].length<=s[8]&&u==st;if(!(_||w))return o;f&P&&(o[2]=s[2],p|=u&P?0:mt);var k=s[3];if(k){var O=o[3];o[3]=O?Bp(O,k,s[4]):k,o[4]=O?qn(o[3],m):s[4]}return k=s[5],k&&(O=o[5],o[5]=O?$p(O,k,s[6]):k,o[6]=O?qn(o[5],m):s[6]),k=s[7],k&&(o[7]=k),f&Qt&&(o[8]=o[8]==null?s[8]:Ft(o[8],s[8])),o[9]==null&&(o[9]=s[9]),o[0]=s[0],o[1]=p,o}function Qk(o){var s=[];if(o!=null)for(var u in gt(o))s.push(u);return s}function Xk(o){return Wi.call(o)}function rm(o,s,u){return s=At(s===e?o.length-1:s,0),function(){for(var f=arguments,p=-1,_=At(f.length-s,0),w=M(_);++p<_;)w[p]=f[s+p];p=-1;for(var k=M(s+1);++p<s;)k[p]=f[p];return k[s]=u(w),le(o,this,k)}}function om(o,s){return s.length<2?o:_r(o,xe(s,0,-1))}function tx(o,s){for(var u=o.length,f=Ft(s.length,u),p=Xt(o);f--;){var _=s[f];o[f]=kn(_,u)?p[_]:e}return o}function Dl(o,s){if(!(s==="constructor"&&typeof o[s]=="function")&&s!="__proto__")return o[s]}var im=am(Ap),qo=mv||function(o,s){return It.setTimeout(o,s)},Rl=am(xk);function sm(o,s,u){var f=s+"";return Rl(o,Jk(f,ex(Lk(f),u)))}function am(o){var s=0,u=0;return function(){var f=bv(),p=kb-(f-u);if(u=f,p>0){if(++s>=vb)return arguments[0]}else s=0;return o.apply(e,arguments)}}function ps(o,s){var u=-1,f=o.length,p=f-1;for(s=s===e?f:s;++u<s;){var _=ml(u,p),w=o[_];o[_]=o[u],o[u]=w}return o.length=s,o}var lm=Zk(function(o){var s=[];return o.charCodeAt(0)===46&&s.push(""),o.replace(qb,function(u,f,p,_){s.push(p?_.replace(Qb,"$1"):f||u)}),s});function an(o){if(typeof o=="string"||he(o))return o;var s=o+"";return s=="0"&&1/o==-hr?"-0":s}function br(o){if(o!=null){try{return Li.call(o)}catch{}try{return o+""}catch{}}return""}function ex(o,s){return be(Ab,function(u){var f="_."+u[0];s&u[1]&&!Pi(o,f)&&o.push(f)}),o.sort()}function cm(o){if(o instanceof at)return o.clone();var s=new ve(o.__wrapped__,o.__chain__);return s.__actions__=Xt(o.__actions__),s.__index__=o.__index__,s.__values__=o.__values__,s}function nx(o,s,u){(u?Kt(o,s,u):s===e)?s=1:s=At(et(s),0);var f=o==null?0:o.length;if(!f||s<1)return[];for(var p=0,_=0,w=M(Gi(f/s));p<f;)w[_++]=xe(o,p,p+=s);return w}function rx(o){for(var s=-1,u=o==null?0:o.length,f=0,p=[];++s<u;){var _=o[s];_&&(p[f++]=_)}return p}function ox(){var o=arguments.length;if(!o)return[];for(var s=M(o-1),u=arguments[0],f=o;f--;)s[f-1]=arguments[f];return Wn(Q(u)?Xt(u):[u],zt(s,1))}var ix=rt(function(o,s){return St(o)?Bo(o,zt(s,1,St,!0)):[]}),sx=rt(function(o,s){var u=Se(s);return St(u)&&(u=e),St(o)?Bo(o,zt(s,1,St,!0),K(u,2)):[]}),ax=rt(function(o,s){var u=Se(s);return St(u)&&(u=e),St(o)?Bo(o,zt(s,1,St,!0),e,u):[]});function lx(o,s,u){var f=o==null?0:o.length;return f?(s=u||s===e?1:et(s),xe(o,s<0?0:s,f)):[]}function cx(o,s,u){var f=o==null?0:o.length;return f?(s=u||s===e?1:et(s),s=f-s,xe(o,0,s<0?0:s)):[]}function ux(o,s){return o&&o.length?ss(o,K(s,3),!0,!0):[]}function hx(o,s){return o&&o.length?ss(o,K(s,3),!0):[]}function fx(o,s,u,f){var p=o==null?0:o.length;return p?(u&&typeof u!="number"&&Kt(o,s,u)&&(u=0,f=p),ok(o,s,u,f)):[]}function um(o,s,u){var f=o==null?0:o.length;if(!f)return-1;var p=u==null?0:et(u);return p<0&&(p=At(f+p,0)),Bi(o,K(s,3),p)}function hm(o,s,u){var f=o==null?0:o.length;if(!f)return-1;var p=f-1;return u!==e&&(p=et(u),p=u<0?At(f+p,0):Ft(p,f-1)),Bi(o,K(s,3),p,!0)}function fm(o){var s=o==null?0:o.length;return s?zt(o,1):[]}function dx(o){var s=o==null?0:o.length;return s?zt(o,hr):[]}function px(o,s){var u=o==null?0:o.length;return u?(s=s===e?1:et(s),zt(o,s)):[]}function mx(o){for(var s=-1,u=o==null?0:o.length,f={};++s<u;){var p=o[s];f[p[0]]=p[1]}return f}function dm(o){return o&&o.length?o[0]:e}function gx(o,s,u){var f=o==null?0:o.length;if(!f)return-1;var p=u==null?0:et(u);return p<0&&(p=At(f+p,0)),Lr(o,s,p)}function _x(o){var s=o==null?0:o.length;return s?xe(o,0,-1):[]}var yx=rt(function(o){var s=wt(o,wl);return s.length&&s[0]===o[0]?ul(s):[]}),bx=rt(function(o){var s=Se(o),u=wt(o,wl);return s===Se(u)?s=e:u.pop(),u.length&&u[0]===o[0]?ul(u,K(s,2)):[]}),wx=rt(function(o){var s=Se(o),u=wt(o,wl);return s=typeof s=="function"?s:e,s&&u.pop(),u.length&&u[0]===o[0]?ul(u,e,s):[]});function vx(o,s){return o==null?"":_v.call(o,s)}function Se(o){var s=o==null?0:o.length;return s?o[s-1]:e}function kx(o,s,u){var f=o==null?0:o.length;if(!f)return-1;var p=f;return u!==e&&(p=et(u),p=p<0?At(f+p,0):Ft(p,f-1)),s===s?ev(o,s,p):Bi(o,Kd,p,!0)}function xx(o,s){return o&&o.length?Sp(o,et(s)):e}var Sx=rt(pm);function pm(o,s){return o&&o.length&&s&&s.length?pl(o,s):o}function Cx(o,s,u){return o&&o.length&&s&&s.length?pl(o,s,K(u,2)):o}function Ox(o,s,u){return o&&o.length&&s&&s.length?pl(o,s,e,u):o}var Mx=vn(function(o,s){var u=o==null?0:o.length,f=sl(o,s);return Mp(o,wt(s,function(p){return kn(p,u)?+p:p}).sort(Pp)),f});function Ax(o,s){var u=[];if(!(o&&o.length))return u;var f=-1,p=[],_=o.length;for(s=K(s,3);++f<_;){var w=o[f];s(w,f,o)&&(u.push(w),p.push(f))}return Mp(o,p),u}function Il(o){return o==null?o:vv.call(o)}function Tx(o,s,u){var f=o==null?0:o.length;return f?(u&&typeof u!="number"&&Kt(o,s,u)?(s=0,u=f):(s=s==null?0:et(s),u=u===e?f:et(u)),xe(o,s,u)):[]}function Nx(o,s){return is(o,s)}function Ex(o,s,u){return _l(o,s,K(u,2))}function Dx(o,s){var u=o==null?0:o.length;if(u){var f=is(o,s);if(f<u&&$e(o[f],s))return f}return-1}function Rx(o,s){return is(o,s,!0)}function Ix(o,s,u){return _l(o,s,K(u,2),!0)}function zx(o,s){var u=o==null?0:o.length;if(u){var f=is(o,s,!0)-1;if($e(o[f],s))return f}return-1}function jx(o){return o&&o.length?Tp(o):[]}function Px(o,s){return o&&o.length?Tp(o,K(s,2)):[]}function Bx(o){var s=o==null?0:o.length;return s?xe(o,1,s):[]}function $x(o,s,u){return o&&o.length?(s=u||s===e?1:et(s),xe(o,0,s<0?0:s)):[]}function Fx(o,s,u){var f=o==null?0:o.length;return f?(s=u||s===e?1:et(s),s=f-s,xe(o,s<0?0:s,f)):[]}function Vx(o,s){return o&&o.length?ss(o,K(s,3),!1,!0):[]}function Lx(o,s){return o&&o.length?ss(o,K(s,3)):[]}var Wx=rt(function(o){return Kn(zt(o,1,St,!0))}),qx=rt(function(o){var s=Se(o);return St(s)&&(s=e),Kn(zt(o,1,St,!0),K(s,2))}),Jx=rt(function(o){var s=Se(o);return s=typeof s=="function"?s:e,Kn(zt(o,1,St,!0),e,s)});function Hx(o){return o&&o.length?Kn(o):[]}function Kx(o,s){return o&&o.length?Kn(o,K(s,2)):[]}function Ux(o,s){return s=typeof s=="function"?s:e,o&&o.length?Kn(o,e,s):[]}function zl(o){if(!(o&&o.length))return[];var s=0;return o=Ln(o,function(u){if(St(u))return s=At(u.length,s),!0}),Qa(s,function(u){return wt(o,Ga(u))})}function mm(o,s){if(!(o&&o.length))return[];var u=zl(o);return s==null?u:wt(u,function(f){return le(s,e,f)})}var Gx=rt(function(o,s){return St(o)?Bo(o,s):[]}),Zx=rt(function(o){return bl(Ln(o,St))}),Yx=rt(function(o){var s=Se(o);return St(s)&&(s=e),bl(Ln(o,St),K(s,2))}),Qx=rt(function(o){var s=Se(o);return s=typeof s=="function"?s:e,bl(Ln(o,St),e,s)}),Xx=rt(zl);function tS(o,s){return Rp(o||[],s||[],Po)}function eS(o,s){return Rp(o||[],s||[],Vo)}var nS=rt(function(o){var s=o.length,u=s>1?o[s-1]:e;return u=typeof u=="function"?(o.pop(),u):e,mm(o,u)});function gm(o){var s=g(o);return s.__chain__=!0,s}function rS(o,s){return s(o),o}function ms(o,s){return s(o)}var oS=vn(function(o){var s=o.length,u=s?o[0]:0,f=this.__wrapped__,p=function(_){return sl(_,o)};return s>1||this.__actions__.length||!(f instanceof at)||!kn(u)?this.thru(p):(f=f.slice(u,+u+(s?1:0)),f.__actions__.push({func:ms,args:[p],thisArg:e}),new ve(f,this.__chain__).thru(function(_){return s&&!_.length&&_.push(e),_}))});function iS(){return gm(this)}function sS(){return new ve(this.value(),this.__chain__)}function aS(){this.__values__===e&&(this.__values__=Nm(this.value()));var o=this.__index__>=this.__values__.length,s=o?e:this.__values__[this.__index__++];return{done:o,value:s}}function lS(){return this}function cS(o){for(var s,u=this;u instanceof Xi;){var f=cm(u);f.__index__=0,f.__values__=e,s?p.__wrapped__=f:s=f;var p=f;u=u.__wrapped__}return p.__wrapped__=o,s}function uS(){var o=this.__wrapped__;if(o instanceof at){var s=o;return this.__actions__.length&&(s=new at(this)),s=s.reverse(),s.__actions__.push({func:ms,args:[Il],thisArg:e}),new ve(s,this.__chain__)}return this.thru(Il)}function hS(){return Dp(this.__wrapped__,this.__actions__)}var fS=as(function(o,s,u){dt.call(o,u)?++o[u]:bn(o,u,1)});function dS(o,s,u){var f=Q(o)?Jd:rk;return u&&Kt(o,s,u)&&(s=e),f(o,K(s,3))}function pS(o,s){var u=Q(o)?Ln:mp;return u(o,K(s,3))}var mS=Wp(um),gS=Wp(hm);function _S(o,s){return zt(gs(o,s),1)}function yS(o,s){return zt(gs(o,s),hr)}function bS(o,s,u){return u=u===e?1:et(u),zt(gs(o,s),u)}function _m(o,s){var u=Q(o)?be:Hn;return u(o,K(s,3))}function ym(o,s){var u=Q(o)?Bw:pp;return u(o,K(s,3))}var wS=as(function(o,s,u){dt.call(o,u)?o[u].push(s):bn(o,u,[s])});function vS(o,s,u,f){o=te(o)?o:to(o),u=u&&!f?et(u):0;var p=o.length;return u<0&&(u=At(p+u,0)),vs(o)?u<=p&&o.indexOf(s,u)>-1:!!p&&Lr(o,s,u)>-1}var kS=rt(function(o,s,u){var f=-1,p=typeof s=="function",_=te(o)?M(o.length):[];return Hn(o,function(w){_[++f]=p?le(s,w,u):$o(w,s,u)}),_}),xS=as(function(o,s,u){bn(o,u,s)});function gs(o,s){var u=Q(o)?wt:vp;return u(o,K(s,3))}function SS(o,s,u,f){return o==null?[]:(Q(s)||(s=s==null?[]:[s]),u=f?e:u,Q(u)||(u=u==null?[]:[u]),Cp(o,s,u))}var CS=as(function(o,s,u){o[u?0:1].push(s)},function(){return[[],[]]});function OS(o,s,u){var f=Q(o)?Ka:Gd,p=arguments.length<3;return f(o,K(s,4),u,p,Hn)}function MS(o,s,u){var f=Q(o)?$w:Gd,p=arguments.length<3;return f(o,K(s,4),u,p,pp)}function AS(o,s){var u=Q(o)?Ln:mp;return u(o,bs(K(s,3)))}function TS(o){var s=Q(o)?up:vk;return s(o)}function NS(o,s,u){(u?Kt(o,s,u):s===e)?s=1:s=et(s);var f=Q(o)?Qv:kk;return f(o,s)}function ES(o){var s=Q(o)?Xv:Sk;return s(o)}function DS(o){if(o==null)return 0;if(te(o))return vs(o)?qr(o):o.length;var s=Vt(o);return s==ze||s==je?o.size:fl(o).length}function RS(o,s,u){var f=Q(o)?Ua:Ck;return u&&Kt(o,s,u)&&(s=e),f(o,K(s,3))}var IS=rt(function(o,s){if(o==null)return[];var u=s.length;return u>1&&Kt(o,s[0],s[1])?s=[]:u>2&&Kt(s[0],s[1],s[2])&&(s=[s[0]]),Cp(o,zt(s,1),[])}),_s=pv||function(){return It.Date.now()};function zS(o,s){if(typeof s!="function")throw new we(l);return o=et(o),function(){if(--o<1)return s.apply(this,arguments)}}function bm(o,s,u){return s=u?e:s,s=o&&s==null?o.length:s,wn(o,Qt,e,e,e,e,s)}function wm(o,s){var u;if(typeof s!="function")throw new we(l);return o=et(o),function(){return--o>0&&(u=s.apply(this,arguments)),o<=1&&(s=e),u}}var jl=rt(function(o,s,u){var f=P;if(u.length){var p=qn(u,Qr(jl));f|=yt}return wn(o,f,s,u,p)}),vm=rt(function(o,s,u){var f=P|J;if(u.length){var p=qn(u,Qr(vm));f|=yt}return wn(s,f,o,u,p)});function km(o,s,u){s=u?e:s;var f=wn(o,st,e,e,e,e,e,s);return f.placeholder=km.placeholder,f}function xm(o,s,u){s=u?e:s;var f=wn(o,ot,e,e,e,e,e,s);return f.placeholder=xm.placeholder,f}function Sm(o,s,u){var f,p,_,w,k,O,D=0,R=!1,I=!1,$=!0;if(typeof o!="function")throw new we(l);s=Ce(s)||0,kt(u)&&(R=!!u.leading,I="maxWait"in u,_=I?At(Ce(u.maxWait)||0,s):_,$="trailing"in u?!!u.trailing:$);function H(Ct){var Fe=f,Cn=p;return f=p=e,D=Ct,w=o.apply(Cn,Fe),w}function U(Ct){return D=Ct,k=qo(it,s),R?H(Ct):w}function nt(Ct){var Fe=Ct-O,Cn=Ct-D,Wm=s-Fe;return I?Ft(Wm,_-Cn):Wm}function G(Ct){var Fe=Ct-O,Cn=Ct-D;return O===e||Fe>=s||Fe<0||I&&Cn>=_}function it(){var Ct=_s();if(G(Ct))return lt(Ct);k=qo(it,nt(Ct))}function lt(Ct){return k=e,$&&f?H(Ct):(f=p=e,w)}function fe(){k!==e&&Ip(k),D=0,f=O=p=k=e}function Ut(){return k===e?w:lt(_s())}function de(){var Ct=_s(),Fe=G(Ct);if(f=arguments,p=this,O=Ct,Fe){if(k===e)return U(O);if(I)return Ip(k),k=qo(it,s),H(O)}return k===e&&(k=qo(it,s)),w}return de.cancel=fe,de.flush=Ut,de}var jS=rt(function(o,s){return dp(o,1,s)}),PS=rt(function(o,s,u){return dp(o,Ce(s)||0,u)});function BS(o){return wn(o,mn)}function ys(o,s){if(typeof o!="function"||s!=null&&typeof s!="function")throw new we(l);var u=function(){var f=arguments,p=s?s.apply(this,f):f[0],_=u.cache;if(_.has(p))return _.get(p);var w=o.apply(this,f);return u.cache=_.set(p,w)||_,w};return u.cache=new(ys.Cache||yn),u}ys.Cache=yn;function bs(o){if(typeof o!="function")throw new we(l);return function(){var s=arguments;switch(s.length){case 0:return!o.call(this);case 1:return!o.call(this,s[0]);case 2:return!o.call(this,s[0],s[1]);case 3:return!o.call(this,s[0],s[1],s[2])}return!o.apply(this,s)}}function $S(o){return wm(2,o)}var FS=Ok(function(o,s){s=s.length==1&&Q(s[0])?wt(s[0],ce(K())):wt(zt(s,1),ce(K()));var u=s.length;return rt(function(f){for(var p=-1,_=Ft(f.length,u);++p<_;)f[p]=s[p].call(this,f[p]);return le(o,this,f)})}),Pl=rt(function(o,s){var u=qn(s,Qr(Pl));return wn(o,yt,e,s,u)}),Cm=rt(function(o,s){var u=qn(s,Qr(Cm));return wn(o,nn,e,s,u)}),VS=vn(function(o,s){return wn(o,tt,e,e,e,s)});function LS(o,s){if(typeof o!="function")throw new we(l);return s=s===e?s:et(s),rt(o,s)}function WS(o,s){if(typeof o!="function")throw new we(l);return s=s==null?0:At(et(s),0),rt(function(u){var f=u[s],p=Gn(u,0,s);return f&&Wn(p,f),le(o,this,p)})}function qS(o,s,u){var f=!0,p=!0;if(typeof o!="function")throw new we(l);return kt(u)&&(f="leading"in u?!!u.leading:f,p="trailing"in u?!!u.trailing:p),Sm(o,s,{leading:f,maxWait:s,trailing:p})}function JS(o){return bm(o,1)}function HS(o,s){return Pl(vl(s),o)}function KS(){if(!arguments.length)return[];var o=arguments[0];return Q(o)?o:[o]}function US(o){return ke(o,b)}function GS(o,s){return s=typeof s=="function"?s:e,ke(o,b,s)}function ZS(o){return ke(o,y|b)}function YS(o,s){return s=typeof s=="function"?s:e,ke(o,y|b,s)}function QS(o,s){return s==null||fp(o,s,Et(s))}function $e(o,s){return o===s||o!==o&&s!==s}var XS=hs(cl),t2=hs(function(o,s){return o>=s}),wr=yp(function(){return arguments}())?yp:function(o){return xt(o)&&dt.call(o,"callee")&&!op.call(o,"callee")},Q=M.isArray,e2=$d?ce($d):ck;function te(o){return o!=null&&ws(o.length)&&!xn(o)}function St(o){return xt(o)&&te(o)}function n2(o){return o===!0||o===!1||xt(o)&&Ht(o)==So}var Zn=gv||Ul,r2=Fd?ce(Fd):uk;function o2(o){return xt(o)&&o.nodeType===1&&!Jo(o)}function i2(o){if(o==null)return!0;if(te(o)&&(Q(o)||typeof o=="string"||typeof o.splice=="function"||Zn(o)||Xr(o)||wr(o)))return!o.length;var s=Vt(o);if(s==ze||s==je)return!o.size;if(Wo(o))return!fl(o).length;for(var u in o)if(dt.call(o,u))return!1;return!0}function s2(o,s){return Fo(o,s)}function a2(o,s,u){u=typeof u=="function"?u:e;var f=u?u(o,s):e;return f===e?Fo(o,s,e,u):!!f}function Bl(o){if(!xt(o))return!1;var s=Ht(o);return s==Ei||s==Nb||typeof o.message=="string"&&typeof o.name=="string"&&!Jo(o)}function l2(o){return typeof o=="number"&&sp(o)}function xn(o){if(!kt(o))return!1;var s=Ht(o);return s==Di||s==dd||s==Tb||s==Db}function Om(o){return typeof o=="number"&&o==et(o)}function ws(o){return typeof o=="number"&&o>-1&&o%1==0&&o<=Vn}function kt(o){var s=typeof o;return o!=null&&(s=="object"||s=="function")}function xt(o){return o!=null&&typeof o=="object"}var Mm=Vd?ce(Vd):fk;function c2(o,s){return o===s||hl(o,s,Al(s))}function u2(o,s,u){return u=typeof u=="function"?u:e,hl(o,s,Al(s),u)}function h2(o){return Am(o)&&o!=+o}function f2(o){if(Gk(o))throw new Y(a);return bp(o)}function d2(o){return o===null}function p2(o){return o==null}function Am(o){return typeof o=="number"||xt(o)&&Ht(o)==Oo}function Jo(o){if(!xt(o)||Ht(o)!=gn)return!1;var s=Hi(o);if(s===null)return!0;var u=dt.call(s,"constructor")&&s.constructor;return typeof u=="function"&&u instanceof u&&Li.call(u)==uv}var $l=Ld?ce(Ld):dk;function m2(o){return Om(o)&&o>=-Vn&&o<=Vn}var Tm=Wd?ce(Wd):pk;function vs(o){return typeof o=="string"||!Q(o)&&xt(o)&&Ht(o)==Ao}function he(o){return typeof o=="symbol"||xt(o)&&Ht(o)==Ri}var Xr=qd?ce(qd):mk;function g2(o){return o===e}function _2(o){return xt(o)&&Vt(o)==To}function y2(o){return xt(o)&&Ht(o)==Ib}var b2=hs(dl),w2=hs(function(o,s){return o<=s});function Nm(o){if(!o)return[];if(te(o))return vs(o)?Pe(o):Xt(o);if(Do&&o[Do])return Qw(o[Do]());var s=Vt(o),u=s==ze?tl:s==je?$i:to;return u(o)}function Sn(o){if(!o)return o===0?o:0;if(o=Ce(o),o===hr||o===-hr){var s=o<0?-1:1;return s*Cb}return o===o?o:0}function et(o){var s=Sn(o),u=s%1;return s===s?u?s-u:s:0}function Em(o){return o?gr(et(o),0,rn):0}function Ce(o){if(typeof o=="number")return o;if(he(o))return Ti;if(kt(o)){var s=typeof o.valueOf=="function"?o.valueOf():o;o=kt(s)?s+"":s}if(typeof o!="string")return o===0?o:+o;o=Zd(o);var u=ew.test(o);return u||rw.test(o)?zw(o.slice(2),u?2:8):tw.test(o)?Ti:+o}function Dm(o){return sn(o,ee(o))}function v2(o){return o?gr(et(o),-Vn,Vn):o===0?o:0}function ft(o){return o==null?"":ue(o)}var k2=Zr(function(o,s){if(Wo(s)||te(s)){sn(s,Et(s),o);return}for(var u in s)dt.call(s,u)&&Po(o,u,s[u])}),Rm=Zr(function(o,s){sn(s,ee(s),o)}),ks=Zr(function(o,s,u,f){sn(s,ee(s),o,f)}),x2=Zr(function(o,s,u,f){sn(s,Et(s),o,f)}),S2=vn(sl);function C2(o,s){var u=Gr(o);return s==null?u:hp(u,s)}var O2=rt(function(o,s){o=gt(o);var u=-1,f=s.length,p=f>2?s[2]:e;for(p&&Kt(s[0],s[1],p)&&(f=1);++u<f;)for(var _=s[u],w=ee(_),k=-1,O=w.length;++k<O;){var D=w[k],R=o[D];(R===e||$e(R,Hr[D])&&!dt.call(o,D))&&(o[D]=_[D])}return o}),M2=rt(function(o){return o.push(e,Zp),le(Im,e,o)});function A2(o,s){return Hd(o,K(s,3),on)}function T2(o,s){return Hd(o,K(s,3),ll)}function N2(o,s){return o==null?o:al(o,K(s,3),ee)}function E2(o,s){return o==null?o:gp(o,K(s,3),ee)}function D2(o,s){return o&&on(o,K(s,3))}function R2(o,s){return o&&ll(o,K(s,3))}function I2(o){return o==null?[]:ns(o,Et(o))}function z2(o){return o==null?[]:ns(o,ee(o))}function Fl(o,s,u){var f=o==null?e:_r(o,s);return f===e?u:f}function j2(o,s){return o!=null&&Xp(o,s,ik)}function Vl(o,s){return o!=null&&Xp(o,s,sk)}var P2=Jp(function(o,s,u){s!=null&&typeof s.toString!="function"&&(s=Wi.call(s)),o[s]=u},Wl(ne)),B2=Jp(function(o,s,u){s!=null&&typeof s.toString!="function"&&(s=Wi.call(s)),dt.call(o,s)?o[s].push(u):o[s]=[u]},K),$2=rt($o);function Et(o){return te(o)?cp(o):fl(o)}function ee(o){return te(o)?cp(o,!0):gk(o)}function F2(o,s){var u={};return s=K(s,3),on(o,function(f,p,_){bn(u,s(f,p,_),f)}),u}function V2(o,s){var u={};return s=K(s,3),on(o,function(f,p,_){bn(u,p,s(f,p,_))}),u}var L2=Zr(function(o,s,u){rs(o,s,u)}),Im=Zr(function(o,s,u,f){rs(o,s,u,f)}),W2=vn(function(o,s){var u={};if(o==null)return u;var f=!1;s=wt(s,function(_){return _=Un(_,o),f||(f=_.length>1),_}),sn(o,Ol(o),u),f&&(u=ke(u,y|v|b,Pk));for(var p=s.length;p--;)yl(u,s[p]);return u});function q2(o,s){return zm(o,bs(K(s)))}var J2=vn(function(o,s){return o==null?{}:yk(o,s)});function zm(o,s){if(o==null)return{};var u=wt(Ol(o),function(f){return[f]});return s=K(s),Op(o,u,function(f,p){return s(f,p[0])})}function H2(o,s,u){s=Un(s,o);var f=-1,p=s.length;for(p||(p=1,o=e);++f<p;){var _=o==null?e:o[an(s[f])];_===e&&(f=p,_=u),o=xn(_)?_.call(o):_}return o}function K2(o,s,u){return o==null?o:Vo(o,s,u)}function U2(o,s,u,f){return f=typeof f=="function"?f:e,o==null?o:Vo(o,s,u,f)}var jm=Up(Et),Pm=Up(ee);function G2(o,s,u){var f=Q(o),p=f||Zn(o)||Xr(o);if(s=K(s,4),u==null){var _=o&&o.constructor;p?u=f?new _:[]:kt(o)?u=xn(_)?Gr(Hi(o)):{}:u={}}return(p?be:on)(o,function(w,k,O){return s(u,w,k,O)}),u}function Z2(o,s){return o==null?!0:yl(o,s)}function Y2(o,s,u){return o==null?o:Ep(o,s,vl(u))}function Q2(o,s,u,f){return f=typeof f=="function"?f:e,o==null?o:Ep(o,s,vl(u),f)}function to(o){return o==null?[]:Xa(o,Et(o))}function X2(o){return o==null?[]:Xa(o,ee(o))}function tC(o,s,u){return u===e&&(u=s,s=e),u!==e&&(u=Ce(u),u=u===u?u:0),s!==e&&(s=Ce(s),s=s===s?s:0),gr(Ce(o),s,u)}function eC(o,s,u){return s=Sn(s),u===e?(u=s,s=0):u=Sn(u),o=Ce(o),ak(o,s,u)}function nC(o,s,u){if(u&&typeof u!="boolean"&&Kt(o,s,u)&&(s=u=e),u===e&&(typeof s=="boolean"?(u=s,s=e):typeof o=="boolean"&&(u=o,o=e)),o===e&&s===e?(o=0,s=1):(o=Sn(o),s===e?(s=o,o=0):s=Sn(s)),o>s){var f=o;o=s,s=f}if(u||o%1||s%1){var p=ap();return Ft(o+p*(s-o+Iw("1e-"+((p+"").length-1))),s)}return ml(o,s)}var rC=Yr(function(o,s,u){return s=s.toLowerCase(),o+(u?Bm(s):s)});function Bm(o){return Ll(ft(o).toLowerCase())}function $m(o){return o=ft(o),o&&o.replace(iw,Kw).replace(Sw,"")}function oC(o,s,u){o=ft(o),s=ue(s);var f=o.length;u=u===e?f:gr(et(u),0,f);var p=u;return u-=s.length,u>=0&&o.slice(u,p)==s}function iC(o){return o=ft(o),o&&$b.test(o)?o.replace(gd,Uw):o}function sC(o){return o=ft(o),o&&Jb.test(o)?o.replace(Pa,"\\$&"):o}var aC=Yr(function(o,s,u){return o+(u?"-":"")+s.toLowerCase()}),lC=Yr(function(o,s,u){return o+(u?" ":"")+s.toLowerCase()}),cC=Lp("toLowerCase");function uC(o,s,u){o=ft(o),s=et(s);var f=s?qr(o):0;if(!s||f>=s)return o;var p=(s-f)/2;return us(Zi(p),u)+o+us(Gi(p),u)}function hC(o,s,u){o=ft(o),s=et(s);var f=s?qr(o):0;return s&&f<s?o+us(s-f,u):o}function fC(o,s,u){o=ft(o),s=et(s);var f=s?qr(o):0;return s&&f<s?us(s-f,u)+o:o}function dC(o,s,u){return u||s==null?s=0:s&&(s=+s),wv(ft(o).replace(Ba,""),s||0)}function pC(o,s,u){return(u?Kt(o,s,u):s===e)?s=1:s=et(s),gl(ft(o),s)}function mC(){var o=arguments,s=ft(o[0]);return o.length<3?s:s.replace(o[1],o[2])}var gC=Yr(function(o,s,u){return o+(u?"_":"")+s.toLowerCase()});function _C(o,s,u){return u&&typeof u!="number"&&Kt(o,s,u)&&(s=u=e),u=u===e?rn:u>>>0,u?(o=ft(o),o&&(typeof s=="string"||s!=null&&!$l(s))&&(s=ue(s),!s&&Wr(o))?Gn(Pe(o),0,u):o.split(s,u)):[]}var yC=Yr(function(o,s,u){return o+(u?" ":"")+Ll(s)});function bC(o,s,u){return o=ft(o),u=u==null?0:gr(et(u),0,o.length),s=ue(s),o.slice(u,u+s.length)==s}function wC(o,s,u){var f=g.templateSettings;u&&Kt(o,s,u)&&(s=e),o=ft(o),s=ks({},s,f,Gp);var p=ks({},s.imports,f.imports,Gp),_=Et(p),w=Xa(p,_),k,O,D=0,R=s.interpolate||Ii,I="__p += '",$=el((s.escape||Ii).source+"|"+R.source+"|"+(R===_d?Xb:Ii).source+"|"+(s.evaluate||Ii).source+"|$","g"),H="//# sourceURL="+(dt.call(s,"sourceURL")?(s.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Tw+"]")+`
`;o.replace($,function(G,it,lt,fe,Ut,de){return lt||(lt=fe),I+=o.slice(D,de).replace(sw,Gw),it&&(k=!0,I+=`' +
__e(`+it+`) +
'`),Ut&&(O=!0,I+=`';
`+Ut+`;
__p += '`),lt&&(I+=`' +
((__t = (`+lt+`)) == null ? '' : __t) +
'`),D=de+G.length,G}),I+=`';
`;var U=dt.call(s,"variable")&&s.variable;if(!U)I=`with (obj) {
`+I+`
}
`;else if(Yb.test(U))throw new Y(c);I=(O?I.replace(zb,""):I).replace(jb,"$1").replace(Pb,"$1;"),I="function("+(U||"obj")+`) {
`+(U?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(k?", __e = _.escape":"")+(O?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+I+`return __p
}`;var nt=Vm(function(){return ut(_,H+"return "+I).apply(e,w)});if(nt.source=I,Bl(nt))throw nt;return nt}function vC(o){return ft(o).toLowerCase()}function kC(o){return ft(o).toUpperCase()}function xC(o,s,u){if(o=ft(o),o&&(u||s===e))return Zd(o);if(!o||!(s=ue(s)))return o;var f=Pe(o),p=Pe(s),_=Yd(f,p),w=Qd(f,p)+1;return Gn(f,_,w).join("")}function SC(o,s,u){if(o=ft(o),o&&(u||s===e))return o.slice(0,tp(o)+1);if(!o||!(s=ue(s)))return o;var f=Pe(o),p=Qd(f,Pe(s))+1;return Gn(f,0,p).join("")}function CC(o,s,u){if(o=ft(o),o&&(u||s===e))return o.replace(Ba,"");if(!o||!(s=ue(s)))return o;var f=Pe(o),p=Yd(f,Pe(s));return Gn(f,p).join("")}function OC(o,s){var u=xo,f=Ma;if(kt(s)){var p="separator"in s?s.separator:p;u="length"in s?et(s.length):u,f="omission"in s?ue(s.omission):f}o=ft(o);var _=o.length;if(Wr(o)){var w=Pe(o);_=w.length}if(u>=_)return o;var k=u-qr(f);if(k<1)return f;var O=w?Gn(w,0,k).join(""):o.slice(0,k);if(p===e)return O+f;if(w&&(k+=O.length-k),$l(p)){if(o.slice(k).search(p)){var D,R=O;for(p.global||(p=el(p.source,ft(yd.exec(p))+"g")),p.lastIndex=0;D=p.exec(R);)var I=D.index;O=O.slice(0,I===e?k:I)}}else if(o.indexOf(ue(p),k)!=k){var $=O.lastIndexOf(p);$>-1&&(O=O.slice(0,$))}return O+f}function MC(o){return o=ft(o),o&&Bb.test(o)?o.replace(md,nv):o}var AC=Yr(function(o,s,u){return o+(u?" ":"")+s.toUpperCase()}),Ll=Lp("toUpperCase");function Fm(o,s,u){return o=ft(o),s=u?e:s,s===e?Yw(o)?iv(o):Lw(o):o.match(s)||[]}var Vm=rt(function(o,s){try{return le(o,e,s)}catch(u){return Bl(u)?u:new Y(u)}}),TC=vn(function(o,s){return be(s,function(u){u=an(u),bn(o,u,jl(o[u],o))}),o});function NC(o){var s=o==null?0:o.length,u=K();return o=s?wt(o,function(f){if(typeof f[1]!="function")throw new we(l);return[u(f[0]),f[1]]}):[],rt(function(f){for(var p=-1;++p<s;){var _=o[p];if(le(_[0],this,f))return le(_[1],this,f)}})}function EC(o){return nk(ke(o,y))}function Wl(o){return function(){return o}}function DC(o,s){return o==null||o!==o?s:o}var RC=qp(),IC=qp(!0);function ne(o){return o}function ql(o){return wp(typeof o=="function"?o:ke(o,y))}function zC(o){return kp(ke(o,y))}function jC(o,s){return xp(o,ke(s,y))}var PC=rt(function(o,s){return function(u){return $o(u,o,s)}}),BC=rt(function(o,s){return function(u){return $o(o,u,s)}});function Jl(o,s,u){var f=Et(s),p=ns(s,f);u==null&&!(kt(s)&&(p.length||!f.length))&&(u=s,s=o,o=this,p=ns(s,Et(s)));var _=!(kt(u)&&"chain"in u)||!!u.chain,w=xn(o);return be(p,function(k){var O=s[k];o[k]=O,w&&(o.prototype[k]=function(){var D=this.__chain__;if(_||D){var R=o(this.__wrapped__),I=R.__actions__=Xt(this.__actions__);return I.push({func:O,args:arguments,thisArg:o}),R.__chain__=D,R}return O.apply(o,Wn([this.value()],arguments))})}),o}function $C(){return It._===this&&(It._=hv),this}function Hl(){}function FC(o){return o=et(o),rt(function(s){return Sp(s,o)})}var VC=xl(wt),LC=xl(Jd),WC=xl(Ua);function Lm(o){return Nl(o)?Ga(an(o)):bk(o)}function qC(o){return function(s){return o==null?e:_r(o,s)}}var JC=Hp(),HC=Hp(!0);function Kl(){return[]}function Ul(){return!1}function KC(){return{}}function UC(){return""}function GC(){return!0}function ZC(o,s){if(o=et(o),o<1||o>Vn)return[];var u=rn,f=Ft(o,rn);s=K(s),o-=rn;for(var p=Qa(f,s);++u<o;)s(u);return p}function YC(o){return Q(o)?wt(o,an):he(o)?[o]:Xt(lm(ft(o)))}function QC(o){var s=++cv;return ft(o)+s}var XC=cs(function(o,s){return o+s},0),tO=Sl("ceil"),eO=cs(function(o,s){return o/s},1),nO=Sl("floor");function rO(o){return o&&o.length?es(o,ne,cl):e}function oO(o,s){return o&&o.length?es(o,K(s,2),cl):e}function iO(o){return Ud(o,ne)}function sO(o,s){return Ud(o,K(s,2))}function aO(o){return o&&o.length?es(o,ne,dl):e}function lO(o,s){return o&&o.length?es(o,K(s,2),dl):e}var cO=cs(function(o,s){return o*s},1),uO=Sl("round"),hO=cs(function(o,s){return o-s},0);function fO(o){return o&&o.length?Ya(o,ne):0}function dO(o,s){return o&&o.length?Ya(o,K(s,2)):0}return g.after=zS,g.ary=bm,g.assign=k2,g.assignIn=Rm,g.assignInWith=ks,g.assignWith=x2,g.at=S2,g.before=wm,g.bind=jl,g.bindAll=TC,g.bindKey=vm,g.castArray=KS,g.chain=gm,g.chunk=nx,g.compact=rx,g.concat=ox,g.cond=NC,g.conforms=EC,g.constant=Wl,g.countBy=fS,g.create=C2,g.curry=km,g.curryRight=xm,g.debounce=Sm,g.defaults=O2,g.defaultsDeep=M2,g.defer=jS,g.delay=PS,g.difference=ix,g.differenceBy=sx,g.differenceWith=ax,g.drop=lx,g.dropRight=cx,g.dropRightWhile=ux,g.dropWhile=hx,g.fill=fx,g.filter=pS,g.flatMap=_S,g.flatMapDeep=yS,g.flatMapDepth=bS,g.flatten=fm,g.flattenDeep=dx,g.flattenDepth=px,g.flip=BS,g.flow=RC,g.flowRight=IC,g.fromPairs=mx,g.functions=I2,g.functionsIn=z2,g.groupBy=wS,g.initial=_x,g.intersection=yx,g.intersectionBy=bx,g.intersectionWith=wx,g.invert=P2,g.invertBy=B2,g.invokeMap=kS,g.iteratee=ql,g.keyBy=xS,g.keys=Et,g.keysIn=ee,g.map=gs,g.mapKeys=F2,g.mapValues=V2,g.matches=zC,g.matchesProperty=jC,g.memoize=ys,g.merge=L2,g.mergeWith=Im,g.method=PC,g.methodOf=BC,g.mixin=Jl,g.negate=bs,g.nthArg=FC,g.omit=W2,g.omitBy=q2,g.once=$S,g.orderBy=SS,g.over=VC,g.overArgs=FS,g.overEvery=LC,g.overSome=WC,g.partial=Pl,g.partialRight=Cm,g.partition=CS,g.pick=J2,g.pickBy=zm,g.property=Lm,g.propertyOf=qC,g.pull=Sx,g.pullAll=pm,g.pullAllBy=Cx,g.pullAllWith=Ox,g.pullAt=Mx,g.range=JC,g.rangeRight=HC,g.rearg=VS,g.reject=AS,g.remove=Ax,g.rest=LS,g.reverse=Il,g.sampleSize=NS,g.set=K2,g.setWith=U2,g.shuffle=ES,g.slice=Tx,g.sortBy=IS,g.sortedUniq=jx,g.sortedUniqBy=Px,g.split=_C,g.spread=WS,g.tail=Bx,g.take=$x,g.takeRight=Fx,g.takeRightWhile=Vx,g.takeWhile=Lx,g.tap=rS,g.throttle=qS,g.thru=ms,g.toArray=Nm,g.toPairs=jm,g.toPairsIn=Pm,g.toPath=YC,g.toPlainObject=Dm,g.transform=G2,g.unary=JS,g.union=Wx,g.unionBy=qx,g.unionWith=Jx,g.uniq=Hx,g.uniqBy=Kx,g.uniqWith=Ux,g.unset=Z2,g.unzip=zl,g.unzipWith=mm,g.update=Y2,g.updateWith=Q2,g.values=to,g.valuesIn=X2,g.without=Gx,g.words=Fm,g.wrap=HS,g.xor=Zx,g.xorBy=Yx,g.xorWith=Qx,g.zip=Xx,g.zipObject=tS,g.zipObjectDeep=eS,g.zipWith=nS,g.entries=jm,g.entriesIn=Pm,g.extend=Rm,g.extendWith=ks,Jl(g,g),g.add=XC,g.attempt=Vm,g.camelCase=rC,g.capitalize=Bm,g.ceil=tO,g.clamp=tC,g.clone=US,g.cloneDeep=ZS,g.cloneDeepWith=YS,g.cloneWith=GS,g.conformsTo=QS,g.deburr=$m,g.defaultTo=DC,g.divide=eO,g.endsWith=oC,g.eq=$e,g.escape=iC,g.escapeRegExp=sC,g.every=dS,g.find=mS,g.findIndex=um,g.findKey=A2,g.findLast=gS,g.findLastIndex=hm,g.findLastKey=T2,g.floor=nO,g.forEach=_m,g.forEachRight=ym,g.forIn=N2,g.forInRight=E2,g.forOwn=D2,g.forOwnRight=R2,g.get=Fl,g.gt=XS,g.gte=t2,g.has=j2,g.hasIn=Vl,g.head=dm,g.identity=ne,g.includes=vS,g.indexOf=gx,g.inRange=eC,g.invoke=$2,g.isArguments=wr,g.isArray=Q,g.isArrayBuffer=e2,g.isArrayLike=te,g.isArrayLikeObject=St,g.isBoolean=n2,g.isBuffer=Zn,g.isDate=r2,g.isElement=o2,g.isEmpty=i2,g.isEqual=s2,g.isEqualWith=a2,g.isError=Bl,g.isFinite=l2,g.isFunction=xn,g.isInteger=Om,g.isLength=ws,g.isMap=Mm,g.isMatch=c2,g.isMatchWith=u2,g.isNaN=h2,g.isNative=f2,g.isNil=p2,g.isNull=d2,g.isNumber=Am,g.isObject=kt,g.isObjectLike=xt,g.isPlainObject=Jo,g.isRegExp=$l,g.isSafeInteger=m2,g.isSet=Tm,g.isString=vs,g.isSymbol=he,g.isTypedArray=Xr,g.isUndefined=g2,g.isWeakMap=_2,g.isWeakSet=y2,g.join=vx,g.kebabCase=aC,g.last=Se,g.lastIndexOf=kx,g.lowerCase=lC,g.lowerFirst=cC,g.lt=b2,g.lte=w2,g.max=rO,g.maxBy=oO,g.mean=iO,g.meanBy=sO,g.min=aO,g.minBy=lO,g.stubArray=Kl,g.stubFalse=Ul,g.stubObject=KC,g.stubString=UC,g.stubTrue=GC,g.multiply=cO,g.nth=xx,g.noConflict=$C,g.noop=Hl,g.now=_s,g.pad=uC,g.padEnd=hC,g.padStart=fC,g.parseInt=dC,g.random=nC,g.reduce=OS,g.reduceRight=MS,g.repeat=pC,g.replace=mC,g.result=H2,g.round=uO,g.runInContext=S,g.sample=TS,g.size=DS,g.snakeCase=gC,g.some=RS,g.sortedIndex=Nx,g.sortedIndexBy=Ex,g.sortedIndexOf=Dx,g.sortedLastIndex=Rx,g.sortedLastIndexBy=Ix,g.sortedLastIndexOf=zx,g.startCase=yC,g.startsWith=bC,g.subtract=hO,g.sum=fO,g.sumBy=dO,g.template=wC,g.times=ZC,g.toFinite=Sn,g.toInteger=et,g.toLength=Em,g.toLower=vC,g.toNumber=Ce,g.toSafeInteger=v2,g.toString=ft,g.toUpper=kC,g.trim=xC,g.trimEnd=SC,g.trimStart=CC,g.truncate=OC,g.unescape=MC,g.uniqueId=QC,g.upperCase=AC,g.upperFirst=Ll,g.each=_m,g.eachRight=ym,g.first=dm,Jl(g,function(){var o={};return on(g,function(s,u){dt.call(g.prototype,u)||(o[u]=s)}),o}(),{chain:!1}),g.VERSION=r,be(["bind","bindKey","curry","curryRight","partial","partialRight"],function(o){g[o].placeholder=g}),be(["drop","take"],function(o,s){at.prototype[o]=function(u){u=u===e?1:At(et(u),0);var f=this.__filtered__&&!s?new at(this):this.clone();return f.__filtered__?f.__takeCount__=Ft(u,f.__takeCount__):f.__views__.push({size:Ft(u,rn),type:o+(f.__dir__<0?"Right":"")}),f},at.prototype[o+"Right"]=function(u){return this.reverse()[o](u).reverse()}}),be(["filter","map","takeWhile"],function(o,s){var u=s+1,f=u==fd||u==Sb;at.prototype[o]=function(p){var _=this.clone();return _.__iteratees__.push({iteratee:K(p,3),type:u}),_.__filtered__=_.__filtered__||f,_}}),be(["head","last"],function(o,s){var u="take"+(s?"Right":"");at.prototype[o]=function(){return this[u](1).value()[0]}}),be(["initial","tail"],function(o,s){var u="drop"+(s?"":"Right");at.prototype[o]=function(){return this.__filtered__?new at(this):this[u](1)}}),at.prototype.compact=function(){return this.filter(ne)},at.prototype.find=function(o){return this.filter(o).head()},at.prototype.findLast=function(o){return this.reverse().find(o)},at.prototype.invokeMap=rt(function(o,s){return typeof o=="function"?new at(this):this.map(function(u){return $o(u,o,s)})}),at.prototype.reject=function(o){return this.filter(bs(K(o)))},at.prototype.slice=function(o,s){o=et(o);var u=this;return u.__filtered__&&(o>0||s<0)?new at(u):(o<0?u=u.takeRight(-o):o&&(u=u.drop(o)),s!==e&&(s=et(s),u=s<0?u.dropRight(-s):u.take(s-o)),u)},at.prototype.takeRightWhile=function(o){return this.reverse().takeWhile(o).reverse()},at.prototype.toArray=function(){return this.take(rn)},on(at.prototype,function(o,s){var u=/^(?:filter|find|map|reject)|While$/.test(s),f=/^(?:head|last)$/.test(s),p=g[f?"take"+(s=="last"?"Right":""):s],_=f||/^find/.test(s);!p||(g.prototype[s]=function(){var w=this.__wrapped__,k=f?[1]:arguments,O=w instanceof at,D=k[0],R=O||Q(w),I=function(it){var lt=p.apply(g,Wn([it],k));return f&&$?lt[0]:lt};R&&u&&typeof D=="function"&&D.length!=1&&(O=R=!1);var $=this.__chain__,H=!!this.__actions__.length,U=_&&!$,nt=O&&!H;if(!_&&R){w=nt?w:new at(this);var G=o.apply(w,k);return G.__actions__.push({func:ms,args:[I],thisArg:e}),new ve(G,$)}return U&&nt?o.apply(this,k):(G=this.thru(I),U?f?G.value()[0]:G.value():G)})}),be(["pop","push","shift","sort","splice","unshift"],function(o){var s=Fi[o],u=/^(?:push|sort|unshift)$/.test(o)?"tap":"thru",f=/^(?:pop|shift)$/.test(o);g.prototype[o]=function(){var p=arguments;if(f&&!this.__chain__){var _=this.value();return s.apply(Q(_)?_:[],p)}return this[u](function(w){return s.apply(Q(w)?w:[],p)})}}),on(at.prototype,function(o,s){var u=g[s];if(u){var f=u.name+"";dt.call(Ur,f)||(Ur[f]=[]),Ur[f].push({name:s,func:u})}}),Ur[ls(e,J).name]=[{name:"wrapper",func:e}],at.prototype.clone=Mv,at.prototype.reverse=Av,at.prototype.value=Tv,g.prototype.at=oS,g.prototype.chain=iS,g.prototype.commit=sS,g.prototype.next=aS,g.prototype.plant=cS,g.prototype.reverse=uS,g.prototype.toJSON=g.prototype.valueOf=g.prototype.value=hS,g.prototype.first=g.prototype.head,Do&&(g.prototype[Do]=lS),g},Jr=sv();fr?((fr.exports=Jr)._=Jr,qa._=Jr):It._=Jr}).call(ko)})(Oa,Oa.exports);const ur=new u_(nb),Pr="my_text";function td(n){const{markType:t,makeAttrs:e}=n;return(r,i)=>{const a=r.tr,{$from:l,$to:c}=r.selection.ranges[0],h=l.pos,d=c.pos;return a.addMark(h,d,ur.marks[t].create(e())),i!==void 0&&i(a),!0}}const pb={...zy,"Mod-b":Vf(ur.marks.strong),"Mod-i":Vf(ur.marks.em),"Mod-e":td({markType:"comment",makeAttrs:()=>({id:Xf.v4()})}),"Mod-k":td({markType:"link",makeAttrs:()=>({url:`https://www.google.com/search?q=${Xf.v4()}`})})},mb=(n,t)=>{let e=U0({my_text:n});return t&&(e=As(e,r=>{for(const i of t)i.action==="addMark"&&ei(r,"my_text",i.markType,`[${i.startIndex}..${i.endIndex}]`,!0)})),[e,K0(e)]},ed=(n,t)=>{console.log("applying patch",t);let e=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;switch(t.action){case"mark":{for(const i of t.marks){const[a,l]=i.key.split(":");let c;a==="link"&&(c={url:i.value}),a==="comment"&&(c={id:l,text:i.value}),i.value===!1?n=n.removeMark(Br(i.start),Br(i.end),ur.mark(a,c)):n=n.addMark(Br(i.start),Br(i.end),ur.mark(a,c)),e=Math.min(e,i.start),r=Math.max(r,i.end)}return{transaction:n,startPos:Br(e),endPos:Br(r)}}}throw new Error(`BUG: Unsupported patch type '${t.action}'`)};function nd(n){const{actorId:t,editorNode:e,changesNode:r,publisher:i,handleClickOn:a,onRemotePatchApplied:l,editable:c}=n;let{doc:h}=n;const d=new rb({handleFlush:b=>{i.publish(t,b)}});d.start();const m=b=>{};i.subscribe(t,b=>{if(b.length===0)return;let C=v.state,N=C.tr;h=J0(h,b,{patchCallback:P=>{for(const J of P){const mt=ed(N,J);let{transaction:st}=mt;const{startPos:ot,endPos:yt}=mt;l&&(st=l({transaction:st,view:v,startPos:ot,endPos:yt})),N=st}}})[0],C=C.apply(N),v.updateState(C)});const y=Mr.create({schema:ur,plugins:[Wy(pb)],doc:gb({schema:ur,text:h[Pr]})}),v=new py(e,{state:y,handleClickOn:a,editable:()=>c,dispatchTransaction:b=>{let C=v.state;const N=_b({doc:h,txn:b}),{change:P,patches:J}=N;if(h=N.doc,P){let mt=C.tr;for(const st of J){const{transaction:ot}=ed(mt,st);mt=ot}C=C.apply(mt),d.enqueue(P)}b.selectionSet&&(C=C.apply(C.tr.setSelection(new pt(C.doc.resolve(b.selection.anchor),C.doc.resolve(b.selection.head))))),v.updateState(C),console.groupEnd()}});return{doc:h,view:v,queue:d,outputDebugForChange:m}}function pn(n,t){return Oa.exports.clamp(n-1,0,t.textContent.length)}function Br(n){return n+1}function gb(n){const{schema:t,text:e}=n;return e===""?t.node("doc",void 0,[t.node("paragraph",[])]):t.node("doc",void 0,[t.node("paragraph",void 0,t.text(e,[]))])}function _b(n){const t=n.doc,{txn:e}=n;if(e.steps.length===0)return{doc:t,change:null,patches:[]};let r=[];const i=As(t,{patchCallback:l=>{r=l}},l=>{for(const c of e.steps)if(c instanceof Bt)if(c.slice){l.my_text=l.my_text.slice(pn(c.from,e.before),pn(c.to,e.before));const h=c.slice.content.textBetween(0,c.slice.content.size),d=pn(c.from,e.before);l.my_text=`${l.my_text.slice(0,d)}${h}${l.my_text.slice(d)}`}else l.my_text=l.my_text.slice(pn(c.from,e.before),pn(c.to,e.before));else if(c instanceof un){if(!Jf(c.mark.type.name))throw new Error(`Invalid mark type: ${c.mark.type.name}`);const h=pn(c.from,e.before),d=pn(c.to,e.before);if(c.mark.type.name==="comment"){if(!c.mark.attrs||typeof c.mark.attrs.id!="string")throw new Error("Expected comment mark to have id attrs");ei(l,Pr,`${c.mark.type.name}:${c.mark.attrs.id}`,`[${h}..${d}]`,!0)}else if(c.mark.type.name==="link"){if(!c.mark.attrs||typeof c.mark.attrs.url!="string")throw new Error("Expected link mark to have url attrs");ei(l,Pr,`${c.mark.type.name}`,`[${h}..${d}]`,c.mark.attrs.url)}else ei(l,Pr,`${c.mark.type.name}`,`[${h}..${d}]`,!0)}else if(c instanceof Ae){if(!Jf(c.mark.type.name))throw new Error(`Invalid mark type: ${c.mark.type.name}`);const h=pn(c.from,e.before),d=pn(c.to,e.before);if(c.mark.type.name==="comment"){if(!c.mark.attrs||typeof c.mark.attrs.id!="string")throw new Error("Expected comment mark to have id attrs");Vu(l,Pr,`${c.mark.type.name}:${c.mark.attrs.id}`,h,d)}else Vu(l,Pr,c.mark.type.name,h,d)}}),a=q0(t,i);if(a.length>1)throw new Error("BUG: Expected only one change");return{doc:i,change:a[0],patches:r}}class yb{constructor(){vr(this,"subscribers",{})}subscribe(t,e){if(this.subscribers[t])throw new Error(`Subscriber already exists: ${t}`);this.subscribers[t]=e}unsubscribe(t){if(!this.subscribers[t])throw new Error(`Subscriber not found: ${t}`);delete this.subscribers[t]}publish(t,e){for(const[r,i]of Object.entries(this.subscribers))r!==t&&i(e)}}const rd=new yb,Ai={},od=(n,t)=>{n.innerHTML=t.map(e=>`\u2022 ${e.type.name} ${Object.keys(e.attrs).length!==0?JSON.stringify(e.attrs):""}`).join("<br/>")},[bb,wb]=mb("This is the Peritext editor demo. Press sync to synchronize the editors. Ctrl-B for bold, Ctrl-i for italic, Ctrl-k for link, Ctrl-e for comment",[{action:"addMark",markType:"strong",startIndex:84,endIndex:88},{action:"addMark",markType:"em",startIndex:100,endIndex:107},{action:"addMark",markType:"link",attrs:{url:"http://inkandswitch.com"},startIndex:120,endIndex:124},{action:"addMark",markType:"comment",attrs:{id:"1"},startIndex:137,endIndex:144}]),tn=document.querySelector("#alice"),id=tn==null?void 0:tn.querySelector(".editor"),sd=tn==null?void 0:tn.querySelector(".changes"),ad=tn==null?void 0:tn.querySelector(".marks");if(tn&&id&&sd&&ad)Ai.alice=nd({actorId:"alice",editorNode:id,changesNode:sd,doc:bb,publisher:rd,editable:!0,handleClickOn:(n,t,e,r,i,a)=>{if(!a)return!1;const l=n.state.doc.resolve(t).marks();return od(ad,l),!1}});else throw new Error("Didn't find expected node in the DOM");const en=document.querySelector("#bob"),ld=en==null?void 0:en.querySelector(".editor"),cd=en==null?void 0:en.querySelector(".changes"),ud=en==null?void 0:en.querySelector(".marks");if(en&&ld&&cd&&ud)Ai.bob=nd({actorId:"bob",editorNode:ld,changesNode:cd,doc:wb,publisher:rd,editable:!0,handleClickOn:(n,t,e,r,i,a)=>{if(!a)return!1;const l=n.state.doc.resolve(t).marks();return od(ud,l),!1}});else throw new Error("Didn't find expected node in the DOM");for(const n of Object.values(Ai))n.queue.drop();(hd=document.querySelector("#sync"))==null||hd.addEventListener("click",()=>{for(const n of Object.values(Ai))n.queue.flush()})})();
